[
["index.html", "Loss Data Analytics Preface Acknowledgements Contributors Reviewers For our Readers", " Loss Data Analytics An open text authored by the Actuarial Community Preface Date: 22 April 2020 Book Description Loss Data Analytics is an interactive, online, freely available text. The online version contains many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. A subset of the book is available for offline reading in pdf and EPUB formats. The online text will be available in multiple languages to promote access to a worldwide audience. What will success look like? The online text will be freely available to a worldwide audience. The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. Moreover, a subset of the book will be available in pdf format for low-cost printing. The online text will be available in multiple languages to promote access to a worldwide audience. How will the text be used? This book will be useful in actuarial curricula worldwide. It will cover the loss data learning objectives of the major actuarial organizations. Thus, it will be suitable for classroom use at universities as well as for use by independent learners seeking to pass professional actuarial examinations. Moreover, the text will also be useful for the continuing professional development of actuaries and other professionals in insurance and related financial risk management industries. Why is this good for the profession? An online text is a type of open educational resource (OER). One important benefit of an OER is that it equalizes access to knowledge, thus permitting a broader community to learn about the actuarial profession. Moreover, it has the capacity to engage viewers through active learning that deepens the learning process, producing analysts more capable of solid actuarial work. Why is this good for students and teachers and others involved in the learning process? Cost is often cited as an important factor for students and teachers in textbook selection (see a recent post on the $400 textbook). Students will also appreciate the ability to “carry the book around” on their mobile devices. Why loss data analytics? The intent is that this type of resource will eventually permeate throughout the actuarial curriculum. Given the dramatic changes in the way that actuaries treat data, loss data seems like a natural place to start. The idea behind the name loss data analytics is to integrate classical loss data models from applied probability with modern analytic tools. In particular, we recognize that big data (including social media and usage based insurance) are here to stay and that high speed computation is readily available. Project Goal The project goal is to have the actuarial community author our textbooks in a collaborative fashion. To get involved, please visit our Open Actuarial Textbooks Project Site. Acknowledgements Edward Frees acknowledges the John and Anne Oros Distinguished Chair for Inspired Learning in Business which provided seed money to support the project. Frees and his Wisconsin colleagues also acknowledge a Society of Actuaries Center of Excellence Grant that provided funding to support work in dependence modeling and health initiatives. Wisconsin also provided an education innovation grant that provided partial support for the many students who have worked on this project. We acknowledge the Society of Actuaries for permission to use problems from their examinations. We thank Rob Hyndman, Monash University, for allowing us to use his excellent style files to produce the online version of the book. We thank Yihui Xie and his colleagues at Rstudio for the R bookdown package that allows us to produce this book. We also wish to acknowledge the support and sponsorship of the International Association of Black Actuaries in our joint efforts to provide actuarial educational content to all. Contributors The project goal is to have the actuarial community author our textbooks in a collaborative fashion. The following contributors have taken a leadership role in developing Loss Data Analytics. Zeinab Amin is the Director of the Actuarial Science Program and Associate Dean for Undergraduate Studies of the School of Sciences and Engineering at the American University in Cairo (AUC). Amin holds a PhD in Statistics and is an Associate of the Society of Actuaries. Amin is the recipient of the 2016 Excellence in Academic Service Award and the 2009 Excellence in Teaching Award from AUC. Amin has designed and taught a variety of statistics and actuarial science courses. Amin’s current area of research includes quantitative risk assessment, reliability assessment, general statistical modelling, and Bayesian statistics. Katrien Antonio, KU Leuven Jan Beirlant, KU Leuven Arthur Charpentier is a professor in the Department of Mathematics at the Université du Québec á Montréal. Prior to that, he worked at a large general insurance company in Hong Kong, China, and the French Federation of Insurers in Paris, France. He received a MS on mathematical economics at Université Paris Dauphine and a MS in actuarial science at ENSAE (National School of Statistics) in Paris, and a PhD degree from KU Leuven, Belgium. His research interests include econometrics, applied probability and actuarial science. He has published several books (the most recent one on Computational Actuarial Science with R, CRC) and papers on a variety of topics. He is a Fellow of the French Institute of Actuaries, and was in charge of the ‘Data Science for Actuaries’ program from 2015 to 2018. Curtis Gary Dean is the Lincoln Financial Distinguished Professor of Actuarial Science at Ball State University. He is a Fellow of the Casualty Actuarial Society and a CFA charterholder. He has extensive practical experience as an actuary at American States Insurance, SAFECO, and Travelers. He has served the CAS and actuarial profession as chair of the Examination Committee, first editor-in-chief for Variance: Advancing the Science of Risk, and as a member of the Board of Directors and the Executive Council. He contributed a chapter to Predictive Modeling Applications in Actuarial Science published by Cambridge University Press. Edward W. (Jed) Frees is an emeritus professor, formerly the Hickman-Larson Chair of Actuarial Science at the University of Wisconsin-Madison. He is a Fellow of both the Society of Actuaries and the American Statistical Association. He has published extensively (a four-time winner of the Halmstad and Prize for best paper published in the actuarial literature) and has written three books. He also is a co-editor of the two-volume series Predictive Modeling Applications in Actuarial Science published by Cambridge University Press. Guojun Gan is an assistant professor in the Department of Mathematics at the University of Connecticut, where he has been since August 2014. Prior to that, he worked at a large life insurance company in Toronto, Canada for six years. He received a BS degree from Jilin University, Changchun, China, in 2001 and MS and PhD degrees from York University, Toronto, Canada, in 2003 and 2007, respectively. His research interests include data mining and actuarial science. He has published several books and papers on a variety of topics, including data clustering, variable annuity, mathematical finance, applied statistics, and VBA programming. Lisa Gao is a PhD candidate in the Risk and Insurance department at the University of Wisconsin-Madison. She holds a BMath in Actuarial Science and Statistics from the University of Waterloo and is an Associate of the Society of Actuaries. José Garrido, Concordia University Lei (Larry) Hua is an Associate Professor of Actuarial Science at Northern Illinois University. He earned a PhD degree in Statistics from the University of British Columbia. He is an Associate of the Society of Actuaries. His research work focuses on multivariate dependence modeling for non-Gaussian phenomena and innovative applications for financial and insurance industries. Noriszura Ismail is a Professor and Head of Actuarial Science Program, Universiti Kebangsaan Malaysia (UKM). She specializes in Risk Modelling and Applied Statistics. She obtained her BSc and MSc (Actuarial Science) in 1991 and 1993 from University of Iowa, and her PhD (Statistics) in 2007 from UKM. She also passed several papers from Society of Actuaries in 1994. She has received several research grants from Ministry of Higher Education Malaysia (MOHE) and UKM, totaling about MYR1.8 million. She has successfully supervised and co-supervised several PhD students (13 completed and 11 on-going). She currently has about 180 publications, consisting of 88 journals and 95 proceedings. Joseph H.T. Kim, Ph.D., FSA, CERA, is Associate Professor of Applied Statistics at Yonsei University, Seoul, Korea. He holds a Ph.D. degree in Actuarial Science from the University of Waterloo, at which he taught as Assistant Professor. He also worked in the life insurance industry. He has published papers in Insurance Mathematics and Economics, Journal of Risk and Insurance, Journal of Banking and Finance, ASTIN Bulletin, and North American Actuarial Journal, among others. Nii-Armah Okine is a dissertator at the business school of University of Wisconsin-Madison with a major in actuarial science. He obtained his master’s degree in Actuarial science from Illinois State University. His research interests includes micro-level reserving, joint longitudinal-survival modeling, dependence modelling, micro insurance and machine learning. Margie Rosenberg - University of Wisconsin Emine Selin Sarıdaş is a doctoral candidate in the Statistics department of Mimar Sinan University. She holds a bachelor degree in Actuarial Science with a minor in Economics and a master degree in Actuarial Science from Hacettepe University. Her research interest includes dependence modeling, regression, loss models and life contingencies. Peng Shi is an associate professor in the Risk and Insurance Department at the Wisconsin School of Business. He is also the Charles &amp; Laura Albright Professor in Business and Finance. Professor Shi is an Associate of the Casualty Actuarial Society (ACAS) and a Fellow of the Society of Actuaries (FSA). He received a Ph.D. in actuarial science from the University of Wisconsin-Madison. His research interests are problems at the intersection of insurance and statistics. He has won several research awards, including the Charles A. Hachemeister Prize, the Ronald Bornhuetter Loss Reserve Prize, and the American Risk and Insurance Association Prize. Nariankadu D. Shyamalkumar (Shyamal) is an associate professor in the Department of Statistics and Actuarial Science at The University of Iowa. He is an Associate of the Society of Actuaries, and has volunteered in various elected and non-elected roles within the SoA. Having a broad theoretical interest as well as interest in computing, he has published in prominent actuarial, computer science, probability theory, and statistical journals. Moreover, he has worked in the financial industry, and since then served as an independent consultant to the insurance industry. He has experience educating actuaries in both Mexico and the US, serving in the roles of directing an undergraduate program, and as a graduate adviser for both masters and doctoral students. Jianxi Su is an Assistant Professor at the Department of Statistics at Purdue University. He is the Associate Director of Purdue’s Actuarial Science. Prior to joining Purdue in 2016, he completed the PhD at York University (2012-2015). He obtained the Fellow of the Society of Actuaries (FSA) in 2017. His research expertise are in dependence modelling, risk management, and pricing. During the PhD candidature, Jianxi also worked as a research associate at the Model Validation and ORSA Implementation team of Sun Life Financial (Toronto office). Tim Verdonck is associate professor at the University of Antwerp. He has a degree in Mathematics and a PhD in Science: Mathematics, obtained at the University of Antwerp. During his PhD he successfully took the Master in Insurance and the Master in Financial and Actuarial Engineering, both at KU Leuven. His research focuses on the adaptation and application of robust statistical methods for insurance and finance data. Krupa Viswanathan is an Associate Professor in the Risk, Insurance and Healthcare Management Department in the Fox School of Business, Temple University. She is an Associate of the Society of Actuaries. She teaches courses in Actuarial Science and Risk Management at the undergraduate and graduate levels. Her research interests include corporate governance of insurance companies, capital management, and sentiment analysis. She received her Ph.D. from The Wharton School of the University of Pennsylvania. Reviewers Our goal is to have the actuarial community author our textbooks in a collaborative fashion. Part of the writing process involves many reviewers who generously donated their time to help make this book better. They are: Yair Babab Chunsheng Ban, Ohio State University Vytaras Brazauskas, University of Wisconsin - Milwaukee Chun Yong Chew, Universiti Tunku Abdul Rahman (UTAR) Eren Dodd, University of Southampton Gordon Enderle, University of Wisconsin - Madison Rob Erhardt, Wake Forest University Runhun Feng, University of Illinois Liang (Jason) Hong, Robert Morris University Fei Huang, Australian National University Hirokazu (Iwahiro) Iwasawa Himchan Jeong, University of Connecticut Min Ji, Towson University Paul Herbert Johnson, University of Wisconsin - Madison Samuel Kolins, Lebonan Valley College Andrew Kwon-Nakamura, Zurich North America Ambrose Lo, University of Iowa Mark Maxwell, University of Texas at Austin Tatjana Miljkovic, Miami University Bell Ouelega, American University in Cairo Zhiyu (Frank) Quan, University of Connecticut Jiandong Ren, Western University Rajesh V. Sahasrabuddhe, Oliver Wyman Ranee Thiagarajah, Illinois State University Ping Wang, Saint Johns University Chengguo Weng, University of Waterloo Toby White, Drake University Michelle Xia, Northern Illinois University Di (Cindy) Xu, University of Nebraska - Lincoln Lina Xu, Columbia University Lu Yang, University of Amsterdam Jorge Yslas, University of Copenhagen Jeffrey Zheng, Temple University Hongjuan Zhou, Arizona State University For our Readers We hope that you find this book worthwhile and even enjoyable. For your convenience, at our Github Landing site (https://openacttexts.github.io/), you will find links to the book that you can (freely) download for offline reading, including a pdf version (for Adobe Acrobat) and an EPUB version suitable for mobile devices. Data for running our examples are available at the same site. In developing this book, we are emphasizing the online version that has lots of great features such as a glossary, code and solutions to examples that you can be revealed interactively. For example, you will find that the statistical code is hidden and can only be seen by clicking on terms such as R Code for Frequency Table Insample &lt;- read.csv(&quot;Insample.csv&quot;, header=T, na.strings=c(&quot;.&quot;), stringsAsFactors=FALSE) Insample2010 &lt;- subset(Insample, Year==2010) table(Insample2010$Freq) We hide the code because we don’t want to insist that you use the R statistical software (although we like it). Still, we encourage you to try some statistical code as you read the book – we have opted to make it easy to learn R as you go. We have even set up a separate R Code for Loss Data Analytics site to explain more of the details of the code. Freely available, interactive textbooks represent a new venture in actuarial education and we need your input. Although a lot of effort has gone into the development, we expect hiccoughs. Please let your instructor know about opportunities for improvement, write us through our project site, or contact chapter contributors directly with suggested improvements. "],
["C-Intro.html", "Chapter 1 Introduction to Loss Data Analytics 1.1 Relevance of Analytics to Insurance Activities 1.2 Insurance Company Operations 1.3 Case Study: Wisconsin Property Fund 1.4 Further Resources and Contributors", " Chapter 1 Introduction to Loss Data Analytics Chapter Preview. This book introduces readers to methods of analyzing insurance data. Section 1.1 begins with a discussion of why the use of data is important in the insurance industry. Section 1.2 gives a general overview of the purposes of analyzing insurance data which is reinforced in the Section 1.3 case study. Naturally, there is a huge gap between the broad goals summarized in the overview and a case study application; this gap is covered through the methods and techniques of data analysis covered in the rest of the text. 1.1 Relevance of Analytics to Insurance Activities In this section, you learn how to: Summarize the importance of insurance to consumers and the economy Describe analytics Identify data generating events associated with the timeline of a typical insurance contract 1.1.1 Nature and Relevance of Insurance This book introduces the process of using data to make decisions in an insurance context. It does not assume that readers are familiar with insurance but introduces insurance concepts as needed. If you are new to insurance, then it is probably easiest to think about an insurance policy that covers the contents of an apartment or house that you are renting (known as renters insurance) or the contents and property of a building that is owned by you or a friend (known as homeowners insurance). Another common example is automobile insurance. In the event of an accident, this policy may cover damage to your vehicle, damage to other vehicles in the accident, as well as medical expenses of those injured in the accident. One way to think about the nature of insurance is who buys it. Renters, homeowners, and auto insurance are examples of personal insurance in that these are policies issued to people. Businesses also buy insurance, such as coverage on their properties, and this is known as commercial insurance. The seller, an insurance company, is also known as an insurer. Even insurance companies need insurance; this is known as reinsurance. Another way to think about the nature of insurance is the type of risk being covered. In the U.S., policies such as renters and homeowners are known as property insurance whereas a policy such as auto that covers medical damages to people is known as casualty insurance. In the rest of the world, these are both known as nonlife or general insurance, to distinguish them from life insurance. Both life and non-life insurances are important components of the world economy. The Insurance Information Institute (2016) estimates that direct insurance premiums in the world for 2014 was 2,654,549 for life and 2,123,699 for non-life; these figures are in millions of U.S. dollars. As noted earlier, the total represents 6.2% of the world GDP. Put another way, life accounts for 55.5% of insurance premiums and 3.4% of world GDP whereas non-life accounts for 44.5% of insurance premiums and 2.8% of world GDP. Both life and non-life represent important economic activities. Insurance may not be as entertaining as the sports industry (another industry that depends heavily on data) but it does affect the financial livelihoods of many. By almost any measure, insurance is a major economic activity. On a global level, insurance premiums comprised about 6.2% of the world gross domestic product (GDP) in 2014, (Insurance Information Institute 2016). As examples, premiums accounted for 18.9% of GDP in Taiwan (the highest in the study) and represented 7.3% of GDP in the United States. On a personal level, almost everyone owning a home has insurance to protect themselves in the event of a fire, hailstorm, or some other calamitous event. Almost every country requires insurance for those driving a car. In sum, although not particularly entertaining, insurance plays an important role in the economies of nations and the lives of individuals. 1.1.2 What is Analytics? Insurance is a data-driven industry. Like all major corporations and organizations, insurers use data when trying to decide how much to pay employees, how many employees to retain, how to market their services and products, how to forecast financial trends, and so on. These represent general areas of activities that are not specific to the insurance industry. Although each industry has its own data nuances and needs, the collection, analysis and use of data is an activity shared by all, from the internet giants to the small business, by public and governmental organizations, and is not specific to the insurance industry. You will find that the data collection and analysis methods and tools introduced in this text are relevant for all. In any data-driven industry, analytics is a key to deriving and extracting information from data. But what is analytics? Making data-driven business decisions has been described as business analytics, business intelligence, and data science. These terms, among others, are sometimes used interchangeably and sometimes refer to distinct applications. Business intelligence may focus on processes of collecting data, often through databases and data warehouses, whereas business analytics utilizes tools and methods for statistical analyses of data. In contrast to these two terms that emphasize business applications, the term data science can encompass broader data related applications in many scientific domains. For our purposes, we use the term analytics to refer to the process of using data to make decisions. This process involves gathering data, understanding concepts and models of uncertainty, making general inferences, and communicating results. When introducing data methods in this text, we will focus on losses that arise from, or related to, obligations in insurance contracts. This could be the amount of damage to one’s apartment under a renter’s insurance agreement, the amount needed to compensate someone that you hurt in a driving accident, and the like. We call these obligations insurance claim. With this focus, we will be able to introduce and directly use generally applicable statistical tools and techniques. 1.1.3 Insurance Processes Yet another way to think about the nature of insurance is by the duration of an insurance contract, known as the term. This text will focus on short-term insurance contracts. By short-term, we mean contracts where the insurance coverage is typically provided for a year or six months. Most commercial and personal contracts are for a year so that will be our default duration. An important exception is U.S. auto policies that are often six months in length. In contrast, we typically think of life insurance as a long-term contract where the default is to have a multi-year contract. For example, if a person 25 years old purchases a whole life policy that pays upon death of the insured and that person does not die until age 100, then the contract is in force for 75 years. There are other important differences between life and non-life products. In life insurance, the benefit amount is often stipulated in the contract provisions. In contrast, most non-life contracts provide for compensation of insured losses which are unknown before the accident. (There are usually limits placed on the compensation amounts.) In a life insurance contract that stretches over many years, the time value of money plays a prominent role. In a non-life contract, the random amount of compensation takes priority. In both life and non-life insurances, the frequency of claims is very important. For many life insurance contracts, the insured event (such as death) happens only once. In contrast, for non-life insurances such as automobile, it is common for individuals (especially young male drivers) to get into more than one accident during a year. So, our models need to reflect this observation; we will introduce different frequency models that you may also see when studying life insurance. For short-term insurance, the framework of the probabilistic model is straightforward. We think of a one-period model (the period length, e.g., one year, will be specified in the situation). At the beginning of the period, the insured pays the insurer a known premium that is agreed upon by both parties to the contract. At the end of the period, the insurer reimburses the insured for a (possibly multivariate) random loss. This framework will be developed as we proceed; but we first focus on integrating this framework with concerns about how the data may arise. From an insurer’s viewpoint, contracts may be only for a year but they tend to be renewed. Moreover, payments arising from claims during the year may extend well beyond a single year. One way to describe the data arising from operations of an insurance company is to use a timeline granular approach. A process approach provides an overall view of the events occurring during the life of an insurance contract, and their nature – random or planned, loss events (claims) and contract changes events, and so forth. In this micro oriented view, we can think about what happens to a contract at various stages of its existence. Figure 1.1 traces a timeline of a typical insurance contract. Throughout the life of the contract, the company regularly processes events such as premium collection and valuation, described in Section 1.2; these are marked with an x on the timeline. Non-regular and unanticipated events also occur. To illustrate, \\(\\mathrm{t}_2\\) and \\(\\mathrm{t}_4\\) mark the event of an insurance claim (some contracts, such as life insurance, can have only a single claim). Times \\(\\mathrm{t}_3\\) and \\(\\mathrm{t}_5\\) mark events when a policyholder wishes to alter certain contract features, such as the choice of a deductible or the amount of coverage. From a company perspective, one can even think about the contract initiation (arrival, time \\(\\mathrm{t}_1\\)) and contract termination (departure, time \\(\\mathrm{t}_6\\)) as uncertain events. (Alternatively, for some purposes, you may condition on these events and treat them as certain.) Figure 1.1: Timeline of a Typical Insurance Policy. Arrows mark the occurrences of random events. Each x marks the time of scheduled events that are typically non-random. Show Quiz Solution 1.2 Insurance Company Operations In this section, you learn how to: Describe five major operational areas of insurance companies. Identify the role of data and analytics opportunities within each operational area. Armed with insurance data, the end goal is to use data to make decisions. We will learn more about methods of analyzing and extrapolating data in future chapters. To begin, let us think about why we want to do the analysis. We will take the insurance company’s viewpoint (not the insured person) and introduce ways of bringing money in, paying it out, managing costs, and making sure that we have enough money to meet obligations. The emphasis is on insurance-specific operations rather than on general business activities such as advertising, marketing, and human resources management. Specifically, in many insurance companies, it is customary to aggregate detailed insurance processes into larger operational units; many companies use these functional areas to segregate employee activities and areas of responsibilities. Actuaries, other financial analysts, and insurance regulators work within these units and use data for the following activities: Initiating Insurance. At this stage, the company makes a decision as to whether or not to take on a risk (the underwriting stage) and assign an appropriate premium (or rate). Insurance analytics has its actuarial roots in ratemaking, where analysts seek to determine the right price for the right risk. Renewing Insurance. Many contracts, particularly in general insurance, have relatively short durations such as 6 months or a year. Although there is an implicit expectation that such contracts will be renewed, the insurer has the opportunity to decline coverage and to adjust the premium. Analytics is also used at this policy renewal stage where the goal is to retain profitable customers. Claims Management. Analytics has long been used in (1) detecting and preventing claims fraud, (2) managing claim costs, including identifying the appropriate support for claims handling expenses, as well as (3) understanding excess layers for reinsurance and retention. Loss Reserving. Analytic tools are used to provide management with an appropriate estimate of future obligations and to quantify the uncertainty of those estimates. Solvency and Capital Allocation. Deciding on the requisite amount of capital and on ways of allocating capital among alternative investments are also important analytics activities. Companies must understand how much capital is needed so that they will have sufficient flow of cash available to meet their obligations at the times they are expected to materialize (solvency). This is an important question that concerns not only company managers but also customers, company shareholders, regulatory authorities, as well as the public at large. Related to issues of how much capital is the question of how to allocate capital to differing financial projects, typically to maximize an investor’s return. Although this question can arise at several levels, insurance companies are typically concerned with how to allocate capital to different lines of business within a firm and to different subsidiaries of a parent firm. Although data represent a critical component of solvency and capital allocation, other components including the local and global economic framework, the financial investments environment, and quite specific requirements according to the regulatory environment of the day, are also important. Because of the background needed to address these components, we will not address solvency, capital allocation, and regulation issues in this text. Nonetheless, for all operating functions, we emphasize that analytics in the insurance industry is not an exercise that a small group of analysts can do by themselves. It requires an insurer to make significant investments in their information technology, marketing, underwriting, and actuarial functions. As these areas represent the primary end goals of the analysis of data, additional background on each operational unit is provided in the following subsections. 1.2.1 Initiating Insurance Setting the price of an insurance product can be a perplexing problem. This is in contrast to other industries such as manufacturing where the cost of a product is (relatively) known and provides a benchmark for assessing a market demand price. Similarly, in other areas of financial services, market prices are available and provide the basis for a market-consistent pricing structure of products. However, for many lines of insurance, the cost of a product is uncertain and market prices are unavailable. Expectations of the random cost is a reasonable place to start for a price. (If you have studied finance, then you will recall that an expectation is the optimal price for a risk-neutral insurer.) It has been traditional in insurance pricing to begin with the expected cost. Insurers then add margins to this, to account for the product’s riskiness, expenses incurred in servicing the product, and an allowance for profit/surplus of the company. Use of expected costs as a foundation for pricing is prevalent in some lines of the insurance business. These include automobile and homeowners insurance. For these lines, analytics has served to sharpen the market by making the calculation of the product’s expected cost more precise. The increasing availability of the internet to consumers has also promoted transparency in pricing; in today’s marketplace, consumers have ready access to competing quotes from a host of insurers. Insurers seek to increase their market share by refining their risk classification systems, thus achieving a better approximation of the products’ prices and enabling cream-skimming underwriting strategies (“cream-skimming” is a phrase used when the insurer underwrites only the best risks). Recent surveys (e.g., Earnix (2013)) indicate that pricing is the most common use of analytics among insurers. Underwriting, the process of classifying risks into homogeneous categories and assigning policyholders to these categories, lies at the core of ratemaking. Policyholders within a class (category) have similar risk profiles and so are charged the same insurance price. This is the concept of an actuarially fair premium; it is fair to charge different rates to policyholders only if they can be separated by identifiable risk factors. An early article, Two Studies in Automobile Insurance Ratemaking (Bailey and LeRoy 1960), provided a catalyst to the acceptance of analytic methods in the insurance industry. This paper addresses the problem of classification ratemaking. It describes an example of automobile insurance that has five use classes cross-classified with four merit rating classes. At that time, the contribution to premiums for use and merit rating classes were determined independently of each other. Thinking about the interacting effects of different classification variables is a more difficult problem. 1.2.2 Renewing Insurance Insurance is a type of financial service and, like many service contracts, insurance coverage is often agreed upon for a limited time period at which time coverage commitments are complete. Particularly for general insurance, the need for coverage continues and so efforts are made to issue a new contract providing similar coverage, when the existing contract comes to the end of its term. This is called policy renewal. Renewal issues can also arise in life insurance, e.g., term (temporary) life insurance. At the same time other contracts, such as life annuities, terminate upon the insured’s death and so issues of renewability are irrelevant. In the absence of legal restrictions, at renewal the insurer has the opportunity to: accept or decline to underwrite the risk; and determine a new premium, possibly in conjunction with a new classification of the risk. Risk classification and rating at renewal is based on two types of information. First, at the initial stage, the insurer has available many rating variables upon which decisions can be made. Many variables will not change, e.g., sex, whereas others are likely to have changed, e.g., age, and still others may or may not change, e.g., credit score. Second, unlike the initial stage, at renewal the insurer has available a history of policyholder’s loss experience, and this history can provide insights into the policyholder that are not available from rating variables. Modifying premiums with claims history is known as experience rating, also sometimes referred to as merit rating. Experience rating methods are either applied retrospectively or prospectively. With retrospective methods, a refund of a portion of the premium is provided to the policyholder in the event of favorable (to the insurer) experience. Retrospective premiums are common in life insurance arrangements (where policyholders earn dividends in the U.S., bonuses in the U.K., and profit sharing in Israeli term life coverage). In general insurance, prospective methods are more common, where favorable insured experience is rewarded through a lower renewal premium. Claims history can provide information about a policyholder’s risk appetite. For example, in personal lines it is common to use a variable to indicate whether or not a claim has occurred in the last three years. As another example, in a commercial line such as worker’s compensation, one may look to a policyholder’s average claim frequency or severity over the last three years. Claims history can reveal information that is otherwise hidden (to the insurer) about the policyholder. 1.2.3 Claims and Product Management In some of areas of insurance, the process of paying claims for insured events is relatively straightforward. For example, in life insurance, a simple death certificate is all that is needed to pay the benefit amount as provided in the contract. However, in non-life areas such as property and casualty insurance, the process can be much more complex. Think about even a relatively simple insured event such as automobile accident. Here, it is often required to determine which party is at fault, one needs to assess damage to all of the vehicles and people involved in the incident, both insured and non-insured, the expenses incurred in assessing the damages must be assessed, and so forth. The process of determining coverage, legal liability, and settling claims is known as claims adjustment. Insurance managers sometimes use the phrase claims leakage to mean dollars lost through claims management inefficiencies. There are many ways in which analytics can help manage the claims process, c.f., Gorman and Swenson (2013). Historically, the most important has been fraud detection. The claim adjusting process involves reducing information asymmetry (the claimant knows what happened; the company knows some of what happened). Mitigating fraud is an important part of the claims management process. Fraud detection is only one aspect of managing claims. More broadly, one can think about claims management as consisting of the following components: Claims triaging. Just as in the medical world, early identification and appropriate handling of high cost claims (patients, in the medical world), can lead to dramatic savings. For example, in workers compensation, insurers look to achieve early identification of those claims that run the risk of high medical costs and a long payout period. Early intervention into these cases could give insurers more control over the handling of the claim, the medical treatment, and the overall costs with an earlier return-to-work. Claims processing. The goal is to use analytics to identify routine situations that are anticipated to have small payouts. More complex situations may require more experienced adjusters and legal assistance to appropriately handle claims with high potential payouts. Adjustment decisions. Once a complex claim has been identified and assigned to an adjuster, analytic driven routines can be established to aid subsequent decision-making processes. Such processes can also be helpful for adjusters in developing case reserves, an estimate of the insurer’s future liability. This is an important input to the insurer’s loss reserves, described in Section 1.2.4. In addition to the insured’s reimbursement for losses, the insurer also needs to be concerned with another source of revenue outflow, expenses. loss adjustment expenses are part of an insurer’s cost of managing claims. Analytics can be used to reduce expenses directly related to claims handling (allocated) as well as general staff time for overseeing the claims processes (unallocated). The insurance industry has high operating costs relative to other portions of the financial services sectors. In addition to claims payments, there are many other ways in which insurers use data to manage their products. We have already discussed the need for analytics in underwriting, that is, risk classification at the initial acquisition and renewal stages. Insurers are also interested in which policyholders elect to renew their contract and, as with other products, monitor customer loyalty. Analytics can also be used to manage the portfolio, or collection, of risks that an insurer has acquired. When the risk is initially obtained, the insurer’s risk can be managed by imposing contract parameters that modify contract payouts. Chapters 3 and 10 describe common modifications including coinsurance, deductibles and policy upper limits. After the contract has been agreed upon with an insured, the insurer may still modify its net obligation by entering into a reinsurance agreement. This type of agreement is with a reinsurer, an insurer of an insurer. It is common for insurance companies to purchase insurance on its portfolio of risks to gain protection from unusual events, just as people and other companies do. 1.2.4 Loss Reserving An important feature that distinguishes insurance from other sectors of the economy is the timing of the exchange of considerations. In manufacturing, payments for goods are typically made at the time of a transaction. In contrast, for insurance, money received from a customer occurs in advance of benefits or services; these are rendered at a later date when the insured event occurs. This leads to the need to hold a reservoir of wealth to meet future obligations in respect to obligations made, and to gain the trust of the insureds that the company will be able to fulfill its commitments. The size of this reservoir of wealth, and the importance of ensuring its adequacy, is a major concern for the insurance industry. Setting aside money for unpaid claims is known as loss reserving; in some jurisdictions, reserves are also known as technical provisions. We saw in Figure 1.1 several times at which a company summarizes its financial position; these times are known as valuation dates. Claims that arise prior to valuation dates have typically been paid, are in the process of being paid, or are about to be paid; claims in the future of these valuation dates are unknown. A company must estimate these outstanding liabilities when determining its financial strength. Accurately determining loss reserves is important to insurers for many reasons. Loss reserves represent an anticipated claim that the insurer owes its customers. Under-reserving may result in a failure to meet claim liabilities. Conversely, an insurer with excessive reserves may present a weaker financial position than it truly has. Reserves provide an estimate for the unpaid cost of insurance that can be used for pricing contracts. Loss reserving is required by laws and regulations. The public has a strong interest in the financial strength and solvency of insurers. In addition to insurance company management and regulators, other stakeholders such as investors and customers make decisions that depend on company loss reserves. Loss reserving is a topic where there are substantive differences between life and general (also known as property and casualty, or non-life), insurance. In life insurance, the severity (amount of loss) is often not a source of uncertainty as payouts are specified in the contract. The frequency, driven by mortality of the insured, is a concern. However, because of the length of time for settlement of life insurance contracts, the time value of money uncertainty as measured from issue to date of payment can dominate frequency concerns. For example, for an insured who purchases a life contract at age 20, it would not be unusual for the contract to still be open in 60 years time, when the insured celebrates his or her 80th birthday. See, for example, Bowers et al. (1986) or Dickson, Hardy, and Waters (2013) for introductions to reserving for life insurance. Show Quiz Solution 1.3 Case Study: Wisconsin Property Fund In this section, we use the Wisconsin Property Fund as a case study. You learn how to: Describe how data generating events can produce data of interest to insurance analysts. Produce relevant summary statistics for each variable. Describe how these summary statistics can be used in each of the major operational areas of an insurance company. Let us illustrate the kind of data under consideration and the goals that we wish to achieve by examining the Local Government Property Insurance Fund (LGPIF), an insurance pool administered by the Wisconsin Office of the Insurance Commissioner. The LGPIF was established to provide property insurance for local government entities that include counties, cities, towns, villages, school districts, and library boards. The fund insures local government property such as government buildings, schools, libraries, and motor vehicles. The fund covers all property losses except those resulting from flood, earthquake, wear and tear, extremes in temperature, mold, war, nuclear reactions, and embezzlement or theft by an employee. The fund covers over a thousand local government entities who pay approximately \\$25 million in premiums each year and receive insurance coverage of about \\$75 billion. State government buildings are not covered; the LGPIF is for local government entities that have separate budgetary responsibilities and who need insurance to moderate the budget effects of uncertain insurable events. Coverage for local government property has been made available by the State of Wisconsin since 1911, thus providing a wealth of historical data. In this illustration, we restrict consideration to claims from coverage of building and contents; we do not consider claims from motor vehicles and specialized equipment owned by local entities (such as snow plowing machines). We also consider only claims that are closed, with obligations fully met. 1.3.1 Fund Claims Variables: Frequency and Severity At a fundamental level, insurance companies accept premiums in exchange for promises to compensate a policyholder upon the occurrence of an insured event. Indemnification is the compensation provided by the insurer for incurred hurt, loss, or damage that is covered by the policy. This compensation is also known as a claim. The extent of the payout, known as the severity, is a key financial expenditure for an insurer. In terms of money outgo, an insurer is indifferent to having ten claims of 100 when compared to one claim of 1,000. Nonetheless, it is common for insurers to study how often claims arise, known as the frequency of claims. The frequency is important for expenses, but it also influences contractual parameters (such as deductibles and policy limits that are described later) that are written on a per occurrence basis, is routinely monitored by insurance regulators, and can be a key driver in the overall indemnification obligation of the insurer. We shall consider the frequency and severity as the two main claim variables that we wish to understand, model, and manage. To illustrate, in 2010 there were 1,110 policyholders in the property fund who experienced a total of 1,377 claims. Table 1.1 shows the distribution. Almost two-thirds (0.637) of the policyholders did not have any claims and an additional 18.8% had only one claim. The remaining 17.5% (=1 - 0.637 - 0.188) had more than one claim; the policyholder with the highest number recorded 239 claims. The average number of claims for this sample was 1.24 (=1377/1110). Table 1.1: 2010 Claims Frequency Distribution Type Number 0 1 2 3 4 5 6 7 8 9 or more Sum Count 707 209 86 40 18 12 9 4 6 19 1,110 Claims 0 209 172 120 72 60 54 28 48 617 1,377 Proportion 0.637 0.188 0.077 0.036 0.016 0.011 0.008 0.004 0.005 0.017 1.000 R Code for Frequency Table Insample &lt;- read.csv(&quot;Insample.csv&quot;, header=T, na.strings=c(&quot;.&quot;), stringsAsFactors=FALSE) Insample2010 &lt;- subset(Insample, Year==2010) table(Insample2010$Freq) For the severity distribution, a common approach is to examine the distribution of the sample of 1,377 claims. However, another common approach is to examine the distribution of the average claims of those policyholders with claims. In our 2010 sample, there were 403 (=1110-707) such policyholders. For 209 of these policyholders with one claim, the average claim equals the only claim they experienced. For the policyholder with highest frequency, the average claim is an average over 239 separately reported claim events. This average is also known as the pure premium or loss cost. Table 1.2 summarizes the sample distribution of average severities from the 403 policyholders who made a claim; it shows that the average claim amount was 56,330 (all amounts are in U.S. Dollars). However, the average gives only a limited look at the distribution. More information can be gleaned from the summary statistics which show a very large claim in the amount of 12,920,000. Figure 1.2 provides further information about the distribution of sample claims, showing a distribution that is dominated by this single large claim so that the histogram is not very helpful. Even when removing the large claim, you will find a distribution that is skewed to the right. A generally accepted technique is to work with claims in logarithmic units especially for graphical purposes; the corresponding figure in the right-hand panel is much easier to interpret. Table 1.2: 2010 Average Severity Distribution Minimum First Quartile Median Mean Third Quartile Maximum 167 2,226 4,951 56,330 11,900 12,920,000 Figure 1.2: Distribution of Positive Average Severities R Code for Severity Distribution Table and Figures Insample &lt;- read.csv(&quot;Data/PropertyFundInsample.csv&quot;, header=T, na.strings=c(&quot;.&quot;), stringsAsFactors=FALSE) Insample2010 &lt;- subset(Insample, Year==2010) InsamplePos2010 &lt;- subset(Insample2010, yAvg&gt;0) # Table summary(InsamplePos2010$yAvg) length(InsamplePos2010$yAvg) # Figures par(mfrow=c(1, 2)) hist(InsamplePos2010$yAvg, main=&quot;&quot;, xlab=&quot;Average Claims&quot;) hist(log(InsamplePos2010$yAvg), main=&quot;&quot;, xlab=&quot;Logarithmic Average Claims&quot;) 1.3.2 Fund Rating Variables Developing models to represent and manage the two outcome variables, frequency and severity, is the focus of the early chapters of this text. However, when actuaries and other financial analysts use those models, they do so in the context of external variables. In general statistical terminology, one might call these explanatory or predictor variables; there are many other names in statistics, economics, psychology, and other disciplines. Because of our insurance focus, we call them rating variables as they will be useful in setting insurance rates and premiums. We earlier considered observations from a sample of 1,110 policyholders which may seem like a lot. However, as we will see in our forthcoming applications, because of the preponderance of zeros and the skewed nature of claims, actuaries typically yearn for more data. One common approach that we adopt here is to examine outcomes from multiple years, thus increasing the sample size. We will discuss the strengths and limitations of this strategy later but, at this juncture, we just wish to show the reader how it works. Specifically, Table 1.3 shows that we now consider policies over five years of data, 2006, …, 2010, inclusive. The data begins in 2006 because there was a shift in claim coding in 2005 so that comparisons with earlier years are not helpful. To mitigate the effect of open claims, we consider policy years prior to 2011. An open claim means that not all of the obligations for the claim are known at the time of the analysis; for some claims, such an injury to a person in an auto accident or in the workplace, it can take years before costs are fully known. Table 1.3: Claims Summary by Policyholder Year Average Frequency Average Severity Average Coverage Number of Policyholders 2006 0.951 9,695 32,498,186 1,154 2007 1.167 6,544 35,275,949 1,138 2008 0.974 5,311 37,267,485 1,125 2009 1.219 4,572 40,355,382 1,112 2010 1.241 20,452 41,242,070 1,110 R Code for Claims Summary by Policyholder Insample &lt;- read.csv(&quot;Data/PropertyFundInsample.csv&quot;, header=T, na.strings=c(&quot;.&quot;), stringsAsFactors=FALSE) library(doBy) T1A &lt;- summaryBy(Freq ~ Year, data = Insample, FUN = function(x) { c(m = mean(x), num=length(x)) } ) T1B &lt;- summaryBy(yAvg ~ Year, data = Insample, FUN = function(x) { c(m = mean(x), num=length(x)) } ) T1C &lt;- summaryBy(BCcov ~ Year, data = Insample, FUN = function(x) { c(m = mean(x), num=length(x)) } ) Table1In &lt;- cbind(T1A[1],T1A[2],T1B[2],T1C[2],T1A[3]) names(Table1In) &lt;- c(&quot;Year&quot;, &quot;Average Frequency&quot;,&quot;Average Severity&quot;, &quot;Average&quot;,&quot;Number of Policyholders&quot;) Table1In Table 1.3 shows that the average claim varies over time, especially with the high 2010 value (that we saw was due to a single large claim)1. The total number of policyholders is steadily declining and, conversely, the coverage is steadily increasing. The coverage variable is the amount of coverage of the property and contents. Roughly, you can think of it as the maximum possible payout of the insurer. For our immediate purposes, the coverage is our first rating variable. Other things being equal, we would expect that policyholders with larger coverage will have larger claims. We will make this vague idea much more precise as we proceed, and also justify this expectation with data. For a different look at the 2006-2010 data, Table 1.4 summarizes the distribution of our two outcomes, frequency and claims amount. In each case, the average exceeds the median, suggesting that the two distributions are right-skewed. In addition, the table summarizes our continuous rating variables, coverage and deductible amount. The table also suggests that these variables also have right-skewed distributions. Table 1.4: Summary of Claim Frequency and Severity, Deductibles, and Coverages Minimum Median Average Maximum Claim Frequency 0 0 1.109 263 Claim Severity 0 0 9,292 12,922,218 Deductible 500 1,000 3,365 100,000 Coverage (000’s) 8.937 11,354 37,281 2,444,797 R Code for Summary of Claim Frequency and Severity, Deductibles, and Coverages Insample &lt;- read.csv(&quot;Data/PropertyFundInsample.csv&quot;, header=T, na.strings=c(&quot;.&quot;), stringsAsFactors=FALSE) t1&lt;- summaryBy(Insample$Freq ~ 1, data = Insample, FUN = function(x) { c(ma=min(x), m1=median(x),m=mean(x),mb=max(x)) } ) names(t1) &lt;- c(&quot;Minimum&quot;, &quot;Median&quot;,&quot;Average&quot;, &quot;Maximum&quot;) t2 &lt;- summaryBy(Insample$yAvg ~ 1, data = Insample, FUN = function(x) { c(ma=min(x), m1=median(x), m=mean(x),mb=max(x)) } ) names(t2) &lt;- c(&quot;Minimum&quot;, &quot;Median&quot;,&quot;Average&quot;, &quot;Maximum&quot;) t3 &lt;- summaryBy(Deduct ~ 1, data = Insample, FUN = function(x) { c(ma=min(x), m1=median(x), m=mean(x),mb=max(x)) } ) names(t3) &lt;- c(&quot;Minimum&quot;, &quot;Median&quot;,&quot;Average&quot;, &quot;Maximum&quot;) t4 &lt;- summaryBy(BCcov/1000 ~ 1, data = Insample, FUN = function(x) { c(ma=min(x), m1=median(x), m=mean(x),mb=max(x)) } ) names(t4) &lt;- c(&quot;Minimum&quot;, &quot;Median&quot;,&quot;Average&quot;, &quot;Maximum&quot;) Table2 &lt;- rbind(t1,t2,t3,t4) Table2a &lt;- round(Table2,3) Rowlable &lt;- rbind(&quot;Claim Frequency&quot;,&quot;Claim Severity&quot;,&quot;Deductible&quot;,&quot;Coverage (000&#39;s)&quot;) Table2aa &lt;- cbind(Rowlable,as.matrix(Table2a)) Table2aa The following display describes the rating variables considered in this chapter. Hopefully, these are variables that you think might naturally be related to claims outcomes. You can learn more about them in Frees, Lee, and Yang (2016). To handle the skewness, we henceforth focus on logarithmic transformations of coverage and deductibles. Description of Rating Variables \\[{\\small \\begin{matrix} \\begin{array}{ l | l} \\hline Variable &amp; Description \\\\ \\hline \\text{EntityType} &amp; \\text{Categorical variable that is one of six types: (Village, City,} \\\\ &amp; ~~~~ \\text{County, Misc, School, or Town)} \\\\ \\text{LnCoverage} &amp; \\text{Total building and content coverage, in logarithmic millions of dollars}\\\\ \\text{LnDeduct} &amp; \\text{Deductible, in logarithmic dollars} \\\\ \\text{AlarmCredit} &amp; \\text{Categorical variable that is one of four types: (0, 5, 10, or 15)} \\\\ &amp; ~~~~ \\text{for automatic smoke alarms in main rooms} \\\\ \\text{NoClaimCredit} &amp; \\text{Binary variable to indicate no claims in the past two years} \\\\ \\text{Fire5 } &amp; \\text{Binary variable to indicate the fire class is below 5} \\\\ &amp; ~~~~ \\text{(The range of fire class is 0 to 10)} \\\\ \\hline \\end{array} \\end{matrix}}\\] To get a sense of the relationship between the non-continuous rating variables and claims, Table 1.5 relates the claims outcomes to these categorical variables. Table 1.5 suggests substantial variation in the claim frequency and average severity of the claims by entity type. It also demonstrates higher frequency and severity for the \\({\\tt Fire5}\\) variable and the reverse for the \\({\\tt NoClaimCredit}\\) variable. The relationship for the \\({\\tt Fire5}\\) variable is counter-intuitive in that one would expect lower claim amounts for those policyholders in areas with better public protection (when the protection code is five or less). Naturally, there are other variables that influence this relationship. We will see that these background variables are accounted for in the subsequent multivariate regression analysis, which yields an intuitive, appealing (negative) sign for the \\({\\tt Fire5}\\) variable. Table 1.5: Claims Summary by Entity Type, Fire Class, and No Claim Credit Variable Number of Policies Claim Frequency Average Severity EntityType Village 1,341 0.452 10,645 City 793 1.941 16,924 County 328 4.899 15,453 Misc 609 0.186 43,036 School 1,597 1.434 64,346 Town 971 0.103 19,831 Fire Fire5=0 2,508 0.502 13,935 Fire5=1 3,131 1.596 41,421 No Claims Credit NoClaimCredit=0 3,786 1.501 31,365 NoClaimCredit=1 1,853 0.310 30,499 Total 5,639 1.109 31,206 R Code for Claims Summary by Entity Type, Fire Class, and No Claim Credit ByVarSumm&lt;-function(datasub){ tempA &lt;- summaryBy(Freq ~ 1 , data = datasub, FUN = function(x) { c(m = mean(x), num=length(x)) } ) datasub1 &lt;- subset(datasub, yAvg&gt;0) tempB &lt;- summaryBy(yAvg ~ 1, data = datasub1,FUN = function(x) { c(m = mean(x)) } ) tempC &lt;- merge(tempA,tempB,all.x=T)[c(2,1,3)] tempC1 &lt;- as.matrix(tempC) return(tempC1) } datasub &lt;- subset(Insample, TypeVillage == 1); t1 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, TypeCity == 1); t2 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, TypeCounty == 1); t3 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, TypeMisc == 1); t4 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, TypeSchool == 1); t5 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, TypeTown == 1); t6 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, Fire5 == 0); t7 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, Fire5 == 1); t8 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, Insample$NoClaimCredit == 0); t9 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, Insample$NoClaimCredit == 1); t10 &lt;- ByVarSumm(datasub) t11 &lt;- ByVarSumm(Insample) Tablea &lt;- rbind(t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11) Tableaa &lt;- round(Tablea,3) Rowlable &lt;- rbind(&quot;Village&quot;,&quot;City&quot;,&quot;County&quot;,&quot;Misc&quot;,&quot;School&quot;, &quot;Town&quot;,&quot;Fire5--No&quot;,&quot;Fire5--Yes&quot;,&quot;NoClaimCredit--No&quot;, &quot;NoClaimCredit--Yes&quot;,&quot;Total&quot;) Table4 &lt;- cbind(Rowlable,as.matrix(Tableaa)) Table4 Table 1.6 shows the claims experience by alarm credit. It underscores the difficulty of examining variables individually. For example, when looking at the experience for all entities, we see that policyholders with no alarm credit have on average lower frequency and severity than policyholders with the highest (15%, with 24/7 monitoring by a fire station or security company) alarm credit. In particular, when we look at the entity type School, the frequency is 0.422 and the severity 25,523 for no alarm credit, whereas for the highest alarm level it is 2.008 and 85,140. This may simply imply that entities with more claims are the ones that are likely to have an alarm system. Summary tables do not examine multivariate effects; for example, Table 1.5 ignores the effect of size (as we measure through coverage amounts) that affect claims. Table 1.6: Claims Summary by Entity Type and Alarm Credit (AC) Category Entity Type AC0 Claim Frequency AC0 Avg. Severity AC0 Num. Policies AC5 Claim Frequency AC5 Avg. Severity AC5 Num. Policies Village 0.326 11,078 829 0.278 8,086 54 City 0.893 7,576 244 2.077 4,150 13 County 2.140 16,013 50 - - 1 Misc 0.117 15,122 386 0.278 13,064 18 School 0.422 25,523 294 0.410 14,575 122 Town 0.083 25,257 808 0.194 3,937 31 Total 0.318 15,118 2,611 0.431 10,762 239 Claims Summary by Entity Type and Alarm Credit (AC) Category Entity Type AC10 Claim Frequency AC10 Avg. Severity AC10 Num. Policies AC15 Claim Frequency AC15 Avg. Severity AC15 Num. Policies Village 0.500 8,792 50 0.725 10,544 408 City 1.258 8,625 31 2.485 20,470 505 County 2.125 11,688 8 5.513 15,476 269 Misc 0.077 3,923 26 0.341 87,021 179 School 0.488 11,597 168 2.008 85,140 1,013 Town 0.091 2,338 44 0.261 9,490 88 Total 0.517 10,194 327 2.093 41,458 2,462 R Code for Claims Summary by Entity Type and Alarm Credit Category #Claims Summary by Entity Type and Alarm Credit ByVarSumm&lt;-function(datasub){ tempA &lt;- summaryBy(Freq ~ AC00 , data = datasub, FUN = function(x) { c(m = mean(x), num=length(x)) } ) datasub1 &lt;- subset(datasub, yAvg&gt;0) if(nrow(datasub1)==0) { n&lt;-nrow(datasub) return(c(0,0,n)) } else { tempB &lt;- summaryBy(yAvg ~ AC00, data = datasub1, FUN = function(x) { c(m = mean(x)) } ) tempC &lt;- merge(tempA,tempB,all.x=T)[c(2,4,3)] tempC1 &lt;- as.matrix(tempC) return(tempC1) } } AlarmC &lt;- 1*(Insample$AC00==1) + 2*(Insample$AC05==1)+ 3*(Insample$AC10==1)+ 4*(Insample$AC15==1) ByVarCredit&lt;-function(ACnum){ datasub &lt;- subset(Insample, TypeVillage == 1 &amp; AlarmC == ACnum); t1 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, TypeCity == 1 &amp; AlarmC == ACnum); t2 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, TypeCounty == 1 &amp; AlarmC == ACnum); t3 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, TypeMisc == 1 &amp; AlarmC == ACnum); t4 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, TypeSchool == 1 &amp; AlarmC == ACnum); t5 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, TypeTown == 1 &amp; AlarmC ==ACnum); t6 &lt;- ByVarSumm(datasub) datasub &lt;- subset(Insample, AlarmC == ACnum); t7 &lt;- ByVarSumm(datasub) Tablea &lt;- rbind(t1,t2,t3,t4,t5,t6,t7) Tableaa &lt;- round(Tablea,3) Rowlable &lt;- rbind(&quot;Village&quot;,&quot;City&quot;,&quot;County&quot;,&quot;Misc&quot;,&quot;School&quot;, &quot;Town&quot;,&quot;Total&quot;) Table4 &lt;- cbind(Rowlable,as.matrix(Tableaa)) } Table4a &lt;- ByVarCredit(1) #Claims Summary by Entity Type and Alarm Credit==00 Table4b &lt;- ByVarCredit(2) #Claims Summary by Entity Type and Alarm Credit==05 Table4c &lt;- ByVarCredit(3) #Claims Summary by Entity Type and Alarm Credit==10 Table4d &lt;- ByVarCredit(4) #Claims Summary by Entity Type and Alarm Credit==15 1.3.3 Fund Operations We have now seen the Fund’s two outcome variables: a count variable for the number of claims, and a continuous variable for the claims amount. We have also introduced a continuous rating variable (coverage); a discrete quantitative variable (logarithmic deductibles); two binary rating variables (no claims credit and fire class); and two categorical rating variables (entity type and alarm credit). Subsequent chapters will explain how to analyze and model the distribution of these variables and their relationships. Before getting into these technical details, let us first think about where we want to go. General insurance company functional areas are described in Section 1.2; let us now think about how these areas might apply in the context of the property fund. Initiating Insurance Because this is a government sponsored fund, we do not have to worry about selecting good or avoiding poor risks; the fund is not allowed to deny a coverage application from a qualified local government entity. If we do not have to underwrite, what about how much to charge? We might look at the most recent experience in 2010, where the total fund claims were approximately 28.16 million USD (\\(=1377 \\text{ claims} \\times 20452 \\text{ average severity}\\)). Dividing that among 1,110 policyholders, that suggests a rate of 24,370 ( \\(\\approx\\) 28,160,000/1110). However, 2010 was a bad year; using the same method, our premium would be much lower based on 2009 data. This swing in premiums would defeat the primary purpose of the fund, to allow for a steady charge that local property managers could utilize in their budgets. Having a single price for all policyholders is nice but hardly seems fair. For example, Table 1.5 suggests that Schools have much higher claims than other entities and so should pay more. However, simply doing the calculation on an entity by entity basis is not right either. For example, we saw in Table 1.6 that had we used this strategy, entities with a 15% alarm credit (for good behavior, having top alarm systems) would actually wind up paying more. So, we have the data for thinking about the appropriate rates to charge but will need to dig deeper into the analysis. We will explore this topic further in Chapter 7 on premium calculation fundamentals. Selecting appropriate risks is introduced in Chapter 8 on risk classification. Renewing Insurance Although property insurance is typically a one-year contract, Table 1.3 suggests that policyholders tend to renew; this is typical of general insurance. For renewing policyholders, in addition to their rating variables we have their claims history and this claims history can be a good predictor of future claims. For example, Table 1.5 shows that policyholders without a claim in the last two years had much lower claim frequencies than those with at least one accident (0.310 compared to 1.501); a lower predicted frequency typically results in a lower premium. This is why it is common for insurers to use variables such as \\({\\tt NoClaimCredit}\\) in their rating. We will explore this topic further in Chapter 9 on experience rating. Claims Management Of course, the main story line of the 2010 experience was the large claim of over 12 million USD, nearly half the claims for that year. Are there ways that this could have been prevented or mitigated? Are their ways for the fund to purchase protection against such large unusual events? Another unusual feature of the 2010 experience noted earlier was the very large frequency of claims (239) for one policyholder. Given that there were only 1,377 claims that year, this means that a single policyholder had 17.4 % of the claims. This also suggests opportunities for managing claims, the subject of Chapter 10. Loss Reserving In our case study, we look only at the one year outcomes of closed claims (the opposite of open). However, like many lines of insurance, obligations from insured events to buildings such as fire, hail, and the like, are not known immediately and may develop over time. Other lines of business, including those where there are injuries to people, take much longer to develop. Chapter ?? introduces this concern and loss reserving, the discipline of determining how much the insurance company should retain to meet its obligations. Show Quiz Solution 1.4 Further Resources and Contributors Contributor Edward W. (Jed) Frees, University of Wisconsin-Madison, is the principal author of the initial version of this chapter. Email: jfrees@bus.wisc.edu for chapter comments and suggested improvements. Chapter reviewers include: Yair Babad, Chunsheng Ban, Aaron Bruhn, Gordon Enderle, Hirokazu (Iwahiro) Iwasawa, Bell Ouelega. This book introduces loss data analytic tools that are most relevant to actuaries and other financial risk analysts. We have also introduced you to many new insurance terms; more terms can be found at the NAIC Glossary (2018). Here are a few reference cited in the chapter. Bibliography "],
["C-Frequency-Modeling.html", "Chapter 2 Frequency Modeling 2.1 Frequency Distributions 2.2 Basic Frequency Distributions 2.3 The (a, b, 0) Class 2.4 Estimating Frequency Distributions 2.5 Other Frequency Distributions 2.6 Mixture Distributions 2.7 Goodness of Fit 2.8 Exercises 2.9 Further Resources and Contributors", " Chapter 2 Frequency Modeling Chapter Preview. A primary focus for insurers is estimating the magnitude of aggregate claims it must bear under its insurance contracts. Aggregate claims are affected by both the frequency of insured events and the severity of the insured event. Decomposing aggregate claims into these two components, each of which warrant significant attention, is essential for analysis and pricing. This chapter discusses frequency distributions, summary measures, and parameter estimation techniques. In Section 2.1, we present terminology and discuss reasons why we study frequency and severity separately. The foundations of frequency distributions and measures are presented in Section 2.2 along with three principal distributions: the binomial, the Poisson, and the negative binomial. These three distributions are members of what is known as the (a,b,0) class of distributions, a distinguishing, identifying feature which allows for efficient calculation of probabilities, further discussed in Section 2.3. When fitting a dataset with a distribution, parameter values need to be estimated and in Section 2.4, the procedure for maximum likelihood estimation is explained. For insurance datasets, the observation at 0, denoting the occurrence of zero of a particular event, is notable and may deserve additional attention. By nature of the dataset, and explained further in Section 2.5, it may be impossible to have zero of the studied event, or the probability at zero could be of such a magnitude that direct fitting would lead to improper estimates. Zero truncation or modification techniques allow for more appropriate distribution fit. Noting that our insurance portfolio could consist of different sub-groups, each with its own set of individual characteristics, Section 2.6 introduces mixture distributions and methodology to allow for this heterogeneity within a portfolio. Section 2.7 describes Goodness of Fit which measures the reasonableness of the parameter estimates. Exercises are presented in Section 2.8 and Section 2.9.1 concludes the chapter with R Code for plots depicted in Section 2.4. 2.1 Frequency Distributions In this section, you learn how to summarize the importance of frequency modeling in terms of contractual, behavioral, database and regulatory/administrative motivations. 2.1.1 How Frequency Augments Severity Information 2.1.1.1 Basic Terminology In this chapter, loss, also referred to as ground-up loss, denotes the amount suffered by the insured. We use claim to denote the indemnification upon the occurrence of an insured event, thus the amount paid by the insurer. While some texts use loss and claim interchangeably, we wish to make a distinction here to recognize how insurance contractual provisions, such as deductibles and limits, affect the size of the claim stemming from a loss. Frequency represents how often an insured event occurs, typically within a policy contract. Here, we focus on count random variables that represent the number of claims, that is, how frequently an event occurs. Severity denotes the amount, or size, of each payment for an insured event. In future chapters, the aggregate model, which combines frequency models with severity models, is examined. 2.1.1.2 The Importance of Frequency Recall from Chapter 1 that setting the price of an insurance good can be a complex problem. In manufacturing, the cost of a good is (relatively) known. In other financial service areas, market prices are available. In insurance, we can generalize the price setting as follows: start with an expected cost. Add “margins” to account for the product’s riskiness, expenses incurred in servicing the product, and a profit/surplus allowance for the insurer. That expected cost for insurance can be defined as the expected number of claims times the expected amount per claim, that is, expected frequency times severity. The focus on claim count allows the insurer to consider those factors which directly affect the occurrence of a loss, thereby potentially generating a claim. The frequency process can then be modeled. 2.1.1.3 Why Examine Frequency Information Insurers and other stakeholders, including governmental organizations, have various motivations for gathering and maintaining frequency datasets. Contractual. In insurance contracts, it is common for particular deductibles and policy limits to be listed and invoked for each occurrence of an insured event. Correspondingly, the claim count data generated would indicate the number of claims which meet these criteria, offering a unique claim frequency measure. Extending this, models of total insured losses would need to account for deductibles and policy limits for each insured event. Behaviorial. In considering factors that influence loss frequency, the risk-taking and risk-reducing behavior of individuals and companies should be considered. Explanatory (rating) variables can have different effects on models of how often an event occurs in contrast to the size of the event. In healthcare, the decision to utilize healthcare by individuals, and minimize such healthcare utilization through preventive care and wellness measures, is related primarily to his or her personal characteristics. The cost per user is determined by those personal, the medical condition, potential treatment measures, and decisions made by the healthcare provider (such as the physician) and the patient. While there is overlap in those factors and how they affect total healthcare costs, attention can be focused on those separate drivers of healthcare visit frequency and healthcare cost severity. In personal lines, prior claims history is an important underwriting factor. It is common to use an indicator of whether or not the insured had a claim within a certain time period prior to the contract. Also, the number of claims incurred by the insured in previous periods has predictive power. In homeowners insurance, in modeling potential loss frequency, the insurer could consider loss prevention measures that the homeowner has adopted, such as visible security systems. Separately, when modeling loss severity, the insurer would examine those factors that affect repair and replacement costs. Databases. Insurers may hold separate data files that suggest developing separate frequency and severity models. For example, a policyholder file is established when a policy is written. This file records much underwriting information about the insured(s), such as age, gender, and prior claims experience, policy information such as coverage, deductibles and limitations, as well as the insurance claims event. A separate file, known as the “claims” file, records details of the claim against the insurer, including the amount. (There may also be a “payments” file that records the timing of the payments although we shall not deal with that here.) This recording process could then extend to insurers modeling the frequency and severity as separate processes. Regulatory and Administrative. Insurance is a highly regulated and monitored industry, given its importance in providing financial security to individuals and companies facing risk. As part of its duties, regulators routinely require the reporting of claims numbers as well as amounts. This may be due to the fact that there can be alternative definitions of an “amount,” e.g., paid versus incurred, and there is less potential error when reporting claim numbers. This continual monitoring helps ensure financial stability of these insurance companies. Show Quiz Solution 2.2 Basic Frequency Distributions In this section, you learn how to: Determine quantities that summarize a distribution such as the distribution and survival function, as well as moments such as the mean and variance Define and compute the moment and probability generating functions Describe and understand relationships among three important frequency distributions, the binomial, Poisson, and negative binomial distributions In this section, we will introduce the distributions that are commonly used in actuarial practice to model count data. The claim count random variable is denoted by \\(N\\); by its very nature it assumes only non-negative integer values. Hence the distributions below are all discrete distributions supported on the set of non-negative integers \\(\\{0, 1, \\ldots \\}\\). 2.2.1 Foundations Since \\(N\\) is a discrete random variable taking values in \\(\\{0, 1, \\ldots \\}\\), the most natural full description of its distribution is through the specification of the probabilities with which it assumes each of the non-negative integer values. This leads us to the concept of the probability mass function (pmf) of \\(N\\), denoted as \\(p_N(\\cdot)\\) and defined as follows: \\[\\begin{equation} p_N(k)=\\Pr(N=k), \\quad \\hbox{for } k=0,1,\\ldots \\end{equation}\\] We note that there are alternate complete descriptions, or characterizations, of the distribution of \\(N\\); for example, the distribution function of \\(N\\) denoted by \\(F_N(\\cdot)\\) and defined below is another such: \\[\\begin{equation} F_N(x):=\\begin{cases} \\sum\\limits_{k=0}^{\\lfloor x \\rfloor } \\Pr(N=k), &amp;x\\geq 0;\\\\ 0, &amp; \\hbox{otherwise}. \\end{cases} \\end{equation}\\] In the above, \\(\\lfloor \\cdot \\rfloor\\) denotes the floor function; \\(\\lfloor x \\rfloor\\) denotes the greatest integer less than or equal to \\(x\\). We note that the survival function of \\(N\\), denoted by \\(S_N(\\cdot)\\), is defined as the ones’-complement of \\(F_N(\\cdot)\\), i.e. \\(S_N(\\cdot):=1-F_N(\\cdot)\\). Clearly, the latter is another characterization of the distribution of \\(N\\). Often one is interested in quantifying a certain aspect of the distribution and not in its complete description. This is particularly useful when comparing distributions. A center of location of the distribution is one such aspect, and there are many different measures that are commonly used to quantify it. Of these, the mean is the most popular; the mean of \\(N\\), denoted by \\(\\mu_N\\),2 is defined as \\[\\begin{equation} \\mu_N=\\sum_{k=0}^\\infty k~p_N(k). \\end{equation}\\] We note that \\(\\mu_N\\) is the expected value of the random variable \\(N\\), i.e. \\(\\mu_N=\\mathrm{E}[N]\\). This leads to a general class of measures, the moments of the distribution; the \\(r\\)-th moment of \\(N\\), for \\(r&gt; 0\\), is defined as \\(\\mathrm{E}{[N^r]}\\) and denoted by \\(\\mu_N&#39;(r)\\). Hence, for \\(r&gt;0\\), we have \\[\\begin{equation} \\mu_N&#39;(r)= \\mathrm{E}{[N^r]}= \\sum_{k=0}^\\infty k^r~p_N(k). \\end{equation}\\] We note that \\(\\mu_N&#39;(\\cdot)\\) is a well-defined non-decreasing function taking values in \\([0,\\infty]\\), as \\(\\Pr(N\\in\\{0, 1, \\ldots \\})=1\\); also, note that \\(\\mu_N=\\mu_N&#39;(1)\\). In the following, when we refer to a moment it will be implicit that it is finite unless mentioned otherwise. Another basic aspect of a distribution is its dispersion, and of the various measures of dispersion studied in the literature, the standard deviation is the most popular. Towards defining it, we first define the variance of \\(N\\), denoted by \\(\\mathrm{Var}[N]\\), as \\(\\mathrm{Var}[N]:=\\mathrm{E}{[(N-\\mu_N)^2]}\\) when \\(\\mu_N\\) is finite. By basic properties of the expected value of a random variable, we see that \\(\\mathrm{Var}[N]:=\\mathrm{E}[N^2]-[\\mathrm{E}(N)]^2\\). The standard deviation of \\(N\\), denoted by \\(\\sigma_N\\), is defined as the square-root of \\(\\mathrm{Var}~N\\). Note that the latter is well-defined as \\(\\mathrm{Var}[N]\\), by its definition as the average squared deviation from the mean, is non-negative; \\(\\mathrm{Var}[N]\\) is denoted by \\(\\sigma_N^2\\). Note that these two measures take values in \\([0,\\infty]\\). 2.2.2 Moment and Probability Generating Functions Now we will introduce two generating functions that are found to be useful when working with count variables. Recall that for a discrete random variable, the moment generating function (mgf) of \\(N\\), denoted as \\(M_N(\\cdot)\\), is defined as \\[ M_N(t) = \\mathrm{E}~{[e^{tN}]} = \\sum^{\\infty}_{k=0} ~e^{tk}~ p_N(k), \\quad t\\in \\mathbb{R}. \\] We note that while \\(M_N(\\cdot)\\) is well defined as it is the expectation of a non-negative random variable (\\(e^{tN}\\)), though it can assume the value \\(\\infty\\). Note that for a count random variable, \\(M_N(\\cdot)\\) is finite valued on \\((-\\infty,0]\\) with \\(M_N(0)=1\\). The following theorem, whose proof can be found in (Billingsley 2008) (pages 285-6), encapsulates the reason for its name. Theorem 2.1 Let \\(N\\) be a count random variable such that \\(\\mathrm{E}~{[e^{t^\\ast N}]}\\) is finite for some \\(t^\\ast&gt;0\\). We have the following: All moments of \\(N\\) are finite, i.e. \\[ \\mathrm{E}{[N^r]}&lt;\\infty, \\quad r &gt; 0. \\] The mgf can be used to generate its moments as follows: \\[ \\left.\\frac{{\\rm d}^m}{{\\rm d}t^m} M_N(t)\\right\\vert_{t=0}=\\mathrm{E}{N^m}, \\quad m\\geq 1. \\] The mgf \\(M_N(\\cdot)\\) characterizes the distribution; in other words it uniquely specifies the distribution. Another reason that the mgf is very useful as a tool is that for two independent random variables \\(X\\) and \\(Y\\), with their mgfs existing in a neighborhood of \\(0\\), the mgf of \\(X+Y\\) is the product of their respective mgfs. A related generating function to the mgf is called the probability generating function (pgf), and is a useful tool for random variables taking values in the non-negative integers. For a random variable \\(N\\), by \\(P_N(\\cdot)\\) we denote its pgf and we define it as follows3: \\[\\begin{equation} P_N(s):=\\mathrm{E}~{[s^N]}, \\quad s\\geq 0. \\end{equation}\\] It is straightforward to see that if the mgf \\(M_N(\\cdot)\\) exists on \\((-\\infty,t^\\ast)\\) then \\[ P_N(s)=M_N(\\log(s)), \\quad s&lt;e^{t^\\ast}. \\] Moreover, if the pgf exists on an interval \\([0,s^\\ast)\\) with \\(s^\\ast&gt;1\\), then the mgf \\(M_N(\\cdot)\\) exists on \\((-\\infty,\\log(s^\\ast))\\), and hence uniquely specifies the distribution of \\(N\\) by Theorem 2.1. The following result for pgf is an analog of Theorem 2.1, and in particular justifies its name. Theorem 2.2 Let \\(N\\) be a count random variable such that \\(\\mathrm{E}~{(s^{\\ast})^N}\\) is finite for some \\(s^\\ast&gt;1\\). We have the following: All moments of \\(N\\) are finite, i.e. \\[ \\mathrm{E}~{N^r}&lt;\\infty, \\quad r\\geq 0. \\] The r Gloss('pmf') of \\(N\\) can be derived from the pgf as follows: \\[ p_N(m)=\\begin{cases} P_N(0), &amp;m=0;\\cr &amp;\\cr \\left(\\frac{1}{m!}\\right) \\left.\\frac{{\\rm d}^m}{{\\rm d}s^m} P_N(s)\\right\\vert_{s=0}\\;, &amp;m\\geq 1.\\cr \\end{cases} \\] The factorial moments of \\(N\\) can be derived as follows: \\[ \\left.\\frac{{\\rm d}^m}{{\\rm d}s^m} P_N(s)\\right\\vert_{s=1}=\\mathrm{E}~{\\prod\\limits_{i=0}^{m-1} (N-i)}, \\quad m\\geq 1. \\] The pgf \\(P_N(\\cdot)\\) characterizes the distribution; in other words it uniquely specifies the distribution. 2.2.3 Important Frequency Distributions In this sub-section we will study three important frequency distributions used in statistics, namely the binomial, the Poisson, and the negative binomial distributions. In the following, a risk denotes a unit covered by insurance. A risk could be an individual, a building, a company, or some other identifier for which insurance coverage is provided. For context, imagine an insurance data set containing the number of claims by risk or stratified in some other manner. The above mentioned distributions also happen to be the most commonly used in insurance practice for reasons, some of which we mention below. These distributions can be motivated by natural random experiments which are good approximations to real life processes from which many insurance data arise. Hence, not surprisingly, they together offer a reasonable fit to many insurance data sets of interest. The appropriateness of a particular distribution for the set of data can be determined using standard statistical methodologies, as we discuss later in this chapter. They provide a rich enough basis for generating other distributions that even better approximate or well cater to more real situations of interest to us. The three distributions are either one-parameter or two-parameter distributions. In fitting to data, a parameter is assigned a particular value. The set of these distributions can be enlarged to their convex hulls by treating the parameter(s) as a random variable (or vector) with its own probability distribution, with this larger set of distributions offering greater flexibility. A simple example that is better addressed by such an enlargement is a portfolio of claims generated by insureds belonging to many different risk classes. In insurance data, we may observe either a marginal or inordinate number of zeros, that is, zero claims by risk. When fitting to the data, a frequency distribution in its standard specification often fails to reasonably account for this occurrence. The natural modification of the above three distributions, however, accommodate this phenomenon well towards offering a better fit. In insurance we are interested in total claims paid, whose distribution results from compounding the fitted frequency distribution with a severity distribution. These three distributions have properties that make it easy to work with the resulting aggregate severity distribution. 2.2.3.1 Binomial Distribution We begin with the binomial distribution which arises from any finite sequence of identical and independent experiments with binary outcomes. The most canonical of such experiments is the (biased or unbiased) coin tossing experiment with the outcome being heads or tails. So if \\(N\\) denotes the number of heads in a sequence of \\(m\\) independent coin tossing experiments with an identical coin which turns heads up with probability \\(q\\), then the distribution of \\(N\\) is called the binomial distribution with parameters \\((m,q)\\), with \\(m\\) a positive integer and \\(q\\in[0,1]\\). Note that when \\(q=0\\) (resp., \\(q=1\\)) then the distribution is degenerate with \\(N=0\\) (resp., \\(N=m\\)) with probability \\(1\\). Clearly, its support when \\(q\\in(0,1)\\) equals \\(\\{0,1,\\ldots,m\\}\\) with pmf given by4 \\[\\begin{equation*} p_k:= \\binom{m}{k} q^k (1-q)^{m-k}, \\quad k=0,\\ldots,m. \\end{equation*}\\] where \\[\\binom{m}{k} = \\frac{m!}{k!(m-k)!}\\] The reason for its name is that the pmf takes values among the terms that arise from the binomial expansion of \\((q +(1-q))^m\\). This realization then leads to the the following expression for the pgf of the binomial distribution: \\[ P_N(z):= \\sum_{k=0}^m z^k \\binom{m}{k} q^k (1-q)^{m-k} = \\sum_{k=0}^m \\binom{m}{k} (zq)^k (1-q)^{m-k} = (qz+(1-q))^m = (1+q(z-1))^m. \\] Note that the above expression for the pgf confirms the fact that the binomial distribution is the m-convolution of the Bernoulli distribution, which is the binomial distribution with \\(m=1\\) and pgf \\((1+q(z-1))\\). Also, note that the mgf of the binomial distribution is given by \\((1+q(e^t-1))^m\\). The central moments of the binomial distribution can be found in a few different ways. To emphasize the key property that it is a \\(m\\)-convolution of the Bernoulli distribution, we derive below the moments using this property. We begin by observing that the Bernoulli distribution with parameter \\(q\\) assigns probability of \\(q\\) and \\(1-q\\) to \\(1\\) and \\(0\\), respectively. So its mean equals \\(q\\) (\\(=0\\times (1-q) + 1\\times q\\)); note that its raw second moment equals its mean as \\(N^2=N\\) with probability \\(1\\). Using these two facts we see that the variance equals \\(q(1-q)\\). Moving on to the binomial distribution with parameters \\(m\\) and \\(q\\), using the fact that it is the \\(m\\)-convolution of the Bernoulli distribution, we write \\(N\\) as the sum of \\(N_1,\\ldots,N_m\\), where \\(N_i\\) are iid Bernoulli variates. Now using the moments of Bernoulli and linearity of the expectation, we see that \\[ \\mathrm{E}[{N}]=\\mathrm{E}[{\\sum_{i=1}^m N_i}] = \\sum_{i=1}^m ~\\mathrm{E}[N_i] = mq. \\] Also, using the fact that the variance of the sum of independent random variables is the sum of their variances, we see that \\[ \\mathrm{Var}[{N}]=\\mathrm{Var}~\\left({\\sum_{i=1}^m N_i}\\right)=\\sum_{i=1}^m \\mathrm{Var}[{N_i}] = mq(1-q). \\] Alternate derivations of the above moments are suggested in the exercises. One important observation, especially from the point of view of applications, is that the mean is greater than the variance unless \\(q=0\\). 2.2.3.2 Poisson Distribution After the binomial distribution, the Poisson distribution (named after the French polymath Simeon Denis Poisson) is probably the most well known of discrete distributions. This is partly due to the fact that it arises naturally as the distribution of the count of the random occurrences of a type of event in a certain time period, if the rate of occurrences of such events is a constant. It also arises as the asymptotic limit of the binomial distribution with \\(m\\rightarrow \\infty\\) and \\(mq\\rightarrow \\lambda\\). The Poisson distribution is parametrized by a single parameter usually denoted by \\(\\lambda\\) which takes values in \\((0,\\infty)\\). Its pmf is given by \\[ p_k = \\frac{e^{-\\lambda}\\lambda^k}{k!}, k=0,1,\\ldots \\] It is easy to check that the above specifies a pmf as the terms are clearly non-negative, and that they sum to one follows from the infinite Taylor series expansion of \\(e^\\lambda\\). More generally, we can derive its pgf, \\(P(\\cdot)\\), as follows: \\[ P_N(z)= \\sum_{k=0}^\\infty p_k z^k = \\sum_{k=0}^\\infty \\frac{e^{-\\lambda}\\lambda^kz^k}{k!} = e^{-\\lambda} e^{\\lambda z} = e^{\\lambda(z-1)}, \\forall z\\in\\mathbb{R}. \\] From the above, we derive its mgf as follows: \\[ M_N(t)=P_N(e^t)=e^{\\lambda(e^t-1)}, t\\in \\mathbb{R}. \\] Towards deriving its mean, we note that for the Poisson distribution \\[ kp_k=\\begin{cases} 0, &amp;k=0;\\cr \\lambda~p_{k-1}, &amp;k\\geq1. \\end{cases} \\] this can be checked easily. In particular, this implies that \\[ \\mathrm{E}[{N}]=\\sum_{k\\geq 0} k~p_k =\\lambda\\sum_{k\\geq 1} p_{k-1} = \\lambda\\sum_{j\\geq 0} p_{j} =\\lambda. \\] In fact, more generally, using either a generalization of the above or using Theorem 2.2, we see that \\[ \\mathrm{E}{\\prod\\limits_{i=0}^{m-1} (N-i)}=\\left.\\frac{{\\rm d}^m}{{\\rm d}s^m} P_N(s)\\right\\vert_{s=1}=\\lambda^m, \\quad m\\geq 1. \\] This, in particular, implies that \\[ \\mathrm{Var}[{N}]=\\mathrm{E}[{N^2}]-[\\mathrm{E}({N})]^2 = \\mathrm{E}~[N(N-1)]+\\mathrm{E}[N]-(\\mathrm{E}[{N]})^2=\\lambda^2+\\lambda-\\lambda^2=\\lambda. \\] Note that interestingly for the Poisson distribution \\(\\mathrm{Var}[N]=\\mathrm{E}[N]\\). 2.2.3.3 Negative Binomial Distribution The third important count distribution is the negative binomial distribution. Recall that the binomial distribution arose as the distribution of the number of successes in \\(m\\) independent repetition of an experiment with binary outcomes. If we instead consider the number of successes until we observe the \\(r\\)-th failure in independent repetitions of an experiment with binary outcomes, then its distribution is a negative binomial distribution. A particular case, when \\(r=1\\), is the geometric distribution. However when \\(r\\) in not an integer, the above random experiment would not be applicable. In the following, we will allow the parameter \\(r\\) to be any positive real number to then motivate the distribution more generally. To explain its name, we recall the binomial series, i.e. \\[ (1+x)^s= 1 + s x + \\frac{s(s-1)}{2!}x^2 + \\ldots..., \\quad s\\in\\mathbb{R}; \\vert x \\vert&lt;1. \\] If we define \\(\\binom{s}{k}\\), the generalized binomial coefficient, by \\[ \\binom{s}{k}=\\frac{s(s-1)\\cdots(s-k+1)}{k!}, \\] then we have \\[ (1+x)^s= \\sum_{k=0}^{\\infty} \\binom{s}{k} x^k, \\quad s\\in\\mathbb{R}; \\vert x \\vert&lt;1. \\] If we let \\(s=-r\\), then we see that the above yields \\[ (1-x)^{-r}= 1 + r x + \\frac{(r+1)r}{2!}x^2 + \\ldots...= \\sum_{k=0}^\\infty \\binom{r+k-1}{k} x^k, \\quad r\\in\\mathbb{R}; \\vert x \\vert&lt;1. \\] This implies that if we define \\(p_k\\) as \\[ p_k = \\binom{k+r-1}{k} \\left(\\frac{1}{1+\\beta}\\right)^r \\left(\\frac{\\beta}{1+\\beta}\\right)^k, \\quad k=0,1,\\ldots \\] for \\(r&gt;0\\) and \\(\\beta\\geq0\\), then it defines a valid pmf. Such defined distribution is called the negative binomial distribution with parameters \\((r,\\beta)\\) with \\(r&gt;0\\) and \\(\\beta\\geq 0\\). Moreover, the binomial series also implies that the pgf of this distribution is given by \\[ \\begin{aligned} P_N(z) &amp;= (1-\\beta(z-1))^{-r}, \\quad \\vert z \\vert &lt; 1+\\frac{1}{\\beta}, \\beta\\geq0. \\end{aligned} \\] The above implies that the mgf is given by \\[ \\begin{aligned} M_N(t) &amp;= (1-\\beta(e^t-1))^{-r}, \\quad t &lt; \\log\\left(1+\\frac{1}{\\beta}\\right), \\beta\\geq0. \\end{aligned} \\] We derive its moments using Theorem 2.1 as follows: \\[\\begin{eqnarray*} \\mathrm{E}[N]&amp;=&amp;M&#39;(0)= \\left. r\\beta e^t (1-\\beta(e^t-1))^{-r-1}\\right\\vert_{t=0}=r\\beta;\\\\ \\mathrm{E}[N^2]&amp;=&amp;M&#39;&#39;(0)= \\left.\\left[ r\\beta e^t (1-\\beta(e^t-1))^{-r-1} + r(r+1)\\beta^2 e^{2t} (1-\\beta(e^t-1))^{-r-2}\\right]\\right\\vert_{t=0}\\\\ &amp;=&amp;r\\beta(1+\\beta)+r^2\\beta^2;\\\\ \\hbox{and }\\mathrm{Var}[N]&amp;=&amp;\\mathrm{E}{[N^2]}-(\\mathrm{E}[{N}])^2=r\\beta(1+\\beta)+r^2\\beta^2-r^2\\beta^2=r\\beta(1+\\beta) \\end{eqnarray*}\\] We note that when \\(\\beta&gt;0\\), we have \\(\\mathrm{Var}[N] &gt;\\mathrm{E}[N]\\). In other words, this distribution is overdispersed (relative to the Poisson); similarly, when \\(q&gt;0\\) the binomial distribution is said to be underdispersed (relative to the Poisson). Finally, we observe that the Poisson distribution also emerges as a limit of negative binomial distributions. Towards establishing this, let \\(\\beta_r\\) be such that as \\(r\\) approaches infinity \\(r\\beta_r\\) approaches \\(\\lambda&gt;0\\). Then we see that the mgfs of negative binomial distributions with parameters \\((r,\\beta_r)\\) satisfies \\[ \\lim_{r\\rightarrow 0} (1-\\beta_r(e^t-1))^{-r}=\\exp\\{\\lambda(e^t-1)\\}, \\] with the right hand side of the above equation being the mgf of the Poisson distribution with parameter \\(\\lambda\\).5 Show Quiz Solution 2.3 The (a, b, 0) Class In this section, you learn how to: Define the (a,b,0) class of frequency distributions Discuss the importance of the recursive relationship underpinning this class of distributions Identify conditions under which this general class reduces to each of the binomial, Poisson, and negative binomial distributions In the previous section we studied three distributions, namely the binomial, the Poisson and the negative binomial distributions. In the case of the Poisson, to derive its mean we used the the fact that \\[ kp_k=\\lambda p_{k-1}, \\quad k\\geq 1, \\] which can be expressed equivalently as \\[ \\frac{p_k}{p_{k-1}}=\\frac{\\lambda}{k}, \\quad k\\geq 1. \\] Interestingly, we can similarly show that for the binomial distribution \\[ \\frac{p_k}{p_{k-1}}=\\frac{-q}{1-q}+\\left(\\frac{(m+1)q}{1-q}\\right)\\frac{1}{k}, \\quad k=1,\\ldots,m, \\] and that for the negative binomial distribution \\[ \\frac{p_k}{p_{k-1}}=\\frac{\\beta}{1+\\beta}+\\left(\\frac{(r-1)\\beta}{1+\\beta}\\right)\\frac{1}{k}, \\quad k\\geq 1. \\] The above relationships are all of the form \\[\\begin{equation} \\frac{p_k}{p_{k-1}}=a+\\frac{b}{k}, \\quad k\\geq 1; \\tag{2.1} \\end{equation}\\] this raises the question if there are any other distributions which satisfy this seemingly general recurrence relation. Note that the ratio on the left, the ratio of two probabilities, is non-negative. To begin with, let \\(a&lt;0\\). In this case as \\(k\\rightarrow \\infty\\), \\((a+b/k)\\rightarrow a&lt;0\\). It follows that if \\(a&lt;0\\) then \\(b\\) should satisfy \\(b=-ka\\), for some \\(k\\geq 1\\). Any such pair \\((a,b)\\) can be written as \\[ \\left(\\frac{-q}{1-q},\\frac{(m+1)q}{1-q}\\right), \\quad q\\in(0,1), m\\geq 1; \\] note that the case \\(a&lt;0\\) with \\(a+b=0\\) yields the degenerate at \\(0\\) distribution which is the binomial distribution with \\(q=0\\) and arbitrary \\(m\\geq 1\\). In the case of \\(a=0\\), again by non-negativity of the ratio \\(p_k/p_{k-1}\\), we have \\(b\\geq 0\\). If \\(b=0\\) the distribution is degenerate at \\(0\\), which is a binomial with \\(q=0\\) or a Poisson distribution with \\(\\lambda=0\\) or a negative binomial distribution with \\(\\beta=0\\). If \\(b&gt;0\\), then clearly such a distribution is a Poisson distribution with mean (i.e. \\(\\lambda\\)) equal to \\(b\\), as presented at the beginning of this section. In the case of \\(a&gt;0\\), again by non-negativity of the ratio \\(p_k/p_{k-1}\\), we have \\(a+b/k\\geq 0\\) for all \\(k\\geq 1\\). The most stringent of these is the inequality \\(a+b\\geq 0\\). Note that \\(a+b=0\\) again results in degeneracy at \\(0\\); excluding this case we have \\(a+b&gt;0\\) or equivalently \\(b=(r-1)a\\) with \\(r&gt;0\\). Some algebra easily yields the following expression for \\(p_k\\): \\[ p_k = \\binom{k+r-1}{k} p_0 a^k, \\quad k=1,2,\\ldots. \\] The above series converges for \\(a&lt;1\\) when \\(r&gt;0\\), with the sum given by \\(p_0*((1-a)^{(-r)}-1)\\). Hence, equating the latter to \\(1-p_0\\) we get \\(p_0=(1-a)^{(r)}\\). So in this case the pair \\((a,b)\\) is of the form \\((a,(r-1)a)\\), for \\(r&gt;0\\) and \\(0&lt;a&lt;1\\); since an equivalent parametrization is \\((\\beta/(1+\\beta),(r-1)\\beta/(1+\\beta))\\), for \\(r&gt;0\\) and \\(\\beta&gt;0\\), we see from above that such distributions are negative binomial distributions. From the above development we see that not only does the recurrence (2.1) tie these three distributions together, but also it characterizes them. For this reason these three distributions are collectively referred to in the actuarial literature as (a,b,0) class of distributions, with \\(0\\) referring to the starting point of the recurrence. Note that the value of \\(p_0\\) is implied by \\((a,b)\\) since the probabilities have to sum to one. Of course, (2.1) as a recurrence relation for \\(p_k\\) makes the computation of the pmf efficient by removing redundancies. Later, we will see that it does so even in the case of compound distributions with the frequency distribution belonging to the \\((a,b,0)\\) class - this fact is the more important motivating reason to study these three distributions from this viewpoint. Example 2.3.1. A discrete probability distribution has the following properties \\[ \\begin{aligned} p_k&amp;=c\\left( 1+\\frac{2}{k}\\right) p_{k-1} \\:\\:\\: k=1,2,3,\\ldots\\\\ p_1&amp;= \\frac{9}{256} \\end{aligned} \\] Determine the expected value of this discrete random variable. Show Example Solution Solution: Since the pmf satisfies the \\((a,b,0)\\) recurrence relation we know that the underlying distribution is one among the binomial, Poisson, and negative binomial distributions. Since the ratio of the parameters (i.e. \\(b/a\\)) equals \\(2\\), we know that it is negative binomial and that \\(r=3\\). Moreover, since for a negative binomial \\(p_1=r(1+\\beta)^{-(r+1)}\\beta\\), we have \\[ \\begin{aligned} &amp;&amp;\\frac{9}{256}=&amp;3\\frac{\\beta}{(1+\\beta)^4}\\\\ \\implies &amp;&amp;\\frac{3}{(1+3)^4}=&amp;\\frac{\\beta}{(1+\\beta)^4}\\\\ \\implies &amp;&amp;\\beta=&amp;3. \\end{aligned} \\] Finally, since the mean of a negative binomial is \\(r\\beta\\) we have the mean of the given distribution equals \\(9\\). Show Quiz Solution 2.4 Estimating Frequency Distributions In this section, you learn how to: Define a likelihood for a sample of observations from a discrete distribution Define the maximum likelihood estimator for a random sample of observations from a discrete distribution Calculate the maximum likelihood estimator for the binomial, Poisson, and negative binomial distributions 2.4.1 Parameter Estimation In Section 2.2 we introduced three distributions of importance in modeling various types of count data arising from insurance. Let us now suppose that we have a set of count data to which we wish to fit a distribution, and that we have determined that one of these \\((a,b,0)\\) distributions is more appropriate than the others. Since each one of these forms a class of distributions if we allow its parameter(s) to take any permissible value, there remains the task of determining the best value of the parameter(s) for the data at hand. This is a statistical point estimation problem, and in parametric inference problems the statistical inference paradigm of maximum likelihood usually yields efficient estimators. In this section we will describe this paradigm and derive the maximum likelihood estimators. Let us suppose that we observe the independent and identically distributed, iid, random variables \\(X_1,X_2,\\ldots,X_n\\) from a distribution with pmf \\(p_\\theta\\), where \\(\\theta\\) is a parameter and an unknown value in the parameter space \\(\\Theta\\subseteq \\mathbb{R}^d\\). For example, in the case of the Poisson distribution \\[ p_\\theta(x)=e^{-\\theta}\\frac{\\theta^x}{x!}, \\quad x=0,1,\\ldots, \\] with \\(\\theta=(0,\\infty)\\). In the case of the binomial distribution we have \\[ p_\\theta(x)=\\binom{m}{x} q^x(1-q)^{m-x}, \\quad x=0,1,\\ldots,m, \\] with \\(\\theta:=(m,q)\\in \\{0,1,2,\\ldots\\}\\times[0,1]\\). Let us suppose that the observations are \\(x_1,\\ldots,x_n\\), observed values of the random sample \\(X_1,X_2,\\ldots,X_n\\) presented earlier. In this case, the probability of observing this sample from \\(p_\\theta\\) equals \\[ \\prod_{i=1}^n p_\\theta(x_i). \\] The above, denoted by \\(L(\\theta)\\), viewed as a function of \\(\\theta\\) is called the likelihood. Note that we suppressed its dependence on the data, to emphasize that we are viewing it as a function of the parameter. For example, in the case of the Poisson distribution we have \\[ L(\\lambda)=e^{-n\\lambda} \\lambda^{\\sum_{i=1}^n x_i} \\left(\\prod_{i=1}^n x_i!\\right)^{-1}; \\] in the case of the binomial distribution we have \\[ L(m,q)=\\left(\\prod_{i=1}^n \\binom{m}{x_i}\\right) q^{\\sum_{i=1}^n x_i} (1-q)^{nm-\\sum_{i=1}^n x_i} . \\] The maximum likelihood estimator (MLE) for \\(\\theta\\) is any maximizer of the likelihood; in a sense the MLE chooses the set of parameter values that best explains the observed observations. Consider a sample of size \\(3\\) from a Bernoulli distribution (binomial with \\(m=1\\)) with values \\(0,1,0\\). The likelihood in this case is easily checked to equal \\[ L(q)=q(1-q)^2, \\] and the plot of the likelihood is given in Figure 2.1. As shown in the plot, the maximum value of the likelihood equals \\(4/27\\) and is attained at \\(q=1/3\\), and hence the maximum likelihood estimate for \\(q\\) is \\(1/3\\) for the given sample. In this case one can resort to algebra to show that \\[ q(1-q)^2=\\left(q-\\frac{1}{3}\\right)^2\\left(q-\\frac{4}{3}\\right)+\\frac{4}{27}, \\] and conclude that the maximum equals \\(4/27\\), and is attained at \\(q=1/3\\) (using the fact that the first term is non-positive in the interval \\([0,1]\\)). But as is apparent, this way of deriving the mle using algebra does not generalize. In general, one resorts to calculus to derive the mle - note that for some likelihoods one may have to resort to other optimization methods, especially when the likelihood has many local extrema. It is customary to equivalently maximize the logarithm of the likelihood6 \\(L(\\cdot)\\), denoted by \\(l(\\cdot)\\), and look at the set of zeros of its first derivative7 \\(l&#39;(\\cdot)\\). In the case of the above likelihood, \\(l(q)=\\log(q)+2\\log(1-q)\\), and \\[ l&#39;(q):=\\frac{\\rm d}{{\\rm d}q}l(q)=\\frac{1}{q}-\\frac{2}{1-q}. \\] The unique zero of \\(l&#39;(\\cdot)\\) equals \\(1/3\\), and since \\(l&#39;&#39;(\\cdot)\\) is negative, we have \\(1/3\\) is the unique maximizer of the likelihood and hence its maximum likelihood estimate. Figure 2.1: Likelihood of a \\((0,1,0)\\) \\(3\\)-sample from Bernoulli 2.4.2 Frequency Distributions MLE In the following, we derive the maximum likelihood estimator, MLE, for the three members of the \\((a,b,0)\\) class. We begin by summarizing the discussion above. In the setting of observing iid, independent and identically distributed, random variables \\(X_1,X_2,\\ldots,X_n\\) from a distribution with pmf \\(p_\\theta\\), where \\(\\theta\\) takes an unknown value in \\(\\Theta\\subseteq \\mathbb{R}^d\\), the likelihood \\(L(\\cdot)\\), a function on \\(\\Theta\\) is defined as \\[ L(\\theta):=\\prod_{i=1}^n p_\\theta(x_i), \\] where \\(x_1,\\ldots,x_n\\) are the observed values. The MLE of \\(\\theta\\), denoted as \\(\\hat{\\theta}_{\\rm MLE}\\), is a function which maps the observations to an element of the set of maximizers of \\(L(\\cdot)\\), namely \\[ \\{\\theta \\vert L(\\theta)=\\max_{\\eta\\in\\Theta}L(\\eta)\\}. \\] Note the above set is a function of the observations, even though this dependence is not made explicit. In the case of the three distributions that we will study, and quite generally, the above set is a singleton with probability tending to one (with increasing sample size). In other words, for many commonly used distributions and when the sample size is large, the likelihood estimate is uniquely defined with high probability. In the following, we will assume that we have observed \\(n\\) iid random variables \\(X_1,X_2,\\ldots,X_n\\) from the distribution under consideration, even though the parametric value is unknown. Also, \\(x_1,x_2,\\ldots,x_n\\) will denote the observed values. We note that in the case of count data, and data from discrete distributions in general, the likelihood can alternately be represented as \\[ L(\\theta):=\\prod_{k\\geq 0} \\left(p_\\theta(k)\\right)^{m_k}, \\] where \\[ m_k:= \\left\\vert \\{i\\vert x_i=k, 1\\leq i \\leq n\\} \\right\\vert=\\sum_{i= 1}^n I(x_i=k), \\quad k\\geq 0. \\] Note that this transformation retains all of the data, compiling it in a streamlined manner. For large \\(n\\) it leads to compression of the data in the sense of sufficiency. Below, we present expressions for the MLE in terms of \\(\\{m_k\\}_{k\\geq 1}\\) as well. MLE - Poisson Distribution: In this case, as noted above, the likelihood is given by \\[ L(\\lambda)=\\left(\\prod_{i=1}^n x_i!\\right)^{-1}e^{-n\\lambda}\\lambda^{\\sum_{i=1}^n x_i}, \\] which implies that \\[ l(\\lambda)= -\\sum_{i=1}^n \\log(x_i!) -n\\lambda +\\log(\\lambda) \\cdot \\sum_{i=1}^n x_i, \\] and \\[ l&#39;(\\lambda)= -n +\\frac{1}{\\lambda}\\sum_{i=1}^n x_i. \\] In evaluating \\(l&#39;&#39;(\\lambda)\\), when \\(\\sum_{i=1}^n x_i&gt;0\\), \\(l&#39;&#39;&lt; 0\\). Consequently, the maximum is attained at the sample mean, \\(\\overline{x}\\), presented below. When \\(\\sum_{i=1}^n x_i=0\\), the likelihood is a decreasing function and hence the maximum is attained at the least possible parameter value; this results in the maximum likelihood estimate being zero. Hence, we have \\[ \\overline{x} = \\hat{\\lambda}_{\\rm MLE} = \\frac{1}{n}\\sum_{i=1}^n x_i. \\] Note that the sample mean can be computed also as \\[ \\frac{1}{n} \\sum_{k\\geq 1} km_k. \\] It is noteworthy that in the case of the Poisson, the exact distribution of \\(\\hat{\\lambda}_{\\rm MLE}\\) is available in closed form - it is a scaled Poisson - when the underlying distribution is a Poisson. This is so as the sum of independent Poisson random variables is a Poisson as well. Of course, for large sample size one can use the ordinary Central Limit Theorem (CLT) to derive a normal approximation. Note that the latter approximation holds even if the underlying distribution is any distribution with a finite second moment. MLE - Binomial Distribution: Unlike the case of the Poisson distribution, the parameter space in the case of the binomial is \\(2\\)-dimensional. Hence the optimization problem is a bit more challenging. We begin by observing that the likelihood is given by \\[ L(m,q)= \\left(\\prod_{i=1}^n \\binom{m}{x_i}\\right) q^{\\sum_{i=1}^n x_i} (1-q)^{nm-\\sum_{i=1}^n x_i}, \\] and the log-likelihood by \\[ l(m,q)= \\sum_{i=1}^n \\log\\left(\\binom{m}{x_i}\\right) + \\left({\\sum_{i=1}^n x_i}\\right)\\log(q)+ \\left({nm-\\sum_{i=1}^n x_i}\\right)\\log(1-q). \\] Note that since \\(m\\) takes only non-negative integer values, we cannot use multivariate calculus to find the optimal values. Nevertheless, we can use single variable calculus to show that \\[\\begin{equation} \\hat{q}_{\\rm MLE}\\times \\hat{m}_{\\rm MLE}= \\frac{1}{n}\\sum_{i=1}^n X_i. \\tag{2.2} \\end{equation}\\] Towards this we note that for a fixed value of \\(m\\), \\[ \\frac{\\delta}{\\delta q} l(m,q) = \\left({\\sum_{i=1}^n x_i}\\right)\\frac{1}{q}- \\left({nm-\\sum_{i=1}^n x_i}\\right)\\frac{1}{1-q}, \\] and that \\[ \\frac{\\delta^2}{\\delta q^2} l(m,q) = -\\left[\\left({\\sum_{i=1}^n x_i}\\right)\\frac{1}{q^2} + \\left({nm-\\sum_{i=1}^n x_i}\\right)\\frac{1}{(1-q)^2}\\right]\\leq 0. \\] The above implies that for any fixed value of \\(m\\), the maximizing value of \\(q\\) satisfies \\[ mq=\\frac{1}{n}\\sum_{i=1}^n X_i, \\] and hence we establish equation (2.2). The above reduces the task to the search for \\(\\hat{m}_{\\rm MLE}\\), which is member of the set of the maximizers of \\[\\begin{equation} L\\left(m,\\frac{1}{nm}\\sum_{i=1}^n x_i\\right). \\tag{2.3} \\end{equation}\\] Note the likelihood would be zero for values of \\(m\\) smaller than \\(\\max\\limits_{1\\leq i \\leq n}x_i\\), and hence \\[ \\hat{m}_{\\rm MLE}\\geq \\max_{1\\leq i \\leq n}x_i. \\] Towards specifying an algorithm to compute \\(\\hat{m}_{\\rm MLE}\\), we first point out that for some data sets \\(\\hat{m}_{\\rm MLE}\\) could equal \\(\\infty\\), indicating that a Poisson distribution would render a better fit than any binomial distribution. This is so as the binomial distribution with parameters \\((m,\\overline{x}/m)\\) approaches the Poisson distribution with parameter \\(\\overline{x}\\) with \\(m\\) approaching infinity. The fact that some data sets will prefer a Poisson distribution should not be surprising since in the above sense the set of Poisson distribution is on the boundary of the set of binomial distributions. Interestingly, in (Olkin, Petkau, and Zidek 1981) they show that if the sample mean is less than or equal to the sample variance then \\(\\hat{m}_{\\rm MLE}=\\infty\\); otherwise, there exists a finite \\(m\\) that maximizes equation (2.3). In Figure 2.2 below we display the plot of \\(L\\left(m,\\frac{1}{nm}\\sum_{i=1}^n x_i\\right)\\) for three different samples of size \\(5\\); they differ only in the value of the sample maximum. The first sample of \\((2,2,2,4,5)\\) has the ratio of sample mean to sample variance greater than \\(1\\) (\\(1.875\\)), the second sample of \\((2,2,2,4,6)\\) has the ratio equal to \\(1.25\\) which is closer to \\(1\\), and the third sample of \\((2,2,2,4,7)\\) has the ratio less than \\(1\\) (\\(0.885\\)). For these three samples, as shown in Figure 2.2, \\(\\hat{m}_{\\rm MLE}\\) equals \\(7\\), \\(18\\) and \\(\\infty\\), respectively. Note that the limiting value of \\(L\\left(m,\\frac{1}{nm}\\sum_{i=1}^n x_i\\right)\\) as \\(m\\) approaches infinity equals \\[\\begin{equation} \\left(\\prod_{i=1}^n x_i! \\right)^{-1} \\exp\\left\\{-\\sum_{i=1}^n x_i\\right\\} \\overline{x}^{n\\overline{x}}. \\tag{2.4} \\end{equation}\\] Also, note that Figure 2.2 shows that the MLE of \\(m\\) is non-robust, i.e. changes in a small proportion of the data set can cause large changes in the estimator. The above discussion suggests the following simple algorithm: Step 1. If the sample mean is less than or equal to the sample variance, \\(\\hat{m}_{MLE}=\\infty\\). The MLE suggested distribution is a Poisson distribution with \\(\\hat{\\lambda}=\\overline{x}\\). Step 2. If the sample mean is greater than the sample variance, then compute \\(L(m,\\overline{x}/m)\\) for \\(m\\) values greater than or equal to the sample maximum until \\(L(m,\\overline{x}/m)\\) is close to the value of the Poisson likelihood given in (2.4). The value of \\(m\\) that corresponds to the maximum value of \\(L(m,\\overline{x}/m)\\) among those computed equals \\(\\hat{m}_{MLE}\\). We note that if the underlying distribution is the binomial distribution with parameters \\((m,q)\\) (with \\(q&gt;0\\)) then \\(\\hat{m}_{MLE}\\) will equal \\(m\\) for large sample sizes. Also, \\(\\hat{q}_{MLE}\\) will have an asymptotically normal distribution and converge with probability one to \\(q\\). Figure 2.2: Plot of \\(L(m,\\overline{x}/m)\\) for binomial distribution MLE - Negative Binomial Distribution: The case of the negative binomial distribution is similar to that of the binomial distribution in the sense that we have two parameters and the MLEs are not available in closed form. A difference between them is that unlike the binomial parameter \\(m\\) which takes positive integer values, the parameter \\(r\\) of the negative binomial can assume any positive real value. This makes the optimization problem a tad more complex. We begin by observing that the likelihood can be expressed in the following form: \\[ L(r,\\beta)=\\left(\\prod_{i=1}^n \\binom{r+x_i-1}{x_i}\\right) (1+\\beta)^{-n(r+\\overline{x})} \\beta^{n\\overline{x}}. \\] The above implies that log-likelihood is given by \\[ l(r,\\beta)=\\sum_{i=1}^n \\log\\binom{r+x_i-1}{x_i} -n(r+\\overline{x}) \\log(1+\\beta) +n\\overline{x}\\log\\beta, \\] and hence \\[ \\frac{\\delta}{\\delta\\beta} l(r,\\beta) = -\\frac{n(r+\\overline{x})}{1+\\beta} + \\frac{n\\overline{x}}{\\beta}. \\] Equating the above to zero, we get \\[ \\hat{r}_{MLE}\\times \\hat{\\beta}_{MLE} = \\overline{x}. \\] The above reduces the two dimensional optimization problem to a one-dimensional problem - we need to maximize \\[ l(r,\\overline{x}/r)=\\sum_{i=1}^n \\log\\binom{r+x_i-1}{x_i} -n(r+\\overline{x}) \\log(1+\\overline{x}/r) +n\\overline{x}\\log(\\overline{x}/r), \\] with respect to \\(r\\), with the maximizing \\(r\\) being its MLE and \\(\\hat{\\beta}_{MLE}=\\overline{x}/\\hat{r}_{MLE}\\). In (Levin, Reeds, and others 1977) it is shown that if the sample variance is greater than the sample mean then there exists a unique \\(r&gt;0\\) that maximizes \\(l(r,\\overline{x}/r)\\) and hence a unique MLE for \\(r\\) and \\(\\beta\\). Also, they show that if \\(\\hat{\\sigma}^2\\leq \\overline{x}\\), then the negative binomial likelihood will be dominated by the Poisson likelihood with \\(\\hat{\\lambda}=\\overline{x}\\). In other words, a Poisson distribution offers a better fit to the data. The guarantee in the case of \\(\\hat{\\sigma}^2&gt;\\hat{\\mu}\\) permits us to use some algorithm to maximize \\(l(r,\\overline{x}/r)\\). Towards an alternate method of computing the likelihood, we note that \\[ l(r,\\overline{x}/r)=\\sum_{i=1}^n \\sum_{j=1}^{x_i}\\log(r-1+j) - \\sum_{i=1}^n\\log(x_i!) - n(r+\\overline{x}) \\log(r+\\overline{x}) + nr\\log(r) + n\\overline{x}\\log(\\overline{x}), \\] which yields \\[ \\left(\\frac{1}{n}\\right)\\frac{\\delta}{\\delta r}l(r,\\overline{x}/r)=\\left(\\frac{1}{n}\\right)\\sum_{i=1}^n \\sum_{j=1}^{x_i}\\frac{1}{r-1+j} - \\log(r+\\overline{x}) + \\log(r). \\] We note that, in the above expressions for the terms involving a double summation, the inner sum equals zero if \\(x_i=0\\). The maximum likelihood estimate for \\(r\\) is a root of the last expression and we can use a root finding algorithm to compute it. Also, we have \\[ \\left(\\frac{1}{n}\\right)\\frac{\\delta^2}{\\delta r^2}l(r,\\overline{x}/r)=\\frac{\\overline{x}}{r(r+\\overline{x})}-\\left(\\frac{1}{n}\\right)\\sum_{i=1}^n \\sum_{j=1}^{x_i}\\frac{1}{(r-1+j)^2}. \\] A simple but quickly converging iterative root finding algorithm is the Newton’s method, which incidentally the Babylonians are believed to have used for computing square roots. Under this method, an initial approximation is selected for the root and new approximations for the root are successively generated until convergence. Applying the Newton’s method to our problem results in the following algorithm: Step i. Choose an approximate solution, say \\(r_0\\). Set \\(k\\) to \\(0\\). Step ii. Define \\(r_{k+1}\\) as \\[ r_{k+1}:= r_k - \\frac{\\left(\\frac{1}{n}\\right)\\sum_{i=1}^n \\sum_{j=1}^{x_i}\\frac{1}{r_k-1+j} - \\log(r_k+\\overline{x}) + \\log(r_k)}{\\frac{\\overline{x}}{r_k(r_k+\\overline{x})}-\\left(\\frac{1}{n}\\right)\\sum_{i=1}^n \\sum_{j=1}^{x_i}\\frac{1}{(r_k-1+j)^2}} \\] Step iii. If \\(r_{k+1}\\sim r_k\\), then report \\(r_{k+1}\\) as maximum likelihood estimate; else increment \\(k\\) by \\(1\\) and repeat Step ii. For example, we simulated a \\(5\\) observation sample of \\(41, 49, 40, 27, 23\\) from the negative binomial with parameters \\(r=10\\) and \\(\\beta=5\\). Choosing the starting value of \\(r\\) such that \\[ r\\beta=\\hat{\\mu} \\quad \\hbox{and} \\quad r\\beta(1+\\beta)=\\hat{\\sigma}^2 \\] where \\(\\hat{\\mu}\\) represents the estimated mean and \\(hat{\\sigma}^2\\) is the estimated variance. This leads to the starting value for \\(r\\) of \\(23.14286\\). The iterates of \\(r\\) from the Newton’s method are \\[ 21.39627, 21.60287, 21.60647, 21.60647; \\] the rapid convergence seen above is typical of the Newton’s method. Hence in this example, \\(\\hat{r}_{MLE}\\sim21.60647\\) and \\(\\hat{\\beta}_{MLE}=8.3308\\). R Implementation of Newton’s Method - Negative Binomial MLE for \\(r\\) Show R Code Newton&lt;-function(x,abserr){ mu&lt;-mean(x); sigma2&lt;-mean(x^2)-mu^2; r&lt;-mu^2/(sigma2-mu); b&lt;-TRUE; iter&lt;-0; while (b) { tr&lt;-r; m1&lt;-mean(c(x[x==0],sapply(x[x&gt;0],function(z){sum(1/(tr:(tr-1+z)))}))); m2&lt;-mean(c(x[x==0],sapply(x[x&gt;0],function(z){sum(1/(tr:(tr-1+z))^2)}))); r&lt;-tr-(m1-log(1+mu/tr))/(mu/(tr*(tr+mu))-m2); b&lt;-!(abs(tr-r)&lt;abserr); iter&lt;-iter+1; } c(r,iter) } To summarize our discussion of MLE for the \\((a,b,0)\\) class of distributions, in Figure 2.3 below we plot the maximum value of the Poisson likelihood, \\(L(m,\\overline{x}/m)\\) for the binomial, and \\(L(r,\\overline{x}/r)\\) for the negative binomial, for the three samples of size \\(5\\) given in Table 2.1. The data was constructed to cover the three orderings of the sample mean and variance. As show in the Figure 2.3, and supported by theory, if \\(\\hat{\\mu}&lt;\\hat{\\sigma}^2\\) then the negative binomial will result in a higher maximum likelihood value; if \\(\\hat{\\mu}=\\hat{\\sigma}^2\\) the Poisson will have the highest likelihood value; and finally in the case that \\(\\hat{\\mu}&gt;\\hat{\\sigma}^2\\) the binomial will give a better fit than the others. So before fitting a frequency data with an \\((a,b,0,)\\) distribution, it is best to start with examining the ordering of \\(\\hat{\\mu}\\) and \\(\\hat{\\sigma}^2\\). We again emphasize that the Poisson is on the boundary of the negative binomial and binomial distributions. So in the case that \\(\\hat{\\mu}\\geq\\hat{\\sigma}^2\\) (\\(\\hat{\\mu}\\leq\\hat{\\sigma}^2\\), resp.) the Poisson will yield a better fit than the negative binomial (binomial, resp.), which will also be indicated by \\(\\hat{r}=\\infty\\) (\\(\\hat{m}=\\infty\\), resp.). \\[\\begin{matrix} \\begin{array}{c|c|c} \\hline \\text{Data} &amp; \\text{Mean }(\\hat{\\mu}) &amp; \\text{Variance }(\\hat{\\sigma}^2) \\\\ \\hline (2,3,6,8,9) &amp; 5.60 &amp; 7.44 \\\\ (2,5,6,8,9) &amp; 6 &amp; 6\\\\ (4,7,8,10,11) &amp; 8 &amp; 6\\\\\\hline \\end{array} \\end{matrix}\\] Table 2.1 : Three Samples of Size \\(5\\) Figure 2.3: Plot of \\((a,b,0)\\) Partially Maximized Likelihoods Show Quiz Solution 2.5 Other Frequency Distributions In this section, you learn how to: Define the (a,b,1) class of frequency distributions and discuss the importance of the recursive relationship underpinning this class of distributions Interpret zero truncated and modifed versions of the binomial, Poisson, and negative binomial distributions Compute probabilities using the recursive relationship In the previous sections, we discussed three distributions with supports contained in the set of non-negative integers, which well cater to many insurance applications. Moreover, typically by allowing the parameters to be a function of known (to the insurer) explanatory variables such as age, sex, geographic location (territory), and so forth, these distributions allow us to explain claim probabilities in terms of these variables. The field of statistical study that studies such models is known as regression analysis - it is an important topic of actuarial interest that we will not pursue in this book; see (Edward W Frees 2009). There are clearly infinitely many other count distributions, and more importantly the above distributions by themselves do not cater to all practical needs. In particular, one feature of some insurance data is that the proportion of zero counts can be out of place with the proportion of other counts to be explainable by the above distributions. In the following we modify the above distributions to allow for arbitrary probability for zero count irrespective of the assignment of relative probabilities for the other counts. Another feature of a data set which is naturally comprised of homogeneous subsets is that while the above distributions may provide good fits to each subset, they may fail to do so to the whole data set. Later we naturally extend the \\((a,b,0)\\) distributions to be able to cater to, in particular, such data sets. 2.5.1 Zero Truncation or Modification Let us suppose that we are looking at auto insurance policies which appear in a database of auto claims made in a certain period. If one is to study the number of claims that these policies have made during this period, then clearly the distribution has to assign a probability of zero to the count variable assuming the value zero. In other words, by restricting attention to count data from policies in the database of claims, we have in a sense zero-truncated the count data of all policies. In personal lines (like auto), policyholders may not want to report that first claim because of fear that it may increase future insurance rates - this behavior will inflate the proportion of zero counts. Examples such as the latter modify the proportion of zero counts. Interestingly, natural modifications of the three distributions considered above are able to provide good fits to zero-modified/truncated data sets arising in insurance. As presented below, we modify the probability assigned to zero count by the \\((a,b,0)\\) class while maintaining the relative probabilities assigned to non-zero counts - zero modification. Note that since the \\((a,b,0)\\) class of distributions satisfies the recurrence (2.1), maintaining relative probabilities of non-zero counts implies that recurrence (2.1) is satisfied for \\(k\\geq 2\\). This leads to the definition of the following class of distributions. Definition. A count distribution is a member of the \\((a, b, 1)\\) class if for some constants \\(a\\) and \\(b\\) the probabilities \\(p_k\\) satisfy \\[\\begin{equation} \\frac{p_k}{p_{k-1}}=a+\\frac{b}{k},\\quad k\\geq 2. \\tag{2.5} \\end{equation}\\] Note that since the recursion starts with \\(p_1\\), and not \\(p_0\\), we refer to this super-class of \\((a,b,0)\\) distributions by (a,b,1). To understand this class, recall that each valid pair of values for \\(a\\) and \\(b\\) of the \\((a,b,0)\\) class corresponds to a unique vector of probabilities \\(\\{p_k\\}_{k\\geq 0}\\). If we now look at the probability vector \\(\\{\\tilde{p}_k\\}_{k\\geq 0}\\) given by \\[ \\tilde{p}_k= \\frac{1-\\tilde{p}_0}{1-p_0}\\cdot p_k, \\quad k\\geq 1, \\] where \\(\\tilde{p}_0\\in[0,1)\\) is arbitrarily chosen, then since the relative probabilities for positive values according to \\(\\{p_k\\}_{k\\geq 0}\\) and \\(\\{\\tilde{p}_k\\}_{k\\geq 0}\\) are the same, we have \\(\\{\\tilde{p}_k\\}_{k\\geq 0}\\) satisfies recurrence (2.5). This, in particular, shows that the class of \\((a,b,1)\\) distributions is strictly wider than that of \\((a,b,0)\\). In the above, we started with a pair of values for \\(a\\) and \\(b\\) that led to a valid \\((a,b,0)\\) distribution, and then looked at the \\((a,b,1)\\) distributions that corresponded to this \\((a,b,0)\\) distribution. We will now argue that the \\((a,b,1)\\) class allows for a larger set of permissible distributions for \\(a\\) and \\(b\\) than the \\((a,b,0)\\) class. Recall from Section 2.3 that in the case of \\(a&lt;0\\) we did not use the fact that the recurrence (2.1) started at \\(k=1\\), and hence the set of pairs \\((a,b)\\) with \\(a&lt;0\\) that are permissible for the \\((a,b,0)\\) class is identical to those that are permissible for the \\((a,b,1)\\) class. The same conclusion is easily drawn for pairs with \\(a=0\\). In the case that \\(a&gt;0\\), instead of the constraint \\(a+b&gt;0\\) for the \\((a,b,0)\\) class we now have the weaker constraint of \\(a+b/2&gt;0\\) for the \\((a,b,1)\\) class. With the parametrization \\(b=(r-1)a\\) as used in Section 2.3, instead of \\(r&gt;0\\) we now have the weaker constraint of \\(r&gt;-1\\). In particular, we see that while zero modifying a \\((a,b,0)\\) distribution leads to a distribution in the \\((a,b,1)\\) class, the conclusion does not hold in the other direction. Zero modification of a count distribution \\(F\\) such that it assigns zero probability to zero count is called a zero truncation of \\(F\\). Hence, the zero truncated version of probabilities \\(\\{p_k\\}_{k\\geq 0}\\) is given by \\[ \\tilde{p}_k=\\begin{cases} 0, &amp; k=0;\\\\ \\frac{p_k}{1-p_0}, &amp; k\\geq 1. \\end{cases} \\] In particular, we have that a zero modification of a count distribution \\(\\{p_k^T\\}_{k\\geq 0}\\), denoted by \\(\\{p^M_k\\}_{k\\geq 0}\\), can be written as a convex combination of the degenerate distribution at \\(0\\) and the zero truncation of \\(\\{p_k\\}_{k\\geq 0}\\), denoted by \\(\\{p^T_k\\}_{k\\geq 0}\\). That is we have \\[ p^M_k= p^M_0 \\cdot \\delta_{0}(k) + (1-p^M_0) \\cdot p^T_k, \\quad k\\geq 0. \\] Example 2.5.1. Zero Truncated/Modified Poisson. Consider a Poisson distribution with parameter \\(\\lambda=2\\). Calculate \\(p_k, k=0,1,2,3\\), for the usual (unmodified), truncated and a modified version with \\((p_0^M=0.6)\\). Show Example Solution Solution. For the Poisson distribution as a member of the (\\(a,b\\),0) class, we have \\(a=0\\) and \\(b=\\lambda=2\\). Thus, we may use the recursion \\(p_k = \\lambda p_{k-1}/k= 2 p_{k-1}/k\\) for each type, after determining starting probabilities. The calculation of probabilities for \\(k\\leq 3\\) is shown in Table 2.2. \\[\\begin{matrix} \\begin{array}{c|c|c|c} \\hline k &amp; p_k &amp; p_k^T &amp; p_k^M\\\\\\hline 0 &amp; p_0=e^{-\\lambda}=0.135335 &amp; 0 &amp; 0.6\\\\\\hline 1 &amp; p_1=p_0(0+\\frac{\\lambda}{1})=0.27067 &amp; \\frac{p_1}{1-p_0}=0.313035 &amp; \\frac{1-p_0^M}{1-p_0}~p_1=0.125214\\\\\\hline 2 &amp; p_2=p_1\\left( \\frac{\\lambda}{2}\\right)=0.27067 &amp; p_2^T=p_1^T\\left(\\frac{\\lambda}{2}\\right)=0.313035 &amp; p_2^M=p_1^M\\left(\\frac{\\lambda}{2}\\right)=0.125214\\\\\\hline 3 &amp; p_3=p_2\\left(\\frac{\\lambda}{3}\\right)=0.180447 &amp; p_3^T=p_2^T\\left(\\frac{\\lambda}{3}\\right)=0.208690 &amp; p_3^M=p_2^M\\left(\\frac{\\lambda}{3}\\right)=0.083476\\\\\\hline \\end{array} \\end{matrix}\\] Table 2.2 : Calculation of probabilities for \\(k\\leq 3\\) Show Quiz Solution 2.6 Mixture Distributions In this section, you learn how to: Define a mixture distribution when the mixing component is based on a finite number of sub-groups Compute mixture distribution probabilities from mixing proportions and knowledge of the distribution of each subgroup Define a mixture distribution when the mixing component is continuous In many applications, the underlying population consists of naturally defined sub-groups with some homogeneity within each sub-group. In such cases it is convenient to model the individual sub-groups, and in a ground-up manner model the whole population. As we shall see below, beyond the aesthetic appeal of the approach, it also extends the range of applications that can be catered to by standard parametric distributions. Let \\(k\\) denote the number of defined sub-groups in a population, and let \\(F_i\\) denote the distribution of an observation drawn from the \\(i\\)-th subgroup. If we let \\(\\alpha_i\\) denote the proportion of the population in the \\(i\\)-th subgroup, with \\(\\sum_{i=1}^k \\alpha_i=1\\), then the distribution of a randomly chosen observation from the population, denoted by \\(F\\), is given by \\[\\begin{equation} F(x)=\\sum_{i=1}^k \\alpha_i \\cdot F_i(x). \\tag{2.6} \\end{equation}\\] The above expression can be seen as a direct application of the Law of Total Probability. As an example, consider a population of drivers split broadly into two sub-groups, those with at most \\(5\\)-years of driving experience and those with more than \\(5\\)-years experience. Let \\(\\alpha\\) denote the proportion of drivers with less than \\(5\\) years experience, and \\(F_{\\leq 5}\\) and \\(F_{&gt; 5}\\) denote the distribution of the count of claims in a year for a driver in each group, respectively. Then the distribution of claim count of a randomly selected driver is given by \\[ \\alpha\\cdot F_{\\leq 5}(x) + (1-\\alpha)F_{&gt; 5}(x). \\] An alternate definition of a mixture distribution is as follows. Let \\(N_i\\) be a random variable with distribution \\(F_i\\), \\(i=1,\\ldots, k\\). Let \\(I\\) be a random variable taking values \\(1,2,\\ldots,k\\) with probabilities \\(\\alpha_1,\\ldots,\\alpha_k\\), respectively. Then the random variable \\(N_I\\) has a distribution given by equation (2.6)8. In (2.6) we see that the distribution function is a convex combination of the component distribution functions. This result easily extends to the density function, the survival function, the raw moments, and the expectation as these are all linear mappings of the distribution function. We note that this is not true for central moments like the variance, and conditional measures like the hazard rate function. In the case of variance it is easily seen as \\[\\begin{equation} \\mathrm{Var}{[N_I]}=\\mathrm{E}[{\\mathrm{Var}[{N_I\\vert I}]]} + \\mathrm{Var}[{\\mathrm{E}[{N_I|I}}]]=\\sum_{i=1}^k \\alpha_i \\mathrm{Var}[{N_i}] + \\mathrm{Var}[{\\mathrm{E}[{N_I|I}}]] . \\tag{2.7} \\end{equation}\\] Appendix 15 provides additonal background about this important expression. Example 2.6.1. Actuarial Exam Question. In a certain town the number of common colds an individual will get in a year follows a Poisson distribution that depends on the individual’s age and smoking status. The distribution of the population and the mean number of colds are as follows: \\[\\begin{matrix} \\begin{array}{l|c|c} \\hline &amp; \\text{Proportion of population} &amp; \\text{Mean number of colds}\\\\\\hline \\text{Children} &amp; 0.3 &amp; 3\\\\ \\text{Adult Non-Smokers} &amp; 0.6 &amp; 1\\\\ \\text{Adult Smokers} &amp; 0.1 &amp; 4\\\\\\hline \\end{array} \\end{matrix}\\] Table 2.3 : The distribution of the population and the mean number of colds Calculate the probability that a randomly drawn person has 3 common colds in a year. Calculate the conditional probability that a person with exactly 3 common colds in a year is an adult smoker. Show Example Solution Solution. Using Law of Total Probability, we can write the required probability as \\(\\Pr(N_I=3)\\), with \\(I\\) denoting the group of the randomly selected individual with \\(1,2\\) and \\(3\\) signifying the groups Children, Adult Non-Smoker, and Adult Smoker, respectively. Now by conditioning we get \\[ \\Pr(N_I=3)=0.3\\cdot\\Pr(N_1=3)+0.6\\cdot\\Pr(N_2=3)+0.1\\cdot\\Pr(N_3=3), \\] with \\(N_1,N_2\\) and \\(N_3\\) following Poisson distributions with means \\(3,1\\), and \\(4\\), respectively. Using the above, we get \\(\\Pr(N_I=3)\\sim0.1235\\) The conditional probability of event A given event B, \\(\\Pr(A\\vert B) = \\frac{\\Pr(A,B)}{\\Pr(B)}\\). The required conditional probability in this problem can then be written as \\(\\Pr(I=3\\vert N_I=3)\\), which equals \\[ \\Pr(I=3\\vert N_I=3)=\\frac{\\Pr(I=3,N_3=3)}{\\Pr(N_I=3)}\\sim\\frac{0.1 \\times 0.1954}{0.1235}\\sim 0.1581. \\] In the above example, the number of subgroups \\(k\\) was equal to three. In general, \\(k\\) can be any natural number, but when \\(k\\) is large it is parsimonious from a modeling point of view to take the following infinitely many subgroup approach. To motivate this approach, let the \\(i\\)-th subgroup be such that its component distribution \\(F_i\\) is given by \\(G_{\\tilde{\\theta_i}}\\), where \\(G_\\cdot\\) is a parametric family of distributions with parameter space \\(\\Theta\\subseteq \\mathbb{R}^d\\). With this assumption, the distribution function \\(F\\) of a randomly drawn observation from the population is given by \\[ F(x)=\\sum_{i=1}^k \\alpha_i G_{\\tilde{\\theta_i}}(x),\\quad \\forall x\\in\\mathbb{R}. \\] which can be alternately written as \\[ F(x)=\\mathrm{E}[{G_{\\tilde{\\vartheta}}(x)}],\\quad \\forall x\\in\\mathbb{R}, \\] where \\(\\tilde{\\vartheta}\\) takes values \\(\\tilde{\\theta_i}\\) with probability \\(\\alpha_i\\), for \\(i=1,\\ldots,k\\). The above makes it clear that when \\(k\\) is large, one could model the above by treating \\(\\tilde{\\vartheta}\\) as continuous random variable. To illustrate this approach, suppose we have a population of drivers with the distribution of claims for an individual driver being distributed as a Poisson. Each person has their own (personal) expected number of claims \\(\\lambda\\) - smaller values for good drivers, and larger values for others. There is a distribution of \\(\\lambda\\) in the population; a popular and convenient choice for modeling this distribution is a gamma distribution with parameters \\((\\alpha, \\theta)\\). With these specifications it turns out that the resulting distribution of \\(N\\), the claims of a randomly chosen driver, is a negative binomial with parameters \\((r=\\alpha,\\beta=\\theta)\\). This can be shown in many ways, but a straightforward argument is as follows: \\[\\begin{align*} \\Pr(N=k)&amp;= \\int_0^\\infty \\frac{e^{-\\lambda}\\lambda^k}{k!} \\frac{\\lambda^{\\alpha-1}e^{-\\lambda/\\theta}}{\\Gamma{(\\alpha)}\\theta^{\\alpha}} {\\rm d}\\lambda = \\frac{1}{k!\\Gamma(\\alpha)\\theta^\\alpha}\\int_0^\\infty \\lambda^{\\alpha+k-1}e^{-\\lambda(1+1/\\theta)}{\\rm d}\\lambda=\\frac{\\Gamma{(\\alpha+k)}}{k!\\Gamma(\\alpha)\\theta^\\alpha(1+1/\\theta)^{\\alpha+k}} \\\\ &amp;=\\binom{\\alpha+k-1}{k}\\left(\\frac{1}{1+\\theta}\\right)^\\alpha\\left(\\frac{\\theta}{1+\\theta}\\right)^k, \\quad k=0,1,\\ldots \\end{align*}\\] Note that the above derivation implicitly uses the following: \\[ f_{N\\vert\\Lambda=\\lambda}(N=k)=\\frac{e^{-\\lambda}\\lambda^k}{k!}, \\quad k\\geq 0; \\quad \\hbox{and} \\quad f_{\\Lambda}(\\lambda)= \\frac{\\lambda^{\\alpha-1}e^{-\\lambda/\\theta}}{\\Gamma{(\\alpha)}\\theta^{\\alpha}}, \\quad \\lambda&gt;0. \\] It is worth mentioning that by considering mixtures of a parametric class of distributions we increase the richness of the class. This expansion of distributions results in the mixture class being able to cater well to more applications that the parametric class we started with. Mixture modeling is a very important modeling technique in insurance applications, and later chapters will cover more aspects of this modeling technique. Example 2.6.2. Suppose that \\(N|\\Lambda \\sim\\) Poisson\\((\\Lambda)\\) and that \\(\\Lambda \\sim\\) gamma with mean of 1 and variance of 2. Determine the probability that \\(N=1\\). Show Example Solution Solution. For a gamma distribution with parameters \\((\\alpha, \\theta)\\), we have that the mean is \\(\\alpha \\theta\\) and the variance is \\(\\alpha \\theta^2\\). Using these expressions we have \\[ \\begin{aligned} \\alpha &amp;= \\frac{1}{2} \\text{ and } \\theta =2. \\end{aligned} \\] Now, one can directly use the above result to conclude that \\(N\\) is distributed as a negative binomial with \\(r = \\alpha = \\frac{1}{2}\\) and \\(\\beta= \\theta =2\\). Thus \\[ \\begin{aligned} \\Pr(N=1) &amp;= \\binom{1+r-1}{1}(\\frac{1}{(1+\\beta)^r})\\left(\\frac{\\beta}{1+\\beta}\\right)^1 \\\\ &amp;= \\binom{1+\\frac{1}{2}-1}{1}{\\frac{1}{(1+2)^{1/2}}}\\left(\\frac{2}{1+2}\\right)^1\\\\ &amp;= \\frac{1}{3^{3/2}} = 0.19245 . \\end{aligned} \\] Show Quiz Solution 2.7 Goodness of Fit In this section, you learn how to: Calculate a goodness of fit statistic to compare a hypothesized discrete distribution to a sample of discrete observations Compare the statistic to a reference distribution to assess the adequacy of the fit In the above we have discussed three basic frequency distributions, along with their extensions through zero modification/truncation and by looking at mixtures of these distributions. Nevertheless, these classes still remain parametric and hence by their very nature a small subset of the class of all possible frequency distributions (i.e. the set of distributions on non-negative integers.) Hence, even though we have talked about methods for estimating the unknown parameters, the fitted distribution will not be a good representation of the underlying distribution if the latter is far from the class of distribution used for modeling. In fact, it can be shown that the maximum likelihood estimator will converge to a value such that the corresponding distribution will be a Kullback-Leibler projection of the underlying distribution on the class of distributions used for modeling. Below we present one testing method - Pearson’s chi-square statistic - to check for the goodness of fit of the fitted distribution. For more details on the Pearson’s chi-square test, at an introductory mathematical statistics level, we refer the reader to Section 9.1 of (Hogg, Tanis, and Zimmerman 2015). In \\(1993\\), a portfolio of \\(n=7,483\\) automobile insurance policies from a major Singaporean insurance company had the distribution of auto accidents per policyholder as given in Table 2.4. \\[\\begin{matrix} \\begin{array}{c|c|c|c|c|c|c} \\hline \\text{Count }(k) &amp; 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; \\text{Total}\\\\ \\hline \\text{No. of Policies with }k\\text{ accidents }(m_k) &amp; 6,996 &amp; 455 &amp; 28 &amp; 4 &amp; 0 &amp; 7483\\\\ \\hline \\end{array} \\end{matrix}\\] Table 2.4 : Singaporean Automobile Accident Data If we a fit a Poisson distribution, then the MLE for \\(\\lambda\\), the Poisson mean, is the sample mean which is given by \\[ \\overline{N} = \\frac{0\\cdot 6996 + 1 \\cdot 455 + 2 \\cdot 28 + 3 \\cdot 4 + 4 \\cdot 0}{7483} = 0.06989. \\] Now if we use Poisson (\\(\\hat{\\lambda}_{MLE}\\)) as the fitted distribution, then a tabular comparison of the fitted counts and observed counts is given by Table 2.5 below, where \\(\\hat{p}_k\\) represents the estimated probabilities under the fitted Poisson distribution. \\[\\begin{matrix} \\begin{array}{c|c|c} \\hline \\text{Count} &amp; \\text{Observed} &amp; \\text{Fitted Counts}\\\\ (k) &amp; (m_k) &amp; \\text{Using Poisson }(n\\hat{p}_k)\\\\ \\hline 0 &amp; 6,996 &amp; 6,977.86 \\\\ 1 &amp; 455 &amp; 487.70 \\\\ 2 &amp; 28 &amp; 17.04 \\\\ 3 &amp; 4 &amp; 0.40 \\\\ \\geq4 &amp; 0 &amp; 0.01\\\\ \\hline \\text{Total} &amp; 7,483 &amp; 7,483.00\\\\ \\hline \\end{array} \\end{matrix}\\] Table 2.5 : Comparison of Observed to Fitted Counts: Singaporean Auto Data While the fit seems reasonable, a tabular comparison falls short of a statistical test of the hypothesis that the underlying distribution is indeed Poisson. The Pearson’s chi-square statistic is a goodness of fit statistical measure that can be used for this purpose. To explain this statistic let us suppose that a dataset of size \\(n\\) is grouped into \\(k\\) cells with \\(m_k/n\\) and \\(\\hat{p}_k\\), for \\(k=1\\ldots,K\\) being the observed and estimated probabilities of an observation belonging to the \\(k\\)-th cell, respectively. The Pearson’s chi-square test statistic is then given by \\[ \\sum_{k=1}^K\\frac{\\left( m_k-n\\widehat{p}_k \\right) ^{2}}{n\\widehat{p}_k}. \\] The motivation for the above statistic derives from the fact that \\[ \\sum_{k=1}^K\\frac{\\left( m_k-n{p}_k \\right) ^{2}}{n{p}_k} \\] has a limiting chi-square distribution with \\(K-1\\) degrees of freedom if \\(p_k\\), \\(k=1,\\ldots,K\\) are the true cell probabilities. Now suppose that only the summarized data represented by \\(m_k\\), \\(k=1,\\ldots,K\\) is available. Further, if \\(p_k\\)’s are functions of \\(s\\) parameters, replacing \\(p_k\\)’s by any efficiently estimated probabilities \\(\\widehat{p}_k\\)’s results in the statistic continuing to have a limiting chi-square distribution but with degrees of freedom given by \\(K-1-s\\). Such efficient estimates can be derived for example by using the MLE method (with a multinomial likelihood) or by estimating the \\(s\\) parameters which minimizes the Pearson’s chi-square statistic above. For example, the R code below does calculate an estimate for \\(\\lambda\\) doing the latter and results in the estimate \\(0.06623153\\), close but different from the MLE of \\(\\lambda\\) using the full data: m&lt;-c(6996,455,28,4,0); op&lt;-m/sum(m); g&lt;-function(lam){sum((op-c(dpois(0:3,lam),1-ppois(3,lam)))^2)}; optim(sum(op*(0:4)),g,method=&quot;Brent&quot;,lower=0,upper=10)$par When one uses the full data to estimate the probabilities, the asymptotic distribution is in between chi-square distributions with parameters \\(K-1\\) and \\(K-1-s\\). In practice it is common to ignore this subtlety and assume the limiting chi-square has \\(K-1-s\\) degrees of freedom. Interestingly, this practical shortcut works quite well in the case of the Poisson distribution. For the Singaporean auto data the Pearson’s chi-square statistic equals \\(41.98\\) using the full data MLE for \\({\\lambda}\\). Using the limiting distribution of chi-square with \\(5-1-1=3\\) degrees of freedom, we see that the value of \\(41.98\\) is way out in the tail (\\(99\\)-th percentile is below \\(12\\)). Hence we can conclude that the Poisson distribution provides an inadequate fit for the data. In the above, we started with the cells as given in the above tabular summary. In practice, a relevant question is how to define the cells so that the chi-square distribution is a good approximation to the finite sample distribution of the statistic. A rule of thumb is to define the cells in such a way to have at least \\(80\\%\\), if not all, of the cells having expected counts greater than \\(5\\). Also, it is clear that a larger number of cells results in a higher power of the test, and hence a simple rule of thumb is to maximize the number of cells such that each cell has at least 5 observations. Show Quiz Solution 2.8 Exercises Theoretical Exercises Exercise 2.1. Derive an expression for \\(p_N(\\cdot)\\) in terms of \\(F_N(\\cdot)\\) and \\(S_N(\\cdot)\\). Exercise 2.2. A measure of center of location must be equi-variant with respect to shifts, or location transformations. In other words, if \\(N_1\\) and \\(N_2\\) are two random variables such that \\(N_1+c\\) has the same distribution as \\(N_2\\), for some constant \\(c\\), then the difference between the measures of the center of location of \\(N_2\\) and \\(N_1\\) must equal \\(c\\). Show that the mean satisfies this property. Exercise 2.3. Measures of dispersion should be invariant with respect to shifts and scale equi-variant. Show that standard deviation satisfies these properties by doing the following: Show that for a random variable \\(N\\), its standard deviation equals that of \\(N+c\\), for any constant \\(c\\). Show that for a random variable \\(N\\), its standard deviation equals \\(1/c\\) times that of \\(cN\\), for any positive constant \\(c\\). Exercise 2.4. Let \\(N\\) be a random variable with probability mass function given by \\[ p_N(k):= \\begin{cases} \\left(\\frac{6}{\\pi^2}\\right)\\left(\\frac{1}{k^{2}}\\right), &amp; k\\geq 1;\\\\ 0, &amp;\\hbox{otherwise}. \\end{cases} \\] Show that the mean of \\(N\\) is \\(\\infty\\). Exercise 2.5. Let \\(N\\) be a random variable with a finite second moment. Show that the function \\(\\psi(\\cdot)\\) defined by \\[ \\psi(x):=\\mathrm{E}{(N-x)^2}. \\quad x\\in\\mathbb{R} \\] is minimized at \\(\\mu_N\\) without using calculus. Also, give a proof of this fact using derivatives. Conclude that the minimum value equals the variance of \\(N\\). Exercise 2.6. Derive the first two central moments of the \\((a,b,0)\\) distributions using the methods mentioned below: For the binomial distribution, derive the moments using only its pmf, then its mgf, and then its pgf. For the Poisson distribution, derive the moments using only its mgf. For the negative binomial distribution, derive the moments using only its pmf, and then its pgf. Exercise 2.7. Let \\(N_1\\) and \\(N_2\\) be two independent Poisson random variables with means \\(\\lambda_1\\) and \\(\\lambda_2\\), respectively. Identify the conditional distribution of \\(N_1\\) given \\(N_1+N_2\\). Exercise 2.8. (Non-Uniqueness of the MLE) Consider the following parametric family of densities indexed by the parameter \\(p\\) taking values in \\([0,1]\\): \\[ f_p(x)=p\\cdot\\phi(x+2)+(1-p)\\cdot\\phi(x-2), \\quad x\\in\\mathbb{R}, \\] where \\(\\phi(\\cdot)\\) represents the standard normal density. Show that for all \\(p\\in[0,1]\\), \\(f_p(\\cdot)\\) above is a valid density function. Find an expression in \\(p\\) for the mean and the variance of \\(f_p(\\cdot)\\). Let us consider a sample of size one consisting of \\(x\\). Show that when \\(x\\) equals \\(0\\), the set of maximum likelihood estimates for \\(p\\) equals \\([0,1]\\); also show that the MLE is unique otherwise. Exercise 2.9. Graph the region of the plane corresponding to values of \\((a,b)\\) that give rise to valid \\((a,b,0)\\) distributions. Do the same for \\((a,b,1)\\) distributions. Exercise 2.10. (Computational Complexity) For the \\((a,b,0)\\) class of distributions, count the number of basic mathematical operations (addition, subtraction, multiplication, division) needed to compute the \\(n\\) probabilities \\(p_0\\ldots p_{n-1}\\) using the recurrence relationship. For the negative binomial distribution with non-integer \\(r\\), count the number of such operations. What do you observe? Exercise 2.11. (** **) Using the development of Section 2.3 rigorously show that not only does the recurrence (2.1) tie the binomial, the Poisson and the negative binomial distributions together, but that it also characterizes them. Exercises with a Practical Focus Exercise 2.12. Actuarial Exam Question. You are given: \\(p_k\\) denotes the probability that the number of claims equals \\(k\\) for \\(k=0,1,2,\\ldots\\) \\(\\frac{p_n}{p_m}=\\frac{m!}{n!}, m\\ge 0, n\\ge 0\\) Using the corresponding zero-modified claim count distribution with \\(p_0^M=0.1\\), calculate \\(p_1^M\\). Exercise 2.13. Actuarial Exam Question. During a one-year period, the number of accidents per day was distributed as follows: \\[ \\begin{matrix} \\begin{array}{c|c|c|c|c|c|c} \\hline \\text{No. of Accidents} &amp; 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5\\\\ \\hline \\text{No. of Days} &amp; 209 &amp; 111 &amp; 33 &amp; 7 &amp; 5 &amp; 2\\\\ \\hline \\end{array} \\end{matrix} \\] You use a chi-square test to measure the fit of a Poisson distribution with mean 0.60. The minimum expected number of observations in any group should be 5. The maximum number of groups should be used. Determine the value of the chi-square statistic. A discrete probability distribution has the following properties \\[ \\begin{aligned} \\Pr(N=k) = \\left( \\frac{3k+9}{8k}\\right) \\Pr(N=k-1), \\quad k=1,2,3,\\ldots \\end{aligned} \\] Determine the value of \\(\\Pr(N=3)\\). (Ans: 0.1609) Additional Exercises Here are a set of exercises that guide the viewer through some of the theoretical foundations of Loss Data Analytics. Each tutorial is based on one or more questions from the professional actuarial examinations – typically the Society of Actuaries Exam C. Frequency Distribution Guided Tutorials 2.9 Further Resources and Contributors Appendix Chapter 14 gives a general introduction to maximum likelihood theory regarding estimation of parameters from a parametric family. Appendix Chapter 16 gives more specific examples and expands some of the concepts. Contributors N.D. Shyamalkumar, The University of Iowa, and Krupa Viswanathan, Temple University, are the principal authors of the initial version of this chapter. Email: shyamal-kumar@uiowa.edu for chapter comments and suggested improvements. Chapter reviewers include: Paul Johnson, Hirokazu (Iwahiro) Iwasawa, Rajesh Sahasrabuddhe, Michelle Xia. 2.9.1 TS 2.A. R Code for Plots Code for Figure 2.3: Show R Code likbinm&lt;-function(m){ # binomial likelihood maximized w.r.t. p prod((dbinom(x,m,mean(x)/m))) } liknbinm&lt;-function(r){ # negative binomial likelihood maximized w.r.t. beta prod(dnbinom(x,r,1-mean(x)/(mean(x)+r))) } # Data Matrix; Three Samples, one in each Column; # First Sample has Var&lt;Mean # Second Sample has Var=Mean # Third Sample has Var&gt;Mean X&lt;-cbind(c(2,5,6,8,9)+2,c(2,5,6,8,9),c(2,3,6,8,9)); # Used for creating the labels in the z matrix ord_char&lt;-c(&quot;&lt;&quot;,&quot;=&quot;,&quot;&gt;&quot;); # Empty matrices; Y&lt;-matrix(1,ncol=2,nrow=0); Z&lt;-matrix(1,ncol=2,nrow=0); for (i in (1:3)) { # Work with data in the i-th sample x&lt;-X[,i]; # Binomial Likelihood # Interval of n values covering the MLE n&lt;-(9:100); # Evaluating the Likelihood at various values of n ll&lt;-sapply(n,likbinm); # Finding the MLE of n n[ll==max(ll[!is.na(ll)])] # Storing the data and the labels Y&lt;-rbind(Y,cbind(n,ll)); Z&lt;-rbind(Z,cbind(rep(paste(&quot;$\\\\hat{\\\\sigma}^2&quot;,ord_char[i],&quot;\\\\hat{\\\\mu}$&quot;),length(n)),rep(&quot;Binomial - $L(m,\\\\overline{x}/m)$&quot;,length(n)))); # Negative Binomial Likelihood # Interval of r values r&lt;-(1:100); # Evaluating the Likelihood at various values of r ll&lt;-sapply(r,liknbinm); # Finding the MLE of r ll[is.na(ll)]=0; r[ll==max(ll[!is.na(ll)])]; # Storing the data and the labels Y&lt;-rbind(Y,cbind(r,ll)); Z&lt;-rbind(Z,cbind(rep(paste(&quot;$\\\\hat{\\\\sigma}^2&quot;,ord_char[i],&quot;\\\\hat{\\\\mu}$&quot;),length(r)),rep(&quot;Neg.Binomial - $L(r,\\\\overline{x}/r)$&quot;,length(r)))); # Poisson Likelihood # Storing the data and the labels # In the Poisson case MLE is the sample mean Y&lt;-rbind(Y,cbind(r,rep(prod(dpois(x,mean(x))),length(r)))); Z&lt;-rbind(Z,cbind(rep(paste(&quot;$\\\\hat{\\\\sigma}^2&quot;,ord_char[i],&quot;\\\\hat{\\\\mu}$&quot;),length(r)),rep(&quot;Poisson - $L(\\\\overline{x})$&quot;,length(r)))); } # Assigning Column Names colnames(Y)&lt;-c(&quot;x&quot;,&quot;lik&quot;); colnames(Z)&lt;-c(&quot;dataset&quot;,&quot;Distribution&quot;); # Creating a Dataframe for using ggplot dy&lt;-cbind(data.frame(Y),data.frame(Z)); library(tikzDevice); library(ggplot2); options(tikzMetricPackages = c(&quot;\\\\usepackage[utf8]{inputenc}&quot;,&quot;\\\\usepackage[T1]{fontenc}&quot;, &quot;\\\\usetikzlibrary{calc}&quot;, &quot;\\\\usepackage{amssymb}&quot;,&quot;\\\\usepackage{amsmath}&quot;,&quot;\\\\usepackage[active]{preview}&quot;)) tikz(file = &quot;plot_test_2.tex&quot;, width = 6.25, height = 6.25); ggplot(data=dy,aes(x=x,y=lik,col=Distribution)) + geom_point(size=0.25) + facet_grid(dataset~.)+ labs(x=&quot;m/r&quot;,y=&quot;Likelihood&quot;,title=&quot;&quot;); dev.off(); Code for Figure 2.2: Show R Code likm&lt;-function(m){ prod((dbinom(x,m,mean(x)/m))) } x&lt;-c(2,2,2,4,5); n&lt;-(5:100); # Computing the Likelihood ll&lt;-sapply(n,likm); # Computing the MLE n[ll==max(ll)] # Storing the Likelihood Curve y&lt;-cbind(n,ll); # Second Dataset x&lt;-c(2,2,2,4,6); ll&lt;-sapply(n,likm); n[ll==max(ll)] y&lt;-cbind(y,ll); # Third Dataset x&lt;-c(2,2,2,4,7); ll&lt;-sapply(n,likm); n[ll==max(ll)] y&lt;-cbind(y,ll); colnames(y)&lt;-c(&quot;m&quot;,&quot;$\\\\tilde{x}=(2,2,2,4,5)$&quot;,&quot;$\\\\tilde{x}=(2,2,2,4,6)$&quot;,&quot;$\\\\tilde{x}=(2,2,2,4,7)$&quot;); dy&lt;-data.frame(y); library(tikzDevice); library(ggplot2); options(tikzMetricPackages = c(&quot;\\\\usepackage[utf8]{inputenc}&quot;,&quot;\\\\usepackage[T1]{fontenc}&quot;, &quot;\\\\usetikzlibrary{calc}&quot;, &quot;\\\\usepackage{amssymb}&quot;,&quot;\\\\usepackage{amsmath}&quot;,&quot;\\\\usepackage[active]{preview}&quot;)) tikz(file = &quot;plot_test.tex&quot;, width = 6.25, height = 3.125); ggplot(dy) + geom_point(aes(x=m, y=(X..tilde.x...2.2.2.4.5..),shape=&quot;$\\\\tilde{x}=(2,2,2,4,5):\\\\hat{m}=7$&quot;),size=0.75) + geom_point(aes(x=m, y=(X..tilde.x...2.2.2.4.6..),shape=&quot;$\\\\tilde{x}=(2,2,2,4,6):\\\\hat{m}=18$&quot;),size=0.75) + geom_point(aes(x=m, y=(X..tilde.x...2.2.2.4.7..),shape=&quot;$\\\\tilde{x}=(2,2,2,4,7):\\\\hat{m}=\\\\infty$&quot;),size=0.75) + geom_point(aes(x=c(7),y=dy$X..tilde.x...2.2.2.4.5..[3],colour=&quot;$\\\\hat{m}$&quot;,shape=&quot;$\\\\tilde{x}=(2,2,2,4,5):\\\\hat{m}=7$&quot;),size=0.75)+ geom_point(aes(x=c(18),y=dy$X..tilde.x...2.2.2.4.6..[14],colour=&quot;$\\\\hat{m}$&quot;,shape=&quot;$\\\\tilde{x}=(2,2,2,4,6):\\\\hat{m}=18$&quot;),size=0.75)+ labs(x=&quot;m&quot;,y=&quot;$L(m,\\\\overline{x}/m)$&quot;,title=&quot;MLE for $m$: Non-Robustness of MLE &quot;); dev.off(); Bibliography "],
["C-Severity.html", "Chapter 3 Modelización de la severidad de las pérdidas 3.1 Cantidades distribucionales básicas 3.2 Distribuciones continuas para modelizar la severidad de las pérdidas 3.3 Métodos para crear distribuciones nuevas 3.4 Modificaciones de cobertura 3.5 Estimación por máxima verosimilitud 3.6 Recursos y contribuciones adicionales", " Chapter 3 Modelización de la severidad de las pérdidas Vista previa del capítulo. El enfoque tradicional para la modelización de la distribución de las pérdidas agregadas comienza ajustando por separado una distribución para la frecuencia al número de pérdidas y una distribución para la severidad al tamaño de las pérdidas. La distribución de pérdidas agregades estimada combina la distribución para la frecuencia y la distribución para la severidad de las pérdidas por convolución. En el Capítulo 2 han sido utilizadas distribuciones discretas, frecuentemente referenciades como distribuciones para el recuento o distribuciones para la frecuencia, para describir el número de eventos, como por ejemplo el número de accidentes del conductor o número de siniestros del asegurado. Tiempos de vida, valores de activos, pérdidas y tamaños de siniestros son frecuentemente modelizados como variables aleatorias continuas y como tales son modelizadas usando distribuciones continuas, frecuentemente referenciades como distribuciones de perdidas o de severidad. Una distribución mixta es una combinación ponderada de distribuciones más simples que es usada para modelitzar un fenómeno investigado en una población heterogénea, como modelitzar más de un tipo de siniestro en el seguro de responsabilidad civil (siniestros pequeños pero frecuentes y siniestros grandes pero relativamente raros). En este capítulo se explora el uso de distribuciones continuas y mixtas para modelitzar el tamaño aleatorio de las pérdidas. Se presentan atributos clave que caracterizan modelos continuos y que además son un medio para crear nuevas distribuciones a partir de otras existentes. También se explora el efecto de modificaciones de cobertura, que cambian las condiciones que desencadenan el pago, como por ejemplo la aplicación de franquicias, límites, o ajustes por inflación, a la distribución de las cantidades de pérdidas individuales. Las distribuciones de frecuencias del Capítulo ?? seran combinadas con las ideas de este capítulo para describir las pérdidas agregadas del conjunto de la cartera en el Capítulo 5. 3.1 Cantidades distribucionales básicas En esta sección, se muestra la definición de algunas cantidades distribucionales básicas: momentos, percentiles, y funciones generadoras. 3.1.1 Momentos Sea \\(X\\) una variable aleatoria continua con función de densidad de probabilidad \\(f_{X}\\left( x \\right)\\). El k-ésimo momento ordinario de \\(X\\), denotado como \\(\\mu_{k}^{\\prime}\\), es el valor esperado de la k-esima potencia de \\(X\\), siempre que esta exista. El primer momento ordinario \\(\\mu_{1}^{\\prime}\\) es la media de \\(X\\) frecuentemente denotada como \\(\\mu\\). La fórmula para \\(\\mu_{k}^{\\prime}\\) viene dada por \\[ \\mu_{k}^{\\prime} = \\mathrm{E}\\left( X^{k} \\right) = \\int_{0}^{\\infty}{x^{k}f_{X}\\left( x \\right)dx } . \\] El soporte de la variable aleatoria \\(X\\) se asume que es no negativo dado que los fenómenos actuariales son raramente negativos. Una simple integración por partes demuestra que los momentos ordinarios para variables no negativas pueden también calcularse usando \\[ \\mu_{k}^{\\prime} = \\int_{0}^{\\infty}{k~x^{k-1}\\left[1- F_{X}(x) \\right]dx }, \\] que está basado en la función de supervivencia, denotada como \\(S_X(x) = 1-F_{X}(x)\\). Esta fórmula es particularment útil cuando \\(k=1\\). El k-ésimo momento central de \\(X\\), denotado como \\(\\mu_{k}\\), es el valor esperado de la potencia k-ésima de la desviación de \\(X\\) respecto de su media \\(\\mu\\). La fórmula para \\(\\mu_{k}\\) viene dada por \\[ \\mu_{k} = \\mathrm{E}\\left\\lbrack {(X - \\mu)}^{k} \\right\\rbrack = \\int_{0}^{\\infty}{\\left( x - \\mu \\right)^{k}f_{X}\\left( x \\right) dx }. \\] El segundo momento central \\(\\mu_{2}\\) define la varianza de \\(X\\), denotada por \\(\\sigma^{2}\\). La raíz cuadrada de la varianza es la desviación estándar \\(\\sigma\\). Desde una perspectiva clásica, otras caracterizaciones de la forma de una distribución incluyen su grado de simetria así como su apuntamiento en comparación con la distribución normal. La ratio del tercer momento central sobre el cubo de la desviación estándar \\(\\left( \\mu_{3} / \\sigma^{3} \\right)\\) define el coeficiente de asimetría que es una medida de simetría. Un coeficiente positivo de asimetria indica que la distribución es asimétrica por la derecha (asimetria positiva). La ratio del cuarto momento central sobre la cuarta potencia de la desviación estándar \\(\\left(\\mu_{4} / \\sigma^{4} \\right)\\) define el coeficiente de curtosis. La distribución normal tiene un coeficiente de curtosis de 3. Una distribución con un coeficiente de curtosis mayor que 3 tiene colas más pesadas y un mayor pico que la normal, mientras que distribuciones con un coeficiente de curtosis menor que 3 tienen colas más ligeras y son más planas. En la Sección 10.2 se describen las colas de las distribuciones desde una perspectiva actuarial y aseguradora. Ejemplo 3.1.1. Pregunta de un examen actuarial. Asumimos que la v.a. \\(X\\) tiene una distribución gamma con media 8 y asimetría 1. Determina la varianza de \\(X\\). (Hint: La distribución gamma es tratada en la Sección 3.2.1.) Mostrar Ejemplo de Solución Solución. La función de densidad de probabilidad de \\(X\\) viene dada por \\[ f_{X}\\left( x \\right) = \\frac{\\left( x / \\theta \\right)^{\\alpha}}{x ~\\Gamma\\left( \\alpha \\right)} e^{- x / \\theta} \\] para \\(x &gt; 0\\). Para \\(\\alpha&gt;0\\), el k-ésimo momento ordinário es \\[ \\mu_{k}^{\\prime} = \\mathrm{E}\\left( X^{k} \\right) = \\int_{0}^{\\infty}{\\frac{1}{\\Gamma\\left( \\alpha \\right)\\theta^{\\alpha}}x^{k + \\alpha - 1}e^{- x / \\theta} dx} = \\frac{\\Gamma\\left( k + \\alpha \\right)}{\\Gamma\\left( \\alpha \\right)}\\theta^{k} \\] Dado que \\(\\Gamma\\left( r + 1 \\right) = r\\Gamma\\left( r \\right)\\) y \\(\\Gamma\\left( 1 \\right) = 1\\), then \\(\\mu_{1}^{\\prime} = \\mathrm{E}\\left( X \\right) = \\alpha\\theta\\), \\(\\mu_{2}^{\\prime} = \\mathrm{E}\\left( X^{2} \\right) = \\left( \\alpha + 1 \\right)\\alpha\\theta^{2}\\), \\(\\mu_{3}^{\\prime} = \\mathrm{E}\\left( X^{3} \\right) = \\left( \\alpha + 2 \\right)\\left( \\alpha + 1 \\right)\\alpha\\theta^{3}\\), y \\(\\mathrm{Var}\\left( X \\right) = (\\alpha + 1)\\alpha\\theta^2 - (\\alpha\\theta)^2 = \\alpha\\theta^{2}\\). \\[ \\text{Skewness} = \\frac{\\mathrm{E}\\left\\lbrack {(X - \\mu_{1}^{\\prime})}^{3} \\right\\rbrack}{{\\mathrm{Var}\\left( X \\right)}^{3/2}} = \\frac{\\mu_{3}^{\\prime} - 3\\mu_{2}^{\\prime}\\mu_{1}^{\\prime} + 2{\\mu_{1}^{\\prime}}^{3}}{{\\mathrm{Var}\\left( X \\right)}^{3/2}} \\\\ = \\frac{\\left( \\alpha + 2 \\right)\\left( \\alpha + 1 \\right)\\alpha\\theta^{3} - 3\\left( \\alpha + 1 \\right)\\alpha^{2}\\theta^{3} + 2\\alpha^{3}\\theta^{3}}{\\left( \\alpha\\theta^{2} \\right)^{3/2}} = \\frac{2}{\\alpha^{1/2}} = 1. \\] Por lo tanto, \\(\\alpha = 4\\). Dado que \\(\\mathrm{E}\\left( X \\right) = \\alpha\\theta = 8\\), entonces \\(\\theta = 2\\) y finalmente, \\(\\mathrm{Var}\\left( X \\right) = \\alpha\\theta^{2} = 16\\). 3.1.2 Cuantiles Los cuantiles también pueden ser usados para describir las características de la distribución de \\(X\\). Cuando la distribución de \\(X\\) es continua, para una fracción concreta \\(0 \\leq p \\leq 1\\) el correspondiente cuantil es la solución a la ecuación \\[ F_{X}\\left( \\pi_{p} \\right) = p . \\] Por ejemplo, el punto medio de una distribución, \\(\\pi_{0.5}\\), es la mediana. Un percentil es un tipo de cuantil; un \\(100p\\) percentil es el número tal que \\(100 \\times p\\) porciento de los datos están por debajo de él. Ejemplo 3.1.1. Pregunta de un examen actuarial. Sea \\(X\\) una variable aleatoria continua con función de densidad \\(f_{X}\\left( x \\right) = \\theta e^{- \\theta x}\\), para \\(x &gt; 0\\) y 0 en caso contrario. Si la mediana de la distribución es \\(\\frac{1}{3}\\), encuentra \\(\\theta\\). Mostrar Ejemplo de Solución Solución. La función de distribución es \\(F_{X}\\left( x \\right) = 1 - e^{- \\theta x}\\). Por tanto, \\(F_{X}\\left( \\pi_{0,5} \\right) = 1 - e^{- \\theta\\pi_{0.5}} = 0.5\\). Como \\(\\pi_{0,5} = \\frac{1}{3}\\), tenemos que \\(F_X\\left(\\frac{1}{3}\\right) = 1 - e^{-\\theta / 3} = 0,5\\) y \\(\\theta = 3 \\ln 2\\). En la Sección 4.1.1.3 se extiende la definición de cuantil para incluir las distribuciones que son discretas, continuas, o una combiación híbrida. 3.1.3 Función generatriz de momentos La función generatriz de momentos, denotada por \\(M_{X}(t)\\) caracteriza unícovamente la distribución de \\(X\\). Mientras que es posible que dos distribuciones diferentes tengan los mismos momentos y sigan siendo diferentes, esto no ocurre con la función generatriz de momentos. Es decir, si dos variables aleatorias tienen la misma función generatriz de momentos, entonces tienen la misma distribución. La función generatriz de momentos viene dada por \\[ M_{X}(t) = \\mathrm{E}\\left( e^{tX} \\right) = \\int_{0}^{\\infty}{e^{\\text{tx}}f_{X}\\left( x \\right) dx } \\] para todo \\(t\\) para el que exista el valor esperado. La función generatriz de momentos es una función real para la que la k-ésima derivada en cero es igual al k-ésimo momento ordinario de \\(X\\). En símbolos, esto es \\[ \\left.\\frac{d^k}{dt^k} M_{X}(t)\\right|_{t=0} = \\mathrm{E}\\left( X^{k} \\right) . \\] Ejemplo 3.1.3. Pregunta de un examen actuarial. La variable aleatoria \\(X\\) tiene una distribución exponencial con media \\(\\frac{1}{b}\\). Se determina que \\(M_{X}\\left( - b^{2} \\right) = 0,2\\). Encuentra \\(b\\). (Hint: La exponencial es un caso especial de la distribución gamma que es tratada en la Sección 3.2.1.) Mostrar Ejemplo de Solución Solución. Dado que \\(X\\) sigue una distribución exponencial con media \\(\\frac{1}{b}\\), tenemos que \\[ M_{X}(t) = \\mathrm{E}\\left( e^{tX} \\right) = \\int_{0}^{\\infty}{e^{\\text{tx}}be^{- bx} dx} = \\int_{0}^{\\infty}{be^{- x\\left( b - t \\right)} dx} = \\frac{b}{\\left( b - t \\right)}. \\] Entonces, \\[ M_{X}\\left( - b^{2} \\right) = \\frac{b}{\\left( b + b^{2} \\right)} = \\frac{1}{\\left( 1 + b \\right)} = 0,2. \\] Por tanto, \\(b = 4\\). Ejemplo 3.1.4. Pregunta de examen actuarial. Sea \\(X_{1}, \\ldots, X_{n}\\) variables aleatorias independientes, donde \\(X_i\\) sigue una distribución gamma con parámetros \\(\\alpha_{i}\\) y \\(\\theta\\). Encuentra la distribución de \\(S = \\sum_{i = 1}^{n}X_{i}\\), la media \\(\\mathrm{E}(S)\\) y la varianza \\(\\mathrm{Var}(S)\\). Mostrar Ejemplo de Solución Solución. La función generatriz de momentos de \\(S\\) es \\[ M_{S}(t) = \\text{E}\\left( e^{\\text{tS}} \\right) = \\mathrm{E}\\left( e^{t\\sum_{i = 1}^{n}X_{i}} \\right) = \\mathrm{E}\\left( \\prod_{i = 1}^{n}e^{tX_{i}} \\right) . \\] Teniendo en cuenta que son independientes, obtenemos \\[ M_{S}(t) = \\prod_{i = 1}^{n}{\\mathrm{E}\\left( e^{tX_{i}} \\right) = \\prod_{i = 1}^{n}{M_{X_{i}}(t)}} . \\] La función generatriz de momentos de una distribución gamma \\(X_i\\) es \\(M_{X_i}(t) = (1-\\theta)^{\\alpha_i}\\). . Entonces, \\[ M_{S}(t) = \\prod_{i = 1}^{n}\\left( 1 - \\theta t \\right)^{- \\alpha_{i}} = \\left( 1 - \\theta t \\right)^{- \\sum_{i = 1}^{n}\\alpha_{i}} . \\] Esto indica que la distribución de \\(S\\) es gamma con parámetros \\(\\sum_{i = 1}^{n}\\alpha_{i}\\) y \\(\\theta\\). Esta es una demostración de cómo puede usarse la propiedad de unicidad de la función generatriz de momentos para determinar la distribución de probabilidad de una variable aleatoria. Podemos encontrar la media y varianza a partir de las propiedades de la distribución gamma. Alternativamente, determinando la primera y segunda derivadas de \\(M_{S}(t)\\) en cero, se demuestra que \\(\\mathrm{E}\\left( S \\right) = \\left. \\ \\frac{\\partial M_{S}(t)}{\\partial t} \\right|_{t = 0} = \\alpha\\theta\\) donde \\(\\alpha = \\sum_{i = 1}^{n}\\alpha_{i}\\), y \\[ \\mathrm{E}\\left( S^{2} \\right) = \\left. \\ \\frac{\\partial^{2}M_{S}(t)}{\\partial t^{2}} \\right|_{t = 0} = \\left( \\alpha + 1 \\right)\\alpha\\theta^{2}. \\] Por lo tanto, \\(\\mathrm{Var}\\left( S \\right) = \\alpha\\theta^{2}\\). También se puede usar la función generatriz de momentos para calcular la función generatriz de probabilidad \\[ P_{X}(z) = \\mathrm{E}\\left( z^{X} \\right) = M_{X}\\left( \\ln z \\right) . \\] Tal y como se introdujo en la Sección 2.2.2, la función generatriz de probabilidad es más útil para v.a.s discretas. 3.2 Distribuciones continuas para modelizar la severidad de las pérdidas En esta sección, se presentará la definición y aplicación de cuatro distribuciones fundamentales para la severidad: gamma, Pareto, Weibull, y distribución beta generalitzada de segundo tipo. 3.2.1 Distribución gamma El enfoque tradicional para la modelización de las pérdidas consiste en ajustar de forma separada modelos para la frecuencia y la severidad. Cuando la frecuencia y la severidad se modelizan por separado es común para los actuarios usar la distribución de Poisson (introducida en la Sección 2.2.3.2) para la frecuencia de siniestros y la distribucíon gamma para la severidad. Un enfoque alternativo para modelitzar las pérdidas que ha ganado popularidad recientemente es crear un único modelo para la prima pura (coste medio de los siniestros) que será descrito en el Capítulo Chapter 4. Se dice que la variable continua \\(X\\) tiene una distribución gamma con parámetro de forma \\(\\alpha\\) y parámetro de escala \\(\\theta\\) si su función de densidad de probabilidad viene dada por \\[ f_{X}\\left( x \\right) = \\frac{\\left( x/ \\theta \\right)^{\\alpha}}{x~ \\Gamma\\left( \\alpha \\right)}\\exp \\left( -x/ \\theta \\right) \\ \\ \\ \\text{for } x &gt; 0 . \\] Nótese que \\(\\alpha &gt; 0,\\ \\theta &gt; 0\\). Los dos paneles de la Figura 3.1 muestran los efectos de los parámetros de escala y forma en la función de densidad de la gamma. Figure 3.1: Densidades Gamma. El panel de la izquierda corresponde a forma=2 y un parámetro de escala variable. El panel de la derecha corresponde a escala=100 y parámetro de forma variable. Código R para gráficos de densidad gamma par(mfrow=c(1, 2), mar = c(4, 4, .1, .1)) # Densidades gamma con escala variable scaleparam &lt;- seq(100, 250, by = 50) shapeparam &lt;- 2:5 x &lt;- seq(0, 1000, by = 1) fgamma &lt;- dgamma(x, shape = 2, scale = scaleparam[1]) plot(x, fgamma, type = &quot;l&quot;, ylab = &quot;Densidad gamma&quot;) for(k in 2:length(scaleparam)){ fgamma &lt;- dgamma(x,shape = 2, scale = scaleparam[k]) lines(x,fgamma, col = k) } legend(&quot;topright&quot;, c(&quot;scale=100&quot;, &quot;scale=150&quot;, &quot;scale=200&quot;, &quot;scale=250&quot;), lty=1, col = 1:4) # Densidades gamma con forma variable fgamma &lt;- dgamma(x, shape = shapeparam[1], scale = 100) plot(x, fgamma, type = &quot;l&quot;, ylab = &quot;Densidad gamma&quot;) for(k in 2:length(shapeparam)){ fgamma &lt;- dgamma(x,shape = shapeparam[k], scale = 100) lines(x,fgamma, col = k) } legend(&quot;topright&quot;, c(&quot;shape=2&quot;, &quot;shape=3&quot;, &quot;shape=4&quot;, &quot;shape=5&quot;), lty=1, col = 1:4) Cuando \\(\\alpha = 1\\) la gamma se reduce a una distribución exponencial y cuando \\(\\alpha = \\frac{n}{2}\\) y \\(\\theta = 2\\) la gamma se reduce a una distribucióin chi-cuadrado con \\(n\\) grados de libertad. Tal y como veremos en la Sección 14.4, la distribución chi-cuadrado es ampliamente utilitzada en el contraste estadístico de hipótesis. La función de distribución de un modelo gamma es la función incompleta gamma, denotada por \\(\\Gamma\\left(\\alpha; \\frac{x}{\\theta} \\right)\\), y definida como \\[ F_{X}\\left( x \\right) = \\Gamma\\left( \\alpha; \\frac{x}{\\theta} \\right) = \\frac{1}{\\Gamma\\left( \\alpha \\right)}\\int_{0}^{x /\\theta}t^{\\alpha - 1}e^{- t}~dt \\] \\(\\alpha &gt; 0,\\ \\theta &gt; 0\\). Para un entero \\(\\alpha\\), puede expresarse como \\(\\Gamma\\left( \\alpha; \\frac{x}{\\theta} \\right) = 1 - e^{-x/\\theta}\\sum_{k = 0}^{\\alpha-1}\\frac{(x/\\theta)^k}{k!}\\). El momento \\(k\\)-ésimo de una variable aleatoria con distribución gamma para cualquier \\(k\\) positivo viene dada por \\[ \\mathrm{E}\\left( X^{k} \\right) = \\theta^{k} \\frac{\\Gamma\\left( \\alpha + k \\right)}{\\Gamma\\left( \\alpha \\right)} . \\] La media y varianza vienen dadas por \\(\\mathrm{E}\\left( X \\right) = \\alpha\\theta\\) y \\(\\mathrm{Var}\\left( X \\right) = \\alpha\\theta^{2}\\), respectivamente. Dado que todos los momentos existen para cualquier \\(k\\) positivo, la distribución gamma se considera una distribución de cola ligera, que puede no ser adecuada para modelitzar activos con riesgo dado que no proporciona una valoración realista de la versimilitud de pérdidas severas. 3.2.2 Distribución Pareto La distribución Pareto, denominada así por el economista italiano Vilfredo Pareto (1843-1923), tiene muchas aplicacions económicas y financieras. Es una distribución con asimetria positiva y con cola pesada que la hace adecuada para modelitzar ingresos, siniestros en seguros con alto riesgo y la severidad de grandes pérdidas en seguros. La función de supervivencia de una distribución de Pareto que decrece lentamente a cero fue por primera vez utilizada para describir la distribución de ingresos en los que un pequeño porcentaje de la población tiene una gran proporción de la riqueza total. Para siniestros extermos en seguros, la cola de la distribución de la severidad (pérdidas por encima de un determinado umbral) pueden modelizarse usando una distribución Pareto Generalizada. Se dice que la variable continua \\(X\\) tiene una distribución de Pareto con parámetro de forma \\(\\alpha\\) y parámetro de escala \\(\\theta\\) si su pdf viene dada por \\[ f_{X}\\left( x \\right) = \\frac{\\alpha\\theta^{\\alpha}}{\\left( x + \\theta \\right)^{\\alpha + 1}} \\ \\ \\ x &gt; 0,\\ \\alpha &gt; 0,\\ \\theta &gt; 0. \\] Los dos paneles de la Figura 3.2 muestran los efectos de los parámetros de escala y forma en la función de densidad Pareto. Figure 3.2: Densidades Pareto. El panel de la izquierda corresponde a escala=2000 y forma variable. El panel de la derecha corresponde a forma=3 y escala variable Código R para los gráficos de la densidad Pareto library(VGAM) par(mfrow=c(1, 2), mar = c(4, 4, .1, .1)) # Densidades Pareto con forma variable x &lt;- seq(1, 3000, by = 1) scaleparam &lt;- seq(2000, 3500, 500) shapeparam &lt;- 1:4 # variando el parámetro de forma plot(x, dparetoII(x, loc=0, shape = shapeparam[1], scale = 2000), ylim=c(0,0.002),type = &quot;l&quot;, ylab = &quot;Pareto density&quot;) for(k in 2:length(shapeparam)){ lines(x, dparetoII(x, loc=0, shape = shapeparam[k], scale = 2000), col = k) } legend(&quot;topright&quot;, c(expression(alpha~&#39;=1&#39;), expression(alpha~&#39;=2&#39;), expression(alpha~&#39;=3&#39;), expression(alpha~&#39;=4&#39;)), lty=1, col = 1:4) # Densidades de Pareto con escala variable plot(x, dparetoII(x, loc=0, shape = 3, scale = scaleparam[1]), type = &quot;l&quot;, ylab = &quot;Pareto density&quot;) for(k in 2:length(scaleparam)){ lines(x, dparetoII(x, loc=0, shape = 3, scale = scaleparam[k]), col = k) } legend(&quot;topright&quot;, c(expression(theta~&#39;=2000&#39;), expression(theta~&#39;=2500&#39;), expression(theta~&#39;=3000&#39;), expression(theta~&#39;=3500&#39;)), lty=1, col = 1:4) La función de distribución de una Pareto viene dada por \\[ F_{X}\\left( x \\right) = 1 - \\left( \\frac{\\theta}{x + \\theta} \\right)^{\\alpha} \\ \\ \\ x &gt; 0,\\ \\alpha &gt; 0,\\ \\theta &gt; 0. \\] Se puede ver fácilmente que la función de riesgo de la distribución de Pareto es una función decreciente en \\(x\\), otro indicador de que es una distribución de cola pesada. Cuando la función de riesgo decrece con el tiempo la población fallece a una tasa decreciente dando como resultado una cola más pesada para la distribución. La función de riesgo revela información sobre la distribución de la cola y es frecuentemente usada para modelizar distribuciones en análisis de la supervivencia. La función de riesgo se define como la posibilidad instantánea de que el evento de interés ocurra dentro de un marco temporal muy pequeño. El momento \\(k\\)-ésimo de una variable aleatoria con una distribución de Pareto existe si y solo si \\(\\alpha &gt; k\\). Si \\(k\\) es un entero positivo entonces \\[ \\mathrm{E}\\left( X^{k} \\right) = \\frac{\\theta^{k}~ k!}{\\left( \\alpha - 1 \\right)\\cdots\\left( \\alpha - k \\right)} \\ \\ \\ \\alpha &gt; k. \\] La media y varianza vienen dadas por \\[\\mathrm{E}\\left( X \\right) = \\frac{\\theta}{\\alpha - 1} \\ \\ \\ \\text{for } \\alpha &gt; 1\\] y \\[\\mathrm{Var}\\left( X \\right) = \\frac{\\alpha\\theta^{2}}{\\left( \\alpha - 1 \\right)^{2}\\left( \\alpha - 2 \\right)} \\ \\ \\ \\text{for } \\alpha &gt; 2,\\]respectivamente. Ejemplo 3.2.1. El tamaño de los siniestros en una cartera de asegurados sigue una distribución de Pareto con media y varianza iguales a 40 y 1800 respectivamente. Encuentra Los parámetros de forma y escala. El percentil 95 de la distribución. Mostrar Ejemplo de Solución Solución. a. Dado que \\(X\\sim Pa(\\alpha,\\theta)\\), se tiene que \\(\\mathrm{E}\\left( X \\right) = \\frac{\\theta}{\\alpha - 1} = 40\\) y \\(\\mathrm{Var}\\left( X \\right) = \\frac{\\alpha\\theta^{2}}{\\left( \\alpha - 1 \\right)^{2}\\left( \\alpha - 2 \\right)} = 1800\\). Dividiendo el cuadrado de la primera ecuación por la segunda obtenemos \\(\\frac{\\alpha - 2}{\\alpha} = \\frac{40^{2}}{1800}\\). Por tanto, \\(\\alpha = 18,02\\) y \\(\\theta = 680,72\\). b. El percentil 95, \\(\\pi_{0,95}\\), satisface la ecuación \\[ F_{X}\\left( \\pi_{0,95} \\right) = 1 - \\left( \\frac{680,72}{\\pi_{0,95} + 680,72} \\right)^{18,02} = 0,95. \\] Por tanto, \\(\\pi_{0,95} = 122,96\\). 3.2.3 Distribución Weibull La distribución Weibull, denominada así por el físico sueco Waloddi Weibull (1887-1979) es ampliamente utilizada en fiabilidad, análisis de tiempos de vida, predicciones del tiempo y siniestros en seguros generales. Datos truncados aparecen frecuentemente en estudios de seguros. La distribución Weibull ha sido utilizada para modelizar el acuerdo de exceso de pérdida en el seguro del automóvil así como el tiempo entre la llegada de dos terremotos. Se dice que la variable continua \\(X\\) sigue una distribución Weibull con parámetro de forma \\(\\alpha\\) y parámetro de escala \\(\\theta\\) si su función de densidad de probabilidad viene dada por \\[ f_{X}\\left( x \\right) = \\frac{\\alpha}{\\theta}\\left( \\frac{x}{\\theta} \\right)^{\\alpha - 1} \\exp \\left(- \\left( \\frac{x}{\\theta} \\right)^{\\alpha}\\right) \\ \\ \\ x &gt; 0,\\ \\alpha &gt; 0,\\ \\theta &gt; 0. \\] Los dos paneles de la Figura 3.3 muestran los efectos de los parámetros de escala y forma de la función de densidad de una Weibull. Figure 3.3: Densidades Weibull. El panel de la izquierda corresponde a forma=3 y escala variable. El panel de la derecha corresponde a escala=100 y forma variable. Código R para los gráficos de la densidad Weibull par(mfrow=c(1, 2), mar = c(4, 4, .1, .1)) # Densidad Weibull con escala variable z&lt;- seq(0,400,by=1) scaleparam &lt;- seq(50,200,50) shapeparam &lt;- seq(1.5,3,0.5) plot(z, dweibull(z, shape = 3, scale = scaleparam[1]), type = &quot;l&quot;, ylab = &quot;Densidad Weibull&quot;) for(k in 2:length(scaleparam)){ lines(z,dweibull(z,shape = 3, scale = scaleparam[k]), col = k)} legend(&quot;topright&quot;, c(&quot;scale=50&quot;, &quot;scale=100&quot;, &quot;scale=150&quot;, &quot;scale=200&quot;), lty=1, col = 1:4) # Densidad Weibull con forma variable plot(z, dweibull(z, shape = shapeparam[1], scale = 100), ylim=c(0,0.012), type = &quot;l&quot;, ylab = &quot;Densidad Weibull &quot;) for(k in 2:length(shapeparam)){ lines(z,dweibull(z,shape = shapeparam[k], scale = 100), col = k)} legend(&quot;topright&quot;, c(&quot;shape=1.5&quot;, &quot;shape=2&quot;, &quot;shape=2.5&quot;, &quot;shape=3&quot;), lty=1, col = 1:4) La función de distribución de una Weibull viene dada por \\[ F_{X}\\left( x \\right) = 1 - e^{- \\left( x / \\theta \\right)^{\\alpha}} \\ \\ \\ x &gt; 0,\\ \\alpha &gt; 0,\\ \\theta &gt; 0. \\] Se puede ver fácilmente que el parámetro de forma \\(\\alpha\\) describe la forma de la función de riesgo de una distribución Weibull. La función de riesgo es una función decreciente cuando \\(\\alpha &lt; 1\\) (distribución de cola pesada), constante cuando \\(\\alpha = 1\\) y creciente cuando \\(\\alpha &gt; 1\\) (distribución de cola ligera). Este comportamiento de la función de riesgo hace que la distribución de Weibull sea adecuada para una gran variedad de fenómenos como la predicción del tiempo, ingeniería eléctrica e industrial, modelización actuarial y análisis del riesgo financiero. El momento \\(k\\)-ésimo de una variable aleatoria con distribución Weibull viene dado por \\[ \\mathrm{E}\\left( X^{k} \\right) = \\theta^{k}~\\Gamma\\left( 1 + \\frac{k}{\\alpha} \\right) . \\] La media y la varianza vienen dades por \\[ \\mathrm{E}\\left( X \\right) = \\theta~\\Gamma\\left( 1 + \\frac{1}{\\alpha} \\right) \\] y \\[ \\mathrm{Var}(X)= \\theta^{2}\\left( \\Gamma\\left( 1 + \\frac{2}{\\alpha} \\right) - \\left\\lbrack \\Gamma\\left( 1 + \\frac{1}{\\alpha} \\right) \\right\\rbrack ^{2}\\right), \\] respectivamente. Ejemplo 3.2.2. Se asume que la distribución de probabilidad del tiempo de vida de pacientes con SIDA (en meses) desde el momento del diagnóstico sigue una distribución de Weibull con parámetro de forma 1,2 y parámetro de escala 33,33. Determina la probabilidad de que una persona de esta población elegida al azar sobreviva al menos 12 meses, Se selecciona una muestra de 10 pacientes de esta población. Cuál es la probabilidad de que como máximo dos mueran al cabo de un año del diagnóstico. Encuentra el percentil 99 de la distribución de los tiempos de vida. Mostrar Ejemplo de Solución Solución. a. Sea \\(X\\) el tiempo de vida de los pacientes con SIDA (en meses) con distribución Weibull de parámetros \\(\\left(1,2,\\ 33,33 \\right)\\). Tenemos, \\[ \\Pr \\left( X \\geq 12 \\right) = S_{X} \\left( 12 \\right) = e^{- \\left( \\frac{12}{33,33} \\right)^{1,2}} = 0,746. \\] b. Sea \\(Y\\) el número de pacientes que mueren al cabo de un año del diagnóstico. Entonces, \\(Y\\sim Bin\\left( 10,\\ 0,254 \\right)\\) y \\(\\Pr\\left( Y \\leq 2 \\right) = 0,514.\\) c. Sea \\(\\pi_{0,99}\\) el percentil 99 de esta distribución. Entonces, \\[ S_{X}\\left( \\pi_{0,99} \\right) = \\exp\\left\\{- \\left( \\frac{\\pi_{0,99}}{33,33} \\right)^{1,2}\\right\\} = 0,01. \\] Resolviendo para \\(\\pi_{0,99}\\), obtenemos \\(\\pi_{0,99} = 118,99\\). 3.2.4 Distribución Beta Generalizada de segundo tipo La Distribución Beta Generalizada de segundo tipo (GB2) fue introducida por Venter (1983) en el contexto de la modelización de las pérdidas en seguros y por McDonald (1984) como una distribución para los ingresos y la riqueza. Es una distribución de cuatro parámetros muy flexible que puede modelizar distribuciones con asimetria tanto positiva como negativa. Se dice que la variable \\(X\\) tiene una distribución GB2 con parámetros \\(\\sigma\\), \\(\\theta\\), \\(\\alpha_1\\) y \\(\\alpha_2\\) si su función de densidad de probabilidad viene dada por \\[\\begin{equation} f_{X}\\left( x \\right) = \\frac{(x/\\theta)^{\\alpha_2/\\sigma}}{x \\sigma~\\mathrm{B}\\left( \\alpha_1,\\alpha_2\\right)\\left\\lbrack 1 + \\left( x/\\theta \\right)^{1/\\sigma} \\right\\rbrack^{\\alpha_1 + \\alpha_2}} \\ \\ \\ \\text{for } x &gt; 0, \\tag{3.1} \\end{equation}\\] \\(\\sigma,\\theta,\\alpha_1,\\alpha_2 &gt; 0\\), y donde la función beta es \\(\\mathrm{B}\\left( \\alpha_1,\\alpha_2 \\right)\\) definida como \\[ \\mathrm{B}\\left( \\alpha_1,\\alpha_2\\right) = \\int_{0}^{1}{t^{\\alpha_1 - 1}\\left( 1 - t \\right)^{\\alpha_2 - 1}}~ dt. \\] La GB2 proporciona una modelo para datos con cola pesada así como ligera. Incluye a las distribuciones exponencial, gamma, Weibull, Burr, Lomax, F, chi-cuadrado, Rayleigh, lognormal y log-logistic como casos especiales o límite. Por ejemplo, estableciendo estos valores para los parámetros \\(\\sigma = \\alpha_1 = \\alpha_2 = 1\\), la GB2 se reduce a la distribución log-logistic. Cuando \\(\\sigma = 1\\) y \\(\\alpha_2 \\rightarrow \\infty\\), se reduce a la distribución gamma y cuando \\(\\alpha = 1\\) y \\(\\alpha_2 \\rightarrow \\infty\\), se reduce a la distribución Weibull. Una variable aleatoria GB2 puede ser definida como sigue. Se asume que \\(G_1\\) y \\(G_2\\) son variables aleatorias independientes donde \\(G_i\\) tiene una distribución gamma con parámetros \\(\\alpha_i\\) y parámetro de escala igual a 1. Entonces, puede demostrarse que la variable aleatoria \\(X = \\theta \\left(\\frac{G_1}{G_2}\\right)^{\\sigma}\\) sigue una distribución GB2 con pdf resumida en la ecuación (3.1). Este resultado teórico tiene diverses implicaciones. Por ejemplo, cuando los momentos existen, puede demostrarse que el momento \\(k\\)-ésimo de la variable aleatoria con distribución GB2 viene dado por \\[ \\mathrm{E}\\left( X^{k} \\right) = \\frac{\\theta^{k}~\\mathrm{B}\\left( \\alpha_1 +k \\sigma,\\alpha_2 - k \\sigma \\right)}{\\mathrm{B}\\left( \\alpha_1,\\alpha_2 \\right)}, \\ \\ \\ k &gt; 0. \\] Anteriormente la GB2 también había sido aplicada a datos de ingresos y más recientemente ha sido utilitzada para modelitzar datos de siniestros de cola larga (en la Sección 10.2 se describen diferentes interpretaciones del concepto “cola larga”). GB2 fue usada para modelizar diferentes tipos de siniestros en el seguro del automóvil, severidad de las pérdidas causades por el fuego así como datos de sinietros en seguros médicos. 3.3 Métodos para crear distribuciones nuevas En esta sección se mostrara como: Entender las conexiones entre distribuciones Proporcionar ideas sobre cuando una distribución es preferible en comparación con otras alternativas Proporcionar los fundamentos para la creación de nuevas distribuciones 3.3.1 Funciones de variables aleatorias y sus distribuciones En la Sección 3.2 se han descrito algunas distribuciones fundamentales conocidas. En esta sección se describe la forma de crear nuevas distribuciones de probabilidad paramétricas a partir de otras existentes. Concretamente, sea \\(X\\) una variable aleatoria continua con función de densidad de probabilidad conocida \\(f_{X}(x)\\) y función de distribución \\(F_{X}(x)\\). Se desea conocer la distribución de \\(Y = g\\left( X \\right)\\), donde \\(g(X)\\) es una transformación uno-a-uno que define una nueva variable aleatoria \\(Y\\). Es esta sección se aplica las siguientes técnicas para crear nuevas familias de distribuciones: (a) multiplicación por una constante (b) elevación a una potencia, (c) exponenciación y (d) mixtura. 3.3.2 Multiplicación por una constante Si los datos de siniestros muestran cambios a lo largo del tiempo entonces esta transformación puede ser útil para ajustar el efecto de la inflación. Si el nivel de la inflación es positivo entonces los costes de los siniestros están aumentando, y si es negativo los costes están decreciendo. Para realizar el ajuste por inflación multiplicamos el coste \\(X\\) por 1+ tasa de inflación (inflación negativa es deflacción). Para tener en cuenta el impacto de los tipos de cambio en los costes de los siniestros también usamos una transformación para aplicar la conversión de una moneda base a otra. Se considera la transformación \\(Y = cX\\), donde \\(c &gt; 0\\), entonces, la función de distribución de \\(Y\\) viene dada por \\[ F_{Y}\\left( y \\right) = \\Pr\\left( Y \\leq y \\right) = \\Pr\\left( cX \\leq y \\right) = \\Pr\\left( X \\leq \\frac{y}{c} \\right) = F_{X}\\left( \\frac{y}{c} \\right). \\] Por lo tanto, la función de densidad de probabilidad que se desea determinar \\(f_{Y}(y)\\) puede expresarse como \\[ f_{Y}\\left( y \\right) = \\frac{1}{c}f_{X}\\left( \\frac{y}{c} \\right). \\] Se asume que \\(X\\) pertenece a un cierto conjunto de distribuciones paramétricas y se define la versión reescalada \\(Y\\ = \\ cX\\), \\(c\\ &gt; \\ 0\\). Si \\(Y\\) está en el mismo conjunto de distribuciones entonces se dice que la distribución es una distribución escala. Cuando un miembro de una distribución escala se multiplica por una constante \\(c\\) (\\(c &gt; 0\\)), el parámetro de escala de esa distribución escala cumple dos condiciones: El parámetro se transforma multiplicando por \\(c\\); El resto de parámetros no se ven afectados. Ejemplo 3.3.1. Pregunta de un examen actuarial. Las pérdidas agregadas de Eiffel Auto Insurance se denotan en Euros y siguen una distribución lognormal con \\(\\mu = 8\\) y \\(\\sigma = 2\\). Dado que 1 euro \\(=\\) 1,3 dólares, encuentra el conjunto de parámetros lognormales que describen la distribución de pérdidas de Eiffel en dólares. Mostrar Ejemplo de Solución Solución. Sean \\(X\\) e \\(Y\\) las pérdidas agregadas de Eiffel Auto Insurance en euros y dólares respectivamente. Dado que \\(Y = 1.3X\\), tenemos, \\[ F_{Y}\\left( y \\right) = \\Pr\\left( Y \\leq y \\right) = \\Pr\\left( 1.3X \\leq y \\right) = \\Pr\\left( X \\leq \\frac{y}{1,3} \\right) = F_{X}\\left( \\frac{y}{1.3} \\right). \\] \\(X\\) sigue una distribución lognormal con parámetros \\(\\mu = 8\\) y \\(\\sigma = 2\\). La función de densidad de probabilidad de \\(X\\) viene dada por \\[ f_{X}\\left( x \\right) = \\frac{1}{x \\sigma \\sqrt{2\\pi}}\\exp \\left\\{- \\frac{1}{2}\\left( \\frac{\\ln x - \\mu}{\\sigma} \\right)^{2}\\right\\} \\ \\ \\ \\text{para } x &gt; 0. \\] Dado que \\(\\left| \\frac{dx}{dy} \\right| = \\frac{1}{1,3}\\), la función de densidad de probabilidad de interés \\(f_{Y}(y)\\) es \\[ f_{Y}\\left( y \\right) = \\frac{1}{1,3}f_{X}\\left( \\frac{y}{1,3} \\right) \\\\ = \\frac{1}{1,3}\\frac{1,3}{y \\sigma \\sqrt{2\\pi}}\\exp \\left\\{- \\frac{1}{2}\\left( \\frac{\\ln\\left( y/1.3 \\right) - \\mu}{\\sigma} \\right)^{2}\\right\\} \\\\ = \\frac{1}{y \\sigma\\sqrt{2\\pi}}\\exp \\left\\{- \\frac{1}{2}\\left( \\frac{\\ln y - \\left( \\ln 1,3 + \\mu \\right)}{\\sigma} \\right)^{2}\\right\\}. \\] Entonces \\(Y\\) sigue una distribución lognormal con parámetros \\(\\ln 1,3 + \\mu = 8,26\\) y \\(\\sigma = 2,00\\). Si se establece que \\(\\mu = ln(m)\\) entonces resulta fácil ver que \\(m\\)=\\(e^{\\mu}\\) es el parámetro de escala que fue multiplicado por 1,3 mientras que \\(\\sigma\\) es el parámetro de forma que no se ha visto alterado. Ejemplo 3.3.2. Pregunta de un examen actuarial. Demuestra que la distribución gamma es una distribución escala. Mostrar Ejemplo de Solución Solución. Sea \\(X\\sim Ga(\\alpha,\\theta)\\) e \\(Y = cX\\). Dado que \\(\\left| \\frac{dx}{dy} \\right| = \\frac{1}{c}\\), entonces \\[ f_{Y}\\left( y \\right) = \\frac{1}{c}f_{X}\\left( \\frac{y}{c} \\right) = \\frac{\\left( \\frac{y}{c\\theta} \\right)^{\\alpha}}{y~\\Gamma\\left( \\alpha \\right)}\\exp \\left( - \\frac{y}{c\\theta} \\right) . \\] Se puede ver que \\(Y\\sim Ga(\\alpha,c\\theta)\\) lo cual indica que la gamma es una distribución escala y \\(\\theta\\) es un parámetro de escala. Usando el mismo enfoque podemos demostrar que otras distribuciones introducidas en la Sección 3.2 son también distribuciones escala. En la modelización actuarial, trabajar con una distribución escala es muy conveniente porque permite incorporar el efecto de la inflación y adaptar los cambios en la modeda correspondiente. 3.3.3 Elevación a una potencia En la Sección 3.2.3 se ha tratado la fexibilidad de la distribución de Weibull para el ajuste de datos de fiabilidad. Teniendo en cuenta los orígenes de la distribución de Weibull, se reconoce que la Weibull es una transformación basada en la potencia de la distribución exponencial. Esta se una aplicación de otro tipo de transformación que implica elevar una variable aleatoria a una potencia. Si se considera la transformación \\(Y = X^{\\tau}\\), donde \\(\\tau &gt; 0\\), entonces la función de distribución de \\(Y\\) viene dada por \\[ F_{Y}\\left( y \\right) = \\Pr\\left( Y \\leq y \\right) = \\Pr\\left( X^{\\tau} \\leq y \\right) = \\Pr\\left( X \\leq y^{1/ \\tau} \\right) = F_{X}\\left( y^{1/ \\tau} \\right). \\] Por lo tanto, la función de densidad de probabilidad de interés \\(f_{Y}(y)\\) puede expresarse como \\[ f_{Y}(y) = \\frac{1}{\\tau} y^{1/ \\tau - 1} f_{X}\\left( y^{1/ \\tau} \\right). \\] Por otro lado, si \\(\\tau &lt; 0\\), la función de distribución de \\(Y\\) viene dada por \\[ F_{Y}\\left( y \\right) = \\Pr\\left( Y \\leq y \\right) = \\Pr\\left( X^{\\tau} \\leq y \\right) = \\Pr\\left( X \\geq y^{1/ \\tau} \\right) = 1 - F_{X}\\left( y^{1/ \\tau} \\right), \\] y \\[ f_{Y}(y) = \\left| \\frac{1}{\\tau} \\right|{y^{1/ \\tau - 1}f}_{X}\\left( y^{1/ \\tau} \\right). \\] Ejemplo 3.3.3. Se asume que \\(X\\) sigue una distribución exponencial con media \\(\\theta\\) y se considera la variable transformada \\(Y = X^{\\tau}\\). Demuestra que \\(Y\\) sigue una distribución de Weibull cuando \\(\\tau\\) es positiva y determina los parámetros de la distribución de Weibull. Mostrar Ejemplo de Solución Solución. Dado que \\(X\\) sigue una distribución exponencial con media \\(\\theta\\), tenemos \\[ f_{X}(x) = \\frac{1}{\\theta}e^{- x/ \\theta} \\ \\ \\ \\, x &gt; 0. \\] Resolviendo para x se obtiene \\(x = y^{1/\\tau}\\). Tomando derivadas, tenemos \\[ \\left| \\frac{dx}{dy} \\right| = \\frac{1}{\\tau}{y^{\\frac{1}{\\tau}-1}}. \\] Así tenemos, \\[ f_{Y}\\left( y \\right) = \\frac{1}{\\tau}{y^{\\frac{1}{\\tau} - 1}f}_{X}\\left( y^{\\frac{1}{\\tau}} \\right) \\\\ = \\frac{1}{\\tau \\theta }y^{\\frac{1}{\\tau} - 1}e^{- \\frac{y^{\\frac{1}{\\tau}}}{\\theta}} = \\frac{\\alpha}{\\beta}\\left( \\frac{y}{\\beta} \\right)^{\\alpha - 1}e^{- \\left( y/ \\beta \\right)^{\\alpha}}. \\] donde \\(\\alpha = \\frac{1}{\\tau}\\) y \\(\\beta = \\theta^{\\tau}\\). Entonces, \\(Y\\) sigue una distribución de Weibull con parámetro de forma \\(\\alpha\\) y parámetro de escala \\(\\beta\\). 3.3.4 Exponenciación La distribución normal es un modelo muy popular para un gran número de aplicaciones y cuando el tamaño muestral es grande, puede servir como una distribucion aproximada para otros modelos. Si una variable aleatoria \\(X\\) tiene una distribución normal con media \\(\\mu\\) y varianza \\(\\sigma^{2}\\), entonces \\(Y = e^{X}\\) tiene una distribución lognormal con parámetros \\(\\mu\\) y \\(\\sigma^{2}\\). La variable aleatoria lognormal está acotada en cero por abajo, tiene asimetria positiva y tiene una larga cola por la derecha. La distribución lognormal es frecuentemente utilizada para describir la distribución de activos financieros como los precios de las acciones. También es usada para ajustar cuantías de siniestros en los seguros del automóvil y de salud. Este es un ejemplo de otro tipo de transformación que implica exponenciación. En general, consideramos la transformación \\(Y = e^{X}\\). Entonces, la función de distribución de \\(Y\\) viene dada por \\[F_{Y}\\left( y \\right) = \\Pr\\left( Y \\leq y \\right) = \\Pr\\left( e^{X} \\leq y \\right) = \\Pr\\left( X \\leq \\ln y \\right) = F_{X}\\left( \\ln y \\right).\\] Tomando derivadas, vemos que la función de densidad de probabilidad de interés \\(f_{Y}(y)\\) puede expresarse como \\[ f_{Y}(y) = \\frac{1}{y}f_{X}\\left( \\ln y \\right). \\] Como un caso especial e importante, se asume que \\(X\\) tiene distribución normal con media \\(\\mu\\) y varianza \\(\\sigma^2\\). Entonces, la distribución de \\(Y = e^X\\) es \\[ f_{Y}(y) = \\frac{1}{y}f_{X}\\left( \\ln y \\right) = \\frac{1}{y\\sqrt{2 \\pi}} \\exp \\left\\{-\\frac{1}{2}\\left(\\frac{ \\ln y - \\mu}{\\sigma}\\right)^2\\right\\}. \\] A esta distribución se la conoce como la distribución lognormal. Ejemplo 3.3.4. Pregunta de examen actuarial. Se asume que \\(X\\) tiene una distribución uniforme en el intervalo \\((0,\\ c)\\) y definimos \\(Y = e^{X}\\). Determina la distribución de \\(Y\\). Mostrar Ejemplo de Solución Solución. En primer lugar, se considera la cdf de \\(Y\\), \\[ F_{Y}\\left( y \\right) = \\Pr\\left( Y \\leq y \\right) = \\Pr\\left( e^{X} \\leq y \\right) = \\Pr\\left( X \\leq \\ln y \\right) = F_{X}\\left( \\ln y \\right). \\] Tomando derivadas, se tiene, \\[ f_{Y}\\left( y \\right) = \\frac{1}{y}f_{X}\\left(\\ln y \\right) = \\frac{1}{cy} . \\] Dado que \\(0 &lt; x &lt; c\\), entonces \\(1 &lt; y &lt; e^{c}\\). 3.3.5 Mixturas finitas Las distribuciones mixtas representan una forma útil de modelizar datos que provienen de una población heterogénea. Esta población de origen puede considerarse dividida en múltiples subpoblaciones con diferentes distribuciones. 3.3.5.1 Mixtura de dos variables Si el fenómeno subyacente es diverso y puede ser ciertamente descrito como dos fenómenos que representan dos subpoblaciones con diferentes modelos, es posible construir la variable aleatoria de mixtura de dos variables \\(X\\). Sean las variables aleatorias \\(X_{1}\\) y \\(X_{2}\\), con funciones de densidad de probabilidad \\(f_{X_{1}}\\left( x \\right)\\) y \\(f_{X_{2}}\\left( x \\right)\\) respectivamente, la función de densidad de probabilidad de \\(X\\) es la media ponderada de la componente de la funcion de densidad de probabilidad \\(f_{X_{1}}\\left( x \\right)\\) y \\(f_{X_{2}}\\left( x \\right)\\). Las funciones de densidad de probabilidad y de distribución de \\(X\\) vienen dadas por \\[f_{X}\\left( x \\right) = af_{X_{1}}\\left( x \\right) + \\left( 1 - a \\right)f_{X_{2}}\\left( x \\right),\\] y \\[F_{X}\\left( x \\right) = aF_{X_{1}}\\left( x \\right) + \\left( 1 - a \\right)F_{X_{2}}\\left( x \\right),\\] para \\(0 &lt; a &lt;1\\), donde los parámetros de mixtura \\(a\\) y \\((1 - a)\\) representan las proporciones de las observaciones de los datos que caen en cada una de las dos subpoblaciones repectivamente. Esta media ponderada puede ser aplicada a un buen número distribuciones relacionadas con cuantías. El momento k-ésimo y la función generatriz de momentos de \\(X\\) vienen dadas por \\(\\mathrm{E}\\left( X^{k} \\right) = a\\mathrm{E}\\left( X_{1}^{K} \\right) + \\left( 1 - a \\right)\\mathrm{E}\\left( X_{2}^{k} \\right)\\), y \\[M_{X}(t) = aM_{X_{1}}(t) + \\left( 1 - a \\right)M_{X_{2}}(t),\\] respectivamente. Ejemplo 3.3.5. Pregunta del examen actuarial. En un conjunto de pólizas de seguros se distinguen dos tipos. 25% de las pólizas son de Tipo 1 y 75% de Tipo 2. Para una póliza de Tipo 1, la cuantía de pérdida por año sigue una distribución exponencial con media 200, y para las pólizas de Tipo 2, la cuantía de perdidas por año sigue una distribución de Pareto con parámetros \\(\\alpha=3\\) y \\(\\theta=200\\). Para una póliza seleccionada al azar de la población total que incluye los dos tipos de pólizas, encuentra la probabilidad de que la pérdida anual sea inferior a 100, y determina la perdida media. Mostrar Ejemplo de Solución Solución. Los dos tipos de pérdidas son las variables aleatorias \\(X_1\\) y \\(X_2\\). \\(X_1\\) digue una distribución exponencial con media 100, por lo tanto \\(F_{X_1}\\left(100\\right)=1-e^{-\\frac{100}{200}}=0,393\\). \\(X_2\\) sigue una distribución de Pareto con parámetros \\(\\alpha=3\\) y \\(\\theta=200\\), por lo tanto \\(F_{X_1}\\left(100\\right)=1-\\left(\\frac{200}{100+200}\\right)^3=0,704\\). Por lo tanto, \\(F_X\\left(100\\right)=\\left(0,25\\times0,393\\right)+\\left(0,75\\times0,704\\right)=0,626\\). La pérdida media viene dada por \\[\\mathrm{E}\\left(X\\right)=0,25\\mathrm{E}\\left(X_1\\right)+0,75\\mathrm{E}\\left(X_2\\right)=\\left(0,25\\times200\\right)+\\left(0,75\\times100\\right)=125\\]. 3.3.5.2 Mixtura de k variables En el caso de las distribuciones mixtas finitas, la variable aleatoria de interés \\(X\\) tiene una probabilidad \\(p_{i}\\) de provenir de una subpoblación homogénea \\(i\\), donde \\(i = 1,2,\\ldots,k\\) y \\(k\\) es el número inicialment especificado de subpoblaciones en la mixtura. El parámetro de mixtura \\(p_{i}\\) representa la proporción de observaciones de la subpoblación \\(i\\). Se considera la variable aleatoria \\(X\\) que es generada por \\(k\\) subpoblaciones diferentes, donde la subpoblación \\(i\\) es modelizada con la distribución continua \\(f_{X_{i}}\\left( x \\right)\\). La distribución de probabilidad de \\(X\\) viene dada por \\[f_{X}\\left( x \\right) = \\sum_{i = 1}^{k}{p_{i}f_{X_{i}}\\left( x \\right)},\\] donde \\(0 &lt; p_{i} &lt; 1\\) y \\(\\sum_{i = 1}^{k} p_{i} = 1\\). Este modelo es frecuentemente referenciado como mixtura finita o mixtura de \\(k\\) variables. La función de distribución, momento \\(r\\)-ésimo y funciones generatrices de momentos de la mixtura de \\(k\\) variables vienen dadas por \\[F_{X}\\left( x \\right) = \\sum_{i = 1}^{k}{p_{i}F_{X_{i}}\\left( x \\right)},\\] \\[\\mathrm{E}\\left( X^{r} \\right) = \\sum_{i = 1}^{k}{p_{i}\\mathrm{E}\\left( X_{i}^{r} \\right)}, \\text{and}\\] \\[M_{X}(t) = \\sum_{i = 1}^{k}{p_{i}M_{X_{i}}(t)},\\] respectivamente. Ejemplo 3.3.6. Pregunta de un examen actuarial. \\(Y_{1}\\) es una mixtura de \\(X_{1}\\) y \\(X_{2}\\) con ponderaciones de mixtura \\(a\\) y \\((1 - a)\\). \\(Y_{2}\\) es una mixtura de \\(X_{3}\\) y \\(X_{4}\\) con ponderaciones de mixtura \\(b\\) y \\((1 - b)\\). \\(Z\\) es una mixtura de \\(Y_{1}\\) y \\(Y_{2}\\) con ponderaciones de mixtura \\(c\\) y \\((1 - c)\\). Demuestra que \\(Z\\) es una mixtura de \\(X_{1}\\), \\(X_{2}\\), \\(X_{3}\\) y \\(X_{4}\\), y determina las ponderaciones de mixtura. Mostrar Ejemplo de Solución Solución. Aplicando la fórmula para una distribución mixta, obtenemos \\[f_{Y_{1}}\\left( x \\right) = af_{X_{1}}\\left( x \\right) + \\left( 1 - a \\right)f_{X_{2}}\\left( x \\right)\\] \\[f_{Y_{2}}\\left( x \\right) = bf_{X_{3}}\\left( x \\right) + \\left( 1 - b \\right)f_{X_{4}}\\left( x \\right)\\] \\[f_{Z}\\left( x \\right) = cf_{Y_{1}}\\left( x \\right) + \\left( 1 - c \\right)f_{Y_{2}}\\left( x \\right)\\] Sustituyendo las dos primeras ecuaciones en la tercera, obtenemos \\[f_{Z}\\left( x \\right) = c\\left\\lbrack af_{X_{1}}\\left( x \\right) + \\left( 1 - a \\right)f_{X_{2}}\\left( x \\right) \\right\\rbrack + \\left( 1 - c \\right)\\left\\lbrack bf_{X_{3}}\\left( x \\right) + \\left( 1 - b \\right)f_{X_{4}}\\left( x \\right) \\right\\rbrack\\] \\[= caf_{X_{1}}\\left( x \\right) + c\\left( 1 - a \\right)f_{X_{2}}\\left( x \\right) + \\left( 1 - c \\right)bf_{X_{3}}\\left( x \\right) + (1 - c)\\left( 1 - b \\right)f_{X_{4}}\\left( x \\right)\\]. Entonces, \\(Z\\) es una mixtura de \\(X_{1}\\), \\(X_{2}\\), \\(X_{3}\\) y \\(X_{4}\\), con pesos de mixtura \\(\\text{ca}\\), \\(c\\left( 1 - a \\right)\\), \\(\\left( 1 - c \\right)b\\) y \\((1 - c)\\left( 1 - b \\right)\\), respectivamente. Se puede ver fácilmente que las ponderaciones de mixtura suman uno. 3.3.6 Mixturas continuas Una mixtura con un gran número de subpoblaciones (\\(k\\) tiende a infinito) es frecuentemente denominada mixtura continua. En una mixtura continua, las subpoblaciones no se distinguen a través de un parámetro de mixtura discreto sino por una variable continua \\(\\Theta\\), donde \\(\\Theta\\) juega el papel de \\(p_{i}\\) en la mixtura finita. Se considera la variable aleatoria \\(X\\) con una distribución que depende de un parametro \\(\\Theta\\), donde \\(\\Theta\\) es a su vez una variable aleatoria continua. Esta descrición da lugar al siguiente modelo para \\(X\\) \\[ f_{X}\\left( x \\right) = \\int_{-\\infty}^{\\infty}{f_{X}\\left(x \\left| \\theta \\right. \\right)g_{\\Theta}( \\theta )} d \\theta , \\] donde \\(f_{X}\\left( x | \\theta \\right)\\) es la distribución condicional de \\(X\\) en un valor concreto de \\(\\Theta=\\theta\\) y \\(g_{\\Theta}\\left( \\theta \\right)\\) es la declaración realitzada sobre la probabilidad en relación con el parámetro \\(\\theta\\) desconocido. En un contexto Bayesiano (descrito en la Sección 4.4), se le conoce como la distribución a priori de \\(\\Theta\\) (la información a priori u opinión experta que se va a utilitzar en el análisis). La función de distribución, momento \\(k\\)-ésimo y función generatriz de momentos de la mixtura continua vienen dadas por \\[ F_{X}\\left( x \\right) = \\int_{-\\infty}^{\\infty}{F_{X}\\left(x \\left| \\theta \\right. \\right) g_{\\Theta}(\\theta)} d \\theta, \\] \\[ \\mathrm{E}\\left( X^{k} \\right) = \\int_{-\\infty}^{\\infty}{\\mathrm{E}\\left( X^{k}\\left| \\theta \\right. \\right)g_{\\Theta}(\\theta)}d \\theta, \\] \\[ M_{X}(t) = \\mathrm{E}\\left( e^{t X} \\right) = \\int_{-\\infty}^{\\infty}{\\mathrm{E}\\left( e^{ tx}\\left| \\theta \\right. \\right)g_{\\Theta}(\\theta)}d \\theta, \\] respectivamente. El momento \\(k\\)-ésimo de la distribución mixta puede ser igualmente expresado como \\[ \\mathrm{E}\\left( X^{k} \\right) = \\int_{-\\infty}^{\\infty}{\\mathrm{E}\\left( X^{k}\\left| \\theta \\right. \\right)g_{\\Theta}(\\theta)}d\\theta ~=~ \\mathrm{E}\\left\\lbrack \\mathrm{E}\\left( X^{k}\\left| \\Theta \\right. \\right) \\right\\rbrack . \\] Usando la ley de las esperanzas iteradas (ver Apéndice Capítulo 15), se puede definir la media y varianza de \\(X\\) como \\[ \\mathrm{E}\\left( X \\right) = \\mathrm{E}\\left\\lbrack \\mathrm{E}\\left( X\\left| \\Theta \\right. \\right) \\right\\rbrack \\] y \\[ \\mathrm{Var}\\left( X \\right) = \\mathrm{E}\\left\\lbrack \\mathrm{Var}\\left( X\\left| \\Theta \\right. \\right) \\right\\rbrack + \\mathrm{Var}\\left\\lbrack \\mathrm{E}\\left( X\\left| \\Theta \\right. \\right) \\right\\rbrack . \\] Ejemplo 3.3.7. Pregunta del examen actuarial. \\(X\\) tiene una distribución normal con media \\(\\Lambda\\) y varianza 1. \\(\\Lambda\\) tiene una distribución normal con media 1 y varianza 1. Determina la media y varianza de \\(X\\). Mostrar Ejemplo de Solución Solución. X es una mixtura continua con media \\[ \\mathrm{E}\\left(X\\right)=\\mathrm{E}\\left[\\mathrm{E}\\left(X\\middle|\\Lambda\\right)\\right]=\\mathrm{E}\\left(\\Lambda\\right)=1 \\text{ and } \\mathrm{V}\\left(X\\right)=\\mathrm{V}\\left[\\mathrm{E}\\left(X\\middle|\\Lambda\\right)\\right]+\\mathrm{E}\\left[\\mathrm{V}\\left(X\\middle|\\Lambda\\right)\\right]=\\mathrm{V}\\left(\\Lambda\\right)+\\mathrm{E}\\left(1\\right)=1+1=2. \\] Ejemplo 3.3.8. Pregunta del examen actuarial. Las cuantías de los siniestros, \\(X\\), son uniformes en el intervalo \\(\\left(\\Theta,\\Theta+10\\right)\\) para cada asegurado. \\(\\Theta\\) varía según el asegurado de acuerdo a una distribución exponencial con media 5. Determina la distribución incondicional, media y varianza de \\(X\\). Mostrar Ejemplo de Solución Solución. La distribución condicional de \\(X\\) es \\(f_{X}\\left( \\left. \\ x \\right|\\theta \\right) = \\frac{1}{10}\\) para \\(\\theta &lt; x &lt; \\theta + 10\\). La distribución a priori de \\(\\theta\\) es \\(g_{\\Theta}(\\theta) = \\frac{1}{5}e^{- \\frac{\\theta}{5}}\\) para \\(0 &lt; \\theta &lt; \\infty\\). La media y varianza condicionales de \\(X\\) vienen dadas por \\[ \\mathrm{E}\\left( \\left. \\ X \\right|\\theta \\right) = \\frac{\\theta + \\theta + 10}{2} = \\theta + 5 \\] y \\[ \\mathrm{Var}\\left( \\left. \\ X \\right|\\theta \\right) = \\frac{\\left\\lbrack \\left( \\theta + 10 \\right) - \\theta \\right\\rbrack^{2}}{12} = \\frac{100}{12}, \\] respectivamente. Por lo tanto, la media y varianza incondicionales de \\(X\\) vienen dadas por \\[ \\mathrm{E}\\left( X \\right) = \\mathrm{E}\\left\\lbrack \\mathrm{E}\\left( X\\left| \\Theta \\right. \\right) \\right\\rbrack = \\mathrm{E}\\left( \\Theta + 5 \\right) = \\mathrm{E}\\left( \\Theta \\right) + 5 = 5 + 5 = 10, \\] y \\[ \\mathrm{Var}\\left( X \\right) = \\mathrm{E}\\left\\lbrack V\\left( X\\left| \\Theta \\right. \\right) \\right\\rbrack + \\mathrm{Var}\\left\\lbrack \\mathrm{E}\\left( X\\left| \\Theta \\right. \\right) \\right\\rbrack \\\\ = \\mathrm{E}\\left( \\frac{100}{12} \\right) + \\mathrm{Var}\\left( \\Theta + 5 \\right) = 8.33 + \\mathrm{Var}\\left( \\Theta \\right) = 33,33. \\] La distribucíon incondicional de \\(X\\) es \\[ f_{X}\\left( x \\right) = \\int f_{X}\\left( x |\\theta \\right) ~g_{\\Theta}(\\theta) d \\theta . \\] \\[ f_{X}\\left( x \\right) = \\left\\{ \\begin{matrix} \\int_{0}^{x}{\\frac{1}{50}e^{- \\frac{\\theta}{5}}d\\theta = \\frac{1}{10}\\left( 1 - e^{- \\frac{x}{5}} \\right)} &amp; 0 \\leq x \\leq 10, \\\\ \\int_{x - 10}^{x}{\\frac{1}{50}e^{- \\frac{\\theta}{5}} d\\theta} = \\frac{1}{10}\\left( e^{- \\frac{\\left( x - 10 \\right)}{5}} - e^{- \\frac{x}{5}} \\right) &amp; 10 &lt; x &lt; \\infty. \\\\ \\end{matrix} \\right.\\ \\] 3.4 Modificaciones de cobertura En esta sección se evalúa el impacto de las modificaciones de cobertura: a) franquicias, b) límites en la póliza, c) coseguro e inflación en los costes del asegurador. 3.4.1 Franquicias En una póliza con franquícia ordinaria, el asegurado (tomador) acepta cubrir una cantidad fija de un siniestro antes de que el asegurador comience a pagar. Este gasto fijo pagado de su bolsillo se llama franquícia y suele denotarse por \\(d\\). Si la cuantía del siniestro excede \\(d\\) entonces el asegurador es responsable de cubrir el coste X menos la franquicia \\(d\\). Dependiendo del acuerdo, la franquícia puede aplicarse a cada pérdida asegurada o al total de las pérdidas durante un determinado periodo (mes, año, etc.) Las franquicias eliminan un gran número de pequeños siniestros, reduce el coste de gestionar y processar estos siniestros, reduce las primas para el tomador y reduce el riesgo moral. El riesgo moral ocurre cuando el asegurado asume más riesgos, aumentando las posibilidades de pérdidas debido a peligros frente a los que está asegurado, al saber que el asegurador se hará cargo de los costes (e.g. un asegurado con seguro frente a colisiones puede estar alentado a conducir temerariamente). Cuanto mayor sea la franquícia, el asegurado pagará primas más bajas por su póliza. Sea \\(X\\) la pérdida incurrida para el asegurado e \\(Y\\) la cantidad del siniestro pagada por el asegurador. En relación con el beneficio pagado al tomador, se distinguen dos variables: el pago por pérdida y el pago por pago. La variable pago por pérdida, denotada por \\(Y^{L}\\) o \\((X-d)_+\\) está censurada por la izquierda porque los valores de \\(X\\) que son inferiores a \\(d\\) no son ignorados pero se igualan a cero. Esta variable incluye pérdidas para las que se realiza un pago así como pérdidas inferiores a la franquícia y por lo tanto se define como \\[ Y^{L} = \\left( X - d \\right)_{+} = \\left\\{ \\begin{array}{cc} 0 &amp; X &lt; d, \\\\ X - d &amp; X &gt; d \\end{array} \\right. . \\] \\(Y^{L}\\) es frecuentemente denominada como una variable censurada por la izquierda y desplazada porque los valores por debajo de \\(d\\) no son ignorados y todas las pérdidas se ven desplazadas un valor \\(d\\). Por otra parte, la variable pago por pago, denotada por \\(Y^{P}\\), está solo definida cuando existe un pago. Concretamente, \\(Y^P\\) es igual a \\(X-d\\) cuando \\(\\{X &gt;d\\}\\), denotado como \\(Y^P = X-d ||X&gt;d\\). Otra forma frecuentemente utilizada para expresarla es \\[ Y^{P} = \\left\\{ \\begin{matrix} \\text{No definido} &amp; X \\le d \\\\ X - d &amp; X &gt; d \\end{matrix} . \\right. \\] Por lo tanto, \\(Y^{P}\\) es frecuentemente referenciada como una variable truncada por la izquierda y desplazada o variable exceso de pérdida porque los siniestros inferiores a \\(d\\) no son reportados y los valores por encima de \\(d\\) se ven desplazados en \\(d\\) unidades. Incluso cuando la distribución de \\(X\\) es continua, la distribución de \\(Y^{L}\\) es una combinación híbrida de una componente discreta y otra continua. La parte discreta de la distribución está concentrada en \\(Y = 0\\) (cuando \\(X \\leq d\\)) y la parte continua se extiende sobre el intervalo \\(Y &gt; 0\\) (cuando \\(X &gt; d\\)). Para la parte discreta, la probabilidad de que no existan pagos es la probabiidad de que las pérdidas caigan por debajo de la franquícia; que es, \\[\\Pr\\left( Y^{L} = 0 \\right) = \\Pr\\left( X \\leq d \\right) = F_{X}\\left( d \\right).\\] Usando la transformación \\(Y^{L} = X - d\\) para la parte continua de la distribución, se puede determinar la función de densidad de probabilidad de \\(Y^{L}\\) que viene dada por \\[f_{Y^{L}}\\left( y \\right) = \\left\\{ \\begin{matrix} F_{X}\\left( d \\right) &amp; y = 0, \\\\ f_{X}\\left( y + d \\right) &amp; y &gt; 0 \\end{matrix} \\right. \\] Se puede ver que la variable pago por pago es la variable pago por pérdida condicionado a que la pérdida exceda la franquicia; es decir, \\(Y^{P} = \\left. \\ Y^{L} \\right|X &gt; d\\). Por lo tanto, la función de densidad de probabilidad de \\(Y^{P}\\) viene dada por \\[f_{Y^{P}}\\left( y \\right) = \\frac{f_{X}\\left( y + d \\right)}{1 - F_{X}\\left( d \\right)},\\] para \\(y &gt; 0\\). De acuerdo con esto, las funciones de distribución de \\(Y^{L}\\) y \\(Y^{P}\\) vienen dadas por \\[F_{Y^{L}}\\left( y \\right) = \\left\\{ \\begin{matrix} F_{X}\\left( d \\right) &amp; y = 0, \\\\ F_{X}\\left( y + d \\right) &amp; y &gt; 0. \\\\ \\end{matrix} \\right.\\ \\] y \\[F_{Y^{P}}\\left( y \\right) = \\frac{F_{X}\\left( y + d \\right) - F_{X}\\left( d \\right)}{1 - F_{X}\\left( d \\right)},\\] para \\(y &gt; 0\\), respectivamente. Los momentos ordinarios de \\(Y^{L}\\) y \\(Y^{P}\\) se pueden determinar directamente usando la función de densidad de probabilidad de \\(X\\) como sigue \\[\\mathrm{E}\\left\\lbrack \\left( Y^{L} \\right)^{k} \\right\\rbrack = \\int_{d}^{\\infty}\\left( x - d \\right)^{k}f_{X}\\left( x \\right)dx ,\\] y \\[ \\mathrm{E}\\left\\lbrack \\left( Y^{P} \\right)^{k} \\right\\rbrack = \\frac{\\int_{d}^{\\infty}\\left( x - d \\right)^{k}f_{X}\\left( x \\right) dx }{{1 - F}_{X}\\left( d \\right)} = \\frac{\\mathrm{E}\\left\\lbrack \\left( Y^{L} \\right)^{k} \\right\\rbrack}{{1 - F}_{X}\\left( d \\right)}, \\] respectivamente. Para \\(k=1\\), se puede usar la función de supervivencia para calcular \\(\\mathrm{E}(Y^L)\\) como \\[ \\mathrm{E}(Y^L) = \\int_d^{\\infty} [1-F_X(x)] ~dx . \\] Esto puede ser facilmente demostrado si se considera la definición inicial de \\(\\mathrm{E}(Y^L)\\) y se integra por partes. Se ha visto que la franquicia \\(d\\) impuesta en una póliza de seguros es la cantidad de pérdida que ha de ser pagada del bolsillo del asegurado antes de que el asegurador realice ningún pago. La franquicia \\(d\\) impuesta en una póliza de seguros reduce la prima. La ratio de eliminación de pérdida (LER) es el porcentaje de decrecimiento en el pago esperado del asegurador como resultado de imponer una franquícia. LER se define como \\[LER = \\frac{\\mathrm{E}\\left( X \\right) - \\mathrm{E}\\left( Y^{L} \\right)}{\\mathrm{E}\\left( X \\right)}.\\] Un tipo de franquícia no tan frecuente es la franquícia pura. La franquicia pura se aplica a la póliza de igual manera que la franquícia ordinaria excepto que cuando la pérdida excede la franquícia \\(d\\), la totalidad de la pérdida es cubierta por el asegurador. Las variables pago por pérdida y pago por pago en este caso se definen como \\[Y^{L} = \\left\\{ \\begin{matrix} 0 &amp; X \\leq d, \\\\ X &amp; X &gt; d, \\\\ \\end{matrix} \\right.\\ \\] y \\[Y^{P} = \\left\\{ \\begin{matrix} \\text{No definido} &amp; X \\leq d, \\\\ X &amp; X &gt; d, \\\\ \\end{matrix} \\right.\\ \\] respectivamente. Ejemplo 3.4.1. Pregunta del examen actuarial. Se asume que la distribución para la severidad de los siniestros es exponencial con media 1000. Una compañía de seguros pagará la cantidad de cada siniestro en exceso de una franquicia de 100. Calcula la varianza de la cantidad pagada por la compañía aseguradora por un siniestro, incluyendo la posibilidad de que la cantidad pagada sea 0. Mostrar Ejemplo de Solución Solution. Sea \\(Y^{L}\\) la cantidad pagada por la compañía aseguradora por un siniestro. \\[Y^{L} = \\left( X - 100 \\right)_{+} = \\left\\{ \\begin{matrix} 0 &amp; X \\leq 100, \\\\ X - 100 &amp; X &gt; 100. \\\\ \\end{matrix} \\right.\\ \\] El primer y segundo momento de \\(Y^{L}\\) son \\[E\\left( Y^{L} \\right) = \\int_{100}^{\\infty}\\left( x - 100 \\right)f_{X}\\left( x \\right)dx \\\\ = {\\int_{100}^{\\infty}{S_{X}\\left( x \\right)}dx = 1000e}^{- \\frac{100}{1000}},\\] y \\[E\\left\\lbrack \\left( Y^{L} \\right)^{2} \\right\\rbrack = \\int_{100}^{\\infty}\\left( x - 100 \\right)^{2}f_{X}\\left( x \\right)dx \\\\\\\\ = 2 \\times 1000^{2}e^{- \\frac{100}{1000}}.\\] Por lo tanto, \\[\\mathrm{Var}\\left( Y^{L} \\right) = \\left( 2 \\times 1000^{2}e^{- \\frac{100}{1000}} \\right) - \\left( {1000e}^{- \\frac{100}{1000}} \\right)^{2} = 990,944.\\] Otra forma más simple para llegar a la solución consiste en usar la relación entre \\(X\\) e \\(Y^{P}\\). Si \\(X\\) tiene distribución exponencial con media 1000, entonces \\(Y^{P}\\) tiene también distribución exponencial con la misma media, debido a la propiedad de falta de memoria de la distribución exponencial. Por lo tanto, \\(E\\left( Y^{P} \\right)\\)=1000 y \\[E\\left\\lbrack \\left( Y^{P} \\right)^{2} \\right\\rbrack = 2 \\times 1000^{2}.\\] Usando la relación entre \\(Y^{L}\\) y \\(Y^{P}\\) determinamos \\[E\\left( Y^{L} \\right) = \\ E\\left( Y^{P} \\right)S_{X}\\left( 100 \\right){= 1000e}^{- \\frac{100}{1000}}\\] \\[E\\left\\lbrack \\left( Y^{L} \\right)^{2} \\right\\rbrack = E\\left\\lbrack \\left( Y^{P} \\right)^{2} \\right\\rbrack S_{X}\\left( 100 \\right) = 2 \\times 1000^{2}e^{- \\frac{100}{1000}}.\\] La relación entre \\(X\\) e \\(Y^P\\) se puede usar también al trabajar con las distribuciones uniforme y Pareto. Puede demostrarse facilmente que si \\(X\\) es uniforme en el intervalo \\(\\left(0,\\theta\\right)\\) entonces \\(Y^P\\) es uniforme en el intervalo \\(\\left(0,\\theta-d\\right)\\) y si \\(X\\) es Pareto con parámetros \\(\\alpha\\) y \\(\\theta\\) entonces \\(Y^P\\) es Pareto con parámetros \\(\\alpha\\) y \\(\\theta+d\\). Ejemplo 3.4.2. Pregunta del examen actuarial. Para un seguro: Las pérdidas tienen la función de densidad \\[f_{X}\\left( x \\right) = \\left\\{ \\begin{matrix} 0,02x &amp; 0 &lt; x &lt; 10, \\\\ 0 &amp; \\text{en otros casos.} \\\\ \\end{matrix} \\right. \\] El seguro tiene una franquicia ordinaria por pérdida de 4. \\(Y^{P}\\) es la variable aleatoria pago por pago. Calcula \\(\\mathrm{E}\\left( Y^{P} \\right)\\). Mostrar Ejemplo de Solución Solución. Se define \\(Y^P\\) como sigue \\[Y^{P} = \\left\\{ \\begin{matrix} \\text{Indefinido} &amp; X \\leq 4, \\\\ X - 4 &amp; X &gt; 4. \\\\ \\end{matrix} \\right.\\ \\] Por lo tanto, \\(E\\left( Y^{P} \\right) = \\frac{\\int_{4}^{10}\\left( x - 4 \\right)0,02xdx}{{1 - F}_{X}\\left( 4 \\right)} = \\frac{2,88}{0,84} = 3,43\\). Nótese que se divide por \\(S_X(4)=1-F_X(4)\\), dado que ese es el rango en el que la variable \\(Y^P\\) está definida. Ejemplo 3.4.3. Pregunta del examen actuarial. Se proporcionan los siguientes datos: Las pérdidas siguen una distribución exponencial con la misma media en todos los años. . La ratio de eliminación de pérdida este año es 70%. La franquicia ordinaria para el año siguiente es 4/3 de la franquicia actual. Calcula la ratio de eliminación de pérdida para el siguiente año. Mostrar Ejemplo de Solución Solución. Sean las pérdidas \\(X\\sim Exp(\\theta)\\) y la franquícia para el año próximo \\(d&#39; = \\frac{4}{3}d\\), la franquícia del año actual. La LER para el año actual es \\[\\frac{E\\left( X \\right) - E\\left( Y^{L} \\right)}{E\\left( X \\right)} = \\frac{\\theta - \\theta e^{- d / \\theta}}{\\theta} = 1 - e^{- d / \\theta} = 0,7.\\] Entonces, \\(e^{- d / \\theta} = 0,3\\). La LER para el año próximo es \\[\\begin{align*} &amp;\\frac{\\theta - \\theta \\exp(- \\frac{d&#39;}{\\theta})}{\\theta}=\\frac{\\theta - \\theta \\exp(- \\frac{\\left( \\frac{4}{3}d \\right)}{\\theta})}{\\theta} \\\\ &amp;= 1 - \\exp\\left(- \\frac{ \\frac{4}{3} d }{\\theta}\\right) = 1 - \\left( e^{-d /\\theta} \\right)^{4/3} = 1 - {0,3}^{4/3} = 0.8 . \\end{align*}\\] 3.4.2 Límites de la póliza Cuando existe un límite en la póliza, el asegurador es responsable de cubrir la pérdida real \\(X\\) hasta el límite de cobertura. Este límite de cobertura fijado se llama límite de la póliza y se denota frecuentemente como \\(u\\). Si la pérdida excede el límite de la póliza, la diferencia \\(X - u\\) ha de ser pagada por el tomador. Mientras que un límite más alto para la póliza implica una compensación más alta para el asegurado, también se asocia a una prima mayor. Sea \\(X\\) la pérdida incurrida por el asegurado e \\(Y\\) la cantidad pagada por el asegurador. La variable \\(Y\\) conocida como variable pérdida limitada se denota por \\(X \\land u\\). Es una variable censurada por la derecha porque los valores por encima de \\(u\\) se igualan a \\(u\\). La variable aleatoria pérdida limitada \\(Y\\) se define como \\[ Y = X \\land u = \\left\\{ \\begin{matrix} X &amp; X \\leq u, \\\\ u &amp; X &gt; u. \\\\ \\end{matrix} \\right.\\ \\] Se puede ver que la distinción entre \\(Y^{L}\\) e \\(Y^{P}\\) no es necesaria en el supuesto de una póliza limitada dado que el asegurador siempre hará un pago. Usando las definiciones de \\(\\left(X-d\\right)_+ \\text{ y } \\left(X\\land d\\right)\\), se puede ver facilmente que el pago esperado sin modificaciones de cobertura, \\(X\\), es igual a la suma de los pagos esperados con una franquicia \\(d\\) y un límite \\(d\\). Es decir, \\({X=\\left(X-d\\right)}_++ \\left(X\\land d\\right)\\). Cuando una pérdida está sujeta a una franquicia \\(d\\) y un límite \\(u\\), la variable pago por pérdida \\(Y^L\\) se define como \\[ Y^{L} = \\left\\{ \\begin{matrix} 0 &amp; X \\leq d, \\\\ X - d &amp; d &lt; X \\leq u, \\\\ u - d &amp; X &gt; u. \\\\ \\end{matrix} \\right.\\ \\] Por tanto, \\(Y^L\\) puede expresarse como \\(Y^L=\\left(X\\land u\\right)-\\left(X\\land d\\right)\\). Aún cuando la distribución de \\(X\\) sea continua, la distribución de \\(Y\\) es una combinación híbrida de un componente discreto y uno continuo. La parte discreta de la distribución está concentrada en \\(Y = u\\) (cuando \\(X &gt; u\\)), mientras que la parte continua se extiende en el intervalo \\(Y &lt; u\\) (cuando \\(X \\leq u\\)). Para la parte discreta, la probabilidad de que la compensación pagada sea \\(u\\), es la probabilidad de que la pérdida exceda el límite de la póliza \\(u\\); es decir, \\[\\Pr \\left( Y = u \\right) = \\Pr \\left( X &gt; u \\right) = {1 - F}_{X}\\left( u \\right).\\] Para la parte continua de la distribución \\(Y = X\\), por lo tanto la función de densidad de probabilidad de \\(Y\\) viene dada por \\[f_{Y}\\left( y \\right) = \\left\\{ \\begin{matrix} f_{X}\\left( y \\right) &amp; 0 &lt; y &lt; u, \\\\ 1 - F_{X}\\left( u \\right) &amp; y = u. \\\\ \\end{matrix} \\right.\\ \\] De acuerdo con esto, la función de distribución de \\(Y\\) viene dada por \\[F_{Y}\\left( y \\right) = \\left\\{ \\begin{matrix} F_{X}\\left( x \\right) &amp; 0 &lt; y &lt; u, \\\\ 1 &amp; y \\geq u. \\\\ \\end{matrix} \\right.\\ \\] Los momentos ordinarios de \\(Y\\) pueden determinarse directamente usando la función de densidad de probabilidad de \\(X\\) como sigue \\[ \\mathrm{E}\\left( Y^{k} \\right) = \\mathrm{E}\\left\\lbrack \\left( X \\land u \\right)^{k} \\right\\rbrack = \\int_{0}^{u}x^{k}f_{X}\\left( x \\right)dx + \\int_{u}^{\\infty}{u^{k}f_{X}\\left( x \\right)} dx \\\\ = \\int_{0}^{u}x^{k}f_{X}\\left( x \\right)dx + u^{k}\\left\\lbrack {1 - F}_{X}\\left( u \\right) \\right\\rbrack . \\] For \\(k=1\\), we can use the survival function to calculate \\(\\mathrm{E}\\left( Y \\right)\\) as follows \\[ \\mathrm{E}\\left( Y \\right) = \\mathrm{E}\\left( X \\land u \\right) = \\int_{0}^{u} [1-F_{X}(x) ]dx . \\] Esto puede ser demostrado facilmente si se considera la distribución inicial de \\(\\mathrm{E}\\left( Y \\right)\\) y se hace una integración por partes. Ejemplo 3.4.4. Pregunta del examen actuarial. A través de una póliza de seguro colectivo, un asegurador se compromete a pagar el 100% de las facturas médicas incurridas durante el año por los empleados de una pequeña compañía, hasta una cantidad total máxima de un millón de dólares. La cantidad total de facturas incurridas, \\(X\\), tiene función de densiad de probabilidad \\[f_{X}\\left( x \\right) = \\left\\{ \\begin{matrix} \\frac{x\\left( 4 - x \\right)}{9} &amp; 0 &lt; x &lt; 3, \\\\ 0 &amp; \\text{en otros casos.} \\\\ \\end{matrix} \\right.\\ \\] donde \\(x\\) se mide en millones. Calcula la cantidad total, en millones de dólares, que en términos esperados el asegurador pagará por esta póliza. Mostrar Ejemplo de Solución Solución. Se define la cantidad total que el asegurador paga por las facturas como \\[Y = X \\land 1 = \\left\\{ \\begin{matrix} X &amp; X \\leq 1, \\\\ 1 &amp; X &gt; 1. \\\\ \\end{matrix} \\right.\\ \\] Por lo tanto \\(\\mathrm{E}\\left( Y \\right) = \\mathrm{E}\\left( X \\land 1 \\right) = \\int_{0}^{1}\\frac{x^{2}(4 - x)}{9}dx + 1 * \\int_{1}^{3}\\frac{x\\left( 4 - x \\right)}{9}dx = 0,935\\). 3.4.3 Coseguro e inflación Tal y como hemos visto en la Sección 3.4.1 la cantidad de pérdida retenida por el tomador está limitada por el nivel de la franquicia \\(d\\). La pérdida retenida también puede ser un porcentaje del importe de los siniestros. El porcentaje \\(\\alpha\\), a menudo denominado factor de coseguro, es el porcentaje del siniestro que la compañía ha de cubrir. Si la póliza está sujeta a una franquicia ordinaria y a un límite de la póliza, el coseguro se refiere al porcentaje del siniestro que el asegurador ha de cubrir, después de imponer la franquicia ordinaria y el límite de la póliza. La variable pago por pérdida, \\(Y^{L}\\), se define como \\[ Y^{L} = \\left\\{ \\begin{matrix} 0 &amp; X \\leq d, \\\\ \\alpha\\left( X - d \\right) &amp; d &lt; X \\leq u, \\\\ \\alpha\\left( u - d \\right) &amp; X &gt; u. \\\\ \\end{matrix} \\right.\\ \\] El límite de la póliza (la cantidad máxima pagada por el asegurador) en este caso es \\(\\alpha\\left( u - d \\right)\\), mientras que \\(u\\) es la pérdida máxima cubierta. Hemos visto en la Sección 3.4.2 que cuando una pérdida está sujeta a una franquicia \\(d\\) y a un límite \\(u\\) la variable por pérdida \\(Y^L\\) puede expresarse como \\(Y^L=\\left(X\\land u\\right)-\\left(X\\land d\\right)\\). Con coseguro, se tiene que \\(Y^L\\) puede expresarse como \\(Y^L=\\alpha\\left[(X\\land u)-(X\\land d)\\right]\\). El momento \\(k\\)-ésimo de \\(Y^{L}\\) viene dado por \\[ \\mathrm{E}\\left\\lbrack \\left( Y^{L} \\right)^{k} \\right\\rbrack = \\int_{d}^{u}\\left\\lbrack \\alpha\\left( x - d \\right) \\right\\rbrack^{k}f_{X}\\left( x \\right)dx + \\left\\lbrack \\alpha\\left( u - d \\right) \\right\\rbrack^{k} [1-F_{X}\\left( u \\right)] . \\] Un factor de incremento \\(\\left( 1 + r \\right)\\) se puede aplicar a \\(X\\) dando como resultado una variable aleatoria de pérdida ajustada por inflación \\(\\left( 1 + r \\right)X\\) (los valores de d y u preespecificados se mantienen inalterables). La variable por pérdida resultante se puede expresar como \\[Y^{L} = \\left\\{ \\begin{matrix} 0 &amp; X \\leq \\frac{d}{1 + r}, \\\\ \\alpha\\left\\lbrack \\left( 1 + r \\right)X - d \\right\\rbrack &amp; \\frac{d}{1 + r} &lt; X \\leq \\frac{u}{1 + r}, \\\\ \\alpha\\left( u - d \\right) &amp; X &gt; \\frac{u}{1 + r}. \\\\ \\end{matrix} \\right.\\ \\] Los momentos primero y segundo de \\(Y^{L}\\) se pueden expresar como \\[\\mathrm{E}\\left( Y^{L} \\right) = \\alpha\\left( 1 + r \\right)\\left\\lbrack \\mathrm{E}\\left( X \\land \\frac{u}{1 + r} \\right) - \\mathrm{E}\\left( X \\land \\frac{d}{1 + r} \\right) \\right\\rbrack,\\] y \\[\\mathrm{E}\\left\\lbrack \\left( Y^{L} \\right)^{2} \\right\\rbrack = \\alpha^{2}\\left( 1 + r \\right)^{2} \\left\\{ \\mathrm{E}\\left\\lbrack \\left( X \\land \\frac{u}{1 + r} \\right)^{2} \\right\\rbrack - \\mathrm{E}\\left\\lbrack \\left( X \\land \\frac{d}{1 + r} \\right)^{2} \\right\\rbrack \\right. \\\\ \\left. \\ \\ \\ \\ \\ - 2\\left( \\frac{d}{1 + r} \\right)\\left\\lbrack \\mathrm{E}\\left( X \\land \\frac{u}{1 + r} \\right) - \\mathrm{E}\\left( X \\land \\frac{d}{1 + r} \\right) \\right\\rbrack \\right\\} ,\\] respectivamente. Las fórmulas proporcionadas para los momentos primero y segundo de \\(Y^{L}\\) son generales. Bajo cobertura total, \\(\\alpha = 1\\), \\(r = 0\\), \\(u = \\infty\\), \\(d = 0\\) y \\(\\mathrm{E}\\left( Y^{L} \\right)\\) se reduce a \\(\\mathrm{E}\\left( X \\right)\\). Si solo se impone una franquicia ordinaria, \\(\\alpha = 1\\), \\(r = 0\\), \\(u = \\infty\\) y \\(\\mathrm{E}\\left( Y^{L} \\right)\\) se reduce a \\(\\mathrm{E}\\left( X \\right) - \\mathrm{E}\\left( X \\land d \\right)\\). Si solo se impone un límite en la póliza \\(\\alpha = 1\\), \\(r = 0\\), \\(d = 0\\) y \\(\\mathrm{E}\\left( Y^{L} \\right)\\) se reduce a \\(\\mathrm{E}\\left( X \\land u \\right)\\). Ejemplo 3.4.5. Pregunta del examen actuarial. La variable aleatoria ground up loss para una póliza de seguro de salud en 2006 se modeliza con X, una distribución exponencial de media 1000. Una póliza de seguros paga las pérdidas por encima de una franquicia ordinaria de 100, con un máximo pago anual de 500. La variable aleatoria ground up loss se espera que sea 5% mayor en 2007, pero el seguro en 2007 tiene la misma franquícia y máximo pago como en 2006. Encuentra el porcentaje de incremento en el coste esperado por pago desde 2006 a 2007. Mostrar Ejemplo de Solución Solución. Definimos la cantidad por pérdida \\(Y^L\\) en ambos años como \\[Y_{2006}^{L} = \\left\\{ \\begin{matrix} 0 &amp; X \\leq 100, \\\\ X - 100 &amp; 100 &lt; X \\leq 600, \\\\ 500 &amp; X &gt; 600. \\\\ \\end{matrix} \\right.\\ \\] \\[Y_{2007}^{L} = \\left\\{ \\begin{matrix} 0 &amp; X \\leq 95,24, \\\\ 1.05X - 100 &amp; 95,24 &lt; X \\leq 571,43, \\\\ 500 &amp; X &gt; 571,43. \\\\ \\end{matrix} \\right.\\ \\] Por lo tanto, \\[E\\left( Y_{2006}^{L} \\right) = E\\left( X \\land 600 \\right) - E\\left( X \\land 100 \\right) = 1000\\left( {1 - e}^{- \\frac{600}{1000}} \\right) - 1000\\left( {1 - e}^{- \\frac{100}{1000}} \\right)\\] \\[= 356,026\\]. \\[E\\left( Y_{2007}^{L} \\right) = 1,05\\left\\lbrack E\\left( X \\land 571,43 \\right) - E\\left( X \\land 95,24 \\right) \\right\\rbrack\\] \\[ = 1,05\\left\\lbrack 1000\\left( {1 - e}^{- \\frac{571,43}{1000}} \\right) - 1000\\left( {1 - e}^{- \\frac{95,24}{1000}} \\right) \\right\\rbrack \\] \\[=361,659\\]. \\(E\\left( Y_{2006}^{P} \\right) = \\frac{356,026}{e^{- \\frac{100}{1000}}} = 393,469\\). \\(E\\left( Y_{2007}^{P} \\right) = \\frac{361,659}{e^{- \\frac{95,24}{1000}}} = 397,797\\). Dado que \\(\\frac{E\\left( Y_{2007}^{P} \\right)}{E\\left( Y_{2006}^{P} \\right)} -1 = 0,011,\\) hay un incremento del 1,1% desde 2006 a 2007. Debido al límite de la póliza, el coste por evento por pago creció solo un 1,1% entre 2006 y 2007 aunque las ground up losses aumentaron un 5% entre los dos años. 3.4.4 Reaseguro En la Sección 3.4.1 se introdujo la franquicia en la póliza, que es un acuerdo contractual bajo el cual un asegurado transfiere parte del riesgo al asegurador que garantiza su cobertura a cambio del pago de una prima. En base a esta póliza, el asegurado ha de pagar todos los costes hasta el valor de la franquicia, y el asegurador solo paga la cantidad por encima de la franquicia (si la supera). Ahora se introduce el conceptoreaseguro, un mecanismo de seguro para las compañías aseguradoras. El reaseguro es un acuerdo contractual bajo el cual un asegurador transfiere la cobertura de parte de los riesgos subyacentes asegurados a otro asegurador (al que nos referimos como el reasegurador) a cambio de una prima de reaseguro. Aunque el reaseguro implica una relación entre tres partes: el asegurado original, el asegurador (a veces denominado cedente) y el reasegurador, el acuerdo de reaseguro solo implica al asegurador primario y al reasegurador. No existe relación contractual entre el asegurado original y el reasegurador. Aunque existen diferentes tipos de contratos de reaseguro, una forma común es la cobertura de exceso de pérdida. En estos contratos, el asegurador primario ha de hacer todos los pagos requeridos al asegurado hasta que el total de pagos del asegurador primario alcanza el valor de la franquicia fijada en el reaseguro. El reasegurador es entonces solo responsable del pago de cuantías por encima de la franquícia de reaseguro. La cantidad máxima retenida por el asegurador primario en el acuerdo de reaseguro (la franquícia de reaseguro) se denomina retención. Los acuerdos de reaseguro permiten a los aseguradores con recursos financieros limitados incrementar su capacidad de suscribir pólizas y cumplir con los requerimientos realizados por los clientes para cobertures de seguro mayores al tiempo que reducen el impacto de pérdidas potenciales y protegen la compañía aseguradora frente a pérdidas castastróficas. El reasseguro también permite al asegurador primario beneficiarse de las habilidades de suscripción, la experiencia y la gestión compleja y competente de los archivos de reclamaciones de las compañías de reaseguro más grandes. Ejemplo 3.4.6. Pregunta del examen actuarial. Las pérdidas que se derivan de una determinada cartera tienen una distribución de Pareto de dos parámetros con \\(\\alpha=5\\) y \\(\\theta=3.600\\). Se ha firmado un acuerdo de reaseguro, bajo el cual (a) el reasegurador acepta un 15% de las pérdidas hasta \\(u=5.000\\) y todas las cantidades en exceso de 5.000 y (b) el asegurador paga el resto de pérdidas. Expresa las variables aleatorias para los pagos del reasegurador y asegurador en función de \\(X\\), las pérdidas de la cartera. Calcula la cantidad media pagada por el asegurador por un único siniestro. Asumiendo que el límite superior es \\(u = \\infty\\), calcula un límite superior para la desviación estándar de la cantidad pagada por un único siniestro por el asegurador (reteniendo el 15% de copago). Mostrar Ejemplo de Solución Solución. La porción del reasegurador es \\[ Y_{reasegurador} = \\left\\{ \\begin{array}{cc} 0,15 X &amp; X &lt; 5000, \\\\ 0,15(5000) + X-5000 &amp; X \\ge 5000 \\end{array} \\right. . \\] Y la porción del asegurador es \\[ Y_{asegurador} = \\left\\{ \\begin{array}{cc} 0,85 X &amp; X &lt; 5000, \\\\ 0,85(5000) &amp; X \\ge 5000 \\end{array} \\right. = 0,85(X \\wedge 5000). \\] b) Usando las tablas para el valor esperado limitado de una distribución de Pareto, tenemos \\[ \\mathrm{E}~Y_{asegurador} = 0,85~\\mathrm{E}~(X \\wedge 5000)= 0,85~\\frac{\\theta}{\\alpha-1}\\left[ 1- \\left(\\frac{\\theta}{5000+\\theta}\\right)^{\\alpha-1} \\right] \\\\ = 0,85~\\frac{3600}{5-1}\\left[ 1- \\left(\\frac{3600}{5000+3600}\\right)^{5-1}\\right] = 741,5103. \\] c) Para el primer momento de la variable no limitada, tenemos \\[ \\mathrm{E}~Y_{asegurador}(u=\\infty) = 0,85~\\mathrm{E}~X = 0,85~\\frac{\\theta}{\\alpha-1} = 0,85~\\frac{3600}{5-1} = 765. \\] Para el segundo momento de la variable no limitada, usamos la tabla de distribuciones para obtener \\[ \\mathrm{E}~Y_{asegurador}(u=\\infty)^2 = 0,85^2~\\mathrm{E}~X^2 = 0,85^2~\\frac{\\theta^2 \\Gamma(2+1)\\Gamma(\\alpha-2)}{\\Gamma(\\alpha)} \\\\ = 0,85^2~\\frac{3600^2 *2*2}{24} = 1560600. \\] Por tanto, la varianza es \\(1560600-765^2 =975375.\\) Alternativamente, se puede usar la fórmula \\[ 0,85^2~\\mathrm{Var}~X = 0,85^2~\\frac{\\alpha \\theta^2}{(\\alpha-1)^2(\\alpha-2)} \\\\ = 0,85^2~\\frac{5(3600^2)}{(5-1)^2(5-2)} = 975375. \\] Tomando raíces cuadradas, la desviación estándar es \\(\\sqrt{975375} \\approx 987,6108\\). En la Sección ?? se proporcionaran más detalles sobre el reaseguro. 3.5 Estimación por máxima verosimilitud En esta sección, se describirá cómo: Definir la verosimilitud para una muestra de observaciones de una distribución continua Definir el estimador de máxima verosimilitud para una muestra aleatoria de observaciones de una distribución continua Estimar distribuciones paramétricas basándose en datos agrupados, censurados y truncados 3.5.1 Estimadores de máxima verosimilitud para datos completos Hasta este punto, este capítulo se ha centrado en distribuciones paramétricas que son frecuentemente usadas en aplicacions en el mundo asegurador. No obstante, para ser útiles en el trabajo aplicado, estas distribuciones deben usar valores “realistas” para los parámetros, y para ello es necesario volver a los datos. Fundamentalmente, asumimos que el analista dispone de una muestra aleatoria \\(X_1, \\ldots, X_n\\) de una distribución con función de distribución \\(F_X\\) (por simplicidad, a veces se omite el subíndice \\(X\\)). Como es común, se usa el vector \\(\\boldsymbol \\theta\\) para denotar el conjunto de parámetros de \\(F\\). Este esquema básico de la muestra es revisado en la Sección Appendix 14.1. Aunque sea básico, este esquema de muestreo proporciona los fundamentos para entender esquemas más complejos que son regularmente usados en la práctica, y por lo tanto es importante dominar los conceptos básicos. Antes de obtener valores aleatorios de una distribución, se consideran los resultados potenciales resumidos por una variable aleatoria \\(X_i\\) (aquí, \\(i\\) es 1, 2, …, \\(n\\)). Después de obtener el valor aleatorio, se observa \\(x_i\\). En relación con la notación, se usa letras romanas mayúsculas para variables aleatorias y minúscules para las realizaciones. Ya se ha presentado este planteamiento en la Sección 2.4, donde se ha usado \\(\\Pr(X_1 =x_1, \\ldots, X_n=x_n)\\) para cuantificar la “verosimilitud” de extraer una muestra \\(\\{x_1, \\ldots, x_n\\}\\). Con datos continuos, se usa la función de densidad de probabilidad conjunta (pdf) en lugar de probabilidades conjuntas. Asumiendo independencia, la pdf conjunta puede ser expressada como el producto de pdfs. Por lo tanto, se define la verosimilitud como \\[\\begin{equation} L(\\boldsymbol \\theta) = \\prod_{i=1}^n f(x_i) . \\tag{3.2} CREO QUE ESTO ES UN LABEL Y DE DEBERIA SALIR \\end{equation}\\] A partir de esta notación, es necesario destacar que se considera esta función una función de los parámetros en \\(\\boldsymbol \\theta\\), con los datos \\(\\{x_1, \\ldots, x_n\\}\\) fijos. El estimador de máxima verosimilitud es aquel valor de los parámetros en \\(\\boldsymbol \\theta\\) que maximiza \\(L(\\boldsymbol \\theta)\\). De cálculo, se sabe que maximizar una función produce el mismo resultado que maximizar el logaritmo de la función (esto es debido a que el logaritmo es una función monótona convexa). Dado que obtenemos los mismos resultados, para facilitar las consideraciones computacionales, es común considerar la verosimilitud logarítmica, denotada como \\[\\begin{equation} l(\\boldsymbol \\theta) = \\ln L(\\boldsymbol \\theta) = \\sum_{i=1}^n \\ln f(x_i) . (\\#eq:Verosimilitud logarítmica) \\end{equation}\\] Ejemplo 3.5.1. Pregunta del examen actuarial. Se proporcionan las siguientes cinco observaciones: 521, 658, 702, 819, 1217. Se usa una Pareto de un único parámetro con función de distribución: \\[ F(x) = 1- \\left(\\frac{500}{x}\\right)^{\\alpha}, ~~~~ x&gt;500 . \\] Con \\(n=5\\), el logaritmo de la función de verosimilitud es \\[ l(\\alpha|\\mathbf{x} ) = \\sum_{i=1}^5 \\ln f(x_i;\\alpha ) = 5 \\alpha \\ln 500 + 5 \\ln \\alpha -(\\alpha+1) \\sum_{i=1}^5 \\ln x_i. \\] La Figura 3.4 muestra la verosimilitud logarítmica como función del parámetro \\(\\alpha\\). Figure 3.4: Verosimilitud logarítmica para una Pareto de un parámetro Se puede determinar el valor máximo del logaritmo de la verosimilitud tomando derivadas e igualándolas a cero. De esto resulta \\[ \\frac{ \\partial}{\\partial \\alpha } l(\\alpha |\\mathbf{x}) = 5 \\ln 500 + 5 / \\alpha - \\sum_{i=1}^5 \\ln x_i =_{set} 0 \\Rightarrow \\hat{\\alpha}_{MLE} = \\frac{5}{\\sum_{i=1}^5 \\ln x_i - 5 \\ln 500 } = 2,453 . \\] Naturalmente, hay muchos problemas en los que no es práctico realizar un cálculo manual para la optimización. Afortunadamente hay muchas rutinas estadísticas disponibles como la función optim de R. Código de R para la optimización c1 &lt;- log(521)+log(658)+log(702)+log(819)+log(1217) nloglike &lt;- function(alpha){-(5*alpha*log(500)+5*log(alpha)-(alpha+1)*c1)} MLE &lt;- optim(par=1, fn=nloglike)$par Este código confirma el resultado del cálculo manual en el que el estimador máximo verosímil es \\(\\alpha_{MLE} =\\) 2.453125. Se presentan algunos ejemplos adicionales para ilustrar cómo los actuarios ajustan modelos de distribución paramétricos a una base de datos de siniestros usando máxima verosimilitud. Ejemmplo 3.5.2. Pregunta de examen actuarial. Se considera una muestra aleatoria de cuantías de siniestros: 8.000 10.000 12.000 15.000. Se asume que la cuantía de los siniestros sigue una distribución inversa exponencial, con parámetro \\(\\theta\\). Calcula el estimador máximo verosímil de \\(\\theta\\). Mostrar Ejemplo de Solución Solución. La función de densidad de probabilidad es \\[f_{X}\\left( x \\right) = \\frac{\\theta e^{- \\frac{\\theta}{x}}}{x^{2}}, \\] donde \\(x &gt; 0\\). La función de verosimilitud, \\(L\\left( \\theta \\right)\\), puede ser vista como la probabilidad de los datos observados, expresada en función de los parámetros del modelo \\(\\theta\\) \\[L\\left( \\theta \\right) = \\prod_{i = 1}^{4}{f_{X_{i}}\\left( x_{i} \\right)} = \\frac{\\theta^{4}e^{- \\theta\\sum_{i = 1}^{4}\\frac{1}{x_{i}}}}{\\prod_{i = 1}^{4}x_{i}^{2}}.\\] El logaritmo de la función de verosimilitud, \\(\\ln L \\left( \\theta \\right)\\), es la suma de los logarítmos individuales. \\[\\ln L \\left( \\theta \\right) = 4 \\ln \\theta - \\theta\\sum_{i = 1}^{4}\\frac{1}{x_{i}} - 2\\sum_{i = 1}^{4}\\ln x_{i} .\\] \\[ \\frac{d \\ln L \\left( \\theta \\right)}{d \\theta} = \\frac{4}{\\theta} - \\sum_{i = 1}^{4}\\frac{1}{x_{i}}. \\] El estimador máximo verosímil de \\(\\theta\\), denotado como \\(\\hat{\\theta}\\), es la solución para la ecuación \\[\\frac{4}{\\hat{\\theta}} - \\sum_{i = 1}^{4}{\\frac{1}{x_{i}} = 0}.\\] Por tanto, \\(\\hat{\\theta} = \\frac{4}{\\sum_{i = 1}^{4}\\frac{1}{x_{i}}} = 10.667\\) La segunda derivada de \\(\\ln L \\left( \\theta \\right)\\) viene dada por \\[\\frac{d^{2}\\ln L\\left( \\theta \\right)}{d\\theta^{2}} = \\frac{- 4}{\\theta^{2}}.\\] Evaluando la segunda derivada del logaritmo de la función de verosimilitud en \\(\\hat{\\theta} = 10.667\\) da un valor negativo, lo cual indica que \\(\\hat{\\theta}\\) es el valor que maximiza el logaritmo de la función de verosimilitud. Ejemplo 3.5.3. Pregunta del examen actuarial. Una muestra aleatoria de tamaño 6 proviene de una distribución lognormal con parámetros \\(\\mu\\) y \\(\\sigma\\). Los valores de la muestra son 200, 3.000, 8.000, 60.000, 60.000, 160.000. Calcula el estimador máximo verosímil de \\(\\mu\\) y \\(\\sigma\\). Mostrar Ejemplo de Solución Solución. La función de densidad de probabilidad es \\[f_{X}\\left( x \\right) = \\frac{1}{x \\sigma \\sqrt{2\\pi}}\\exp - \\frac{1}{2}\\left( \\frac{\\ln x - \\mu}{\\sigma} \\right)^{2},\\] donde \\(x &gt; 0\\). La función de verosimilitud, \\(L\\left( \\mu,\\sigma \\right)\\), es el producto de la pdf para cada punto. \\[L\\left( \\mu,\\sigma \\right) = \\prod_{i = 1}^{6}{f_{X_{i}}\\left( x_{i} \\right)} = \\frac{1}{\\sigma^{6}\\left( 2\\pi \\right)^{3}\\prod_{i = 1}^{6}x_{i}}exp - \\frac{1}{2}\\sum_{i = 1}^{6}\\left( \\frac{\\ln x_{i} - \\mu}{\\sigma} \\right)^{2}.\\] El logaritmo de la función de verosimilitud, \\(\\ln L \\left( \\mu,\\sigma \\right)\\), es la suma de los logaritmos individuales. \\[\\ln \\left( \\mu,\\sigma \\right) = - 6 \\ln \\sigma - 3 \\ln \\left( 2\\pi \\right) - \\sum_{i = 1}^{6}\\ln x_{i} - \\frac{1}{2}\\sum_{i = 1}^{6}\\left( \\frac{\\ln x_{i} - \\mu}{\\sigma} \\right)^{2}.\\] Las primeras derivadas parciales son \\[\\frac{\\partial \\ln L\\left( \\mu,\\sigma \\right)}{\\partial\\mu} = \\frac{1}{\\sigma^{2}}\\sum_{i = 1}^{6}\\left( \\ln x_{i} - \\mu \\right).\\] \\[\\frac{\\partial \\ln L\\left( \\mu,\\sigma \\right)}{\\partial\\sigma} = \\frac{- 6}{\\sigma} + \\frac{1}{\\sigma^{3}}\\sum_{i = 1}^{6}\\left( \\ln x_{i} - \\mu \\right)^{2}.\\] Los estimadores máximo verosímiles de \\(\\mu\\) y \\(\\sigma\\), denotados como \\(\\hat{\\mu}\\) y \\(\\hat{\\sigma}\\), son las soluciones de las ecuaciones \\[\\frac{1}{{\\hat{\\sigma}}^{2}}\\sum_{i = 1}^{6}\\left( \\ln x_{i} - \\hat{\\mu} \\right) = 0.\\] \\[\\frac{- 6}{\\hat{\\sigma}} + \\frac{1}{{\\hat{\\sigma}}^{3}}\\sum_{i = 1}^{6}\\left( \\ln x_{i} - \\hat{\\mu} \\right)^{2} = 0.\\] Esto resulta en las estimaciones \\[\\hat{\\mu} = \\frac{\\sum_{i = 1}^{6}{\\ln x_{i}}}{6} = 9,38 \\ \\ \\ \\text{y} \\ \\ \\ {\\hat{\\sigma}}^{2} = \\frac{\\sum_{i = 1}^{6}\\left( \\ln x_{i} - \\hat{\\mu} \\right)^{2}}{6} = 5,12 . \\]. Las segundas derivadas parciales son \\[ \\frac{\\partial^{2}\\ln L\\left( \\mu,\\sigma \\right)}{\\partial\\mu^{2}} = \\frac{- 6}{\\sigma^{2}}, \\ \\ \\ \\ \\frac{\\partial^{2}\\ln L\\left( \\mu,\\sigma \\right)}{\\partial\\mu\\partial\\sigma} = \\frac{- 2}{\\sigma^{3}}\\sum_{i = 1}^{6}\\left( \\ln x_{i} - \\mu \\right) \\] y \\[ \\frac{\\partial^{2}\\ln L\\left( \\mu,\\sigma \\right)}{\\partial\\sigma^{2}} = \\frac{6}{\\sigma^{2}} - \\frac{3}{\\sigma^{4}}\\sum_{i = 1}^{6}\\left( \\ln x_{i} - \\mu \\right)^{2} \\]. Dos cuestiones que vendrían a continuación tienen que ver con las propiedades para muestras grandes que el lector puede haber visto en cursos anteriores. El Capítulo del Apéndice 16 revisa la definición de función de verosimilitud, introduce sus propiedades, revisa los estimadores máximo verosímiles, extiende sus propiedades para muestras grandes al caso en el que hay múltiples parámetros en el modelo, y revisa la inferencia estadística basada en los estimadores máximo verosímiles. En las soluciones de estos ejemplos se derivan las varianzas asintóticas de los estimadores máximo verosímiles de los parámetros del modelo. Se usa el método delta para derivar las varianzas asintóticas de las funciones de estos parámetros. Ejemplo 3.5.2 - Continuación. Se refiere al Ejemplo 3.5.2. Aproxima la varianza del estimador máximo verosímil. Determina un intervalo de confianza para \\(\\theta\\) al 95%. Determina un intervalo de confianza del 95% para \\(\\Pr \\left( X \\leq 9.000 \\right).\\) Mostrar Ejemplo de Solución Solución. a. Tomando el recíproco de la esperanza negativa de la segunda derivada de \\(\\ln L \\left( \\theta \\right)\\), se obtiene una estimación de la varianza de \\(\\hat{\\theta}\\), \\(\\widehat{Var}\\left( \\hat{\\theta} \\right) = \\left. \\ \\left\\lbrack E\\left( \\frac{d^{2}\\ln L \\left( \\theta \\right)}{d\\theta^{2}} \\right) \\right\\rbrack^{- 1} \\right|_{\\theta = \\hat{\\theta}} = \\frac{{\\hat{\\theta}}^{2}}{4} = 28.446.222\\). Nótese que dado que el tamaño de la muestra \\(n \\rightarrow \\infty\\), la distribución del estimador máximo verosímil \\(\\hat{\\theta}\\) converge a una distribución normal con media \\(\\theta\\) y varianza \\(\\hat{V}\\left( \\hat{\\theta} \\right)\\). El intervalo de confianza aproximado en este ejemplo se basa en el supuesto de normalidad, a pesar del pequeño tamaño muestral, solo con fines ilustrativos. b. El intervalo de confianza al 95% para \\(\\theta\\) viene dado por \\[ 10.667 \\pm 1,96\\sqrt{28.446.222} = \\left( 213,34,\\ 21.120,66 \\right). \\] c. La función de distribución de \\(X\\) es \\(F\\left( x \\right) = 1 - e^{- \\frac{x}{\\theta}}\\). Entonces, el estimador máximo verosímil de \\(g_{\\Theta}(\\theta) = F\\left( 9.000 \\right)\\) es \\[g\\left( \\hat{\\theta} \\right) = 1 - e^{- \\frac{9.000}{10.667}} = 0,57.\\] Se usa el método delta para aproximar la varianza de \\(g\\left( \\hat{\\theta} \\right)\\). \\[\\frac{\\text{dg}\\left( \\theta \\right)}{d \\theta} = {- \\frac{9.000}{\\theta^{2}}e}^{- \\frac{9.000}{\\theta}}.\\] \\(\\widehat{Var}\\left\\lbrack g\\left( \\hat{\\theta} \\right) \\right\\rbrack = \\left( - {\\frac{9.000}{{\\hat{\\theta}}^{2}}e}^{- \\frac{9.000}{\\hat{\\theta}}} \\right)^{2}\\hat{V}\\left( \\hat{\\theta} \\right) = 0,0329\\). El intervalo de confianza al 95% para \\(F\\left( 9.000 \\right)\\) viene dado por \\[0,57 \\pm 1,96\\sqrt{0,0329} = \\left( 0,214,\\ 0,926 \\right).\\] Ejemplo 3.5.3 - Continuación. Se refiere al Ejemplo 3.5.3. Estima la matriz de covarianzas del estimador máximo verosímil. Determina intervalos de confianza aproximados al 95% para \\(\\mu\\) y \\(\\sigma\\). Determina un intervalo de confianza aproximado al 95% para la media de la distribución lognormal. Mostrar Ejemplo de Solución a. Para obtener la matriz de covarianzas del mle es necesario encontrar esperanzas de las segundas derivadas. Dado que la variable aleatoria \\(X\\) sigue una distribución lognormal con parámetros \\(\\mu\\) y \\(\\sigma\\), entonces \\(\\text{lnX}\\) se distribuye como una normal con media \\(\\mu\\) y varianza \\(\\sigma^{2}\\). \\(\\mathrm{E}\\left( \\frac{\\partial^{2}\\text{lnL}\\left( \\mu,\\sigma \\right)}{\\partial\\mu^{2}} \\right) = \\mathrm{E}\\left( \\frac{- 6}{\\sigma^{2}} \\right) = \\frac{- 6}{\\sigma^{2}}\\), \\(\\mathrm{E}\\left( \\frac{\\partial^{2}\\text{lnL}\\left( \\mu,\\sigma \\right)}{\\partial\\mu\\partial\\sigma} \\right) = \\frac{- 2}{\\sigma^{3}}\\sum_{i = 1}^{6}{\\mathrm{E}\\left( \\ln x_{i} - \\mu \\right)} = \\frac{- 2}{\\sigma^{3}}\\sum_{i = 1}^{6}\\left\\lbrack \\mathrm{E}\\left( \\ln x_{i} \\right) - \\mu \\right\\rbrack\\)=\\(\\frac{- 2}{\\sigma^{3}}\\sum_{i = 1}^{6}\\left( \\mu - \\mu \\right) = 0\\), y \\(\\mathrm{E}\\left( \\frac{\\partial^{2}\\text{lnL}\\left( \\mu,\\sigma \\right)}{\\partial\\sigma^{2}} \\right) = \\frac{6}{\\sigma^{2}} - \\frac{3}{\\sigma^{4}}\\sum_{i = 1}^{6}{\\mathrm{E}\\left( \\ln x_{i} - \\mu \\right)}^{2} = \\frac{6}{\\sigma^{2}} - \\frac{3}{\\sigma^{4}}\\sum_{i = 1}^{6}{\\mathrm{V}\\left( \\ln x_{i} \\right) = \\frac{6}{\\sigma^{2}} - \\frac{3}{\\sigma^{4}}\\sum_{i = 1}^{6}{\\sigma^{2} = \\frac{- 12}{\\sigma^{2}}}}\\). Usando el negativo de estas esperanzas se obtiene la matriz de información de Fisher \\[\\begin{bmatrix} \\frac{6}{\\sigma^{2}} &amp; 0 \\\\ 0 &amp; \\frac{12}{\\sigma^{2}} \\\\ \\end{bmatrix}.\\] La matriz de covarianzas, \\(\\Sigma\\), es la inversa de la matriz de información de Fisher \\[\\Sigma = \\begin{bmatrix} \\frac{\\sigma^{2}}{6} &amp; 0 \\\\ 0 &amp; \\frac{\\sigma^{2}}{12} \\\\ \\end{bmatrix}.\\] La matriz estimada viene dada por \\[\\hat{\\Sigma} = \\begin{bmatrix} 0,8533 &amp; 0 \\\\ 0 &amp; 0,4267 \\\\ \\end{bmatrix}.\\] b. El intervalo de confianza al 95% para \\(\\mu\\) viene dado por \\(9,38 \\pm 1,96\\sqrt{0,8533} = \\left( 7,57,\\ 11,19 \\right)\\). El intervalo de confianza al 95% para \\(\\sigma^{2}\\) viene dado por \\(5,12 \\pm 1,96\\sqrt{0,4267} = \\left( 3,84,\\ 6,40 \\right)\\). c. La media de X es \\(\\exp\\left( \\mu + \\frac{\\sigma^{2}}{2} \\right)\\). Entonces, el estimador máximo verosímil de \\[g\\left( \\mu,\\sigma \\right) = \\exp\\left( \\mu + \\frac{\\sigma^{2}}{2} \\right)\\] es \\[g\\left( \\hat{\\mu},\\hat{\\sigma} \\right) = \\exp\\left( \\hat{\\mu} + \\frac{{\\hat{\\sigma}}^{2}}{2} \\right) = 153.277.\\] Se usa el método delta para aproximar la varianza del mle \\(g\\left( \\hat{\\mu},\\hat{\\sigma} \\right)\\). \\(\\frac{\\partial g\\left( \\mu,\\sigma \\right)}{\\partial\\mu} = exp\\left( \\mu + \\frac{\\sigma^{2}}{2} \\right)\\) y \\(\\frac{\\partial g\\left( \\mu,\\sigma \\right)}{\\partial\\sigma} = \\sigma exp\\left( \\mu + \\frac{\\sigma^{2}}{2} \\right)\\). Usando el método delta, la varianza aproximada de \\(g\\left( \\hat{\\mu},\\hat{\\sigma} \\right)\\) viene dada por \\[\\left. \\ \\hat{V}\\left( g\\left( \\hat{\\mu},\\hat{\\sigma} \\right) \\right) = \\begin{bmatrix} \\frac{\\partial g\\left( \\mu,\\sigma \\right)}{\\partial\\mu} &amp; \\frac{\\partial g\\left( \\mu,\\sigma \\right)}{\\partial\\sigma} \\\\ \\end{bmatrix}\\Sigma\\begin{bmatrix} \\frac{\\partial g\\left( \\mu,\\sigma \\right)}{\\partial\\mu} \\\\ \\frac{\\partial g\\left( \\mu,\\sigma \\right)}{\\partial\\sigma} \\\\ \\end{bmatrix} \\right|_{\\mu = \\hat{\\mu},\\sigma = \\hat{\\sigma}}\\] \\[= \\begin{bmatrix} 153.277 &amp; 346.826 \\\\ \\end{bmatrix}\\begin{bmatrix} 0,8533 &amp; 0 \\\\ 0 &amp; 0,4267 \\\\ \\end{bmatrix}\\begin{bmatrix} 153.277 \\\\ 346.826 \\\\ \\end{bmatrix} =\\]71.374.380.000 El intervalo de confianza al 95% para \\(\\exp\\left( \\mu + \\frac{\\sigma^{2}}{2} \\right)\\) viene dado por \\(153.277 \\pm 1,96\\sqrt{71.374.380.000} = \\left( - 370.356,\\ 676.910 \\right)\\). Dado que la media de la distribución lognormal no puede ser negativa, se debería reemplazar el límite inferior negativo en el intervalo anterior por cero. Ejemplo 3.5.4. Fondo de propiedad de Wisconsin. Para ver cómo los estimadores máximo verosímiles se aplican a datos reales, volvemos a los 2010 datos de siniestros introducidos en la Sección 1.3. El siguiente fragmento de código muestra cómo ajustar un modelo exponencial, gamma, Pareto, lognormal y GB2. Por consistencia, el código emplea el paquete VGAM de R. El acrónimo viene de Vector Generalized Linear and Additive Models; como sugiere el nombre, este paquete puede hacer mucho más que ajustar estos modelos, aunque esto es suficiente para los propósitos requeridos en este caso. La única excepción es la densidad GB2 que no es muy utilizada fuera del mundo asegurador; en cualquier caso, puede programarse esta densidad y calcular los estimadores máximo verosímiles usando el optimizador general optim. Mostrar Ejemplo de Solución library(VGAM) claim_lev &lt;- read.csv(&quot;Data/CLAIMLEVEL.csv&quot;, header = TRUE) claim_data &lt;- subset(claim_lev, Year == 2010); # Inferencia usando una distribución GB2 – más complicado # La función de verosimilitud de una distribución GB2 (negativo para optimización) lik_gb2 &lt;- function (param) { a_1 &lt;- param[1] a_2 &lt;- param[2] mu &lt;- param[3] sigma &lt;- param[4] yt &lt;- (log(claim_data$Claim) - mu) / sigma logexpyt &lt;- ifelse(yt &gt; 23, yt, log(1 + exp(yt))) logdens &lt;- a_1 * yt - log(sigma) - log(beta(a_1,a_2)) - (a_1+a_2) * logexpyt - log(claim_data$Claim) return(-sum(logdens)) } # &quot;optim&quot; es una función general utilizada con propósito de minimizar gb2_bop &lt;- optim(c(1, 1, 0, 1), lik_gb2, method = c(&quot;L-BFGS-B&quot;), lower = c(0.01, 0.01, -500, 0.01), upper = c(500, 500, 500, 500), hessian = TRUE) # Gráfico no paramétrico plot(density(log(claim_data$Claim)), main = &quot;&quot;, xlab = &quot;Gastos logarítmicos&quot;, ylim = c(0 ,0.37)) x &lt;- seq(0, 15, by = 0.01) #Exponencial fit.exp &lt;- vglm(Claim ~ 1, exponential, data = claim_data) theta = 1 / exp(coef(fit.exp)) fexp_ex &lt;- dgamma(exp(x), scale = exp(-coef(fit.exp)), shape = 1) * exp(x) lines(x, fexp_ex, col = &quot;red&quot;, lty =2) # Inferencia asumiendo una distribución gamma fit.gamma &lt;- vglm(Claim ~ 1, family = gamma2, data = claim_data) theta &lt;- exp(coef(fit.gamma)[1]) / exp(coef(fit.gamma)[2]) # theta = mu / alpha alpha &lt;- exp(coef(fit.gamma)[2]) fgamma_ex &lt;- dgamma(exp(x), shape = alpha, scale = theta) * exp(x) lines(x, fgamma_ex, col = &quot;blue&quot;, lty =3) #Pareto fit.pareto &lt;- vglm(Claim ~ 1, paretoII, loc = 0, data = claim_data) fpareto_ex &lt;- dparetoII(exp(x), loc = 0, shape = exp(coef(fit.pareto)[2]), scale = exp(coef(fit.pareto)[1])) * exp(x) lines(x, fpareto_ex, col = &quot;purple&quot;) # Lognormal fit.LN &lt;- vglm(Claim ~ 1, family = lognormal, data = claim_data) flnorm_ex &lt;- dlnorm(exp(x), mean = coef(fit.LN)[1], sd = exp(coef(fit.LN)[2])) * exp(x) lines(x, flnorm_ex, col = &quot;lightblue&quot;) # Densidad para GB II gb2_density &lt;- function (x) { a_1 &lt;- gb2_bop$par[1] a_2 &lt;- gb2_bop$par[2] mu &lt;- gb2_bop$par[3] sigma &lt;- gb2_bop$par[4] xt &lt;- (log(x) - mu) / sigma logexpxt &lt;- ifelse (xt &gt; 23, yt, log(1 + exp(xt))) logdens &lt;- a_1 * xt - log(sigma) - log(beta(a_1, a_2)) - (a_1+a_2) * logexpxt -log(x) exp(logdens) } fGB2_ex = gb2_density(exp(x)) * exp(x) lines(x, fGB2_ex, col=&quot;green&quot;) legend(&quot;topleft&quot;, c(&quot;log(Gastos)&quot;, &quot;Exponencial&quot;, &quot;Gamma&quot;, &quot;Pareto&quot;, &quot;Lognormal&quot;, &quot;GB2&quot;), cex=0.8, lty = c(4,2,3,1,1,1), #4 is &quot;longdash&quot; col = c(&quot;black&quot;,&quot;red&quot;,&quot;blue&quot;,&quot;purple&quot;,&quot;lightblue&quot;,&quot;green&quot;)) Figure 3.5: Comparaciones de densidad para el fondo de propiedad de Wisconsin Los resultados del ejercicio de ajuste se resumen en la Figura 3.5. Aquí, la curva negra de rayas largas es un histograma suavizado para los datos reales (que introduciremos en la Sección 4.1); las otras curvas son curvas paramétricas donde los parámetros se calculan vía máxima verosimilitud. Se aprecia un pobre ajuste en la línia de rayas rojas correspondiente al ajuste de la distribución exponencial y la línea de puntos azules correspondiente al ajuste de la distribución gamma. Los ajustes de las otras curvas, Pareto, lognormal y GB2, parecen proporcionar un ajuste razonablemente bueno a los datos reales. En el Capítulo 4 se describe en más detalle los principios para la selección de modelos. 3.5.2 Estimadores por máxima verosimilitud usando datos modificados En muchas aplicaciones, los actuarios y otros analistas desean estimar modelos paramétricos basados en datos individuales que no están limitados. En cualquier caso, hay también importantes aplicaciones en las que solo hay datos disponibles que están limitados o modificados. Esta sección introduce la estimación máximo verosímil para datos agrupados, censurados y truncados. Más adelante, se continuará con detalles adicionales en la Sección 4.3. 3.5.2.1 Estimadores por máxima verosimilitud para datos agrupados En la sección anterior se consideró la estimación máximo verosímil de modelos continuos a partir de datos (individuales) completos. Cada observación individual es guardada, y su contribución a la función de verosimilitud es la densidad en ese valor. En esta sección se considera el problema de obtener estimaciones máximo verosímiles de los parámetros a partir de datos agrupados. Las observaciones están solo disponibles en forma agrupada, y la contribución de cada observación a la función de verosimilitud es la probabilidad de caer en un grupo específico (intérvalo). Sea \\(n_{j}\\) el número de observaciones en el intervalo \\(\\left( \\left. \\ c_{j - 1},c_{j} \\right\\rbrack \\right.\\ \\) La función de verosimilitud para datos agrupados viene dada por \\[ L\\left( \\theta \\right) = \\prod_{j = 1}^{k}\\left\\lbrack F_X\\left( \\left. \\ c_{j} \\right|\\theta \\right) - F_X\\left( \\left. \\ c_{j - 1} \\right|\\theta \\right) \\right\\rbrack^{n_{j}}, \\] donde \\(c_{0}\\) es la observación más pequeña posible (a menudo establecida como cero) y \\(c_{k}\\) es la observación más grande posible (a menudo establecida como infinito). Ejemplo 3.5.5. Pregunta del examen actuarial. Para un grupo de pólizas, se sabe que las pérdidas siguen la función de distribución \\(F_X\\left( x \\right) = 1 - \\frac{\\theta}{x}\\), para \\(\\theta &lt; x &lt; \\infty.\\) Además, una muestra de 20 pérdidas toma los valores: \\[ {\\small \\begin{matrix}\\hline \\text{Intervalo} &amp; \\text{Número de pérdidas} \\\\ \\hline (\\theta, 10] &amp; 9 \\\\ (10, 25] &amp; 6 \\\\ (25, \\infty) &amp; 5 \\\\ \\hline \\end{matrix} } \\] Calcula la estimación máximo verosímil de \\(\\theta\\). Mostrar Ejemplo de Solución Solución. La contribución de cada una de las 9 observaciones en el primer intervalo a la función de verosimilitud es la probabilidad de que \\(X \\leq 10\\); es decir, \\(\\Pr\\left( X \\leq 10 \\right) = F_X\\left( 10 \\right)\\). De manera similar, las contribuciones de cada una de las 6 y 5 observationes en los intervalos segundo y tercero son \\(\\Pr\\left( 10 &lt; X \\leq 25 \\right) = F_X\\left( 25 \\right) - F_X(10)\\) y \\(P\\left( X &gt; 25 \\right) = 1 - F_X(25)\\), respectivamente. La función de verosimilitud viene dada por \\[ L\\left( \\theta \\right) = \\left\\lbrack F_X\\left( 10 \\right) \\right\\rbrack^{9}\\left\\lbrack F_X\\left( 25 \\right) - F_X(10) \\right\\rbrack^{6}\\left\\lbrack 1 - F_X(25) \\right\\rbrack^{5} \\] \\[ = {\\left( 1 - \\frac{\\theta}{10} \\right)}^{9}\\left( \\frac{\\theta}{10} - \\frac{\\theta}{25} \\right)^{6}\\left( \\frac{\\theta}{25} \\right)^{5} \\] \\[ = {\\left( \\frac{10 - \\theta}{10} \\right)}^{9}\\left( \\frac{15\\theta}{250} \\right)^{6}\\left( \\frac{\\theta}{25} \\right)^{5}. \\] Entonces, \\(\\ln L \\left( \\theta \\right) = 9\\ln \\left( 10 - \\theta \\right) + 6\\ln \\theta + 5\\ln \\theta - 9\\ln 10 + 6\\ln 15 - 6\\ln 250 - 5\\ln 25\\). \\[ \\frac{d \\ln L \\left( \\theta \\right)}{d \\theta} = \\frac{- 9}{\\left( 10 - \\theta \\right)} + \\frac{6}{\\theta} + \\frac{5}{\\theta}. \\] El estimador máximo verosímil, \\(\\hat{\\theta}\\), es la solución de la ecuación \\[ \\frac{- 9}{\\left( 10 - \\hat{\\theta} \\right)} + \\frac{11}{\\hat{\\theta}} = 0 \\] y \\(\\hat{\\theta} = 5,5\\). 3.5.2.2 Estimadores por máxima verosimilitud para datos censurados Otra posible característica distintiva de un mecanismo de recopilación de datos es la censura. Mientras que para algunos eventos de interés (pérdidas, siniestros, tiempos de vida, etc.) los datos completos pueden estar disponibles, para otros solo está disponible información parcial; todo lo que se sabe es que la observación excede un valor específico. La póliza limitada introducida en la Sección 3.4.2 es un ejemplo de censura por la derecha. Cualquier pérdida mayor o igual al límite de la póliza se iguala al límite. La contribución de la observación censurada a la función de verosimilitud es la probabilidad de que la variable aleatoria exceda el límite especificado. Nótese que las contribuciones tanto de las observaciones completas como censuradas comparten la función de supervivencia, para una observación completa esta función de supervivencia se multiplica por la función de riesgo, pero para una obseración censurada no. La función de verosimilitud para observaciones censuradas viene dada por \\[ L(\\theta) = \\left[ \\prod_{i=1}^r f_X(x_i) \\right] \\left[ S_X(u) \\right]^m , \\] donde \\(r\\) es el número de cuantías de pérdidas conocidas que están por debajo del límite \\(u\\) y \\(m\\) es el número de cuantías de pérdidas mayores que el límite \\(u\\). Ejemplo 3.5.6. Pregunta del examen actuarial. La variable aleatoria \\(X\\) tiene función de supervivencia: \\[ S_{X}\\left( x \\right) = \\frac{\\theta^{4}}{\\left( \\theta^{2} + x^{2} \\right)^{2}}. \\] Sean 2 y 4 dos valores observados de \\(X\\). Además, otro valor excede 4. Calcula el estimador máximo verosímil de \\(\\theta\\). Mostrar Ejemplo de Solución Solución. Las contribuciones de las dos observaciones 2 y 4 son \\(f_{X}\\left( 2 \\right)\\) y \\(f_{X}\\left( 4 \\right)\\) respectivamente. La contribución de la tercera observación, de la cual solo se sabe que excede 4 es \\(S_{X}\\left( 4 \\right)\\). La función de verosimilitud viene por tanto dada por \\[ L\\left( \\theta \\right) = f_{X}\\left( 2 \\right)f_{X}\\left( 4 \\right)S_{X}\\left( 4 \\right). \\] La función de densidad de probabilidad de \\(X\\) viene dada por \\[ f_{X}\\left( x \\right) = \\frac{4x\\theta^{4}}{\\left( \\theta^{2} + x^{2} \\right)^{3}}. \\] Por tanto, \\[ L\\left( \\theta \\right) = \\frac{8\\theta^{4}}{\\left( \\theta^{2} + 4 \\right)^{3}}\\frac{16\\theta^{4}}{\\left( \\theta^{2} + 16 \\right)^{3}}\\frac{\\theta^{4}}{\\left( \\theta^{2} + 16 \\right)^{2}} \\\\ = \\frac{128\\theta^{12}}{\\left( \\theta^{2} + 4 \\right)^{3}\\left( \\theta^{2} + 16 \\right)^{5}}, \\] Entonces, \\[ \\ln L\\left( \\theta \\right) = \\ln 128 + 12\\ln \\theta - 3\\ln \\left( \\theta^{2} + 4 \\right) - 5\\ln \\left( \\theta^{2} + 16 \\right) , \\] y \\(\\frac{d \\ln L\\left( \\theta \\right)}{d \\theta} = \\frac{12}{\\theta} - \\frac{6\\theta}{\\left( \\theta^{2} + 4 \\right)} - \\frac{10\\theta}{\\left( \\theta^{2} + 16 \\right)}\\). El estimador máximo verosímil, \\(\\hat{\\theta}\\), es la solución a la ecuación \\[ \\frac{12}{\\hat{\\theta}} - \\frac{6\\hat{\\theta}}{\\left( {\\hat{\\theta}}^{2} + 4 \\right)} - \\frac{10\\hat{\\theta}}{\\left( {\\hat{\\theta}}^{2} + 16 \\right)} = 0 \\] o \\[12\\left( {\\hat{\\theta}}^{2} + 4 \\right)\\left( {\\hat{\\theta}}^{2} + 16 \\right) - 6{\\hat{\\theta}}^{2}\\left( {\\hat{\\theta}}^{2} + 16 \\right) - 10{\\hat{\\theta}}^{2}\\left( {\\hat{\\theta}}^{2} + 4 \\right) = \\\\ - 4{\\hat{\\theta}}^{4} + 104{\\hat{\\theta}}^{2} + 768 = 0,\\] que permite obtener \\({\\hat{\\theta}}^{2} = 32\\) y \\(\\hat{\\theta} = 5,7\\). 3.5.2.3 Estimadores por máxima verosimilitud para datos truncados Esta sección se centra en la estimación máximo verosímil de la distribución continua de una variable aleatoria \\(X\\) cuando los datos estan incompletos debido a la existencia de truncamiento. Si los valores de \\(X\\) están truncados en \\(d\\), debe tenerse en cuenta que podria pasar desapercibida la existencia de estos valores si no superasen \\(d\\). La franquícia introducida en la póliza en la Sección 3.4.1 es un ejemplo de truncamiento por la izquierda. Cualquier pérdida menor o igual a la franquícia no se registra. La contribución a la función de verosimilitud de una observación \\(x\\) truncada en \\(d\\) será una probabilidad condicionada y \\(f_{X}\\left( x \\right)\\) será reemplazado por \\(\\frac{f_{X}\\left( x \\right)}{S_{X}\\left( d \\right)}\\). La función de verosimilitud para datos truncados viene dada por \\[ L(\\theta) = \\prod_{i=1}^k \\frac{f_X(x_i)}{S_X(d)} , \\] donde \\(k\\) es el número de cuantías de pérdidas mayores que la franquicia \\(d\\). Ejemplo 3.5.7. Pregunta del examen actuarial. Para una distribución de Pareto de un solo parámetro con \\(\\theta = 2\\), se aplica la estimación máximo verosímil para estimar el parámetro \\(\\alpha\\). Determina la media estimada de la distribución ground up loss en base a la estimación máximo verosímil de \\(\\alpha\\) para la siguiente base de datos: Franquicia ordinaria en la póliza de 5, máxima pérdida cubierta de 25 (límite de la póliza 20) 8 cuantías de seguro pagadas: 2, 4, 5, 5, 8, 10, 12, 15 2 límites de pago: 20, 20. Mostrar Ejemplo de Solución Solución. Las contribuciones de las diferentes observaciones pueden ser resumidas a continuación: Para la pérdida exacta: \\(f_{X}\\left( x \\right)\\) Para las observaciones censuradas: \\(S_{X}\\left( 25 \\right)\\). Para las observaciones truncadas: \\(\\frac{f_{X}\\left( x \\right)}{S_{X}\\left( 5 \\right)}\\). Dado que las ground up losses menores de 5 se omiten del conjunto de datos, la contribución de todas las observaciones debe estar condicionada a exceder 5. La función de verosimilitud resulta ser \\[ L\\left( \\alpha \\right) = \\frac{\\prod_{i = 1}^{8}{f_{X}\\left( x_{i} \\right)}}{\\left\\lbrack S_{X}\\left( 5 \\right) \\right\\rbrack^{8}}\\left\\lbrack \\frac{S_{X}\\left( 25 \\right)}{S_{X}\\left( 5 \\right)} \\right\\rbrack^{2}. \\] Para la Pareto de un parámetro las funciones densidad de probabilidad y distribución vienen dadas por \\[ f_{X}\\left( x \\right) = \\frac{\\alpha\\theta^{\\alpha}}{x^{\\alpha + 1}} \\ \\ \\text{and} \\ \\ F_{X}\\left( x \\right) = 1 - \\left( \\frac{\\theta}{x} \\right)^{\\alpha}, \\] para \\(x &gt; \\theta\\), respectivamente. Entonces, la función de verosimilitud y el logaritmo de la función de verosimilitud vienen dadas por \\[ L\\left( \\alpha \\right) = \\frac{\\alpha^{8}}{\\prod_{i = 1}^{8}x_{i}^{\\alpha + 1}}\\frac{5^{10\\alpha}}{25^{2\\alpha}}, \\] \\[ \\ln L \\left( \\alpha \\right) = 8\\ln\\alpha - \\left( \\alpha + 1 \\right)\\sum_{i = 1}^{8}{\\ln x_{i}} + 10\\alpha \\ln 5 - 2\\alpha \\ln 25. \\] \\(\\frac{d \\ln L \\left( \\alpha \\right)}{d \\theta} = \\frac{8}{\\alpha} - \\sum_{i = 1}^{8}{\\ln x_{i}} + 10\\ln 5 - 2\\ln 25\\). El estimador máximo verosímil, \\(\\hat{\\alpha}\\), es la solución de la ecuación \\[ \\frac{8}{\\hat{\\alpha}} - \\sum_{i = 1}^{8}{\\ln x_{i}} + 10\\ln 5 - 2\\ln 25 = 0, \\] que resulta en \\[ \\hat{\\alpha} = \\frac{8}{\\sum_{i = 1}^{8}{\\ln x_{i}} - 10\\ln 5 + 2\\ln 25} = \\frac{8}{(\\ln 7 + \\ln 9 + \\cdots + \\ln 20) - 10\\ln 5 + 2\\ln 25} = 0,785. \\] La media de la Pareto solo existe para \\(\\alpha &gt; 1\\). Dado que \\(\\hat{\\alpha} = 0,785 &lt; 1\\). Entonces, la media no existe. 3.6 Recursos y contribuciones adicionales ####Colaboradores {-} Zeinab Amin, The American University in Cairo, es el principal autor de este capítulo. Email: zeinabha@aucegypt.edu para comentarios sobre el capítulo y sugerencias de mejora. Numerosos comentarios de gran utilidad han sido proporcionados por Hirokazu (Iwahiro) Iwasawa, iwahiro@bb.mbn.or.jp . Otros revisores del capítulo son: Rob Erhardt, Jorge Yslas, Tatjana Miljkovic, y Samuel Kolins. Traducción al español: Ana Maria Pérez-Marín (Universitat de Barcelona) Ejercicios Se proporciona una lista de ejercicios que sirven de guía al lector sobre algunos de los fundamentos teóricos de ** Loss Data Analytics **. Cada tutorial se basa en una o más preguntas de los examenes para la profesión actuarial – típicamente el Examen C de la Sociedad de Actuarios. Severity Distribution Guided Tutorials Lecturas y referencias adicionales Notables contribuciones incluyen a: Cummins and Derrig (2012), Frees and Valdez (2008), Klugman, Panjer, and Willmot (2012), Kreer et al. (2015), McDonald (1984), McDonald and Xu (1995), Tevet (2016), and Venter (1983). Bibliography "],
["C-ModelSelection.html", "Chapter 4 Model Selection and Estimation 4.1 Nonparametric Inference 4.2 Model Selection 4.3 Estimation using Modified Data 4.4 Bayesian Inference 4.5 Further Resources and Contributors", " Chapter 4 Model Selection and Estimation Chapter Preview. Chapters 2 and 3 have described how to fit parametric models to frequency and severity data, respectively. This chapter begins with the selection of models. To compare alternative parametric models, it is helpful to summarize data without reference to a specific parametric distribution. Section 4.1 describes nonparametric estimation, how we can use it for model comparisons and how it can be used to provide starting values for parametric procedures. The process of model selection is then summarized in Section 4.2. Although our focus is on continuous data, the same process can be used for discrete data or data that come from a hybrid combination of discrete and continuous data. Model selection and estimation are fundamental aspects of statistical modeling. To provide a flavor as to how they can be adapted to alternative sampling schemes, Section 4.3 describes estimation for grouped, censored and truncated data (following the Section 3.5 introduction). To see how they can be adapted to alternative models, the chapter closes with Section 4.4 on Bayesian inference, an alternative procedure where the (typically unknown) parameters are treated as random variables. 4.1 Nonparametric Inference In this section, you learn how to: Estimate moments, quantiles, and distributions without reference to a parametric distribution Summarize the data graphically without reference to a parametric distribution Determine measures that summarize deviations of a parametric from a nonparametric fit Use nonparametric estimators to approximate parameters that can be used to start a parametric estimation procedure 4.1.1 Nonparametric Estimation In Section 2.2 for frequency and Section 3.1 for severity, we learned how to summarize a distribution by computing means, variances, quantiles/percentiles, and so on. To approximate these summary measures using a dataset, one strategy is to: assume a parametric form for a distribution, such as a negative binomial for frequency or a gamma distribution for severity, estimate the parameters of that distribution, and then use the distribution with the estimated parameters to calculate the desired summary measure. This is the parametric approach. Another strategy is to estimate the desired summary measure directly from the observations without reference to a parametric model. Not surprisingly, this is known as the nonparametric approach. Let us start by considering the most basic type of sampling scheme and assume that observations are realizations from a set of random variables \\(X_1, \\ldots, X_n\\) that are iid draws from an unknown population distribution \\(F(\\cdot)\\). An equivalent way of saying this is that \\(X_1, \\ldots, X_n\\), is a random sample (with replacement) from \\(F(\\cdot)\\). To see how this works, we now describe nonparametric estimators of many important measures that summarize a distribution. 4.1.1.1 Moment Estimators We learned how to define moments in Section 2.2.2 for frequency and Section 3.1.1 for severity. In particular, the \\(k\\)-th moment, \\(\\mathrm{E~}[X^k] = \\mu^{\\prime}_k\\), summarizes many aspects of the distribution for different choices of k. Here, \\(\\mu^{\\prime}_k\\) is sometimes called the kth population moment to distinguish it from the kth sample moment, \\[ \\frac{1}{n} \\sum_{i=1}^n X_i^k , \\] which is the corresponding nonparametric estimator. In typical applications, \\(k\\) is a positive integer, although it need not be. An important special case is the first moment where k=1. In this case, the prime symbol (\\(\\prime\\)) and the \\(1\\) subscript are usually dropped and one uses \\(\\mu=\\mu^{\\prime}_1\\) to denote the population mean, or simply the mean. The corresponding sample estimator for \\(\\mu\\) is called the sample mean, denoted with a bar on top of the random variable: \\[ \\bar{X} =\\frac{1}{n} \\sum_{i=1}^n X_i . \\] Another type of summary measure of interest is the the \\(k\\)-th central moment, \\(\\mathrm{E~} [(X-\\mu)^k] = \\mu_k\\). (Sometimes, \\(\\mu^{\\prime}_k\\) is called the \\(k\\)-th raw moment to distinguish it from the central moment \\(\\mu_k\\).). A nonparametric, or sample, estimator of \\(\\mu_k\\) is \\[ \\frac{1}{n} \\sum_{i=1}^n \\left(X_i - \\bar{X}\\right)^k . \\] The second central moment (\\(k=2\\)) is an important case for which we typically assign a new symbol, \\(\\sigma^2 = \\mathrm{E~} [(X-\\mu)^2]\\), known as the variance. Properties of sample moment estimator of the variance such as \\(n^{-1}\\sum_{i=1}^n \\left(X_i - \\bar{X}\\right)^2\\) have been studied extensively and so it is natural that many variations have been proposed. The most widely used variation is one where the effective sample size is reduced by one, and so we define \\[ s^2 = \\frac{1}{n-1} \\sum_{i=1}^n \\left(X_i - \\bar{X}\\right)^2. \\] Here, the statistic \\(s^2\\) known as the sample variance. Dividing by n-1 instead of n matters little when you have a sample size n in the thousands as is common in insurance applications. Still, the resulting estimator is unbiased in the sense that \\(\\mathrm{E~} s^2 = \\sigma^2\\), a desirable property particularly when interpreting results of an analysis. 4.1.1.2 Empirical Distribution Function We have seen how to compute nonparametric estimators of the kth moment \\(\\mathrm{E~} X^k\\). In the same way, for any known function \\(\\mathrm{g}(\\cdot)\\), we can estimate \\(\\mathrm{E~} \\mathrm{g}(X)\\) using \\(n^{-1}\\sum_{i=1}^n \\mathrm{g}(X_i)\\). Now suppose that we fix a value of x and consider the function \\(\\mathrm{g}(X) = I(X \\le x)\\). Here, the notation \\(I(\\cdot)\\) is the indicator function; it returns 1 if the event \\((\\cdot)\\) is true and 0 otherwise. For this choice of \\(\\mathrm{g}(\\cdot)\\), the expected value is \\(\\mathrm{E~} I(X \\le x) = \\Pr(X \\le x) = F(x)\\), the distribution function evaluated at a fixed point x. Using the analog principle, we define the nonparametric estimator of the distribution function \\[ \\begin{aligned} F_n(x) &amp;= \\frac{1}{n} \\sum_{i=1}^n I\\left(X_i \\le x\\right) \\\\ &amp;= \\frac{\\text{number of observations less than or equal to }x}{n} . \\end{aligned} \\] As a nonparametric estimator, \\(F_n(\\cdot)\\) is based on only observations and does not assume a parametric family for the distribution, it is also known as the empirical distribution function. Example 4.1.1. Toy Data Set. To illustrate, consider a fictitious, or “toy,” data set of \\(n=10\\) observations. Determine the empirical distribution function. \\[ {\\small \\begin{array}{c|cccccccccc} \\hline i &amp;1&amp;2&amp;3&amp;4&amp;5&amp;6&amp;7&amp;8&amp;9&amp;10 \\\\ X_i&amp; 10 &amp;15 &amp;15 &amp;15 &amp;20 &amp;23 &amp;23 &amp;23 &amp;23 &amp;30\\\\ \\hline \\end{array} } \\] Show Example Solution You should check that the sample mean is \\(\\bar{X} = 19.7\\) and that the sample variance is \\(s^2 =34.45556\\). The corresponding empirical distribution function is \\[ \\begin{aligned} F_n(x) &amp;= \\left\\{ \\begin{array}{ll} 0 &amp; \\text{ for }\\ x&lt;10 \\\\ 0.1 &amp; \\text{ for }\\ 10 \\leq x&lt;15 \\\\ 0.4 &amp; \\text{ for }\\ 15 \\leq x&lt;20 \\\\ 0.5 &amp; \\text{ for }\\ 20 \\leq x&lt;23 \\\\ 0.9 &amp; \\text{ for }\\ 23 \\leq x&lt;30 \\\\ 1 &amp; \\text{ for }\\ x \\geq 30, \\end{array} \\right.\\end{aligned} \\] which is shown in the following graph in Figure 4.1. Figure 4.1: Empirical Distribution Function of a Toy Example Show R Code (xExample &lt;- c(10,rep(15,3),20,rep(23,4),30)) PercentilesxExample &lt;- ecdf(xExample) plot(PercentilesxExample, main=&quot;&quot;,xlab=&quot;x&quot;) 4.1.1.3 Quartiles, Percentiles and Quantiles We have already seen the median, which is the number such that approximately half of a data set is below (or above) it. The first quartile is the number such that approximately 25% of the data is below it and the third quartile is the number such that approximately 75% of the data is below it. A \\(100p\\) percentile is the number such that \\(100 \\times p\\) percent of the data is below it. To generalize this concept, consider a distribution function \\(F(\\cdot)\\), which may or may not be continuous, and let \\(q\\) be a fraction so that \\(0&lt;q&lt;1\\). We want to define a quantile, say \\(q_F\\), to be a number such that \\(F(q_F) \\approx q\\). Notice that when \\(q = 0.5\\), \\(q_F\\) is the median; when \\(q = 0.25\\), \\(q_F\\) is the first quartile, and so on. So, a quantile generalizes the concepts of median, quartiles, and percentiles. To be precise, for a given \\(0&lt;q&lt;1\\), define the \\(q\\)th quantile \\(q_F\\) to be any number that satisfies \\[\\begin{equation} F(q_F-) \\le q \\le F(q_F) \\tag{4.1} \\end{equation}\\] Here, the notation \\(F(x-)\\) means to evaluate the function \\(F(\\cdot)\\) as a left-hand limit. To get a better understanding of this definition, let us look at a few special cases. First, consider the case where \\(X\\) is a continuous random variable so that the distribution function \\(F(\\cdot)\\) has no jump points, as illustrated in Figure 4.2. In this figure, a few fractions, \\(q_1\\), \\(q_2\\), and \\(q_3\\) are shown with their corresponding quantiles \\(q_{F,1}\\), \\(q_{F,2}\\), and \\(q_{F,3}\\). In each case, it can be seen that \\(F(q_F-)= F(q_F)\\) so that there is a unique quantile. Because we can find a unique inverse of the distribution function at any \\(0&lt;q&lt;1\\), we can write \\(q_F= F^{-1}(q)\\). Figure 4.2: Continuous Quantile Case Figure 4.3 shows three cases for distribution functions. The left panel corresponds to the continuous case just discussed. The middle panel displays a jump point similar to those we already saw in the empirical distribution function of Figure 4.1. For the value of \\(q\\) shown in this panel, we still have a unique value of the quantile \\(q_F\\). Even though there are many values of \\(q\\) such that \\(F(q_F-) \\le q \\le F(q_F)\\), for a particular value of \\(q\\), there is only one solution to equation (4.1). The right panel depicts a situation in which the quantile cannot be uniquely determined for the \\(q\\) shown as there is a range of \\(q_F\\)’s satisfying equation (4.1). Figure 4.3: Three Quantile Cases Example 4.1.2. Toy Data Set: Continued. Determine quantiles corresponding to the 20th, 50th, and 95th percentiles. Show Example Solution Solution. Consider Figure 4.1. The case of \\(q=0.20\\) corresponds to the middle panel, so the 20th percentile is 15. The case of \\(q=0.50\\) corresponds to the right panel, so the median is any number between 20 and 23 inclusive. Many software packages use the average 21.5 (e.g. R, as seen below). For the 95th percentile, the solution is 30. We can see from the graph that 30 also corresponds to the 99th and the 99.99th percentiles. quantile(xExample, probs=c(0.2, 0.5, 0.95), type=6) ## 20% 50% 95% ## 15.0 21.5 30.0 By taking a weighted average between data observations, smoothed empirical quantiles can handle cases such as the right panel in Figure 4.3. The \\(q\\)th smoothed empirical quantile is defined as \\[ \\hat{\\pi}_q = (1-h) X_{(j)} + h X_{(j+1)} \\] where \\(j=\\lfloor(n+1)q\\rfloor\\), \\(h=(n+1)q-j\\), and \\(X_{(1)}, \\ldots, X_{(n)}\\) are the ordered values (known as the order statistics) corresponding to \\(X_1, \\ldots, X_n\\). Note that \\(\\hat{\\pi}_q\\) is simply a linear interpolation between \\(X_{(j)}\\) and \\(X_{(j+1)}\\). Example 4.1.3. Toy Data Set: Continued. Determine the 50th and 20th smoothed percentiles. Show Example Solution Solution Take \\(n=10\\) and \\(q=0.5\\). Then, \\(j=\\lfloor(11)0.5 \\rfloor= \\lfloor5.5 \\rfloor=5\\) and \\(h=(11)(0.5)-5=0.5\\). Then the 0.5-th smoothed empirical quantile is \\[\\hat{\\pi}_{0.5} = (1-0.5) X_{(5)} + (0.5) X_{(6)} = 0.5 (20) + (0.5)(23) = 21.5.\\] Now take \\(n=10\\) and \\(q=0.2\\). In this case, \\(j=\\lfloor(11)0.2\\rfloor=\\lfloor 2.2 \\rfloor=2\\) and \\(h=(11)(0.2)-2=0.2\\). Then the 0.2-th smoothed empirical quantile is \\[\\hat{\\pi}_{0.2} = (1-0.2) X_{(2)} + (0.2) X_{(3)} = 0.2 (15) + (0.8)(15) = 15.\\] 4.1.1.4 Density Estimators Discrete Variable. When the random variable is discrete, estimating the probability mass function \\(f(x) = \\Pr(X=x)\\) is straightforward. We simply use the sample average, defined to be \\[f_n(x) = \\frac{1}{n} \\sum_{i=1}^n I(X_i = x).\\] Continuous Variable within a Group. For a continuous random variable, consider a discretized formulation in which the domain of \\(F(\\cdot)\\) is partitioned by constants \\(\\{c_0 &lt; c_1 &lt; \\cdots &lt; c_k\\}\\) into intervals of the form \\([c_{j-1}, c_j)\\), for \\(j=1, \\ldots, k\\). The data observations are thus “grouped” by the intervals into which they fall. Then, we might use the basic definition of the empirical mass function, or a variation such as \\[f_n(x) = \\frac{n_j}{n \\times (c_j - c_{j-1})} \\ \\ \\ \\ \\ \\ c_{j-1} \\le x &lt; c_j,\\] where \\(n_j\\) is the number of observations (\\(X_i\\)) that fall into the interval \\([c_{j-1}, c_j)\\). Continuous Variable (not grouped). Extending this notion to instances where we observe individual data, note that we can always create arbitrary groupings and use this formula. More formally, let \\(b&gt;0\\) be a small positive constant, known as a bandwidth, and define a density estimator to be \\[\\begin{equation} f_n(x) = \\frac{1}{2nb} \\sum_{i=1}^n I(x-b &lt; X_i \\le x + b) \\tag{4.2} \\end{equation}\\] Show A Snippet of Theory The idea is that the estimator \\(f_n(x)\\) in equation (4.2) is the average over \\(n\\) iid realizations of a random variable with mean \\[ \\begin{aligned} \\mathrm{E~ } \\frac{1}{2b} I(x-b &lt; X \\le x + b) &amp;= \\frac{1}{2b}\\left(F(x+b)-F(x-b)\\right) \\\\ &amp;= \\frac{1}{2b} \\left( \\left\\{ F(x) + b F^{\\prime}(x) + b^2 C_1\\right\\} \\left\\{ F(x) - b F^{\\prime}(x) + b^2 C_2\\right\\} \\right) \\\\ &amp;= F^{\\prime}(x) + b \\frac{C_1-C_2}{2} \\rightarrow F^{\\prime}(x) = f(x), \\end{aligned} \\] as \\(b\\rightarrow 0\\). That is, \\(f_n(x)\\) is an asymptotically unbiased estimator of \\(f(x)\\) (its expectation approaches the true value as sample size increases to infinity). This development assumes some smoothness of \\(F(\\cdot)\\), in particular, twice differentiability at \\(x\\), but makes no assumptions on the form of the distribution function \\(F\\). Because of this, the density estimator \\(f_n\\) is said to be nonparametric. More generally, define the kernel density estimator of the pdf at x as \\[\\begin{equation} f_n(x) = \\frac{1}{nb} \\sum_{i=1}^n w\\left(\\frac{x-X_i}{b}\\right) , \\tag{4.3} \\end{equation}\\] where \\(w\\) is a probability density function centered about 0. Note that equation (4.2) simply becomes the kernel density estimator where \\(w(x) = \\frac{1}{2}I(-1 &lt; x \\le 1)\\), also known as the uniform kernel. Other popular choices are shown in Table 4.1. \\[ {\\small \\begin{matrix} \\text{Table 4.1: Popular Choices for the Kernel Density Estimator}\\\\ \\begin{array}{l|cc} \\hline \\text{Kernel} &amp; w(x) \\\\ \\hline \\text{Uniform } &amp; \\frac{1}{2}I(-1 &lt; x \\le 1) \\\\ \\text{Triangle} &amp; (1-|x|)\\times I(|x| \\le 1) \\\\ \\text{Epanechnikov} &amp; \\frac{3}{4}(1-x^2) \\times I(|x| \\le 1) \\\\ \\text{Gaussian} &amp; \\phi(x) \\\\ \\hline \\end{array}\\end{matrix} } \\] Here, \\(\\phi(\\cdot)\\) is the standard normal density function. As we will see in the following example, the choice of bandwidth \\(b\\) comes with a bias-variance tradeoff between matching local distributional features and reducing the volatility. Example 4.1.4. Property Fund. Figure 4.4 shows a histogram (with shaded gray rectangles) of logarithmic property claims from 2010. The (blue) thick curve represents a Gaussian kernel density where the bandwidth was selected automatically using an ad hoc rule based on the sample size and volatility of the data. For this dataset, the bandwidth turned out to be \\(b=0.3255\\). For comparison, the (red) dashed curve represents the density estimator with a bandwidth equal to 0.1 and the green smooth curve uses a bandwidth of 1. As anticipated, the smaller bandwidth (0.1) indicates taking local averages over less data so that we get a better idea of the local average, but at the price of higher volatility. In contrast, the larger bandwidth (1) smooths out local fluctuations, yielding a smoother curve that may miss perturbations in the local average. For actuarial applications, we mainly use the kernel density estimator to get a quick visual impression of the data. From this perspective, you can simply use the default ad hoc rule for bandwidth selection, knowing that you have the ability to change it depending on the situation at hand. Figure 4.4: Histogram of Logarithmic Property Claims with Superimposed Kernel Density Estimators Show R Code #Density Comparison hist(log(ClaimData$Claim), main=&quot;&quot;, ylim=c(0,.35),xlab=&quot;Log Expenditures&quot;, freq=FALSE, col=&quot;lightgray&quot;) lines(density(log(ClaimData$Claim)), col=&quot;blue&quot;,lwd=2.5) lines(density(log(ClaimData$Claim), bw=1), col=&quot;green&quot;) lines(density(log(ClaimData$Claim), bw=.1), col=&quot;red&quot;, lty=3) legend(&quot;topright&quot;, c(&quot;b=0.3255 (default)&quot;, &quot;b=0.1&quot;, &quot;b=1.0&quot;), lty=c(1,3,1), lwd=c(2.5,1,1), col=c(&quot;blue&quot;, &quot;red&quot;, &quot;green&quot;), cex=1) Nonparametric density estimators, such as the kernel estimator, are regularly used in practice. The concept can also be extended to give smooth versions of an empirical distribution function. Given the definition of the kernel density estimator, the kernel estimator of the distribution function can be found as \\[ \\begin{aligned} \\hat{F}_n(x) = \\frac{1}{n} \\sum_{i=1}^n W\\left(\\frac{x-X_i}{b}\\right).\\end{aligned} \\] where \\(W\\) is the distribution function associated with the kernel density \\(w\\). To illustrate, for the uniform kernel, we have \\(w(y) = \\frac{1}{2}I(-1 &lt; y \\le 1)\\), so \\[ \\begin{aligned} W(y) = \\begin{cases} 0 &amp; y&lt;-1\\\\ \\frac{y+1}{2}&amp; -1 \\le y &lt; 1 \\\\ 1 &amp; y \\ge 1 \\\\ \\end{cases}\\end{aligned} . \\] Example 4.1.5. Actuarial Exam Question. You study five lives to estimate the time from the onset of a disease to death. The times to death are: \\[ \\begin{array}{ccccc} 2 &amp; 3 &amp; 3 &amp; 3 &amp; 7 \\\\ \\end{array} \\] Using a triangular kernel with bandwith \\(2\\), calculate the density function estimate at 2.5. Show Example Solution Solution. For the kernel density estimate, we have \\[f_n(x) = \\frac{1}{nb} \\sum_{i=1}^n w\\left(\\frac{x-X_i}{b}\\right),\\] where \\(n=5\\), \\(b=2\\), and \\(x=2.5\\). For the triangular kernel, \\(w(x) = (1-|x|)\\times I(|x| \\le 1)\\). Thus, \\[ \\begin{array}{c|c|c} \\hline X_i &amp; \\frac{x-X_i}{b} &amp; w\\left(\\frac{x-X_i}{b} \\right) \\\\ \\hline 2 &amp; \\frac{2.5-2}{2}=\\frac{1}{4} &amp; (1-\\frac{1}{4})(1) = \\frac{3}{4} \\\\ \\hline 3 &amp; &amp; \\\\ 3 &amp; \\frac{2.5-3}{2}=\\frac{-1}{4} &amp; \\left(1-\\left| \\frac{-1}{4} \\right| \\right)(1) = \\frac{3}{4} \\\\ 3 &amp; &amp; \\\\ \\hline 7 &amp; \\frac{2.5-7}{2}=-2.25 &amp; (1-|-2.25|)(0) = 0\\\\ \\hline \\end{array} \\] Then the kernel density estimate is \\[f_n(x) = \\frac{1}{5(2)}\\left( \\frac{3}{4} + (3) \\frac{3}{4} + 0 \\right) = \\frac{3}{10}\\] 4.1.1.5 Plug-in Principle One way to create a nonparametric estimator is to use the analog or plug-in principle where one replaces the unknown cdf \\(F\\) with a known estimate such as the empirical cdf \\(F_n\\). So, if we are trying to estimate \\(\\mathrm{E}~\\mathrm{g}(X)=\\mathrm{E}_F~\\mathrm{g}(X)\\) for a generic function g, then we define a nonparametric estimator to be \\(\\mathrm{E}_{F_n}~\\mathrm{g}(X)=n^{-1}\\sum_{i=1}^n \\mathrm{g}(X_i)\\). To see how this works, as a special case of g we consider the loss elimination ratio introduced in Section 3.4.1, \\[ LER(d) = \\frac{\\mathrm{E~}(\\min(X,d) )}{\\mathrm{E~}(X)} \\] for a fixed deductible \\(d\\). Example. 4.1.11. Bodily Injury Claims and Loss Elimination Ratios We use a sample of 432 closed auto claims from Boston from Derrig, Ostaszewski, and Rempala (2001). Losses are recorded for payments due to bodily injuries in auto accidents. Losses are not subject to deductibles but are subject to various policy limits also available in the data. It turns out that only 17 out of 432 (\\(\\approx\\) 4%) were subject to policy limit and so we ignore these data for this illustration. The average loss paid is 6906. Figure 4.5 shows other aspects of the distribution. Specifically, the left-hand panel shows the empirical distribution function, the right-hand panel gives a nonparametric density plot. Figure 4.5: Bodily Injury Claims. The left-hand panel gives the empirical distribution function. The right-hand panel presents a nonparametric density plot. The impact of bodily injury losses can be mitigated by the imposition of limits or purchasing reinsurance policies (see Section 10.3). To quantify the impact of these risk mitigation tools, it is common to compute the loss elimination ratio (LER) as introduced in Section 3.4.1. The distribution function is not available and so much be estimated in some way. Using the plug-in principle, a nonparametric estimator can be defined as \\[ LER_n(d) = \\frac{n^{-1} \\sum_{i=1}^n \\min(X_i,d)}{n^{-1} \\sum_{i=1}^n X_i} = \\frac{\\sum_{i=1}^n \\min(X_i,d)}{\\sum_{i=1}^n X_i} . \\] Figure 4.5 shows the estimator \\(LER_n(d)\\) for various choices of d. For example, if \\(d=14,000\\), then it turns out that \\(LER_n(14000) \\approx\\) 0.9768. Imposing a limit of 14,000 means that we expect to retain 97.68 percent of claims. Figure 4.6: LER for Bodily Injury Claims. The figure presents the loss elimination ratio (LER) as a function of deductible d. 4.1.2 Tools for Model Selection and Diagnostics The previous section introduced nonparametric estimators in which there was no parametric form assumed about the underlying distributions. However, in many actuarial applications, analysts seek to employ a parametric fit of a distribution for ease of explanation and the ability to readily extend it to more complex situations such as including explanatory variables in a regression setting. When fitting a parametric distribution, one analyst might try to use a gamma distribution to represent a set of loss data. However, another analyst may prefer to use a Pareto distribution. How does one know which model to select? Nonparametric tools can be used to corroborate the selection of parametric models. Essentially, the approach is to compute selected summary measures under a fitted parametric model and to compare it to the corresponding quantity under the nonparametric model. As the nonparametric does not assume a specific distribution and is merely a function of the data, it is used as a benchmark to assess how well the parametric distribution/model represents the data. This comparison may alert the analyst to deficiencies in the parametric model and sometimes point ways to improving the parametric specification. Procedures geared towards assessing the validity of a model are known as model diagnostics. 4.1.2.1 Graphical Comparison of Distributions We have already seen the technique of overlaying graphs for comparison purposes. To reinforce the application of this technique, Figure 4.7 compares the empirical distribution to two parametric fitted distributions. The left panel shows the distribution functions of claims distributions. The dots forming an “S-shaped” curve represent the empirical distribution function at each observation. The thick blue curve gives corresponding values for the fitted gamma distribution and the light purple is for the fitted Pareto distribution. Because the Pareto is much closer to the empirical distribution function than the gamma, this provides evidence that the Pareto is the better model for this data set. The right panel gives similar information for the density function and provides a consistent message. Based (only) on these figures, the Pareto distribution is the clear choice for the analyst. Figure 4.7: Nonparametric Versus Fitted Parametric Distribution and Density Functions. The left-hand panel compares distribution functions, with the dots corresponding to the empirical distribution, the thick blue curve corresponding to the fitted gamma and the light purple curve corresponding to the fitted Pareto. The right hand panel compares these three distributions summarized using probability density functions. For another way to compare the appropriateness of two fitted models, consider the probability-probability (pp) plot. A \\(pp\\) plot compares cumulative probabilities under two models. For our purposes, these two models are the nonparametric empirical distribution function and the parametric fitted model. Figure 4.8 shows \\(pp\\) plots for the Property Fund data. The fitted gamma is on the left and the fitted Pareto is on the right, compared to the same empirical distribution function of the data. The straight line represents equality between the two distributions being compared, so points close to the line are desirable. As seen in earlier demonstrations, the Pareto is much closer to the empirical distribution than the gamma, providing additional evidence that the Pareto is the better model. Figure 4.8: Probability-Probability (\\(pp\\)) Plots. The horizontal axes gives the empirical distribution function at each observation. In the left-hand panel, the corresponding distribution function for the gamma is shown in the vertical axis. The right-hand panel shows the fitted Pareto distribution. Lines of \\(y=x\\) are superimposed. A \\(pp\\) plot is useful in part because no artificial scaling is required, such as with the overlaying of densities in Figure 4.7, in which we switched to the log scale to better visualize the data. The Chapter 4 Technical Supplement A.1 introduces a variation of the \\(pp\\) plot known as a Lorenz curve; this is an important tool for assessing income inequality. Furthermore, \\(pp\\) plots are available in multivariate settings where more than one outcome variable is available. However, a limitation of the \\(pp\\) plot is that, because it is a plot cumulative distribution functions, it can sometimes be difficult to detect where a fitted parametric distribution is deficient. As an alternative, it is common to use a quantile-quantile (qq) plot, as demonstrated in Figure 4.9. The \\(qq\\) plot compares two fitted models through their quantiles. As with \\(pp\\) plots, we compare the nonparametric to a parametric fitted model. Quantiles may be evaluated at each point of the data set, or on a grid (e.g., at \\(0, 0.001, 0.002, \\ldots, 0.999, 1.000\\)), depending on the application. In Figure 4.9, for each point on the aforementioned grid, the horizontal axis displays the empirical quantile and the vertical axis displays the corresponding fitted parametric quantile (gamma for the upper two panels, Pareto for the lower two). Quantiles are plotted on the original scale in the left panels and on the log scale in the right panels to allow us to see where a fitted distribution is deficient. The straight line represents equality between the empirical distribution and fitted distribution. From these plots, we again see that the Pareto is an overall better fit than the gamma. Furthermore, the lower-right panel suggests that the Pareto distribution does a good job with large observations, but provides a poorer fit for small observations. Figure 4.9: Quantile-Quantile (\\(qq\\)) Plots. The horizontal axes gives the empirical quantiles at each observation. The right-hand panels they are graphed on a logarithmic basis. The vertical axis gives the quantiles from the fitted distributions; gamma quantiles are in the upper panels, Pareto quantiles are in the lower panels. Example 4.1.6. Actuarial Exam Question. The graph below shows a \\(pp\\) plot of a fitted distribution compared to a sample. Comment on the two distributions with respect to left tail, right tail, and median probabilities. Show Example Solution Solution. The tail of the fitted distribution is too thick on the left, too thin on the right, and the fitted distribution has less probability around the median than the sample. To see this, recall that the \\(pp\\) plot graphs the cumulative distribution of two distributions on its axes (empirical on the x-axis and fitted on the y-axis in this case). For small values of \\(x\\), the fitted model assigns greater probability to being below that value than occurred in the sample (i.e. \\(F(x) &gt; F_n(x)\\)). This indicates that the model has a heavier left tail than the data. For large values of \\(x\\), the model again assigns greater probability to being below that value and thus less probability to being above that value (i.e. \\(S(x) &lt; S_n(x)\\). This indicates that the model has a lighter right tail than the data. In addition, as we go from 0.4 to 0.6 on the horizontal axis (thus looking at the middle 20% of the data), the \\(pp\\) plot increases from about 0.3 to 0.4. This indicates that the model puts only about 10% of the probability in this range. 4.1.2.2 Statistical Comparison of Distributions When selecting a model, it is helpful to make the graphical displays presented. However, for reporting results, it can be effective to supplement the graphical displays with selected statistics that summarize model goodness of fit. Table 4.2 provides three commonly used goodness of fit statistics. In this table, \\(F_n\\) is the empirical distribution, \\(F\\) is the fitted or hypothesized distribution, and \\(F_i = F(x_i)\\). \\[ {\\small \\begin{matrix} \\text{Table 4.2: Three Goodness of Fit Statistics} \\\\ \\begin{array}{l|cc} \\hline \\text{Statistic} &amp; \\text{Definition} &amp; \\text{Computational Expression} \\\\ \\hline \\text{Kolmogorov-} &amp; \\max_x |F_n(x) - F(x)| &amp; \\max(D^+, D^-) \\text{ where } \\\\ ~~~\\text{Smirnov} &amp;&amp; D^+ = \\max_{i=1, \\ldots, n} \\left|\\frac{i}{n} - F_i\\right| \\\\ &amp;&amp; D^- = \\max_{i=1, \\ldots, n} \\left| F_i - \\frac{i-1}{n} \\right| \\\\ \\text{Cramer-von Mises} &amp; n \\int (F_n(x) - F(x))^2 f(x) dx &amp; \\frac{1}{12n} + \\sum_{i=1}^n \\left(F_i - (2i-1)/n\\right)^2 \\\\ \\text{Anderson-Darling} &amp; n \\int \\frac{(F_n(x) - F(x))^2}{F(x)(1-F(x))} f(x) dx &amp; -n-\\frac{1}{n} \\sum_{i=1}^n (2i-1) \\log\\left(F_i(1-F_{n+1-i})\\right)^2 \\\\ \\hline \\end{array} \\\\ \\end{matrix} } \\] The Kolmogorov-Smirnov statistic is the maximum absolute difference between the fitted distribution function and the empirical distribution function. Instead of comparing differences between single points, the Cramer-von Mises statistic integrates the difference between the empirical and fitted distribution functions over the entire range of values. The Anderson-Darling statistic also integrates this difference over the range of values, although weighted by the inverse of the variance. It therefore places greater emphasis on the tails of the distribution (i.e when \\(F(x)\\) or \\(1-F(x)=S(x)\\) is small). Exaxmple 4.1.7. Actuarial Exam Question (modified). A sample of claim payments is: \\[ \\begin{array}{ccccc} 29 &amp; 64 &amp; 90 &amp; 135 &amp; 182 \\\\ \\end{array} \\] Compare the empirical claims distribution to an exponential distribution with mean \\(100\\) by calculating the value of the Kolmogorov-Smirnov test statistic. Show Example Solution Solution. For an exponential distribution with mean \\(100\\), the cumulative distribution function is \\(F(x)=1-e^{-x/100}\\). Thus, \\[ \\begin{array}{ccccc} \\hline x &amp; F(x) &amp; F_n(x) &amp; F_n(x-) &amp; \\max(|F(x)-F_n(x)|,|F(x)-F_n(x-)|) \\\\ \\hline 29 &amp; 0.2517 &amp; 0.2 &amp; 0 &amp; \\max(0.0517, 0.2517) = 0.2517 \\\\ 64 &amp; 0.4727 &amp; 0.4 &amp; 0.2 &amp; \\max(0.0727, 0.2727) = 0.2727 \\\\ 90 &amp; 0.5934 &amp; 0.6 &amp; 0.4 &amp; \\max(0.0066, 0.1934) = 0.1934 \\\\ 135 &amp; 0.7408 &amp; 0.8 &amp; 0.6 &amp; \\max(0.0592, 0.1408) = 0.1408 \\\\ 182 &amp; 0.8380 &amp; 1 &amp; 0.8 &amp; \\max(0.1620, 0.0380) = 0.1620 \\\\ \\hline \\end{array} \\] The Kolmogorov-Smirnov test statistic is therefore \\(KS = \\max(0.2517, 0.2727, 0.1934, 0.1408, 0.1620) = 0.2727\\). 4.1.3 Starting Values The method of moments and percentile matching are nonparametric estimation methods that provide alternatives to maximum likelihood. Generally, maximum likelihood is the preferred technique because it employs data more efficiently. (See Appendix Chapter 16 for precise definitions of efficiency.) However, methods of moments and percentile matching are useful because they are easier to interpret and therefore allow the actuary or analyst to explain procedures to others. Additionally, the numerical estimation procedure (e.g. if performed in R) for the maximum likelihood is iterative and requires starting values to begin the recursive process. Although many problems are robust to the choice of the starting values, for some complex situations, it can be important to have a starting value that is close to the (unknown) optimal value. Method of moments and percentile matching are techniques that can produce desirable estimates without a serious computational investment and can thus be used as a starting value for computing maximum likelihood. 4.1.3.1 Method of Moments Under the method of moments, we approximate the moments of the parametric distribution using the empirical (nonparametric) moments described in Section 4.1.1.1. We can then algebraically solve for the parameter estimates. Example 4.1.8. Property Fund. For the 2010 property fund, there are \\(n=1,377\\) individual claims (in thousands of dollars) with \\[m_1 = \\frac{1}{n} \\sum_{i=1}^n X_i = 26.62259 \\ \\ \\ \\ \\text{and} \\ \\ \\ \\ m_2 = \\frac{1}{n} \\sum_{i=1}^n X_i^2 = 136154.6 .\\] Fit the parameters of the gamma and Pareto distributions using the method of moments. Show Example Solution Solution. To fit a gamma distribution, we have \\(\\mu_1 = \\alpha \\theta\\) and \\(\\mu_2^{\\prime} = \\alpha(\\alpha+1) \\theta^2\\). Equating the two yields the method of moments estimators, easy algebra shows that \\[\\alpha = \\frac{\\mu_1^2}{\\mu_2^{\\prime}-\\mu_1^2} \\ \\ \\ \\text{and} \\ \\ \\ \\theta = \\frac{\\mu_2^{\\prime}-\\mu_1^2}{\\mu_1}.\\] Thus, the method of moment estimators are \\[ \\begin{aligned} \\hat{\\alpha} &amp;= \\frac{26.62259^2}{136154.6-26.62259^2} = 0.005232809 \\\\ \\hat{\\theta} &amp;= \\frac{136154.6-26.62259^2}{26.62259} = 5,087.629. \\end{aligned} \\] For comparison, the maximum likelihood values turn out to be \\(\\hat{\\alpha}_{MLE} = 0.2905959\\) and \\(\\hat{\\theta}_{MLE} = 91.61378\\), so there are big discrepancies between the two estimation procedures. This is one indication, as we have seen before, that the gamma model fits poorly. In contrast, now assume a Pareto distribution so that \\(\\mu_1 = \\theta/(\\alpha -1)\\) and \\(\\mu_2^{\\prime} = 2\\theta^2/((\\alpha-1)(\\alpha-2) )\\). Easy algebra shows \\[\\alpha = 1+ \\frac{\\mu_2^{\\prime}}{\\mu_2^{\\prime}-\\mu_1^2} \\ \\ \\ \\ \\text{and} \\ \\ \\ \\ \\ \\theta = (\\alpha-1)\\mu_1.\\] Thus, the method of moment estimators are \\[ \\begin{aligned} \\hat{\\alpha} &amp;= 1+ \\frac{136154.6}{136154.6-26,62259^2} = 2.005233 \\\\ \\hat{\\theta} &amp;= (2.005233-1) \\cdot 26.62259 = 26.7619 \\end{aligned} \\] The maximum likelihood values turn out to be \\(\\hat{\\alpha}_{MLE} = 0.9990936\\) and \\(\\hat{\\theta}_{MLE} = 2.2821147\\). It is interesting that \\(\\hat{\\alpha}_{MLE}&lt;1\\); for the Pareto distribution, recall that \\(\\alpha &lt;1\\) means that the mean is infinite. This is another indication that the property claims data set is a long tail distribution. As the above example suggests, there is flexibility with the method of moments. For example, we could have matched the second and third moments instead of the first and second, yielding different estimators. Furthermore, there is no guarantee that a solution will exist for each problem. You will also find that matching moments is possible for a few problems where the data are censored or truncated, but in general, this is a more difficult scenario. Finally, for distributions where the moments do not exist or are infinite, method of moments is not available. As an alternative, one can use the percentile matching technique. 4.1.3.2 Percentile Matching Under percentile matching, we approximate the quantiles or percentiles of the parametric distribution using the empirical (nonparametric) quantiles or percentiles described in Section 4.1.1.3. Example 4.1.9. Property Fund. For the 2010 property fund, we illustrate matching on quantiles. In particular, the Pareto distribution is intuitively pleasing because of the closed-form solution for the quantiles. Recall that the distribution function for the Pareto distribution is \\[F(x) = 1 - \\left(\\frac{\\theta}{x+\\theta}\\right)^{\\alpha}.\\] Easy algebra shows that we can express the quantile as \\[F^{-1}(q) = \\theta \\left( (1-q)^{-1/\\alpha} -1 \\right).\\] for a fraction \\(q\\), \\(0&lt;q&lt;1\\). Determine estimates of the Pareto distribution parameters using the 25th and 95th empirical quantiles. Show Example Solution Solution. The 25th percentile (the first quartile) turns out to be \\(0.78853\\) and the 95th percentile is \\(50.98293\\) (both in thousands of dollars). With two equations \\[0.78853 = \\theta \\left( 1- (1-.25)^{-1/\\alpha} \\right) \\ \\ \\ \\ \\text{and} \\ \\ \\ \\ 50.98293 = \\theta \\left( 1- (1-.75)^{-1/\\alpha} \\right)\\] and two unknowns, the solution is \\[\\hat{\\alpha} = 0.9412076 \\ \\ \\ \\ \\ \\text{and} \\ \\ \\ \\ \\hat{\\theta} = 2.205617 .\\] We remark here that a numerical routine is required for these solutions as no analytic solution is available. Furthermore, recall that the maximum likelihood estimates are \\(\\hat{\\alpha}_{MLE} = 0.9990936\\) and \\(\\hat{\\theta}_{MLE} = 2.2821147\\), so the percentile matching provides a better approximation for the Pareto distribution than the method of moments. Example 4.1.10. Actuarial Exam Question. You are given: Losses follow a loglogistic distribution with cumulative distribution function: \\[F(x) = \\frac{\\left(x/\\theta\\right)^{\\gamma}}{1+\\left(x/\\theta\\right)^{\\gamma}}\\] The sample of losses is: \\[ \\begin{array}{ccccccccccc} 10 &amp;35 &amp;80 &amp;86 &amp;90 &amp;120 &amp;158 &amp;180 &amp;200 &amp;210 &amp;1500 \\\\ \\end{array} \\] Calculate the estimate of \\(\\theta\\) by percentile matching, using the 40th and 80th empirically smoothed percentile estimates. Show Example Solution Solution. With 11 observations, we have \\(j=\\lfloor(n+1)q\\rfloor = \\lfloor 12(0.4) \\rfloor = \\lfloor 4.8\\rfloor=4\\) and \\(h=(n+1)q-j = 12(0.4)-4=0.8\\). By interpolation, the 40th empirically smoothed percentile estimate is \\(\\hat{\\pi}_{0.4} = (1-h) X_{(j)} + h X_{(j+1)} = 0.2(86)+0.8(90)=89.2\\). Similarly, for the 80th empirically smoothed percentile estimate, we have \\(12(0.8)=9.6\\) so the estimate is \\(\\hat{\\pi}_{0.8} = 0.4(200)+0.6(210)=206\\). Using the loglogistic cumulative distribution, we need to solve the following two equations for parameters \\(\\theta\\) and \\(\\gamma\\): \\[0.4=\\frac{(89.2/\\theta)^\\gamma}{1+(89.2/\\theta)^\\gamma} \\ \\ \\ \\text{and} \\ \\ \\ \\ 0.8=\\frac{(206/\\theta)^\\gamma}{1+(206+\\theta)^\\gamma}\\] Solving for each parenthetical expression gives \\(\\frac{2}{3}=(89.2/\\theta)^\\gamma\\) and \\(4=(206/\\theta)^\\gamma\\). Taking the ratio of the second equation to the first gives \\(6=(206/89.2)^\\gamma \\Rightarrow \\gamma=\\frac{\\ln(6)}{\\ln(206/89.2)} = 2.1407\\). Then \\(4^{1/2.1407}=206/\\theta \\Rightarrow \\theta=107.8\\) Like the method of moments, percentile matching is almost too flexible in the sense that many estimators can be based on percentile matches; for example, one actuary can base estimation on the 25th and 95th percentiles whereas another actuary uses the 20th and 80th percentiles. In general these estimators will differ and there is no compelling reason to prefer one over the other. Also as with the method of moments, percentile matching is appealing because it provides a technique that can be readily applied in selected situations and has an intuitive basis. Although most actuarial applications use maximum likelihood estimators, it can be convenient to have alternative approaches such as method of moments and percentile matching available. Show Quiz Solution 4.2 Model Selection In this section, you learn how to: Describe the iterative model selection specification process Outline steps needed to select a parametric model Describe pitfalls of model selection based purely on insample data when compared to the advantages of out-of-sample model validation This section underscores the idea that model selection is an iterative process in which models are cyclically (re)formulated and tested for appropriateness before using them for inference. After an overview, we describe the model selection process based on: an in-sample or training dataset, an out-of-sample or test dataset, and a method that combines these approaches known as cross-validation. 4.2.1 Iterative Model Selection In our development, we examine the data graphically, hypothesize a model structure, and compare the data to a candidate model in order to formulate an improved model. Box (1980) describes this as an iterative process which is shown in Figure 4.10. Figure 4.10: The iterative model specification process. This iterative process provides a useful recipe for structuring the task of specifying a model to represent a set of data. The first step, the model formulation stage, is accomplished by examining the data graphically and using prior knowledge of relationships, such as from economic theory or industry practice. The second step in the iteration is fitting based on the assumptions of the specified model. These assumptions must be consistent with the data to make valid use of the model. The third step is diagnostic checking; the data and model must be consistent with one another before additional inferences can be made. Diagnostic checking is an important part of the model formulation; it can reveal mistakes made in previous steps and provide ways to correct these mistakes. The iterative process also emphasizes the skills you need to make analytics work. First, you need a willingness to summarize information numerically and portray this information graphically. Second, it is important to develop an understanding of model properties. You should understand how a probabilistic model behaves in order to match a set of data to it. Third, theoretical properties of the model are also important for inferring general relationships based on the behavior of the data. 4.2.2 Model Selection Based on a Training Dataset It is common to refer to a dataset used for analysis as an in-sample or training dataset. Techniques available for selecting a model depend upon whether the outcomes \\(X\\) are discrete, continuous, or a hybrid of the two, although the principles are the same. Graphical and other Basic Summary Measures. Begin by summarizing the data graphically and with statistics that do not rely on a specific parametric form, as summarized in Section 4.1. Specifically, you will want to graph both the empirical distribution and density functions. Particularly for loss data that contain many zeros and that can be skewed, deciding on the appropriate scale (e.g., logarithmic) may present some difficulties. For discrete data, tables are often preferred. Determine sample moments, such as the mean and variance, as well as selected quantiles, including the minimum, maximum, and the median. For discrete data, the mode (or most frequently occurring value) is usually helpful. These summaries, as well as your familiarity of industry practice, will suggest one or more candidate parametric models. Generally, start with the simpler parametric models (for example, one parameter exponential before a two parameter gamma), gradually introducing more complexity into the modeling process. Critique the candidate parametric model numerically and graphically. For the graphs, utilize the tools introduced in Section 4.1.2 such as \\(pp\\) and \\(qq\\) plots. For the numerical assessments, examine the statistical significance of parameters and try to eliminate parameters that do not provide additional information. Likelihood Ratio Tests. For comparing model fits, if one model is a subset of another, then a likelihood ratio test may be employed; the general approach to likelihood ratio testing is described in Sections 14.4.3 and 16.3.2. Goodness of Fit Statistics. Generally, models are not proper subsets of one another so overall goodness of fit statistics are helpful for comparing models. Information criteria are one type of goodness of statistic. The most widely used examples are Akaike’s Information Criterion (AIC) and the (Schwarz) Bayesian Information Criterion (BIC); they are widely cited because they can be readily generalized to multivariate settings. Section 14.4.4 provides a summary of these statistics. For selecting the appropriate distribution, statistics that compare a parametric fit to a nonparametric alternative, summarized in Section 4.1.2.2, are useful for model comparison. For discrete data, a goodness of fit statistic (as described in Section 2.7) is generally preferred as it is more intuitive and simpler to explain. 4.2.3 Model Selection Based on a Test Dataset Model validation is the process of confirming that the proposed model is appropriate, especially in light of the purposes of the investigation. An important limitation of the model selection process based only on insample data is that it can be susceptible to data-snooping, that is, fitting a great number of models to a single set of data. By looking at a large number of models, we may overfit the data and understate the natural variation in our representation. Selecting a model based only on insample data also does not support the goal of predictive inference. Particularly in actuarial applications, our goal is to make statements about new experience rather than a dataset at hand. For example, we use claims experience from one year to develop a model that can be used to price insurance contracts for the following year. As an analogy, we can think about the training data set as experience from one year that is used to predict the behavior of the next year’s test data set. We can respond to these criticisms by using a technique sometimes known as out-of-sample validation. The ideal situation is to have available two sets of data, one for training, or model development, and one for testing, or model validation. We initially develop one or several models on the first data set that we call our candidate models. Then, the relative performance of the candidate models can be measured on the second set of data. In this way, the data used to validate the model is unaffected by the procedures used to formulate the model. Random Split of the Data. Unfortunately, rarely will two sets of data be available to the investigator. However, we can implement the validation process by splitting the data set into training and test subsamples, respectively. Figure 4.11 illustrates this splitting of the data. Figure 4.11: Model Validation. A data set is randomly split into two subsamples. Various researchers recommend different proportions for the allocation. Snee (1977) suggests that data-splitting not be done unless the sample size is moderately large. The guidelines of Picard and Berk (1990) show that the greater the number of parameters to be estimated, the greater the proportion of observations needed for the model development subsample. Model Validation Statistics. Much of the literature supporting the establishment of a model validation process is based on regression and classification models that you can think of as an input-output problem (James et al. (2013)). That is, we have several inputs \\(x_1, \\ldots, x_k\\) that are related to an output \\(y\\) through a function such as \\[y = \\mathrm{g}\\left(x_1, \\ldots, x_k\\right).\\] One uses the training sample to develop an estimate of \\(\\mathrm{g}\\), say, \\(\\hat{\\mathrm{g}}\\), and then calibrate the distance from the observed outcomes to the predictions using a criterion of the form \\[\\begin{equation} \\sum_i \\mathrm{d}(y_i,\\hat{\\mathrm{g}}\\left(x_{i1}, \\ldots, x_{ik}\\right) ) . \\tag{4.4} \\end{equation}\\] Here, the sum i is over the test data. In many regression applications, it is common to use squared Euclidean distance of the form \\(\\mathrm{d}(y_i,\\mathrm{g}) = (y_i-\\mathrm{g})^2\\). In actuarial applications, Euclidean distance \\(\\mathrm{d}(y_i,\\mathrm{g}) = |y_i-\\mathrm{g}|\\) is often preferred because of the skewed nature of the data (large outlying values of \\(y\\) can have a large effect on the measure). Chapter 7 describes another measure, the Gini index, that is useful in actuarial applications particularly when there is a large proportion of zeros in claims data (corresponding to no claims). Selecting a Distribution. Still, our focus so far has been to select a distribution for a data set that can be used for actuarial modeling without additional inputs \\(x_1, \\ldots, x_k\\). Even in this more fundamental problem, the model validation approach is valuable. If we base all inference on only in-sample data, then there is a tendency to select more complicated models then needed. For example, we might select a four parameter GB2, generalized beta of the second kind, distribution when only a two parameter Pareto is needed. Information criteria such as AIC and BIC included penalties for model complexity and so provide some protection but using a test sample is the best guarantee to achieve parsimonious models. From a quote often attributed to Albert Einstein, we want to “use the simplest model as possible but no simpler.” 4.2.4 Model Selection Based on Cross-Validation Although out-of-sample validation is the gold standard in predictive modeling, it is not always practical to do so. The main reason is that we have limited sample sizes and the out-of-sample model selection criterion in equation (4.4) depends on a random split of the data. This means that different analysts, even when working the same data set and same approach to modeling, may select different models. This is likely in actuarial applications because we work with skewed data sets where there is a large chance of getting some very large outcomes and large outcomes may have a great influence on the parameter estimates. Cross-Validation Procedure. Alternatively, one may use cross-validation, as follows. The procedure begins by using a random mechanism to split the data into K subsets known as folds, where analysts typically use 5 to 10. Next, one uses the first K-1 subsamples to estimate model parameters. Then, “predict” the outcomes for the Kth subsample and use a measure such as in equation (4.4) to summarize the fit. Now, repeat this by holding out each of the K sub-samples, summarizing with a cumulative out-of-sample statistic. Repeat these steps for several candidate models and choose the model with the lowest cumulative out-of-sample statistic. Cross-validation is widely used because it retains the predictive flavor of the out-of-sample model validation process but, due to the re-use of the data, is more stable over random samples. Show Quiz Solution 4.3 Estimation using Modified Data In this section, you learn how to: Describe grouped, censored, and truncated data Estimate parametric distributions based on grouped, censored, and truncated data Estimate distributions nonparametrically based on grouped, censored, and truncated data 4.3.1 Parametric Estimation using Modified Data Basic theory and many applications are based on individual observations that are “complete” and “unmodified,” as we have seen in the previous section. Section 3.5 introduced the concept of observations that are “modified” due to two common types of limitations: censoring and truncation. For example, it is common to think about an insurance deductible as producing data that are truncated (from the left) or policy limits as yielding data that are censored (from the right). This viewpoint is from the primary insurer (the seller of the insurance). However, as we will see in Chapter 10, a reinsurer (an insurer of an insurance company) may not observe claims smaller than an amount, only that a claim exists, an example of censoring from the left. So, in this section, we cover the full gamut of alternatives. Specifically, this section will address parametric estimation methods for three alternatives to individual, complete, and unmodified data: interval-censored data available only in groups, data that are limited or censored, and data that may not be observed due to truncation. 4.3.1.1 Parametric Estimation using Grouped Data Consider a sample of size \\(n\\) observed from the distribution \\(F(\\cdot)\\), but in groups so that we only know the group into which each observation fell, not the exact value. This is referred to as grouped or interval-censored data. For example, we may be looking at two successive years of annual employee records. People employed in the first year but not the second have left sometime during the year. With an exact departure date (individual data), we could compute the amount of time that they were with the firm. Without the departure date (grouped data), we only know that they departed sometime during a year-long interval. Formalizing this idea, suppose there are \\(k\\) groups or intervals delimited by boundaries \\(c_0 &lt; c_1&lt; \\cdots &lt; c_k\\). For each observation, we only observe the interval into which it fell (e.g. \\((c_{j-1}, c_j)\\)), not the exact value. Thus, we only know the number of observations in each interval. The constants \\(\\{c_0 &lt; c_1 &lt; \\cdots &lt; c_k\\}\\) form some partition of the domain of \\(F(\\cdot)\\). Then the probability of an observation \\(X_i\\) falling in the \\(j\\)th interval is \\[\\Pr\\left(X _i \\in (c_{j-1}, c_j]\\right) = F(c_j) - F(c_{j-1}).\\] The corresponding probability mass function for an observation is \\[ \\begin{aligned} f(x) &amp;= \\begin{cases} F(c_1) - F(c_{0}) &amp; \\text{if }\\ x \\in (c_{0}, c_1]\\\\ \\vdots &amp; \\vdots \\\\ F(c_k) - F(c_{k-1}) &amp; \\text{if }\\ x \\in (c_{k-1}, c_k]\\\\ \\end{cases} \\\\ &amp;= \\prod_{j=1}^k \\left\\{F(c_j) - F(c_{j-1})\\right\\}^{I(x \\in (c_{j-1}, c_j])} \\end{aligned} \\] Now, define \\(n_j\\) to be the number of observations that fall in the \\(j\\)th interval, \\((c_{j-1}, c_j]\\). Thus, the likelihood function (with respect to the parameter(s) \\(\\theta\\)) is \\[ \\begin{aligned} \\mathcal{L}(\\theta) = \\prod_{j=1}^n f(x_i) = \\prod_{j=1}^k \\left\\{F(c_j) - F(c_{j-1})\\right\\}^{n_j} \\end{aligned} \\] And the log-likelihood function is \\[ \\begin{aligned} L(\\theta) = \\ln \\mathcal{L}(\\theta) = \\ln \\prod_{j=1}^n f(x_i) = \\sum_{j=1}^k n_j \\ln \\left\\{F(c_j) - F(c_{j-1})\\right\\} \\end{aligned} \\] Maximizing the likelihood function (or equivalently, maximizing the log-likelihood function) would then produce the maximum likelihood estimates for grouped data. Example 4.3.1. Actuarial Exam Question. You are given: Losses follow an exponential distribution with mean \\(\\theta\\). A random sample of 20 losses is distributed as follows: \\[ {\\small \\begin{array}{l|c} \\hline \\text{Loss Range} &amp; \\text{Frequency} \\\\ \\hline [0,1000] &amp; 7 \\\\ (1000,2000] &amp; 6 \\\\ (2000,\\infty) &amp; 7 \\\\ \\hline \\end{array} } \\] Calculate the maximum likelihood estimate of \\(\\theta\\). Show Example Solution Solution. \\[ \\begin{aligned} \\mathcal{L}(\\theta) &amp;= F(1000)^7[F(2000)-F(1000)]^6[1-F(2000)]^7 \\\\ &amp;= (1-e^{-1000/\\theta})^7(e^{-1000/\\theta} - e^{-2000/\\theta})^6(e^{-2000/\\theta})^7 \\\\ &amp;= (1-p)^7(p-p^2)^6(p^2)^7 \\\\ &amp;= p^{20}(1-p)^{13} \\end{aligned} \\] where \\(p=e^{-1000/\\theta}\\). Maximizing this expression with respect to \\(p\\) is equivalent to maximizing the likelihood with respect to \\(\\theta\\). The maximum occurs at \\(p=\\frac{20}{33}\\) and so \\(\\hat{\\theta}=\\frac{-1000}{\\ln(20/33)}= 1996.90\\). 4.3.1.2 Censored Data Censoring occurs when we record only a limited value of an observation. The most common form is right-censoring, in which we record the smaller of the “true” dependent variable and a censoring variable. Using notation, let \\(X\\) represent an outcome of interest, such as the loss due to an insured event or time until an event. Let \\(C_U\\) denote the censoring amount. With right-censored observations, we record \\(X_U^{\\ast}= \\min(X, C_U) = X \\wedge C_U\\). We also record whether or not censoring has occurred. Let \\(\\delta_U= I(X \\leq C_U)\\) be a binary variable that is 0 if censoring occurs and 1 if it does not. For an example that we saw in Section 3.4.2, \\(C_U\\) may represent the upper limit of coverage of an insurance policy (we used \\(u\\) for the upper limit in that section). The loss may exceed the amount \\(C_U\\), but the insurer only has \\(C_U\\) in its records as the amount paid out and does not have the amount of the actual loss \\(X\\) in its records. Similarly, with left-censoring, we record the larger of a variable of interest and a censoring variable. If \\(C_L\\) is used to represent the censoring amount, we record \\(X_L^{\\ast}= \\max(X, C_L)\\) along with the censoring indicator \\(\\delta_L= I(X \\geq C_L)\\). As an example, you got a brief introduction to reinsurance, insurance for insurers, in Section 3.4.4 and will see more in Chapter 10. Suppose a reinsurer will cover insurer losses greater than \\(C_L\\); this means that the reinsurer is responsible for the excess of \\(X_L^{\\ast}\\) over \\(C_L\\). Using notation, this is \\(Y = X_L^{\\ast} - C_L\\). To see this, first consider the case where the policyholder loss \\(X &lt; C_L\\). Then, the insurer will pay the entire claim and \\(Y =C_L- C_L=0\\), no loss for the reinsurer. For the second case, if the loss \\(X \\ge C_L\\), then \\(Y = X-C_L\\) represents the reinsurer’s retained claims. Put another way, if a loss occurs, the reinsurer records the actual amount if it exceeds the limit \\(C_L\\) and otherwise it only records that it had a loss of \\(0\\). 4.3.1.3 Truncated Data Censored observations are recorded for study, although in a limited form. In contrast, truncated outcomes are a type of missing data. An outcome is potentially truncated when the availability of an observation depends on the outcome. In insurance, it is common for observations to be left-truncated at \\(C_L\\) when the amount is \\[ \\begin{aligned} Y &amp;= \\left\\{ \\begin{array}{cl} \\text{we do not observe }X &amp; X &lt; C_L \\\\ X &amp; X \\geq C_L \\end{array} \\right.\\end{aligned} . \\] In other words, if \\(X\\) is less than the threshold \\(C_L\\), then it is not observed. For an example we saw in Section 3.4.1, \\(C_L\\) may represent the deductible of an insurance policy (we used \\(d\\) for the deductible in that section). If the insured loss is less than the deductible, then the insurer may not observe or record the loss at all. If the loss exceeds the deductible, then the excess \\(X-C_L\\) is the claim that the insurer covers. In Section 3.4.1, we defined the per payment loss to be \\[ Y^{P} = \\left\\{ \\begin{matrix} \\text{Undefined} &amp; X \\le d \\\\ X - d &amp; X &gt; d \\end{matrix} \\right. , \\] so that if a loss exceeds a deductible, we record the excess amount \\(X-d\\). This is very important when considering amounts that the insurer will pay. However, for estimation purposes of this section, it matters little if we substract a known constant such as \\(C_L=d\\). So, for our truncated variable \\(Y\\), we use the simpler convention and do not subract \\(d\\). Similarly for right-truncated data, if \\(X\\) exceeds a threshold \\(C_U\\), then it is not observed. In this case, the amount is \\[ \\begin{aligned} Y &amp;= \\left\\{ \\begin{array}{cl} X &amp; X \\leq C_U \\\\ \\text{we do not observe }X &amp; X &gt; C_U. \\end{array} \\right.\\end{aligned} \\] Classic examples of truncation from the right include \\(X\\) as a measure of distance to a star. When the distance exceeds a certain level \\(C_U\\), the star is no longer observable. Figure 4.12 compares truncated and censored observations. Values of \\(X\\) that are greater than the “upper” censoring limit \\(C_U\\) are not observed at all (right-censored), while values of \\(X\\) that are smaller than the “lower” truncation limit \\(C_L\\) are observed, but observed as \\(C_L\\) rather than the actual value of \\(X\\) (left-truncated). Figure 4.12: Censoring and Truncation Show Mortality Study Example Example – Mortality Study. Suppose that you are conducting a two-year study of mortality of high-risk subjects, beginning January 1, 2010 and finishing January 1, 2012. Figure 4.13 graphically portrays the six types of subjects recruited. For each subject, the beginning of the arrow represents that the the subject was recruited and the arrow end represents the event time. Thus, the arrow represents exposure time. Figure 4.13: Timeline for Several Subjects on Test in a Mortality Study Type A - Right-censored. This subject is alive at the beginning and the end of the study. Because the time of death is not known by the end of the study, it is right-censored. Most subjects are Type A. Type B - Complete information is available for a type B subject. The subject is alive at the beginning of the study and the death occurs within the observation period. Type C - Right-censored and left-truncated. A type C subject is right-censored, in that death occurs after the observation period. However, the subject entered after the start of the study and is said to have a delayed entry time. Because the subject would not have been observed had death occurred before entry, it is left-truncated. Type D - Left-truncated. A type D subject also has delayed entry. Because death occurs within the observation period, this subject is not right censored. Type E - Left-truncated. A type E subject is not included in the study because death occurs prior to the observation period. Type F - Right-truncated. Similarly, a type F subject is not included because the entry time occurs after the observation period. To summarize, for outcome \\(X\\) and constants \\(C_L\\) and \\(C_U\\), Limitation Type Limited Variable Recording Information right censoring \\(X_U^{\\ast}= \\min(X, C_U)\\) \\(\\delta_U= I(X \\leq C_U)\\) left censoring \\(X_L^{\\ast}= \\max(X, C_L)\\) \\(\\delta_L= I(X \\geq C_L)\\) interval censoring right truncation \\(X\\) observe \\(X\\) if \\(X \\leq C_U\\) left truncation \\(X\\) observe \\(X\\) if \\(X \\geq C_L\\) 4.3.1.4 Parametric Estimation using Censored and Truncated Data For simplicity, we assume non-random censoring amounts and a continuous outcome \\(X\\). To begin, consider the case of right-censored data where we record \\(X_U^{\\ast}= \\min(X, C_U)\\) and censoring indicator \\(\\delta= I(X \\leq C_U)\\). If censoring occurs so that \\(\\delta=0\\), then \\(X \\geq C_U\\) and the likelihood is \\(\\Pr(X \\geq C_U) = 1-F(C_U)\\). If censoring does not occur so that \\(\\delta=1\\), then \\(X &lt; C_U\\) and the likelihood is \\(f(x)\\). Summarizing, we have the likelihood of a single observation as \\[ \\begin{aligned} \\left\\{ \\begin{array}{ll} 1-F(C_U) &amp; \\text{if }\\delta=0 \\\\ f(x) &amp; \\text{if } \\delta = 1 \\end{array} \\right. = \\left\\{ f(x)\\right\\}^{\\delta} \\left\\{1-F(C_U)\\right\\}^{1-\\delta} . \\end{aligned} \\] The right-hand expression allows us to present the likelihood more compactly. Now, for an iid sample of size \\(n\\), the likelihood is \\[ \\mathcal{L} = \\prod_{i=1}^n \\left\\{ f(x_i)\\right\\}^{\\delta_i} \\left\\{1-F(C_{Ui})\\right\\}^{1-\\delta_i} = \\prod_{\\delta_i=1} f(x_i) \\prod_{\\delta_i=0} \\{1-F(C_{Ui})\\}, \\] with potential censoring times \\(\\{ C_{U1}, \\ldots,C_{Un} \\}\\). Here, the notation “\\(\\prod_{\\delta_i=1}\\)” means to take the product over uncensored observations, and similarly for “\\(\\prod_{\\delta_i=0}\\).” On the other hand, truncated data are handled in likelihood inference via conditional probabilities. Specifically, we adjust the likelihood contribution by dividing by the probability that the variable was observed. To summarize, we have the following contributions to the likelihood function for six types of outcomes: \\[ {\\small \\begin{array}{lc} \\hline \\text{Outcome} &amp; \\text{Likelihood Contribution} \\\\ \\hline \\text{exact value} &amp; f(x) \\\\ \\text{right-censoring} &amp; 1-F(C_U) \\\\ \\text{left-censoring} &amp; F(C_L) \\\\ \\text{right-truncation} &amp; f(x)/F(C_U) \\\\ \\text{left-truncation} &amp; f(x)/(1-F(C_L)) \\\\ \\text{interval-censoring} &amp; F(C_U)-F(C_L) \\\\ \\hline \\end{array} } \\] For known outcomes and censored data, the likelihood is \\[\\mathcal{L}(\\theta) = \\prod_{E} f(x_i) \\prod_{R} \\{1-F(C_{Ui})\\} \\prod_{L} F(C_{Li}) \\prod_{I} (F(C_{Ui})-F(C_{Li})),\\] where “\\(\\prod_{E}\\)” is the product over observations with Exact values, and similarly for Right-, Left- and Interval-censoring. For right-censored and left-truncated data, the likelihood is \\[\\mathcal{L} = \\prod_{E} \\frac{f(x_i)}{1-F(C_{Li})} \\prod_{R} \\frac{1-F(C_{Ui})}{1-F(C_{Li})},\\] and similarly for other combinations. To get further insights, consider the following. Show Special Case - Exponential Distribution Special Case: Exponential Distribution. Consider data that are right-censored and left-truncated, with random variables \\(X_i\\) that are exponentially distributed with mean \\(\\theta\\). With these specifications, recall that \\(f(x) = \\theta^{-1} \\exp(-x/\\theta)\\) and \\(F(x) = 1-\\exp(-x/\\theta)\\). For this special case, the log-likelihood is \\[ \\begin{aligned} L(\\theta) &amp;= \\sum_{E} \\left\\{ \\ln f(x_i) - \\ln (1-F(C_{Li})) \\right\\} + \\sum_{R}\\left\\{ \\ln (1-F(C_{Ui}))- \\ln (1-\\mathrm{F}(C_{Li})) \\right\\}\\\\ &amp;= \\sum_{E} (-\\ln \\theta -(x_i-C_{Li})/\\theta ) -\\sum_{R} (C_{Ui}-C_{Li})/\\theta . \\end{aligned} \\] To simplify the notation, define \\(\\delta_i = I(X_i \\geq C_{Ui})\\) to be a binary variable that indicates right-censoring. Let \\(X_i^{\\ast \\ast} = \\min(X_i, C_{Ui}) - C_{Li}\\) be the amount that the observed variable exceeds the lower truncation limit. With this, the log-likelihood is \\[\\begin{equation} L(\\theta) = - \\sum_{i=1}^n ((1-\\delta_i) \\ln \\theta + \\frac{x_i^{\\ast \\ast}}{\\theta}) \\tag{4.5} \\end{equation}\\] Taking derivatives with respect to the parameter \\(\\theta\\) and setting it equal to zero yields the maximum likelihood estimator \\[\\widehat{\\theta} = \\frac{1}{n_u} \\sum_{i=1}^n x_i^{\\ast \\ast},\\] where \\(n_u = \\sum_i (1-\\delta_i)\\) is the number of uncensored observations. Example 4.3.2. Actuarial Exam Question. You are given: A sample of losses is: 600 700 900 No information is available about losses of 500 or less. Losses are assumed to follow an exponential distribution with mean \\(\\theta\\). Calculate the maximum likelihood estimate of \\(\\theta\\). Show Example Solution Solution. These observations are truncated at 500. The contribution of each observation to the likelihood function is \\[\\frac{f(x)}{1-F(500)} = \\frac{\\theta^{-1}e^{-x/\\theta}}{e^{-500/\\theta}}\\] Then the likelihood function is \\[\\mathcal{L}(\\theta)= \\frac{\\theta^{-1} e^{-600/\\theta} \\theta^{-1} e^{-700/\\theta} \\theta^{-1} e^{-900/\\theta}}{(e^{-500/\\theta})^3} = \\theta^{-3}e^{-700/\\theta}\\] The log-likelihood is \\[L(\\theta) = \\ln\\mathcal{L}(\\theta) = -3\\ln \\theta - 700\\theta^{-1}\\] Maximizing this expression by setting the derivative with respect to \\(\\theta\\) equal to 0, we have \\[L&#39;(\\theta) = -3\\theta^{-1} + 700\\theta^{-2} = 0 \\ \\Rightarrow \\ \\hat{\\theta} = \\frac{700}{3} = 233.33\\] Example 4.3.3. Actuarial Exam Question. You are given the following information about a random sample: The sample size equals five. The sample is from a Weibull distribution with \\(\\tau=2\\). Two of the sample observations are known to exceed 50, and the remaining three observations are 20, 30, and 45. Calculate the maximum likelihood estimate of \\(\\theta\\). Show Example Solution Solution. The likelihood function is \\[ \\begin{aligned} \\mathcal{L}(\\theta) &amp;= f(20) f(30) f(45) [1-F(50)]^2 \\\\ &amp;= \\frac{2(20/\\theta)^2 e^{-(20/\\theta)^2}}{20} \\frac{2(30/\\theta)^2 e^{-(30/\\theta)^2}}{30} \\frac{2(45/\\theta)^2 e^{-(45/\\theta)^2}}{45}(e^{-(50/\\theta)^2})^2 \\\\ &amp;\\propto \\frac{1}{\\theta^6} e^{-8325/\\theta^2} \\end{aligned} \\] The natural logarithm of the above expression is \\(-6\\ln\\theta - \\frac{8325}{\\theta^2}\\). Maximizing this expression by setting its derivative to 0, we get \\[\\frac{-6}{\\theta} + \\frac{16650}{\\theta^3} = 0 \\ \\Rightarrow \\ \\hat{\\theta} = \\left(\\frac{16650}{6}\\right)^{\\frac{1}{2}} = 52.6783\\] 4.3.2 Nonparametric Estimation using Modified Data Nonparametric estimators provide useful benchmarks, so it is helpful to understand the estimation procedures for grouped, censored, and truncated data. 4.3.2.1 Grouped Data As we have seen in Section 4.3.1.1, observations may be grouped (also referred to as interval censored) in the sense that we only observe them as belonging in one of \\(k\\) intervals of the form \\((c_{j-1}, c_j]\\), for \\(j=1, \\ldots, k\\). At the boundaries, the empirical distribution function is defined in the usual way: \\[ F_n(c_j) = \\frac{\\text{number of observations } \\le c_j}{n}. \\] For other values of \\(x \\in (c_{j-1}, c_j)\\), we can estimate the distribution function with the ogive estimator, which linearly interpolates between \\(F_n(c_{j-1})\\) and \\(F_n(c_j)\\), i.e. the values of the boundaries \\(F_n(c_{j-1})\\) and \\(F_n(c_j)\\) are connected with a straight line. This can formally be expressed as \\[F_n(x) = \\frac{c_j-x}{c_j-c_{j-1}} F_n(c_{j-1}) + \\frac{x-c_{j-1}}{c_j-c_{j-1}} F_n(c_j) \\ \\ \\ \\text{for } c_{j-1} \\le x &lt; c_j\\] The corresponding density is \\[f_n(x) = F^{\\prime}_n(x) = \\frac{F_n(c_j)-F_n(c_{j-1})}{c_j - c_{j-1}} \\ \\ \\ \\text{for } c_{j-1} \\le x &lt; c_j .\\] Example 4.3.4. Actuarial Exam Question. You are given the following information regarding claim sizes for 100 claims: \\[ {\\small \\begin{array}{r|c} \\hline \\text{Claim Size} &amp; \\text{Number of Claims} \\\\ \\hline 0 - 1,000 &amp; 16 \\\\ 1,000 - 3,000 &amp; 22 \\\\ 3,000 - 5,000 &amp; 25 \\\\ 5,000 - 10,000 &amp; 18 \\\\ 10,000 - 25,000 &amp; 10 \\\\ 25,000 - 50,000 &amp; 5 \\\\ 50,000 - 100,000 &amp; 3 \\\\ \\text{over } 100,000 &amp; 1 \\\\ \\hline \\end{array} } \\] Using the ogive, calculate the estimate of the probability that a randomly chosen claim is between 2000 and 6000. Show Example Solution Solution. At the boundaries, the empirical distribution function is defined in the usual way, so we have \\[F_{100}(1000) = 0.16, \\ F_{100}(3000)=0.38, \\ F_{100}(5000)=0.63, \\ F_{100}(10000)=0.81\\] For other claim sizes, the ogive estimator linearly interpolates between these values: \\[F_{100}(2000) = 0.5F_{100}(1000) + 0.5F_{100}(3000) = 0.5(0.16)+0.5(0.38)=0.27\\] \\[F_{100}(6000)=0.8F_{100}(5000)+0.2F_{100}(10000) = 0.8(0.63)+0.2(0.81)=0.666\\] Thus, the probability that a claim is between 2000 and 6000 is \\(F_{100}(6000) - F_{100}(2000) = 0.666-0.27 = 0.396\\). 4.3.2.2 Right-Censored Empirical Distribution Function It can be useful to calibrate parametric estimators with nonparametric methods that do not rely on a parametric form of the distribution. The product-limit estimator due to (Kaplan and Meier 1958) is a well-known estimator of the distribution function in the presence of censoring. Motivation for the Kaplan-Meier Product Limit Estimator. To explain why the product-limit works so well with censored observations, let us first return to the “usual” case without censoring. Here, the empirical distribution function \\(F_n(x)\\) is an unbiased estimator of the distribution function \\(F(x)\\). This is because \\(F_n(x)\\) is the average of indicator variables each of which are unbiased, that is, \\(\\mathrm{E~} I(X_i \\le x) = \\Pr(X_i \\le x) = F(x)\\). Now suppose the the random outcome is censored on the right by a limiting amount, say, \\(C_U\\), so that we record the smaller of the two, \\(X^* = \\min(X, C_U)\\). For values of \\(x\\) that are smaller than \\(C_U\\), the indicator variable still provides an unbiased estimator of the distribution function before we reach the censoring limit. That is, \\(\\mathrm{E~} I(X^* \\le x) = F(x)\\) because \\(I(X^* \\le x) = I(X \\le x)\\) for \\(x &lt; C_U\\). In the same way, \\(\\mathrm{E~} I(X^* &gt; x) = 1 -F(x) = S(x)\\). But, for \\(x&gt;C_U\\), \\(I(X^* \\le x)\\) is in general not an unbiased estimator of \\(F(x)\\). As an alternative, consider two random variables that have different censoring limits. For illustration, suppose that we observe \\(X_1^* = \\min(X_1, 5)\\) and \\(X_2^* = \\min(X_2, 10)\\) where \\(X_1\\) and \\(X_2\\) are independent draws from the same distribution. For \\(x \\le 5\\), the empirical distribution function \\(F_2(x)\\) is an unbiased estimator of \\(F(x)\\). However, for \\(5 &lt; x \\le 10\\), the first observation cannot be used for the distribution function because of the censoring limitation. Instead, the strategy developed by (Kaplan and Meier 1958) is to use \\(S_2(5)\\) as an estimator of \\(S(5)\\) and then to use the second observation to estimate the survival function conditional on survival to time 5, \\(\\Pr(X &gt; x | X &gt;5) = \\frac{S(x)}{S(5)}\\). Specifically, for \\(5 &lt; x \\le 10\\), the estimator of the survival function is \\[ \\hat{S}(x) = S_2(5) \\times I(X_2^* &gt; x ) . \\] Kaplan-Meier Product Limit Estimator. Extending this idea, for each observation \\(i\\), let \\(u_i\\) be the upper censoring limit (\\(=\\infty\\) if no censoring). Thus, the recorded value is \\(x_i\\) in the case of no censoring and \\(u_i\\) if there is censoring. Let \\(t_{1} &lt;\\cdots&lt; t_{k}\\) be \\(k\\) distinct points at which an uncensored loss occurs, and let \\(s_j\\) be the number of uncensored losses \\(x_i\\)’s at \\(t_{j}\\). The corresponding risk set is the number of observations that are active (not censored) at a value less than \\(t_{j}\\), denoted as \\(R_j = \\sum_{i=1}^n I(x_i \\geq t_{j}) + \\sum_{i=1}^n I(u_i \\geq t_{j})\\). With this notation, the product-limit estimator of the distribution function is \\[\\begin{equation} \\hat{F}(x) = \\left\\{ \\begin{array}{ll} 0 &amp; x&lt;t_{1} \\\\ 1-\\prod_{j:t_{j} \\leq x}\\left( 1-\\frac{s_j}{R_{j}}\\right) &amp; x \\geq t_{1} \\end{array} \\right. .\\tag{4.6} \\end{equation}\\] As usual, the corresponding estimate of the survival function is \\(\\hat{S}(x) = 1 - \\hat{F}(x)\\). Example 4.3.5. Actuarial Exam Question. The following is a sample of 10 payments: \\[ \\begin{array}{cccccccccc} 4 &amp;4 &amp;5+ &amp;5+ &amp;5+ &amp;8 &amp;10+ &amp;10+ &amp;12 &amp;15 \\\\ \\end{array} \\] where \\(+\\) indicates that a loss has exceeded the policy limit. Using the Kaplan-Meier product-limit estimator, calculate the probability that the loss on a policy exceeds 11, \\(\\hat{S}(11)\\). Show Example Solution Solution. There are four event times (non-censored observations). For each time \\(t_j\\), we can calculate the number of events \\(s_j\\) and the risk set \\(R_j\\) as the following: \\[ \\begin{array}{cccc} \\hline j &amp; t_j &amp; s_j &amp; R_j \\\\ \\hline 1 &amp; 4 &amp; 2 &amp; 10 \\\\ 2 &amp; 8 &amp; 1 &amp; 5 \\\\ 3 &amp; 12 &amp; 1 &amp; 2 \\\\ 4 &amp; 15 &amp; 1 &amp; 1 \\\\ \\hline \\end{array} \\] Thus, the Kaplan-Meier estimate of \\(S(11)\\) is \\[ \\begin{aligned} \\hat{S}(11) &amp;= \\prod_{j:t_j\\leq 11} \\left( 1- \\frac{s_j}{R_j} \\right) = \\prod_{j=1}^{2} \\left( 1- \\frac{s_j}{R_j} \\right)\\\\ &amp;= \\left(1-\\frac{2}{10} \\right) \\left(1-\\frac{1}{5} \\right) = (0.8)(0.8)= 0.64. \\\\ \\end{aligned} \\] Example. 4.3.6. Bodily Injury Claims. We consider again the Boston auto bodily injury claims data from Derrig, Ostaszewski, and Rempala (2001) that was introduced in Example 4.1.11. In that example, we omitted the 17 claims that were censored by policy limits. Now, we include the full dataset and use the Kaplan-Meier product limit to estimate the survival function. This is given in Figure 4.14. Figure 4.14: Kaplan-Meier Estimate of the Survival Function for Bodily Injury Claims Show R Code library(survival) # for Surv(), survfit() ## KM estimate KM0 &lt;- survfit(Surv(AmountPaid, UnCensored) ~ 1, type=&quot;kaplan-meier&quot;, data=BIData) plot(KM0, conf.int=FALSE, xlab=&quot;x&quot;,ylab=&quot;Kaplan Meier Survival&quot;) 4.3.2.3 Right-Censored, Left-Truncated Empirical Distribution Function In addition to right-censoring, we now extend the framework to allow for left-truncated data. As before, for each observation \\(i\\), let \\(u_i\\) be the upper censoring limit (\\(=\\infty\\) if no censoring). Further, let \\(d_i\\) be the lower truncation limit (0 if no truncation). Thus, the recorded value (if it is greater than \\(d_i\\)) is \\(x_i\\) in the case of no censoring and \\(u_i\\) if there is censoring. Let \\(t_{1} &lt;\\cdots&lt; t_{k}\\) be \\(k\\) distinct points at which an event of interest occurs, and let \\(s_j\\) be the number of recorded events \\(x_i\\)’s at time point \\(t_{j}\\). The corresponding risk set is \\[R_j = \\sum_{i=1}^n I(x_i \\geq t_{j}) + \\sum_{i=1}^n I(u_i \\geq t_{j}) - \\sum_{i=1}^n I(d_i \\geq t_{j}).\\] With this new definition of the risk set, the product-limit estimator of the distribution function is as in equation (4.6). Greenwood’s Formula. (Greenwood 1926) derived the formula for the estimated variance of the product-limit estimator to be \\[\\widehat{Var}(\\hat{F}(x)) = (1-\\hat{F}(x))^{2} \\sum _{j:t_{j} \\leq x} \\dfrac{s_j}{R_{j}(R_{j}-s_j)}.\\] R‘s survfit method takes a survival data object and creates a new object containing the Kaplan-Meier estimate of the survival function along with confidence intervals. The Kaplan-Meier method (type='kaplan-meier') is used by default to construct an estimate of the survival curve. The resulting discrete survival function has point masses at the observed event times (discharge dates) \\(t_j\\), where the probability of an event given survival to that duration is estimated as the number of observed events at the duration \\(s_j\\) divided by the number of subjects exposed or ’at-risk’ just prior to the event duration \\(R_j\\). Two alternate types of estimation are also available for the survfit method. The alternative (type='fh2') handles ties, in essence, by assuming that multiple events at the same duration occur in some arbitrary order. Another alternative (type='fleming-harrington') uses the Nelson-Aalen (see (Aalen 1978)) estimate of the cumulative hazard function to obtain an estimate of the survival function. The estimated cumulative hazard \\(\\hat{H}(x)\\) starts at zero and is incremented at each observed event duration \\(t_j\\) by the number of events \\(s_j\\) divided by the number at risk \\(R_j\\). With the same notation as above, the Nelson-Äalen estimator of the distribution function is \\[ \\begin{aligned} \\hat{F}_{NA}(x) &amp;= \\left\\{ \\begin{array}{ll} 0 &amp; x&lt;t_{1} \\\\ 1- \\exp \\left(-\\sum_{j:t_{j} \\leq x}\\frac{s_j}{R_j} \\right) &amp; x \\geq t_{1} \\end{array} \\right. .\\end{aligned} \\] Note that the above expression is a result of the Nelson-Äalen estimator of the cumulative hazard function \\[\\hat{H}(x)=\\sum_{j:t_j\\leq x} \\frac{s_j}{R_j} \\] and the relationship between the survival function and cumulative hazard function, \\(\\hat{S}_{NA}(x)=e^{-\\hat{H}(x)}\\). Example 4.3.7. Actuarial Exam Question. For observation \\(i\\) of a survival study: \\(d_i\\) is the left truncation point \\(x_i\\) is the observed value if not right censored \\(u_i\\) is the observed value if right censored You are given: \\[ {\\small \\begin{array}{c|cccccccccc} \\hline \\text{Observation } (i) &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 &amp; 9 &amp; 10\\\\ \\hline d_i &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1.3 &amp; 1.5 &amp; 1.6\\\\ x_i &amp; 0.9 &amp; - &amp; 1.5 &amp; - &amp; - &amp; 1.7 &amp; - &amp; 2.1 &amp; 2.1 &amp; - \\\\ u_i &amp; - &amp; 1.2 &amp; - &amp; 1.5 &amp; 1.6 &amp; - &amp; 1.7 &amp; - &amp; - &amp; 2.3 \\\\ \\hline \\end{array} } \\] Calculate the Kaplan-Meier product-limit estimate, \\(\\hat{S}(1.6)\\) Show Example Solution Solution. Recall the risk set \\(R_j = \\sum_{i=1}^n \\left\\{ I(x_i \\geq t_{j}) + I(u_i \\geq t_{j}) - I(d_i \\geq t_{j}) \\right\\}\\). Then \\[ \\begin{array}{ccccc} \\hline j &amp; t_j &amp; s_j &amp; R_j &amp; \\hat{S}(t_j) \\\\ \\hline 1 &amp; 0.9 &amp; 1 &amp; 10-3 = 7 &amp; 1-\\frac{1}{7} = \\frac{6}{7} \\\\ 2 &amp; 1.5 &amp; 1 &amp; 8-2 = 6 &amp; \\frac{6}{7}\\left( 1 - \\frac{1}{6} \\right) = \\frac{5}{7}\\\\ 3 &amp; 1.7 &amp; 1 &amp; 5-0 = 5 &amp; \\frac{5}{7}\\left( 1 - \\frac{1}{5} \\right) = \\frac{4}{7}\\\\ 4 &amp; 2.1 &amp; 2 &amp; 3 &amp; \\frac{4}{7}\\left( 1 - \\frac{2}{3}\\right) = \\frac{4}{21}\\\\ \\hline \\end{array} \\] The Kaplan-Meier estimate is therefore \\(\\hat{S}(1.6) = \\frac{5}{7}\\). Example 4.3.8. Actuarial Exam Question. - Continued. Using the Nelson-Äalen estimator, calculate the probability that the loss on a policy exceeds 11, \\(\\hat{S}_{NA}(11)\\). Calculate Greenwood’s approximation to the variance of the product-limit estimate \\(\\hat{S}(11)\\). Show Example Solution Solution. As before, there are four event times (non-censored observations). For each time \\(t_j\\), we can calculate the number of events \\(s_j\\) and the risk set \\(R_j\\) as the following: \\[ \\begin{array}{cccc} \\hline j &amp; t_j &amp; s_j &amp; R_j \\\\ \\hline 1 &amp; 4 &amp; 2 &amp; 10 \\\\ 2 &amp; 8 &amp; 1 &amp; 5 \\\\ 3 &amp; 12 &amp; 1 &amp; 2 \\\\ 4 &amp; 15 &amp; 1 &amp; 1 \\\\ \\hline \\end{array} \\] The Nelson-Äalen estimate of \\(S(11)\\) is \\(\\hat{S}_{NA}(11)=e^{-\\hat{H}(11)} = e^{-0.4} = 0.67\\), since \\[ \\begin{aligned} \\hat{H}(11) &amp;= \\sum_{j:t_j\\leq 11} \\frac{s_j}{R_j} = \\sum_{j=1}^{2} \\frac{s_j}{R_j} \\\\ &amp;= \\frac{2}{10} + \\frac{1}{5} = 0.2 + 0.2 = 0.4 .\\\\ \\end{aligned} \\] From earlier work, the Kaplan-Meier estimate of \\(S(11)\\) is \\(\\hat{S}(11) = 0.64\\). Then Greenwood’s estimate of the variance of the product-limit estimate of \\(S(11)\\) is \\[ \\begin{aligned} \\widehat{Var}(\\hat{S}(11)) &amp;= (\\hat{S}(11))^2 \\sum_{j:t_j\\leq 11} \\frac{s_j}{R_j(R_j-s_j)} &amp;= (0.64)^2 \\left(\\frac{2}{10(8)} + \\frac{1}{5(4)} \\right) = 0.0307. \\\\ \\end{aligned} \\] Show Quiz Solution 4.4 Bayesian Inference In this section, you learn how to: Describe the Bayesian model as an alternative to the frequentist approach and summarize the five components of this modeling approach. Summarize posterior distributions of parameters and use these posterior distributions to predict new outcomes. Use conjugate distributions to determine posterior distributions of parameters. 4.4.1 Introduction to Bayesian Inference Up to this point, our inferential methods have focused on the frequentist setting, in which samples are repeatedly drawn from a population. The vector of parameters \\(\\boldsymbol \\theta\\) is fixed yet unknown, whereas the outcomes \\(X\\) are realizations of random variables. In contrast, under the Bayesian framework, we view both the model parameters and the data as random variables. We are uncertain about the parameters \\(\\boldsymbol \\theta\\) and use probability tools to reflect this uncertainty. To get a sense of the Bayesian framework, begin by recalling Bayes’ rule \\[ \\Pr(parameters|data) = \\frac{\\Pr(data|parameters) \\times \\Pr(parameters)}{\\Pr(data)} \\] where \\(\\Pr(parameters)\\) is the distribution of the parameters, known as the prior distribution. \\(\\Pr(data | parameters)\\) is the sampling distribution. In a frequentist context, it is used for making inferences about the parameters and is known as the likelihood. \\(\\Pr(parameters | data)\\) is the distribution of the parameters having observed the data, known as the posterior distribution. \\(\\Pr(data)\\) is the marginal distribution of the data. It is generally obtained by integrating (or summing) the joint distribution of data and parameters over parameter values. Why Bayes? There are several advantages of the Bayesian approach. First, we can describe the entire distribution of parameters conditional on the data. This allows us, for example, to provide probability statements regarding the likelihood of parameters. Second, the Bayesian approach provides a unified approach for estimating parameters. Some non-Bayesian methods, such as least squares, require a separate approach to estimate variance components. In contrast, in Bayesian methods, all parameters can be treated in a similar fashion. This is convenient for explaining results to consumers of the data analysis. Third, this approach allows analysts to blend prior information known from other sources with the data in a coherent manner. This topic is developed in detail in the credibility chapter. Fourth, Bayesian analysis is particularly useful for forecasting future responses. Poisson - Gamma Special Case. To develop intuition, we consider the Poisson-Gamma case that holds a prominent position in actuarial applications. The idea is to consider a set of random variables \\(X_1, \\ldots, X_n\\) where each \\(X_i\\) could represent the number of claims for the ith policyholder. Assume that \\(X_i\\) has a Poisson distribution with parameter \\(\\lambda\\), analogous to the likelihood that we first saw in Chapter 2. In a non-Bayesian (or frequentist) context, the parameter \\(\\lambda\\) is viewed as an unknown quantity that is not random (it is said to be “fixed”). In the Bayesian context, the unknown parameter \\(\\lambda\\) is viewed as uncertain and is modeled as a random variable. In this special case, we use the gamma distribution to reflect this uncertainty, the prior distribution. Think of the following two-stage sampling scheme to motivate our probabilistic set-up. In the first stage, the parameter \\(\\lambda\\) is drawn from a gamma distribution. In the second stage, for that value of \\(\\lambda\\), there are \\(n\\) draws from the same (identical) Poisson distribution that are independent, conditional on \\(\\lambda\\). From this simple set-up, some important conclusions emerge. The distribution of \\(X_i\\) is no longer Poisson. For a special case, it turns out to be a negative binomial distribution (see the following “Snippet of Theory”). The random variables \\(X_1, \\ldots, X_n\\) are not independent. This is because they share the common random variable \\(\\lambda\\). As in the frequentist context, the goal is to make statments about likely values of parameters such as \\(\\lambda\\) given the observed data \\(X_1, \\ldots, X_n\\). However, because now both the parameter and the data are random variables, we can use the language of conditional probability to make such statements. As we will see in Section 4.4.4, it turns out that the distribution of \\(\\lambda\\) given the data \\(X_1, \\ldots, X_n\\) is also gamma (with updated parameters), a result that simplifies the task of inferring likely values of the parameter \\(\\lambda\\). Show A Snippet of Theory Let us demonstrate that the distribution of \\(X\\) is negative binomial. We assume that the distribution of \\(X\\) given \\(\\lambda\\) is Poisson, so that \\[ \\Pr(X = x|\\lambda) = \\frac{\\lambda^x}{\\Gamma(x+1)} e^{-\\lambda} , \\] using notation \\(\\Gamma(x+1) = x!\\) for integer \\(x\\). Assume that \\(\\lambda\\) is a draw from a gamma distribution with fixed parameters, say, \\(\\alpha\\) and \\(\\theta\\), so this has pdf \\[ f(\\lambda) = \\frac{\\lambda^{\\alpha-1}}{\\theta^{\\alpha}\\Gamma(\\alpha)}\\exp(-\\lambda/\\theta). \\] We know that a pdf integrates to one. To make the development easier, define the reciprocal parameter \\(\\theta_r = 1/\\theta\\) and so we have \\[ \\int_0^{\\infty} f(\\lambda) ~d\\lambda =1 ~~~ ==&gt; ~~~ \\theta_r^{-\\alpha} \\Gamma(\\alpha) = \\int_0^{\\infty} \\lambda^{\\alpha-1} \\exp\\left(-\\lambda\\theta_r\\right) ~ d\\lambda . \\] From Appendix Chapter 15 on iterated expectations, we have that the pmf of \\(X\\) can be computed in an iterated fashion as \\[ \\begin{aligned} \\Pr(X = x) &amp;= \\mathrm{E} \\left\\{\\Pr(X = x|\\lambda)\\right\\}\\\\ &amp;= \\int_0^{\\infty} \\Pr(X = x|\\lambda) f(\\lambda) ~d\\lambda \\\\ &amp;= \\int_0^{\\infty} \\frac{\\lambda^x}{\\Gamma(x+1)} e^{-\\lambda} \\frac{\\lambda^{\\alpha-1}}{\\theta^{\\alpha}\\Gamma(\\alpha)}\\exp(-\\lambda/\\theta) ~d\\lambda\\\\ &amp;= \\frac{1}{\\theta^{\\alpha}\\Gamma(x+1)\\Gamma(\\alpha)} \\int_0^{\\infty} \\lambda^{x+\\alpha-1} \\exp\\left(-\\lambda(1+\\frac{1}{\\theta})\\right) ~d\\lambda \\\\ &amp;= \\frac{1}{\\theta^{\\alpha}\\Gamma(x+1)\\Gamma(\\alpha)} \\Gamma(x+\\alpha)\\left(1+\\frac{1}{\\theta}\\right)^{-(x+\\alpha)} \\\\ &amp;= \\frac{\\Gamma(x+\\alpha)}{\\Gamma(x+1)\\Gamma(\\alpha)}\\left(\\frac{1}{1+\\theta}\\right)^{\\alpha} \\left(\\frac{\\theta}{1+\\theta}\\right)^{x} .\\\\ \\end{aligned} \\] Here, we used the gamma distribution equality with the substitution \\(\\theta_r = 1 + 1/\\theta\\). As can be seen from Section 2.2.3.3, this is a negative binomial distribution with parameter \\(r = \\alpha\\) and \\(\\beta = \\theta\\). In this chapter, we use small examples that can be done by hand in order to focus on the foundations. For practical implementation, analysts rely heavily on simulation methods using modern computational methods such as Markov Chain Monte Carlo (MCMC) simulation. We will get an exposure to simulation techniques in Chapter 6 but more intensive techniques such as MCMC requires yet more background. See Hartman (2016) for an introduction to computational Bayesian methods from an actuarial perspective. 4.4.2 Bayesian Model With the intuition developed in the preceding Section 4.4.1, we now restate the Bayesian model with a bit more precision using mathematical notation. For simplicity, this summary assumes both the outcomes and parameters are continuous random variables. In the examples, we sometimes ask the viewer to apply these same principles to discrete versions. Conceptually both the continuous and discrete cases are the same; mechanically, one replaces a pdf by a pmf and an integral by a sum. As stated earlier, under the Bayesian perspective, the model parameters and data are both viewed as random. Our uncertainty about the parameters of the underlying data generating process is reflected in the use of probability tools. Prior Distribution. Specifically, think about parameters \\(\\boldsymbol \\theta\\) as a random vector and let \\(\\pi(\\boldsymbol \\theta)\\) denote the distribution of possible outcomes. This is knowledge that we have before outcomes are observed and is called the prior distribution. Typically, the prior distribution is a regular distribution and so integrates or sums to one, depending on whether \\(\\boldsymbol \\theta\\) is continuous or discrete. However, we may be very uncertain (or have no clue) about the distribution of \\(\\boldsymbol \\theta\\); the Bayesian machinery allows the following situation \\[\\int \\pi(\\theta) d\\theta = \\infty,\\] in which case \\(\\pi(\\cdot)\\) is called an improper prior. Model Distribution. The distribution of outcomes given an assumed value of \\(\\boldsymbol \\theta\\) is known as the model distribution and denoted as \\(f(x | \\boldsymbol \\theta) = f_{X|\\boldsymbol \\theta} (x|\\boldsymbol \\theta )\\). This is the usual frequentist mass or density function. This is simply the likelihood in the frequentist context and so it is also convenient to use this as a descriptor for the model distribution. Joint Distribution. The distribution of outcomes and model parameters is, unsurprisingly, known as the joint distribution and denoted as \\(f(x , \\boldsymbol \\theta) = f(x|\\boldsymbol \\theta )\\pi(\\boldsymbol \\theta)\\). Marginal Outcome Distribution. The distribution of outcomes can be expressed as \\[f(x) = \\int f(x | \\boldsymbol \\theta)\\pi(\\boldsymbol \\theta) ~d \\boldsymbol \\theta.\\] This is analogous to a frequentist mixture distribution. In the mixture distribution, we combined (or “mixed”) different subpopulations. In the Bayesian context, the marginal distribution is a combination of different realizations of parameters (in some literatures, you can think about this as combining different “states of nature”). Posterior Distribution of Parameters. After outcomes have been observed (hence the terminology “posterior”), one can use Bayes theorem to write the distribution as \\[\\pi(\\boldsymbol \\theta | x) =\\frac{f(x , \\boldsymbol \\theta)}{f(x)} =\\frac{f(x|\\boldsymbol \\theta )\\pi(\\boldsymbol \\theta)}{f(x)}\\] The idea is to update your knowledge of the distribution of \\(\\boldsymbol \\theta\\) (\\(\\pi(\\boldsymbol \\theta)\\)) with the data \\(x\\). Making statements about potential values of parameters is an important aspect of statistical inference. 4.4.3 Bayesian Inference 4.4.3.1 Summarizing the Posterior Distribution of Parameters One way to summarize a distribution is to use a confidence interval type statement. To summarize the posterior distribution of parameters, the interval \\([a,b]\\) is said to be a \\(100(1-\\alpha)\\%\\) credibility interval for \\(\\boldsymbol \\theta\\) if \\[\\Pr (a \\le \\theta \\le b | \\mathbf{x}) \\ge 1- \\alpha.\\] For another approach to summarization, we can look to classical decision analysis. In this set-up, the loss function \\(l(\\hat{\\theta}, \\theta)\\) determines the penalty paid for using the estimate \\(\\hat{\\theta}\\) instead of the true \\(\\theta\\). The Bayes estimate is the value that minimizes the expected loss \\(\\mathrm{E~}[ l(\\hat{\\theta}, \\theta)]\\). Some important special cases include: \\[ {\\small \\begin{array}{cll} \\hline \\text{Loss function } l(\\hat{\\theta}, \\theta) &amp; \\text{Descriptor} &amp; \\text{Bayes Estimate} \\\\ \\hline (\\hat{\\theta}- \\theta)^2 &amp; \\text{squared error loss} &amp; \\mathrm{E}(\\theta|X) \\\\ |\\hat{\\theta}- \\theta| &amp; \\text{absolute deviation loss} &amp; \\text{median of } \\pi(\\theta|x) \\\\ I(\\hat{\\theta} =\\theta) &amp; \\text{zero-one loss (for discrete probabilities)} &amp; \\text{mode of } \\pi(\\theta|x) \\\\ \\hline \\end{array} } \\] Minimizing expected loss is a rigorous method for providing a single “best guess” about a likely value of a parameter, comparable to a frequentist estimator of the unknown (fixed) parameter. Example 4.4.1. Actuarial Exam Question. You are given: In a portfolio of risks, each policyholder can have at most one claim per year. The probability of a claim for a policyholder during a year is \\(q\\). The prior density is \\[\\pi(q) = q^3/0.07, \\ \\ \\ 0.6 &lt; q &lt; 0.8\\] A randomly selected policyholder has one claim in Year 1 and zero claims in Year 2. For this policyholder, calculate the posterior probability that \\(0.7 &lt; q &lt; 0.8\\). Show Example Solution Solution. The posterior density is proportional to the product of the likelihood function and prior density. Thus, \\[\\pi(q|1,0) \\propto f(1|q)\\ f(0|q)\\ \\pi(q) \\propto q(1-q)q^3 = q^4-q^5\\] To get the exact posterior density, we integrate the above function over its range \\((0.6, 0.8)\\) \\[\\int_{0.6}^{0.8} q^4-q^5 dq = \\frac{q^5}{5} - \\left. \\frac{q^6}{6} \\right|_{0.6}^{0.8} = 0.014069 \\ \\Rightarrow \\ \\pi(q|1,0)=\\frac{q^4-q^5}{0.014069}\\] Then \\[\\Pr(0.7&lt;q&lt;0.8|1,0)= \\int_{0.7}^{0.8} \\frac{q^4-q^5}{0.014069}dq = 0.5572\\] Example 4.4.2. Actuarial Exam Question. You are given: The prior distribution of the parameter \\(\\Theta\\) has probability density function: \\[\\pi(\\theta) = \\frac{1}{\\theta^2}, \\ \\ 1 &lt; \\theta &lt; \\infty\\] Given \\(\\Theta = \\theta\\), claim sizes follow a Pareto distribution with parameters \\(\\alpha=2\\) and \\(\\theta\\). A claim of 3 is observed. Calculate the posterior probability that \\(\\Theta\\) exceeds 2. Show Example Solution Solution: The posterior density, given an observation of 3 is \\[\\pi(\\theta|3) = \\frac{f(3|\\theta)\\pi(\\theta)}{\\int_1^\\infty f(3|\\theta)\\pi(\\theta)d\\theta} = \\frac{\\frac{2\\theta^2}{(3+\\theta)^3}\\frac{1}{\\theta^2}}{\\int_1^\\infty 2(3+\\theta)^{-3} d\\theta} = \\frac{2(3+\\theta)^{-3}}{\\left. -(3+\\theta)^{-2}\\right|_1^\\infty} = 32(3+\\theta)^{-3}, \\ \\ \\theta &gt; 1\\] Then \\[\\Pr(\\Theta&gt;2|3) = \\int_2^\\infty 32(3+\\theta)^{-3}d\\theta = \\left. -16(3+\\theta)^{-2} \\right|_2^\\infty = \\frac{16}{25} = 0.64\\] 4.4.3.2 Bayesian Predictive Distribution For another type of statistical inference, it is often of interest to “predict” the value of a random outcome that is yet to be observed. Specifically, for new data \\(y\\), the predictive distribution is \\[f(y|x) = \\int f(y|\\theta) \\pi(\\theta|x) d\\theta .\\] It is also sometimes called a “posterior” distribution as the distribution of the new data is conditional on a base set of data. Using squared error loss for the loss function, the Bayesian prediction of \\(Y\\) is \\[ \\begin{aligned} \\mathrm{E}(Y|X) &amp;= \\int ~y f(y|X) dy = \\int y \\left(\\int f(y|\\theta) \\pi(\\theta|X) d\\theta \\right) dy \\\\ &amp;= \\int \\mathrm{E}(Y|\\theta) \\pi(\\theta|X) ~d\\theta . \\end{aligned} \\] As noted earlier, for some situations the distribution of parameters is discrete, not continuous. Having a discrete set of possible parameters allow us to think of them as alternative “states of nature,” a helpful interpretation. Example 4.4.3. Actuarial Exam Question. For a particular policy, the conditional probability of the annual number of claims given \\(\\Theta = \\theta\\), and the probability distribution of \\(\\Theta\\) are as follows: \\[ {\\small \\begin{array}{l|ccc} \\hline \\text{Number of Claims} &amp; 0 &amp; 1 &amp; 2 \\\\ \\text{Probability} &amp; 2\\theta &amp; \\theta &amp; 1-3\\theta \\\\ \\hline \\end{array} } \\] \\[ {\\small \\begin{array}{l|cc} \\hline \\theta &amp; 0.05 &amp; 0.30 \\\\ \\text{Probability} &amp; 0.80 &amp; 0.20 \\\\ \\hline \\end{array} } \\] Two claims are observed in Year 1. Calculate the Bayesian prediction of the number of claims in Year 2. Show Example Solution Solution. Start with the posterior distribution of the parameter \\[ \\Pr(\\theta|X) = \\frac{\\Pr(X|\\theta)\\Pr(\\theta)}{\\sum_{\\theta}\\Pr(X|\\theta)\\Pr(\\theta)} \\] so \\[ \\begin{aligned} \\Pr(\\theta=0.05|X=2) &amp;= \\frac{\\Pr(X=2|\\theta=0.05)\\Pr(\\theta=0.05)} {\\Pr(X=2|\\theta=0.05)\\Pr(\\theta=0.05)+\\Pr(X=2|\\theta=0.3)\\Pr(\\theta=0.3)}\\\\ &amp;=\\frac{(1-3\\times 0.05)(0.8)}{(1-3\\times 0.05)(0.8)+(1-3\\times 0.3)(0.2)}= \\frac{68}{70}. \\end{aligned} \\] Thus, \\(\\Pr(\\theta=0.3|X=1)= 1 - \\Pr(\\theta=0.05|X=1) = \\frac{2}{70}\\). From the model distribution, we have \\[ E(X|\\theta) = 0 \\times 2\\theta + 1 \\times \\theta + 2 \\times (1-3\\theta) = 2 - 5 \\theta. \\] Thus, \\[ \\begin{aligned} E(Y|X) &amp;= \\sum_{\\theta} \\mathrm{E}(Y|\\theta) \\pi(\\theta|X) \\\\ &amp;= \\mathrm{E}(Y|\\theta=0.05) \\pi(\\theta=0.05|X)+\\mathrm{E}(Y|\\theta=0.3) \\pi(\\theta=0.3|X)\\\\ &amp;= ( 2 - 5 (0.05))\\frac{68}{70} + ( 2 - 5 (0.3))\\frac{2}{70} = 1.714. \\end{aligned} \\] Example 4.4.4. Actuarial Exam Question. You are given: Losses on a company’s insurance policies follow a Pareto distribution with probability density function: \\[ f(x|\\theta) = \\frac{\\theta}{(x+\\theta)^2}, \\ \\ 0 &lt; x &lt; \\infty \\] For half of the company’s policies \\(\\theta=1\\) , while for the other half \\(\\theta=3\\). For a randomly selected policy, losses in Year 1 were 5. Calculate the posterior probability that losses for this policy in Year 2 will exceed 8. Show Example Solution Solution. We are given the prior distribution of \\(\\theta\\) as \\(\\Pr(\\theta=1)=\\Pr(\\theta=3)=\\frac{1}{2}\\), the conditional distribution \\(f(x|\\theta)\\), and the fact that we observed \\(X_1=5\\). The goal is to find the predictive probability \\(\\Pr(X_2&gt;8|X_1=5)\\). The posterior probabilities are \\[ \\begin{aligned} \\Pr(\\theta=1|X_1=5) &amp;= \\frac{f(5|\\theta=1)\\Pr(\\theta=1)}{f(5|\\theta=1)\\Pr(\\theta=1) + f(5|\\theta=3)\\Pr(\\theta=3)} \\\\ &amp;= \\frac{\\frac{1}{36}(\\frac{1}{2})}{\\frac{1}{36}(\\frac{1}{2})+\\frac{3}{64}(\\frac{1}{2})} = \\frac{\\frac{1}{72}}{\\frac{1}{72} + \\frac{3}{128}} = \\frac{16}{43} \\end{aligned} \\] \\[ \\begin{aligned} \\Pr(\\theta=3|X_1=5) &amp;= \\frac{f(5|\\theta=3)\\Pr(\\theta=3)}{f(5|\\theta=1)\\Pr(\\theta=1) + f(5|\\theta=3)\\Pr(\\theta=3)} \\\\ &amp;= 1-\\Pr(\\theta=1|X_1=5) = \\frac{27}{43} \\end{aligned} \\] Note that the conditional probability that losses exceed 8 is \\[ \\begin{aligned} \\Pr(X_2&gt;8|\\theta) &amp;= \\int_8^\\infty f(x|\\theta)dx \\\\ &amp;= \\int_8^\\infty \\frac{\\theta}{(x+\\theta)^2}dx = \\left. -\\frac{\\theta}{x+\\theta} \\right|_8^\\infty = \\frac{\\theta}{8 + \\theta} \\end{aligned} \\] The predictive probability is therefore \\[ \\begin{aligned} \\Pr(X_2&gt;8|X_1=5) &amp;= \\Pr(X_2&gt;8|\\theta=1) \\Pr(\\theta=1|X_1=5) + \\Pr(X_2&gt;8|\\theta=3) \\Pr(\\theta=3 | X_1=5) \\\\ &amp;= \\frac{1}{8+1}\\left( \\frac{16}{43}\\right) + \\frac{3}{8+3} \\left( \\frac{27}{43}\\right) = 0.2126 \\end{aligned} \\] Example 4.4.5. Actuarial Exam Question. You are given: The probability that an insured will have at least one loss during any year is \\(p\\). The prior distribution for \\(p\\) is uniform on \\([0, 0.5]\\). An insured is observed for 8 years and has at least one loss every year. Calculate the posterior probability that the insured will have at least one loss during Year 9. Show Example Solution Solution. The posterior probability density is \\[ \\begin{aligned} \\pi(p|1,1,1,1,1,1,1,1) &amp;\\propto \\Pr(1,1,1,1,1,1,1,1|p)\\ \\pi(p) = p^8(2) \\propto p^8 \\\\ \\Rightarrow \\pi(p|1,1,1,1,1,1,1,1) &amp;= \\frac{p^8}{\\int_0^5 p^8 dp} = \\frac{p^8}{(0.5^9)/9} = 9(0.5^{-9})p^8 \\end{aligned} \\] Thus, the posterior probability that the insured will have at least one loss during Year 9 is \\[ \\begin{aligned} \\Pr(X_9=1|1,1,1,1,1,1,1,1) &amp;= \\int_0^5 \\Pr(X_9=1|p) \\pi(p|1,1,1,1,1,1,1,1) dp \\\\ &amp;= \\int_0^5 p(9)(0.5^{-9})p^8 dp = 9(0.5^{-9})(0.5^{10})/10 = 0.45 \\end{aligned} \\] Example 4.4.6. Actuarial Exam Question. You are given: Each risk has at most one claim each year. \\[ {\\small \\begin{array}{ccc} \\hline \\text{Type of Risk} &amp; \\text{Prior Probability} &amp; \\text{Annual Claim Probability} \\\\ \\hline \\text{I} &amp; 0.7 &amp; 0.1 \\\\ \\text{II} &amp; 0.2 &amp; 0.2 \\\\ \\text{III} &amp; 0.1 &amp; 0.4 \\\\ \\hline \\end{array} } \\] One randomly chosen risk has three claims during Years 1-6. Calculate the posterior probability of a claim for this risk in Year 7. Show Example Solution Solution. The probabilities are from a binomial distribution with 6 trials in which 3 successes were observed. \\[ \\begin{aligned} \\Pr(3|\\text{I}) &amp;= {6 \\choose 3} (0.1^3)(0.9^3) = 0.01458 \\\\ \\Pr(3|\\text{II}) &amp;= {6 \\choose 3} (0.2^3)(0.8^3) = 0.08192 \\\\ \\Pr(3|\\text{III}) &amp;= {6 \\choose 3} (0.4^3)(0.6^3) = 0.27648 \\end{aligned} \\] The probability of observing three successes is \\[ \\begin{aligned} \\Pr(3) &amp;= \\Pr(3|\\text{I})\\Pr(\\text{I}) + \\Pr(3|\\text{II})\\Pr(\\text{II}) + \\Pr(3|\\text{III})\\Pr(\\text{III}) \\\\ &amp;= 0.7(0.01458) + 0.2(0.08192) + 0.1(0.27648) = 0.054238 \\end{aligned} \\] The three posterior probabilities are \\[ \\begin{aligned} \\Pr(\\text{I}|3) &amp;= \\frac{\\Pr(3|\\text{I})\\Pr(\\text{I})}{\\Pr(3)} = \\frac{0.7(0.01458)}{0.054238} = 0.18817 \\\\ \\Pr(\\text{II}|3) &amp;= \\frac{\\Pr(3|\\text{II})\\Pr(\\text{II})}{\\Pr(3)} = \\frac{0.2(0.08192)}{0.054238} = 0.30208 \\\\ \\Pr(\\text{III}|3) &amp;= \\frac{\\Pr(3|\\text{III})\\Pr(\\text{III})}{\\Pr(3)} = \\frac{0.1(0.27648)}{0.054238} = 0.50975 \\end{aligned} \\] The posterior probability of a claim is then \\[ \\begin{aligned} \\Pr(\\text{claim} | 3) &amp;= \\Pr(\\text{claim}|\\text{I})\\Pr(\\text{I} | 3) + \\Pr(\\text{claim} | \\text{II})\\Pr(\\text{II} | 3) + \\Pr(\\text{claim} | \\text{III}) \\Pr(\\text{III} | 3) \\\\ &amp;= 0.1(0.18817) + 0.2(0.30208) + 0.4(0.50975) = 0.28313 \\end{aligned} \\] 4.4.4 Conjugate Distributions In the Bayesian framework, the key to statistical inference is understanding the posterior distribution of the parameters. As described in Section 4.4.1, modern data analysis using Bayesian methods utilize computationally intensive techniques such as MCMC simulation. Another approach for computing posterior distributions are based on conjugate distributions. Although this approach is available only for a limited number of distributions, it has the appeal that it provides closed-form expressions for the distributions, allowing for easy interpretations of results. To relate the prior and posterior distributions of the parameters, we have the relationship \\[ \\begin{array}{ccc} \\pi(\\boldsymbol \\theta | x) &amp; = &amp; \\frac{f(x|\\boldsymbol \\theta )\\pi(\\boldsymbol \\theta)}{f(x)} \\\\ &amp; \\propto &amp; f(x|\\boldsymbol \\theta ) \\pi(\\boldsymbol \\theta) \\\\ \\text{Posterior} &amp; \\text{is proportional to} &amp; \\text{likelihood} \\times \\text{prior} . \\end{array} \\] For conjugate distributions, the posterior and the prior come from the same family of distributions. The following illustration looks at the Poisson-gamma special case, the most well-known in actuarial applications. Special Case – Poisson-Gamma - Continued. Assume a Poisson(\\(\\lambda\\)) model distribution and that \\(\\lambda\\) follows a gamma(\\(\\alpha, \\theta\\)) prior distribution. Then, the posterior distribution of \\(\\lambda\\) given the data follows a gamma distribution with new parameters \\(\\alpha_{post} = \\sum_i x_i + \\alpha\\) and \\(\\theta_{post} = 1/(n + 1/\\theta)\\). Show Special Case Details Special Case – Poisson-Gamma - Continued. The model distribution is \\[f(\\mathbf{x} | \\lambda) = \\prod_{i=1}^n \\frac{\\lambda^{x_i} e^{-\\lambda}}{x_i!} .\\] The prior distribution is \\[\\pi(\\lambda) = \\frac{\\left(\\lambda/\\theta\\right)^{\\alpha} \\exp(-\\lambda/\\theta)}{\\lambda \\Gamma(\\alpha)}.\\] Thus, the posterior distribution is proportional to \\[ \\begin{aligned} \\pi(\\lambda | \\mathbf{x}) &amp;\\propto f(\\mathbf{x}|\\theta ) \\pi(\\lambda) \\\\ &amp;= C \\lambda^{\\sum_i x_i + \\alpha -1} \\exp(-\\lambda(n+1/\\theta)) \\end{aligned} \\] where \\(C\\) is a constant. We recognize this to be a gamma distribution with new parameters \\(\\alpha_{post} = \\sum_i x_i + \\alpha\\) and \\(\\theta_{post} = 1/(n + 1/\\theta)\\). Thus, the gamma distribution is a conjugate prior for the Poisson model distribution. Example 4.4.7. Actuarial Exam Question. You are given: The conditional distribution of the number of claims per policyholder is Poisson with mean \\(\\lambda\\). The variable \\(\\lambda\\) has a gamma distribution with parameters \\(\\alpha\\) and \\(\\theta\\). For policyholders with 1 claim in Year 1, the Bayes prediction for the number of claims in Year 2 is 0.15. For policyholders with an average of 2 claims per year in Year 1 and Year 2, the Bayes prediction for the number of claims in Year 3 is 0.20. Calculate \\(\\theta\\). Show Example Solution Solution. Since the conditional distribution of the number of claims per policyholder, \\(E(X|\\lambda)=Var(X|\\lambda)=\\lambda\\), the Bayes prediction is \\[ \\begin{aligned} \\mathrm{E}(X_2|X_1) &amp;= \\int \\mathrm{E}(X_2|\\lambda) \\pi(\\lambda|X_1) d\\lambda = \\alpha_{new} \\theta_{new} \\end{aligned} \\] because the posterior distribution is gamma with parameters \\(\\alpha_{new}\\) and \\(\\theta_{new}\\). For year 1, we have \\[ 0.15 = (X_1 + \\alpha) \\times \\frac{1}{n+1/\\theta} = (1 + \\alpha) \\times \\frac{1}{1+1/\\theta}, \\] so \\(0.15(1+1/\\theta)= 1 + \\alpha.\\) For year 2, we have \\[ 0.2 = (X_1+X_2 + \\alpha) \\times \\frac{1}{n+1/\\theta} = (4 + \\alpha) \\times \\frac{1}{2+1/\\theta}, \\] so \\(0.2(2+1/\\theta)= 4 + \\alpha.\\) Equating these yields \\[ 0.2(2+1/\\theta)=3 + 0.15(1+1/\\theta) \\] resulting in \\(\\theta = 1/55 = 0.018182\\). Closed-form expressions means that results can be readily interpreted and easily computed; hence, conjugate distributions are useful in actuarial practice. Two other special cases used extensively are: The uncertainty of parameters is summarized using a beta distribution and the outcomes have a (conditional on the parameter) binomial distribution. The uncertainty of parameters is summarized using a normal distribution and the outcomes are conditionally normally distributed. Additional results on conjugate distributions are summarized in the Appendix Section 15.3. Show Quiz Solution 4.5 Further Resources and Contributors Exercises Here are a set of exercises that guide the viewer through some of the theoretical foundations of Loss Data Analytics. Each tutorial is based on one or more questions from the professional actuarial examinations, typically the Society of Actuaries Exam C. Model Selection Guided Tutorials Contributors Edward W. (Jed) Frees and Lisa Gao, University of Wisconsin-Madison, are the principal authors of the initial version of this chapter. Email: jfrees@bus.wisc.edu for chapter comments and suggested improvements. Chapter reviewers include: Andrew Kwon-Nakamura, Hirokazu (Iwahiro) Iwasawa, Eren Dodd. Bibliography "],
["C-AggLossModels.html", "Chapter 5 Modelos de pérdidas agregadas 5.1 Introducción 5.2 Modelo de riesgo individual 5.3 Modelo de riesgo colectivo 5.4 Cálculo de la distribución de pérdidas agregadas 5.5 Efectos de la modificación de las coberturas 5.6 Otros recursos y colaboradores", " Chapter 5 Modelos de pérdidas agregadas Vista previa del capítulo. Este capítulo presenta modelos de probabilidad para describir la siniestralidad agregada (siniestros totales) de una cartera de pólizas de seguro. Se presentan dos enfoques de modelización tradicionales, el modelo de riesgo individual y el modelo de riesgo colectivo. Además, se analizan estrategias para calcular la distribución de la siniestralidad agregada, entre los que se incluyen métodos exactos en casos específicos, recursión y simulación. Finalmente, se examinan los efectos de las modificaciones individuales en las pólizas, tales como deducibles, coaseguros e inflación, sobre las distribuciones de frecuencia y severidad y, por lo tanto, sobre la distribución de pérdidas agregadas. 5.1 Introducción El objetivo de este capítulo es construir un modelo de probabilidad para describir los siniestros totales de un sistema de seguros que ocurren en un período de tiempo determinado. El sistema de seguros puede ser una única póliza, un contrato de seguro colectivo, una línea de negocio o el conjunto total del negocio de una entidad aseguradora. En este capítulo, siniestros totales se refieren al número o al importe de los siniestros de una cartera de contratos de seguro. Sin embargo, la modelización que se presenta puede adaptarse fácilmente a una configuración más general. Considere una cartera de seguros de \\(n\\) contratos individuales, donde \\(S\\) representa las pérdidas agregadas de la cartera en un período de tiempo determinado. Existen dos enfoques para modelizar las pérdidas agregadas \\(S\\), el modelo de riesgo individual y el modelo de riesgo colectivo. El modelo de riesgo individual considera la pérdida de cada contrato individual y representa las pérdidas agregadas como: \\[\\begin{aligned} S_n=X_1 +X_2 +\\cdots+X_n, \\end{aligned}\\] donde \\(X_i~(i=1,\\ldots,n)\\) se interpreta como el importe de la pérdida del contrato \\(i\\)-ésimo. Cabe destacar que \\(n\\) denota el número de contratos en la cartera y por lo tanto es un número conocido en lugar de una variable aleatoria. En el modelo de riesgo individual normalmente se asume que los \\(X_{i}\\) son independientes. Debido a las diferentes características de cada contrato, como la cobertura y la exposición, los \\(X_{i}\\) no se consideran necesariamente idénticamente distribuidos. Una particularidad de la distribución de cada \\(X_i\\) es la masa de probabilidad en cero que corresponde al evento de no siniestros. El modelo de riesgo colectivo representa las pérdidas agregadas en base a una distribución de frecuencias y una distribución de gravedad: \\[\\begin{aligned} S_N=X_1 +X_2 +\\cdots+X_N. \\end{aligned}\\] Aquí, uno piensa en un número aleatorio de siniestros \\(N\\) que puede representar tanto el número de pérdidas como el número de pagos. En cambio, en el modelo de riesgo individual se considera un número fijo de contratos \\(n\\). Supongamos que \\(X_1, X_2, \\ldots, X_N\\) representa la cuantía de cada pérdida. Cada pérdida puede o no corresponder a un mismo contrato. Por ejemplo, se pueden generar múltiples reclamaciones en un mismo contrato. Normalmente se considera \\(X_i&gt;0\\) ya que si \\(X_i=0\\) entonces el siniestro no ha ocurrido. Frecuentemente se asume que condicionado a \\(N=n\\), \\(X_{1},X_{2},\\ldots ,X_{n}\\) son variables aleatorias iid. La distribución de \\(N\\) se denomina la distribución de frecuencias, y la distribución de \\(X\\) se conoce como la distribución de severidad. Se asume además que \\(N\\) y \\(X\\) son independientes. En el modelo de riesgo colectivo las pérdidas agregadas se pueden descomponer en el proceso de frecuencia (\\(N\\)) y el modelo de gravedad (\\(X\\)). Esta flexibilidad permite al analista estudiar estas dos componentes por separado. Por ejemplo, el crecimiento de las ventas debido a una relajación de los criterios de suscripción podría dar lugar a una mayor frecuencia de pérdidas, pero podría no afectar a la gravedad de las mismas. Del mismo modo, la inflación u otros factores económicos podrían tener un impacto en la severidad pero no en la frecuencia. 5.2 Modelo de riesgo individual Como se menciona previamente, en el modelo de riesgo individual, \\(X_i\\) se considera la pérdida del \\(i\\)-ésimo contrato y se interpreta \\[\\begin{eqnarray*} S_n=X_1 +X_2 +\\cdots+X_n \\end{eqnarray*}\\] como la pérdida agregada de todos los contratos de una cartera o grupo de contratos. Aquí, las \\(X_i\\) no se distribuyen necesariamente de forma idéntica y se cumple que \\[\\begin{aligned} {\\rm E}(S_n) &amp;= \\sum_{i=1}^{n} {\\rm E}(X_i)~. \\end{aligned}\\] Bajo el supuesto de independencia de las \\(X_i\\) (que implica \\(\\mathrm{Cov}\\left( X_i, X_j \\right) = 0\\) para todo \\(i \\neq j\\)), se puede demostrar que \\[\\begin{aligned} {\\rm Var}(S_n) &amp;= \\sum_{i=1}^{n} {\\rm Var}(X_i) \\\\ P_{S_n}(z) &amp;= \\prod_{i=1}^{n}P_{X_i}(z) \\\\ M_{S_n}(t) &amp;= \\prod_{i=1}^{n}M_{X_i}(t), \\end{aligned}\\] donde \\(P_{S_n}(\\cdot)\\) y \\(M_{S_n}(\\cdot)\\) son la función generadora de probabilidad (pgf) y la función generadora de momentos (mgf) de \\(S_n\\), respectivamente. La distribución de cada \\(X_i\\) tiene masa de probabilidad en cero, que corresponde al caso en el que no han habido siniestros en el contrato \\(i\\)-ésimo. Una estrategia para incluir masa en cero en la distribución es construirla en dos partes: \\[\\begin{aligned} X_i = I_i\\times B_i = \\left\\{\\begin{array}{ll} 0~, &amp; \\text{si }~ I_i=0 \\\\ B_i~, &amp; \\text{si }~ I_i=1 \\end{array} \\right. \\end{aligned}\\] Aquí, \\(I_i\\) es una variable de Bernoulli que indica si ocurren o no pérdidas en el contrato \\(i\\)-ésimo, y \\(B_i\\) es una variable aleatoria con soporte no negativo que representa la cuantía de las pérdidas en el contrato condicionado a que han ocurrido. Supongamos que \\(I_1 ,\\ldots,I_n ,B_1 ,\\ldots,B_n\\) son mutuamente independientes. Denotemos \\({\\rm Pr} (I_i =1)=q_i\\), \\(\\mu_i={\\rm E}(B_i)\\), y \\(\\sigma_i^2={\\rm Var}(B_i)\\). Se demuestra (véase Suplemento técnico 5.A.1 para más detalles) que \\[\\begin{aligned} \\mathrm{E}(S_n)&amp; =\\sum_{i=1}^n ~q_i ~\\mu _i \\\\ \\mathrm{Var}(S_n) &amp; =\\sum_{i=1}^n \\left( q_i \\sigma _i^2+q_i (1-q_i)\\mu_i^2 \\right)\\\\ P_{S_n}(z) &amp; =\\prod_{i=1}^n \\left( 1-q_i+q_i P_{B_i}(z) \\right)\\\\ M_{S_n}(t) &amp; =\\prod_{i=1}^n \\left( 1-q_i+q_i M_{B_i}(t) \\right) \\end{aligned}\\] Un caso particular del modelo anterior es cuando \\(B_i\\) sigue una distribución degenerada con \\(\\mu_i=b_i\\) y \\(\\sigma^2_i=0\\). Un ejemplo es un seguro de vida temporal o seguro de capital diferido en el que \\(b_i\\) representa el importe del capital asegurado en el contrato \\(i\\)-ésimo. Otra estrategia para acomodar masa en cero en la pérdida de cada contrato es considerarlos globalmente a nivel de cartera, como en el modelo de riesgo colectivo. Aquí, la pérdida total es \\(S_{N} = X_1 + \\cdots X_N\\), donde \\(N\\) es una variable aleatoria que representa el número de reclamaciones distintas de cero que se produjeron en todo el conjunto de contratos. Por lo tanto, todos los contratos de la cartera pueden no estar representados en esta suma, y \\(S_N=0\\) cuando \\(N=0\\). El modelo de riesgo colectivo se discutirá en detalle en la siguiente sección. Ejemplo 5.2.1. Pregunta de Examen Actuarial. Una compañía de seguros vendió 300 pólizas de seguro contra incendios de la siguiente forma: \\[ {\\small \\begin{matrix} \\begin{array}{c c c} \\hline \\text{Número de} &amp; \\text{Máximo de la} &amp; \\text{Probabilidad de}\\\\ \\text{Polizas} &amp; \\text{Póliza} &amp; \\text{Siniestro por póliza}\\\\ &amp; (M_i) &amp; (q_i) \\\\ \\hline 100 &amp; 400 &amp; 0,05\\\\ 200 &amp; 300 &amp; 0,06\\\\ \\hline \\end{array} \\end{matrix} } \\] Se sabe que: (i) El coste del siniestro por póliza, \\(X_i\\), se distribuye uniformemente entre \\(0\\) y el máximo de la póliza \\(M_i\\). (ii) La probabilidad de ocurrencia de más de un siniestro por póliza es \\(0\\). (iii) Los siniestros son independientes. Calcular la media, \\(\\mathrm{E~}(S_{300})\\), y la varianza, \\(\\mathrm{Var~}(S_{300})\\), de la siniestralidad total. ¿Como variarán los resultados si ahora cada siniestro es igual al máximo de la póliza? Mostrar Ejemplo de Solución Solución. La siniestralidad total \\(S_{300} = X_1+\\cdots+X_{300}\\), donde \\(X_1, \\ldots, X_{300}\\) son independientes pero no idénticamente distribuidos. El coste de los siniestros se distribuye uniformemente en \\((0,M_i)\\), por lo que el coste medio del siniestro es \\(M_i/2\\) y la varianza es \\(M_i^2/12\\). Por tanto, para la póliza \\(i=1,\\ldots,300\\), se tiene \\[ {\\small \\begin{matrix} \\begin{array}{ccccc} \\hline \\text{Número de} &amp; \\text{Máximo de la} &amp; \\text{Probabilidad de} &amp; \\text{Media del} &amp; \\text{Varianza del}\\\\ \\text{Polizas} &amp; \\text{Póliza} &amp; \\text{Siniestro por póliza} &amp; \\text{Coste} &amp; \\text{Coste}\\\\ &amp; (M_i) &amp; (q_{i}) &amp; (\\mu_{i}) &amp; (\\sigma_{i}^2) \\\\ \\hline 100 &amp; 400 &amp; 0.05 &amp; 200 &amp; 400^2/12\\\\ 200 &amp; 300 &amp; 0.06 &amp; 150 &amp; 300^2/12 \\\\ \\hline \\end{array} \\end{matrix} } \\] La media de la siniestralidad total es \\[\\mathrm{E~} (S_{300}) = \\sum_{i=1}^{300} q_i \\mu_i = 100\\left\\{0,05(200)\\right\\} + 200\\left\\{0,06 (150) \\right\\} = 2.800\\] La varianza de la siniestralidad total es \\[\\begin{eqnarray*} \\mathrm{Var~}(S_{300}) &amp;=&amp; \\sum_{i=1}^{300} \\left( q_i \\sigma _i^2+q_i (1-q_i)\\mu_i^2 \\right) ~~~~ \\text{dado que las } X_i \\text{ son independientes} \\\\ &amp;=&amp; 100\\left\\{ 0,05 \\left(\\frac{400^2}{12}\\right) +0,05 (1-0,05 )200^2 \\right\\}+ 200\\left\\{ 0,06 \\left(\\frac{300^2}{12}\\right) +0,06 (1-0,06 )150^2 \\right\\}\\\\ &amp;=&amp; 600.467. \\end{eqnarray*}\\] Continuación. Ahora supongamos que todos reciben el máximo de la póliza \\(M_i\\) si ocurre un siniestro. ¿Cuál es la pérdida agregada esperada \\(\\mathrm{E~}(\\tilde{S})\\) y la varianza de la pérdida agregada \\(\\mathrm{Var~}(\\tilde{S})\\)? La cuantía del siniestro por póliza \\(X_i\\) es ahora determinista y se establece en \\(M_i\\) en vez de ser un valor aleatorio, así que \\(\\sigma_i^2 = \\mathrm{Var~} (X_i) = 0\\) y \\(\\mu_i = M_i\\). Una vez más, la probabilidad que ocurra una reclamación para cada póliza es \\(q_i\\). En este contexto, la pérdida agregada esperada es \\[\\begin{aligned} \\mathrm{E~}(\\tilde{S}) &amp;= \\sum_{i=1}^{300} q_i \\mu_i = 100 \\left\\{0,05(400) \\right\\} + 200 \\left\\{ 0,06(300) \\right\\} = 5.600 \\end{aligned}\\] La varianza de la pérdida agregada es \\[\\begin{aligned} \\mathrm{Var~}(\\tilde{S}) &amp;= \\sum_{i=1}^{300} \\left( q_i \\sigma _i^2+q_i (1-q_i )\\mu_i^2 \\right) = \\sum_{i=1}^{300} \\left( q_i (1-q_i) \\mu_i^2 \\right) \\\\ &amp;= 100 \\left\\{(0,05) (1-0,05) 400^2\\right\\} + 200 \\left\\{(0,06) (1-0,06)300^2\\right\\} \\\\ &amp;= 1.775.200 \\end{aligned}\\] El modelo de riesgo individual también puede utilizarse para la frecuencia de los siniestros. Si \\(X_i\\) representa el número de siniestros para el \\(i\\)-ésimo contrato, entonces \\(S_n\\) se interpreta como el número total de siniestros de la cartera. En este caso, la construcción de la distribución en dos partes se sigue aplicando, ya que continua existiendo masa de probabilidad en cero para las pólizas que no experimentan ningún siniestro. Supongamos que \\(X_i\\) pertenece a la clase \\((a,b,0)\\) con pmf definida como \\(p_{ik} = \\Pr(X_i=k)\\) para \\(k=0,1,\\ldots\\) (véase Sección 2.3). Así mismo, \\(X_i^{T}\\) indica la distribución truncada en cero asociada de la clase \\((a,b,1)\\) con pmf \\(p_{ik}^T=p_{ik}/(1-p_{i0})\\) para \\(k=1,2,\\ldots\\) (véase Sección 2.5.1). Usando la relación entre sus funciones generadoras de probabilidad (véase Suplemento Técnico 5.A.2 para más detalles): \\[\\begin{aligned} P_{X_i}(z) = p_{i0} +(1-p_{i0}) P_{X_i^{T}}(z), \\end{aligned}\\] se puede escribir \\(X_i=I_i\\times B_i\\) con \\(q_i={\\rm Pr}(I_i=1)={\\rm Pr}(X_i&gt;0)=1-p_{i0}\\) y \\(B_i=X_i^T\\). Como se puede observar, en este caso, se obtiene una distribución modificada en cero, ya que la variable \\(I_i\\) recoge la masa de probabilidad modificada en cero con \\(q_i = \\Pr(I_i=1)\\), mientras que \\(B_i=X_i^T\\) cubre la parte de frecuencia discreta que no es cero. Véase Sección 2.5.1 para la relación entre las distribuciones truncadas en cero y modificadas en cero. Ejemplo 5.2.2. Una compañía aseguradora ha vendido una cartera de 100 pólizas de seguro de hogar independientes entre si, en cada una de las cuales la frecuencia de siniestros sigue una distribución de Poisson modificada en cero, como se indica a continuación: \\[ {\\small \\begin{matrix} \\begin{array}{cccc} \\hline \\text{Tipo de} &amp; \\text{Número de} &amp; \\text{Probabilidad of} &amp; \\lambda \\\\ \\text{Póliza} &amp; \\text{Pólizas} &amp; \\text{Al menos un siniestro} &amp; \\\\ \\hline \\text{Riesgo bajo} &amp; 40 &amp; 0,03 &amp; 1 \\\\ \\text{Riesgo alto} &amp; 60 &amp; 0,05 &amp; 2 \\\\ \\hline \\end{array} \\end{matrix} } \\] Calcular el valor esperado y varianza de la frecuencia de siniestros para el conjunto de la cartera. Mostrar Ejemplo de Solución Solución. Para cada póliza se puede escribir la frecuencia de siniestros Poisson cero modificada \\(N_i\\) como \\(N_i = I_i \\times B_i\\), donde \\[q_i = \\Pr(I_i = 1) = \\Pr(N_i &gt; 0) = 1-p_{i0}\\] Para las pólizas de bajo riesgo se tiene \\(q_i = 0,03\\), y para las pólizas de alto riego \\(q_i=0,05\\). Además, \\(B_i = N_i^T\\), la versión truncada en cero de \\(N_i\\). Por tanto, se tiene \\[\\begin{aligned} \\mu_i &amp;={\\rm E}(B_i) = {\\rm E}(N_i^T) = \\frac{\\lambda}{1-e^{-\\lambda}} \\\\ \\sigma_i^2 &amp;={\\rm Var}(B_i) = {\\rm Var}(N_i^T) = \\frac{\\lambda [1-(\\lambda+1)e^{-\\lambda}]}{(1-e^{-\\lambda})^2} \\end{aligned}\\] La frecuencia de siniestros de la cartera sería \\(S_n = \\sum_{i=1}^n N_i\\). En base a las fórmulas anteriores, el número esperado de siniestros de la cartera es \\[\\begin{aligned} \\mathrm{E~} (S_n) &amp;= \\sum_{i=1}^{100} q_i \\mu_i \\\\ &amp; = 40\\left[0,03 \\left(\\frac{1}{1-e^{-1}} \\right) \\right] + 60 \\left[0,05 \\left( \\frac{2}{1-e^{-2}} \\right) \\right] \\\\ &amp;= 40(0,03)(1,5820) + 60(0,05)(2,3130) = 8,8375 \\end{aligned}\\] La varianza de la frecuencia de siniestros de la cartera es \\[\\begin{aligned} \\mathrm{Var~}(S_n) &amp;= \\sum_{i=1}^{100} \\left( q_i \\sigma _i^2+q_i (1-q_i )\\mu_i^2 \\right) \\\\ &amp;= 40 \\left[ 0,03 \\left(\\frac{1-2e^{-1}}{(1-e^{-1})^2} \\right) + 0,03(0,97)(1,5820^2) \\right] + 60 \\left[0,05 \\left( \\frac{2[1-3e^{-2}]}{ (1-e^{-2})^2} \\right) + 0,05(0.95)(2,3130^2) \\right] \\\\ &amp;= 23,7214 \\end{aligned}\\] Cabe señalar que, equivalentemente, se podría calcular la media y varianza de una póliza individual usando la relación entre la distribuciones de Poisson modificada en cero y truncada en cero (véase Sección 2.3). Para entender la distribución de la pérdida agregada se puede utilizar el teorema central del límite para aproximar la distribución de \\(S_n\\) para valores grandes de \\(n\\). Si se denota \\(\\mu_{S_n}={\\rm E}(S_n)\\) y \\(\\sigma^2_{S_n}={\\rm Var}(S_n)\\) y se considera \\(Z\\sim N(0,1)\\), una variable aleatoria normal estándar con cdf \\(\\Phi\\). Entonces, la cdf de \\(S_n\\) se puede aproximar como: \\[\\begin{aligned} F_{S_n}(s) &amp;= {\\rm Pr}({S_n}\\leq s) = \\Pr \\left( \\frac{S_n - \\mu_{S_n}}{\\sigma_{S_n}} \\leq \\frac{s-\\mu_{S_n}}{\\sigma_{S_n}} \\right) \\\\ &amp;\\approx \\Pr\\left( Z \\leq \\frac{s-\\mu_{S_n}}{\\sigma_{S_n}} \\right) = \\Phi \\left(\\frac{s-\\mu_S}{\\sigma_S}\\right). \\end{aligned}\\] Ejemplo 5.2.3. Pregunta Examen Actuarial - Continuación. Como en el Ejemplo 5.2.1, una compañía de seguros ha vendido 300 pólizas de seguro contra incendios, donde el coste del siniestro \\(X_i\\) se distribuye uniformemente entre 0 y el máximo de la póliza \\(M_i\\). Utilizando la aproximación normal, se pide calcular la probabilidad de que el importe total de los siniestros \\(S_{300}\\) supere los \\(3.500\\$\\). Mostrar Ejemplo de Solución Solución. Previamente se ha obtenido que \\(\\mathrm{E}(S_{300})=2.800\\) y \\(\\mathrm{Var}(S_{300}) = 600.467\\). Por lo tanto, \\[\\begin{aligned} {\\rm Pr}(S_{300} &gt; 3.500) &amp;= 1 - {\\rm Pr}(S_{300} \\leq 3.500) \\\\ &amp;\\approx 1- \\Phi \\left( \\frac{3.500-2.800}{\\sqrt{600.467}} \\right) = 1 - \\Phi \\left( 0,90334 \\right) \\\\ &amp;= 1 – 0,8168 = 0,1832 \\end{aligned}\\] En el caso que \\(n\\) sea un valor pequeño, la distribución de \\(S_n\\) será probablemente sesgada, y la aproximación normal no sería una buena elección. Para analizar la distribución de pérdidas agregada, se debe volver a los métodos básicos iniciales. En concreto, la distribución puede derivarse recursivamente. Si se define \\(S_k=X_1 + \\cdots + X_k, k=1,\\ldots,n\\). Para \\(k=1\\): \\[F_{S_1}(s) = {\\rm Pr}(S_1\\leq s) = {\\rm Pr}(X_1\\leq s) = F_{X_1}(s).\\] Para \\(k=2,\\ldots,n\\): \\[\\begin{aligned} F_{S_k}(s)&amp;={\\Pr}(X_1+\\cdots+X_k\\leq s) ={\\Pr}(S_{k-1}+X_k\\leq s) \\\\ &amp;={\\rm E}_{X_k}\\left[{\\rm Pr}(S_{k-1}\\leq s-X_k|X_k)\\right]= {\\rm E}_{X_k}\\left[F_{S_{k-1}}(s-X_k)\\right]. \\end{aligned}\\] Un caso particular es cuando las \\(X_i\\) se distribuyen igual. Supongamos que \\(F_X(x)={\\Pr}(X\\leq x)\\) es la distribución común de \\(X_i, ~i=1,\\ldots,n\\). Se define \\[F^{*n}_X(x)={\\Pr}(X_1+\\cdots+X_n\\leq x)\\] la convolución \\(n\\)-ésima de \\(F_X\\). En general, \\(F_X^{\\ast n}\\) puede calcularse recursivamente. Se inicia la recursión en \\(k=1\\) mediante \\(F_X^{\\ast 1} \\left(x \\right) =F_X(x)\\). Posteriormente, para \\(k=2\\), se tiene \\[\\begin{eqnarray*} F_X^{\\ast 2} \\left(x \\right) &amp;=&amp; \\Pr(X_1 + X_2 \\le x) = \\mathrm{E}_{X_2} \\left[ \\Pr(X_1 \\le x - X_2|X_2) \\right] \\\\ &amp;=&amp; \\mathrm{E}_{X_2} \\left[ F(x - X_2) \\right] \\\\ &amp;=&amp;\\left\\{\\begin{array}{ll} \\int_{0}^{x} F(x-y) f(y) dy &amp; \\text{para } X_i \\text{ continuas } \\\\ \\sum_{y \\le x} F(x-y) f(y) &amp; \\text{para } X_i \\text{ discretas }\\\\ \\end{array}\\right. \\end{eqnarray*}\\] Recuerde que \\(F(0) = 0\\). Del mismo modo, para \\(k=n\\), se cumple que \\(S_n = X_1 + X_2 + \\cdots + X_n\\) y \\[\\begin{eqnarray*} F^{\\ast n}\\left(x\\right) &amp;=&amp; \\Pr(S_n \\le x) = \\Pr(S_{n-1} + X_n \\le x)\\\\ &amp;=&amp;\\mathrm{E}_{X_n} \\left[ \\Pr(S_{n-1} \\le x - X_n|X_n) \\right] \\\\ &amp;=&amp;\\mathrm{E}_X \\left[ F^{\\ast(n-1)}(x - X) \\right] \\\\ &amp;=&amp; \\left\\{\\begin{array}{ll} \\int_{0}^{x} F^{\\ast(n-1)}(x-y)f(y)dy &amp; \\text{para } X_i \\text{ continuas } \\\\ \\sum_{y \\le x} F^{\\ast(n-1)}(x-y)f(y) &amp; \\text{para } X_i \\text{ discretas } \\\\ \\end{array}\\right. \\end{eqnarray*}\\] Cuando las \\(X_i\\) son independientes y pertenecen a la misma familia de distribuciones, en algunos casos \\(S_n\\) tiene una forma cerrada simple. Esto hace que sea fácil calcular \\(\\Pr(S_n \\le x)\\). Esta propiedad se conoce como cerrado bajo convolución, es decir, la distribución de la suma de variables aleatorias independientes pertenece a la misma familia de distribuciones que la de las variables que la componen, pero con distintos parámetros. Algunos ejemplos son: \\[ {\\small \\begin{matrix} \\text{Tabla de formas cerrada para la suma parcial de distribuciones}\\\\ \\begin{array}{l|l|l} \\hline \\text{Distribución de } X_i &amp; \\text{Abreviatura} &amp; \\text{Distribución de } S_n \\\\ \\hline \\text{Normal con media } \\mu_i \\text{ y varianza } \\sigma_i^2 &amp; N(\\mu_i,\\sigma_i^2) &amp; N\\left(\\sum_{i=1}^{n}\\mu_i,~\\sum_{i=1}^{n}\\sigma_i^2\\right) \\\\ \\text{Exponencial con media } \\theta &amp; Exp(\\theta) &amp; Gam(n,\\theta)\\\\ \\text{Gamma con parámetros de forma } \\alpha_i \\text{ y escala } \\theta &amp; Gam(\\alpha_i,\\theta) &amp; Gam\\left(\\sum_{i=1}^n\\alpha_i,\\theta\\right) \\\\ \\text{Poisson con media (y varianza) } \\lambda_i &amp; Poi(\\lambda_i)&amp; Poi\\left(\\sum_{i=1}^{n}\\lambda_i\\right)\\\\ \\text{Binomial con } m_i \\text{ intentos y probabilidad de éxito } q &amp; Bin(m_i, q)&amp; Bin\\left(\\sum_{i=1}^n m_i, q\\right)\\\\ \\text{Geométrica con media } \\beta &amp; Geo(\\beta) &amp; NB(\\beta,n)\\\\ \\text{Binomial Negativa con media } r_i \\beta~ \\text{ y varianza } ~r_i \\beta (1+\\beta) &amp; NB(\\beta,r_i)&amp; NB\\left(\\beta,\\sum_{i=1}^n r_i\\right)\\\\ \\hline \\end{array} \\end{matrix} } \\] Ejemplo 5.2.4. Distribución Gamma. Supongamos que \\(X_1,\\ldots,X_n\\) son variables aleatorias independientes con \\(X_i \\sim Gam(\\alpha_i, \\theta)\\). La mgf de \\(X_i\\) es \\(M_{X_i}(t) = (1 - \\theta t)^{- \\alpha_i}\\). Por tanto, la mgf de la suma \\(S_n = X_1 + \\cdots + X_n\\) es \\[\\begin{aligned} M_{S_n}(t) &amp;= \\prod_{i=1}^n M_{X_i}(t) ~~~~ \\text{por la independencia de las } X_i \\\\ &amp;= \\prod_{i=1}^n (1 - \\theta t)^{- \\alpha_i} = (1-\\theta t)^{-\\sum_{i=1}^n \\alpha_i }~ , \\end{aligned}\\] que es la mgf de una variable aleatoria gamma con parámetros \\((\\sum_{i=1}^n \\alpha_i, \\theta)\\). Es decir, \\(S_n \\sim Gam(\\sum_{i=1}^n \\alpha_i, \\theta)\\). Ejemplo 5.2.5. Distribución Negativa Binomial. Supongamos que \\(X_1,\\ldots, X_n\\) son variables aleatorias independientes con \\(X_i \\sim NB(\\beta, r_i)\\). La pgf de \\(X_i\\) is \\(P_{X_i}(z) = \\left[1-\\beta(z-1) \\right]^{-r_i}\\). Por lo tanto, la pgf de la suma \\(S_n =X_1+\\cdots+X_n\\) es \\[\\begin{aligned} P_{S_n}(z) &amp;= \\mathrm{E~}\\left[ z^{S_n} \\right] = \\mathrm{E~}\\left[ z^{X_1+\\cdots+X_n} \\right] = \\mathrm{E~}\\left[ z^{X_1} z^{X_2} \\cdots z^{X_n} \\right] \\\\ &amp;= \\mathrm{E~}\\left[z^{X_1}\\right] \\cdots \\mathrm{E~}\\left[z^{X_n}\\right] ~~~~ \\text{bajo independencia de las } X_i \\\\ &amp;= \\prod_{i=1}^n P_{X_i}(z) = \\prod_{i=1}^n \\left[1-\\beta(z-1) \\right]^{-r_i} = \\left[1-\\beta(z-1) \\right]^{-\\sum_{i=1}^n r_i} ~, \\end{aligned}\\] que es la pgf de una variable aleatoria negativa binomial con parámetros \\((\\beta, \\sum_{i=1}^n r_i)\\). Es decir, \\(S_n \\sim NB(\\beta, \\sum_{i=1}^n r_i)\\). Ejemplo 5.2.6. Pregunta Examen Actuarial (modificada). El número anual de visitas al médico para cada miembro de una familia de 4 tiene una distribución geométrica con una media de 1,5. El número anual de visitas de los miembros de la familia es independiente entre sí. Un seguro paga 100 por visita al médico a partir de la cuarta visita de la familia. Calcula la probabilidad de que la familia cobre del seguro este año. Mostrar Ejemplo de Solución Solución. El número de visitas al médico para un miembro de la familia es \\(X_i \\sim Geo(\\beta=1,5)\\) y el número de visitas del conjunto de la familia es \\(S_4 = X_1 + X_2 + X_3 + X_4\\). La suma de 4 variables aleatorias geométricas independientes, cada una con una media \\(\\beta=1,5\\), siguen una distribución binomial negativa, i.e. \\(S_4 \\sim NB(\\beta=1,5, r=4)\\). Si el seguro paga 100 por visita a partir de la cuarta visita de la familia, entonces la familia no cobrará del seguro si tienen menos de 4 siniestros. Esta probabilidad es \\[\\begin{aligned} \\Pr(S_4 &lt; 4) &amp;= \\Pr(S_4 = 0) + \\Pr(S_4 = 1) + \\Pr(S_4 = 2) +\\Pr(S_4 = 3) \\\\ &amp;= (1+1,5)^{-4} + \\frac{4(1,5)}{(1+1,5)^5} + \\frac{4(5)(1,5^2)}{2(1+1,5)^6} + \\frac{4(5)(6)(1,5^3)}{3!(1+1,5)^7}\\\\ &amp;= 0,0256 + 0,0614 + 0,0922 + 0,1106 = 0,2898 \\end{aligned}\\] 5.3 Modelo de riesgo colectivo 5.3.1 Momentos y distribución Bajo el modelo de riesgo colectivo \\(S_N=X_1+\\cdots+X_N\\), las \\(\\{X_i\\}\\) son iid, e independientes de \\(N\\). Supongamos que \\(\\mu = {\\rm E}\\left( X_{i}\\right)\\) y \\(\\sigma ^{2} = {\\rm Var}\\left(X_{i}\\right)\\) para todo \\(i\\). Utilizando la ley de esperanza iterada, la media de la pérdida agregada es \\[\\begin{eqnarray*} {\\rm E}(S_N)={\\rm E}_N[{\\rm E}_S(S|N)] = {\\rm E}_N(N\\mu) = \\mu {\\rm E}(N). \\end{eqnarray*}\\] Utilizando la ley de varianza total, la varianza de la pérdida agregada es \\[\\begin{aligned} {\\rm Var}(S_N) &amp;= {\\rm E}_N[{\\rm Var}(S_N|N)] + {\\rm Var}_N[{\\rm E}(S_N|N)] \\\\ &amp;= \\mathrm{E}_N \\left[ \\mathrm{Var}(X_1+\\cdots+X_N) \\right] + \\mathrm{Var}_N\\left[ \\mathrm{E}(X_1+\\cdots+X_N) \\right] \\\\ &amp;= \\mathrm{E}_N \\left[ \\mathrm{Var}(X_1)+\\cdots+ \\mathrm{Var}(X_N) + 2\\mathrm{Cov}(X_1, X_2) + \\cdots + \\mathrm{Cov}(X_{N-1}, X_N) \\right] + \\mathrm{Var}_N\\left[ \\mathrm{E}(X_1) + \\cdots + \\mathrm{E}(X_N) \\right] \\\\ &amp;={\\rm E}_N[N\\sigma^2] + {\\rm Var}_N[N\\mu] ~~~~ \\text{dado que } \\mathrm{Cov}(X_i, X_j)=0 \\text{ para todo } i\\neq j \\text{ debido a la independencia} \\\\ &amp;=\\sigma^2{\\rm E}[N] + \\mu^2{\\rm Var}[N] \\end{aligned}\\] Caso particular: Frecuencia distribuida según una Poisson. Si \\(N \\sim Poi (\\lambda)\\), entonces \\[\\begin{aligned} \\mathrm{E}(N) &amp;= \\mathrm{Var}(N) = \\lambda\\\\ \\mathrm{E}(S) &amp;= \\lambda \\mathrm{E}(X)\\\\ \\mathrm{Var}(S) &amp;= \\lambda (\\sigma^2 + \\mu^2) = \\lambda ~\\mathrm{E} (X^2) . \\end{aligned}\\] Ejemplo 5.3.1. Pregunta de Examen Actuarial. El número de accidentes sigue una distribución de Poisson con media 12. Cada accidente genera 1, 2 ó 3 reclamantes con probabilidades 1/2, 1/3 y 1/6, respectivamente. Calcular la varianza en el número total de reclamantes. Mostrar Ejemplo de Solución Solución. \\[\\begin{aligned} &amp; \\mathrm{E}(X^2) = 1^2 \\left( \\frac{1}{2}\\right) + 2^2\\left(\\frac{1}{3} \\right) + 3^2\\left(\\frac{1}{6}\\right) = \\frac{10}{3} \\\\ \\Rightarrow &amp;\\mathrm{Var}(S_N) = \\lambda \\ \\mathrm{E}(X^2) = 12\\left(\\frac{10}{3}\\right) = 40 \\end{aligned}\\] Alternativamente, utilizando la expresión genérica, \\(\\mathrm{Var}(S_N) = \\sigma^2 \\mathrm{E}(N) + \\mu^2 \\mathrm{Var}(N)\\), donde \\[\\begin{aligned} \\mathrm{E}(N) &amp;= \\mathrm{Var}(N) = 12 \\\\ \\mu &amp;= \\mathrm{E}(X) = 1\\left(\\frac{1}{2}\\right) + 2\\left(\\frac{1}{3}\\right) + 3\\left(\\frac{1}{6}\\right) = \\frac{5}{3} \\\\ \\sigma^2 &amp;= \\mathrm{E}(X^2) - [\\mathrm{E}(X)]^2 = \\frac{10}{3} - \\frac{25}{9} = \\frac{5}{9} \\\\ \\Rightarrow \\ \\mathrm{Var}(S) &amp;= \\left(\\frac{5}{9}\\right)\\left(12\\right) + \\left(\\frac{5}{3}\\right)^2\\left(12\\right) = 40 . \\end{aligned}\\] En general, los momentos de \\(S_N\\) pueden derivarse de su función generadora de momentos (mgf). Como las \\(X_i\\) son iid, denotaremos la mgf de \\(X\\) como \\(M_{X}(t) = \\mathrm{E~}(e^{tX})\\). Usando la ley de esperanza iterada, la mgf de \\(S_N\\) es \\[\\begin{aligned} M_{S_N}(t) &amp;= \\mathrm{E}(e^{t S_N})=\\mathrm{E}_N[~\\mathrm{E}(e^{tS_N}|N)~]\\\\ &amp;= \\mathrm{E}_N \\left[ ~\\mathrm{E}\\left( e^{t(X_1+\\cdots+X_N)}\\right) ~\\right] = \\mathrm{E}_N \\left[ \\mathrm{E}(e^{tX_1})\\cdots\\mathrm{E}(e^{tX_N}) \\right] ~~~~ \\text{dado que las } X_i \\text{ son independientes} \\\\ &amp;= \\mathrm{E}_N[~(M_{X}(t))^N~] \\end{aligned}\\] Ahora, recuerde que la función generadora de probabilidad (pgf) de \\(N\\) es \\(P_N(z) = \\mathrm{E}(z^N)\\). Denotemos \\(M_{X}(t)=z\\). Sustituyendo en la expresión de la mgf de \\(S_N\\) anterior, se demuestra \\[\\begin{aligned} M_{S_N}(t) = \\mathrm{E~}(z^N) = P_{N}(z) = P_{N}[M_{X}(t)]. \\end{aligned}\\] Del mismo modo, si \\(S_N\\) es discreta, se obtiene que la pgf de \\(S_N\\) es: \\[\\begin{aligned} P_{S_N}(z) = P_{N}[P_{X}(z)]. \\end{aligned}\\] Para obtener \\(\\mathrm{E}(S_N) = M_{S_N}&#39;(0)\\), se usa la regla de la cadena \\[ M_{S_N}&#39;(t) = \\frac{\\partial}{\\partial t} P_{N}(M_{X}(t)) = P_{N}&#39;(M_{X}(t)) M_{X}&#39;(t)\\\\ \\] y recuerde que \\(M_{X}(0) = 1, M_{X}&#39;(0) = \\mathrm{E}(X) = \\mu, P_{N}&#39;(1) = \\mathrm{E}(N)\\). Por lo tanto, \\[\\begin{aligned} \\mathrm{E}(S_N) = M_{S_N}&#39;(0) = P_{N}&#39;(M_{X}(0)) M_{X}&#39;(0) = \\mu {\\rm E}(N) \\end{aligned}\\] De forma similar, se puede utilizar la relación \\(\\mathrm{E}(S_N^2) = M_{S_N}&#39;&#39;(0)\\) para obtener \\[\\mathrm{Var}(S_N) = \\sigma^2 \\mathrm{E}(N) + \\mu^2 \\mathrm{Var}(N).\\] Caso particular. Frecuencia según una Poisson. Supongamos que \\(N \\sim Poi (\\lambda)\\). Entonces, la pgf de \\(N\\) es \\(P_N (z) = e^{\\lambda(z-1)}\\) y la mgf de \\(S_N\\) es \\[\\begin{aligned} M_{S_N}(t) &amp;= P_N[M_X(t)] = e^{\\lambda(M_{X}(t) - 1)}. \\end{aligned}\\] Derivando se obtiene \\[\\begin{aligned} M_{S_N}&#39;(t) &amp;= e^{\\lambda(M_{X}(t) - 1)}~ \\lambda~ M_{X}&#39;(t) = M_{S_N}(t) ~\\lambda ~M_{X}&#39;(t)\\\\ M_{S_N}&#39;&#39;(t) &amp;= M_{S}(t) ~\\lambda~ M_{X}&#39;&#39;(t) + [~M_{S}(t)~\\lambda~ M_{X}&#39;(t)~] ~\\lambda~ M_{X}&#39;(t) \\end{aligned}\\] Si se evalúan en \\(t=0\\) se tiene \\[\\begin{aligned} \\mathrm{E}(S_N) &amp;= M_{S_N}&#39;(0) = \\lambda \\mathrm{E}(X) = \\lambda \\mu \\end{aligned}\\] y \\[\\begin{aligned} M_{S_N}&#39;&#39;(0) &amp;= \\lambda \\mathrm{E}(X^2) + \\lambda^2 \\mu^2\\\\ \\Rightarrow \\mathrm{Var}(S_N) &amp;= \\lambda \\mathrm{E}(X^2) + \\lambda^2 \\mu^2 - (\\lambda \\mu)^2 = \\lambda~ \\mathrm{E}(X^2). \\end{aligned}\\] Ejemplo 5.3.2. Pregunta de Examen Actuarial. El productor de un concurso de televisión otorga premios en efectivo. El número de premios, \\(N\\), y la cuantía de cada premio, \\(X\\), tienen las siguientes distribuciones: \\[ {\\small \\begin{matrix} \\begin{array}{ccccc}\\hline n &amp; \\Pr(N=n) &amp; &amp; x &amp; \\Pr(X=x)\\\\ \\hline 1 &amp; 0,8 &amp; &amp; 0 &amp; 0,2 \\\\ 2 &amp; 0,2 &amp; &amp; 100 &amp; 0,7 \\\\ &amp; &amp; &amp; 1000 &amp; 0,1\\\\\\hline \\end{array} \\end{matrix} } \\] El presupuesto para premios es igual al valor esperado del total de los premios más la desviación estándar del valor total de los premios. Calcular el presupuesto. Mostrar Ejemplo de Solución Solución. Se debe calcular la media y la desviación estándar del total (suma) de los premios en efectivo. Los momentos de la distribución de frecuencias \\(N\\) son \\[\\begin{aligned} \\mathrm{E}(N) &amp;= 1 (0,8) + 2 (0,2) =1,2\\\\ \\mathrm{E}(N^2) &amp;= 1^2 (0,8) + 2^2 (0,2) =1,6\\\\ \\mathrm{Var}(N) &amp;= \\mathrm{E}(N^2) - \\left[ \\mathrm{E}(N) \\right]^2= 0,16 \\end{aligned}\\] Los momentos de la distribución de severidad \\(X\\) son \\[\\begin{aligned} \\mathrm{E}(X) &amp;= 0 (0,2) + 100 (0,7) + 1000 (0,1) = 170 = \\mu\\\\ \\mathrm{E}(X^2) &amp;= 0^2 (0,2) + 100^2 (0,7) + 1000^2 (0,1) = 107.000\\\\ \\mathrm{Var}(X) &amp;= \\mathrm{E}(X^2) - \\left[ \\mathrm{E}(X) \\right]^2=78.100 = \\sigma^2 \\end{aligned}\\] Por lo tanto, la media y la varianza del total de los premios en efectivo son \\[\\begin{aligned} \\mathrm{E}(S_N) &amp;= \\mu \\mathrm{E}(N) = 170 (1,2) = 204 \\\\ \\mathrm{Var}(S_N) &amp;= \\sigma^2 \\mathrm{E}(N) + \\mu^2 \\mathrm{Var}(N)\\\\ &amp;= 78.100 (1,2) + 170^2 (0,16) = 98.344 \\end{aligned}\\] El presupuesto necesario es el siguiente \\[\\begin{aligned} Presupuesto &amp;= \\mathrm{E}(S_N) + \\sqrt{\\mathrm{Var}(S_N)} \\\\ &amp;= 204 + \\sqrt{98.344} = 517,60 . \\end{aligned}\\] La distribución de \\(S_N\\) se denomina distribución compuesta, y puede derivarse a partir de la convolución de \\(F_X\\) como sigue: \\[\\begin{aligned} F_{S_N}(s) &amp;= \\Pr \\left(X_1 + \\cdots + X_N \\le s \\right) \\\\ &amp;= \\mathrm{E} \\left[ \\Pr \\left(X_1 + \\cdots + X_N \\le s|N=n \\right) \\right]\\\\ &amp;= \\mathrm{E} \\left[ F_{X}^{\\ast N}(s) \\right] \\\\ &amp;= p_0 + \\sum_{n=1}^{\\infty }p_n F_{X}^{\\ast n}(s) \\end{aligned}\\] Ejemplo 5.3.3. Pregunta de examen actuarial. El número de siniestros en un determinado período sigue una distribución geométrica de media \\(4\\). La cauantía de cada siniestro \\(X\\) tiene la siguiente distribución \\(\\Pr(X=x) = 0,25, \\ x=1,2,3,4\\), es decir, discreta uniforme en \\(\\{1,2,3,4\\}\\). El número de siniestros y los importes de los mismos son independientes. Si \\(S_N\\) denota la cuantía total de la siniestralidad durante el período, calcular \\(F_{S_N}(3)\\). Mostrar Ejemplo de Solución Solución. Por definición, se sabe que \\[\\begin{aligned} F_{S_N}\\left(3 \\right) &amp;= {\\rm Pr}\\left(\\sum_{i=1}^N X_i \\leq 3\\right) = \\sum_{n=0}^\\infty {\\rm Pr}\\left(\\sum_{i=1}^n X_i\\leq 3|N=n\\right){\\rm Pr}(N=n) \\\\ &amp;= \\sum_n F^{\\ast n} \\left(3 \\right) p_n = \\sum_{n=0}^3 F^{\\ast n}(3) p_n \\\\ &amp;= p_0 + F^{\\ast 1}(3) \\ p_1 + F^{\\ast 2}(3) \\ p_2 + F^{\\ast 3}(3) \\ p_3 \\end{aligned}\\] Dado que \\(N \\sim Geo(\\beta=4)\\), entonces \\[\\begin{aligned} p_n &amp;= \\frac{1}{1+\\beta} \\left(\\frac{\\beta}{1+ \\beta} \\right)^n = \\frac{1}{5} \\left(\\frac{4}{5} \\right)^n \\end{aligned}\\] Para la distribución de la severidad de la siniestralidad, de forma recursiva, se dispone de \\[\\begin{aligned} F^{\\ast 1}(3) &amp;= \\Pr(X \\le 3) = \\frac{3}{4} \\\\ F^{\\ast 2}(3) &amp;= \\sum_{y \\le 3} F^{\\ast 1} (3-y) f(y) = F^{\\ast 1}(2)f(1) + F^{\\ast 1}(1)f(2) \\\\ &amp;= \\frac{1}{4}\\left[F^{\\ast 1} (2) + F^{\\ast 1}(1)\\right] = \\frac{1}{4}\\left[{\\rm Pr}(X\\leq 2) + {\\rm Pr}(X \\leq 1) \\right] \\\\ &amp;= \\frac{1}{4} \\left(\\frac{2}{4} + \\frac{1}{4} \\right) = \\frac{3}{16}\\\\ F^{\\ast 3}(3) &amp;= \\Pr(X_1+X_2 + X_3 \\le 3) = \\Pr(X_1=X_2=X_3=1) = \\left(\\frac{1}{4} \\right)^3 \\end{aligned}\\] Cabe señalar que no es necesario calcular recursivamente \\(F^{\\ast 3}(3)\\) ya que como cada \\(X \\in \\{1,2,3,4\\}\\), la única forma de obtener \\(X_1+X_2+X_3 \\leq 3\\) es tener \\(X_1=X_2=X_3=1\\). Además, para \\(n \\geq 4\\), \\(F^{\\ast n} (3)=0\\) dado que la suma de 4 o más \\(X\\) no puede ser menor a 3. Para \\(n=0\\), \\(F^{\\ast 0}(3) = 1\\) ya que la suma de cero veces \\(X\\) es 0, que es siempre menor a 3. Si se establecen sistemáticamente las probabilidades, \\[\\begin {matrix} \\begin{array}{c c c c}\\hline x &amp; F^{\\ast 1}(x) &amp; F^{\\ast 2}(x) &amp; F^{\\ast 3}(x)\\\\ \\hline 0 &amp; &amp; &amp; \\\\ 1 &amp; \\frac{1}{4} &amp; 0 &amp; \\\\ 2 &amp; \\frac{2}{4} &amp; \\left( \\frac{1}{4} \\right)^2 &amp; \\\\ 3 &amp; \\frac{3}{4} &amp; \\frac{3}{16} &amp; \\left( \\frac{1}{4} \\right)^3 \\\\ \\hline \\end{array} \\end{matrix}\\] Finalmente, \\[\\begin{aligned} F_{S_N}(3) &amp;= p_0 + F^{\\ast 1}(3) \\ p_1 + F^{\\ast 2}(3) \\ p_2 + F^{\\ast 3}(3) \\ p_3 \\\\ &amp;= \\frac{1}{5} + \\frac{3}{4}\\left(\\frac{4}{25} \\right) + \\frac{3}{16} \\left( \\frac{16}{125} \\right) + \\frac{1}{64} \\left( \\frac{64}{625}\\right) = 0,3456\\\\ \\end{aligned}\\] Si se conocen \\(\\mathrm{E}(N)\\) y \\(\\mathrm{Var}(N)\\), también se puede utilizar el teorema central del límite para aproximar la distribución de \\(S_N\\) como en el modelo de riesgo individual. Es decir, \\(\\frac{S_N - \\mathrm{E}(S_N)}{\\sqrt{\\mathrm{Var}(S_N)}}\\) sigue aproximadamente la distribución normal estándar \\(N(0,1)\\). Ejemplo 5.3.4. Pregunta Examen Actuarial. Se sabe lo siguiente: \\[ {\\small \\begin{matrix} \\begin{array}{ c | c c } \\hline &amp; \\text{Media} &amp; \\text{Desviación estándar}\\\\ \\hline \\text{Número de siniestros} &amp; 8 &amp; 3\\\\ \\text{Pérdidas individuales} &amp; 10.000 &amp; 3.937\\\\ \\hline \\end{array} \\end{matrix} } \\] Mediante la aproximación normal, determinar la probabilidad que la pérdida total supere el 150\\(\\%\\) de la pérdida esperada. Mostrar Ejemplo de Solución Solución. Para utilizar la aproximación normal, primero debemos encontrar la media y la varianza de la pérdida agregada \\(S\\) \\[\\begin{aligned} \\mathrm{E}(S_N) &amp;= \\mu \\ \\mathrm{E}(N) = 10.000(8) = 80.000\\\\ \\mathrm{Var}(S_N) &amp;= \\sigma^2 \\ \\mathrm{E}(N) + \\mu^2 \\ \\mathrm{Var}(N)\\\\ &amp;= 3937^2(8) + 10000^2 (3^2) = 1.023.999.752\\\\ \\sqrt{\\mathrm{Var}(S_N)} &amp;= 31.999,996 \\approx 32.000 \\end{aligned}\\] Bajo la aproximación normal, la pérdida agregada \\(S_N\\) es aproximadamente normal con media 80.000 y desviación estándar 32.000. La probabilidad que \\(S_N\\) supere el 150\\(\\%\\) de la pérdida agregada esperada es, por lo tanto \\[\\begin{aligned} \\Pr(S_N&gt;1,5 \\mathrm{E}(S_N)~) &amp;= \\Pr \\left( \\frac{S_N - \\mathrm{E} (S_N)}{\\sqrt{\\mathrm{Var}(S_N)}} &gt; \\frac{1,5 ~\\mathrm{E}(S_N) - \\mathrm{E} (S_N)}{\\sqrt{\\mathrm{Var}(S_N)}} \\right) \\\\ &amp;\\approx \\Pr \\left( Z &gt; \\frac{0,5~ \\mathrm{E}(S_N)}{\\sqrt{\\mathrm{Var}(S_N)} } \\right), ~~~~ \\text{donde } Z\\sim N(0,1) \\\\ &amp;= \\Pr \\left( Z &gt; \\frac{0,5(80.000)}{32.000} \\right) = \\Pr( Z &gt; 1,25) \\\\ &amp;= 1-\\Phi(1,25) = 0,1056 \\end{aligned}\\] Ejemplo 5.3.5. Pregunta Examen Actuarial. Para un individuo de más de \\(65\\): (i) El número de reclamaciones por cobertura de medicinas es una variable aleatoria de Poisson con media \\(25\\). (ii) La cuantía de cada reclamación por cobertura de medicinas se distribuye uniformemente entre \\(5\\) y \\(95\\). iii) Las cuantías de las reclamaciones y el número de reclamaciones son independientes entre sí. Estimar la probabilidad que el coste total de las reclamaciones del individuo supere los \\(2000\\) mediante la aproximación normal. Mostrar Ejemplo de Solución Solución. Se sabe que la frecuencia de siniestros \\(N \\sim Poi(\\lambda = 25)\\) y severidad de los siniestros \\(X \\sim U \\left(5, 95 \\right)\\). Para utilizar la aproximación normal, se necesita encontrar la media y varianza del coste total de las reclamaciones \\(S_N\\). Note que \\[\\begin{matrix} \\begin{array}{lll} \\mathrm{E} (N) = 25 &amp; &amp; \\mathrm{Var} (N) = 25\\\\ \\mathrm{E}(X) = \\frac{5+95}{2} = 50 = \\mu &amp; &amp; \\mathrm{Var}(X) = \\frac{(95-5)^2}{12} = 675 = \\sigma^2\\\\ \\end{array} \\end{matrix}\\] Por lo tanto, para \\(S_N\\), \\[\\begin{aligned} \\mathrm{E}(S_N) &amp;= \\mu \\ \\mathrm{E} (N) = 50(25) = 1.250\\\\ \\mathrm{Var}(S_N) &amp;= \\sigma^2 \\ \\mathrm{E}(N) + \\mu^2 \\ \\mathrm{Var}(N)\\\\ &amp;= 675 (25) + 50^2 (25) = 79.375 \\end{aligned}\\] Utilizando la aproximación normal, \\(S_N\\) es aproximadamente normal con media 1.250 y varianza 79.375. La probabilidad de \\(S_N\\) exceda de 2.000 es \\[\\begin{aligned} \\Pr(S_N&gt;2.000) &amp;= \\Pr \\left(\\frac{S_N - \\mathrm{E} (S_N)}{\\sqrt{\\mathrm{Var} (S_N)}} &gt; \\frac{2.000- \\mathrm{E} (S_N)}{\\sqrt{\\mathrm{Var} (S_N)}} \\right) \\\\ &amp;= \\Pr\\left( Z &gt; \\frac{2.000-1.250}{\\sqrt{79.375}} \\right), ~~~~ \\text{donde } Z\\sim N(0,1) \\\\ &amp;= \\Pr (Z &gt; 2,662) = 1-\\Phi(2,662) = 0,003884 \\end{aligned}\\] 5.3.2 Seguro Stop-loss Recuerde las modificaciones de cobertura a nivel de póliza individual en la Sección 3.4. El seguro sobre la pérdida total \\(S_N\\), sujeto a un deducible \\(d\\), se llama seguro neto stop-loss. El valor esperado de la cantidad de la pérdida total que excede al deducible, \\[\\begin{eqnarray*} \\mathrm{E}[(S-d)_+] \\end{eqnarray*}\\] Se denomina prima neta stop-loss. La prima neta stop-loss se calcula como \\[\\begin{eqnarray*} \\mathrm{E}(S_N-d)_+ &amp;=&amp; \\left\\{\\begin{array}{ll} \\int_{d}^{\\infty}(s-d) f_{S_N}(s) ds&amp; \\text{para } S_N\\text{ continua }\\\\ \\sum_{s&gt;d}(s-d) f_{S_N}(s) &amp; \\text{para } S_N \\text{ discreta }\\\\ \\end{array}\\right.\\\\ &amp;=&amp; \\mathrm{E}(S_N) - \\mathrm{E}(S_N\\wedge d)\\\\ \\end{eqnarray*}\\] Ejemplo 5.3.6. Pregunta Examen Actuarial. En una determinada semana el número de proyectos en los que se requiere trabajar horas extras sigue una distribución geométrica con \\(\\beta=2\\). En cada proyecto la distribución del número de horas extras en la semana, \\(X\\), es la siguiente: \\[ {\\small \\begin{matrix} \\begin{array}{ccc} \\hline x &amp; &amp; f(x)\\\\ \\hline 5 &amp; &amp; 0,2 \\\\ 10 &amp; &amp; 0,3 \\\\ 20 &amp; &amp; 0,5\\\\ \\hline \\end{array} \\end{matrix} } \\] El número de proyectos y el número de horas extras son independientes. Se pagan las horas extras cuando exceden las 15 horas semanales. Calcular el número esperado de horas extras por las que se cobrará en la semana. Mostrar Ejemplo de Solución Solución. El número de proyectos en una semana que requieren horas extras sigue una distribución \\(N \\sim Geo(\\beta=2)\\), mientras que el número de horas extras trabajadas por proyecto sigue la distribución \\(X\\) descrita previamente. El número total de horas extras en una semana es \\(S_N\\) y, por lo tanto, se quiere saber \\[\\mathrm{E}(S_N-15)_+ = \\mathrm{E}(S_N) - \\mathrm{E}(S_N \\wedge 15).\\] Para encontrar \\(\\mathrm{E}(S_N) = \\mathrm{E}(X) ~\\mathrm{E}(N)\\), se sabe \\[\\begin{aligned} &amp;\\mathrm{E}(X) = 5(0,2) + 10(0,3)+ 20(0,5)= 14 \\\\ &amp;\\mathrm{E}(N) = 2 \\\\ \\Rightarrow \\ &amp;\\mathrm{E}(S) = \\mathrm{E}(X) ~ \\mathrm{E}(N) = 14(2) = 28 \\end{aligned}\\] Para encontrar \\(\\mathrm{E} (S_N \\wedge 15) = 0 \\Pr (S_N=0) + 5 \\Pr(S_N=5) + 10 \\Pr(S_N=10) + 15 \\Pr(S_N \\geq 15)\\), se sabe \\[\\begin{aligned} \\Pr(S_N=0) &amp;= \\Pr(N=0) = \\frac{1}{1+\\beta} = \\frac{1}{3} \\\\ \\Pr(S_N=5) &amp;= \\Pr(X=5, \\ N=1) = 0,2 \\left(\\frac{2}{9} \\right)= \\frac{0,4}{9}\\\\ \\Pr(S_N=10) &amp;= \\Pr(X=10, \\ N=1) + \\Pr(X_1=X_2=5, N=2) \\\\ &amp;= 0,3 \\left(\\frac{2}{9} \\right) + (0,2)(0,2) \\left( \\frac{4}{27} \\right)= 0,0726 \\\\ \\Pr(S_N \\geq 15) &amp;= 1 - \\left(\\frac{1}{3} + \\frac{0,4}{9} + 0,0726 \\right) = 0,5496\\\\ \\Rightarrow \\mathrm{E}(S_N \\wedge 15) &amp;= 0 \\Pr (S_N=0) + 5 \\Pr(S_N=5) + 10 \\Pr(S_N=10) + 15 \\Pr(S_N \\geq 15) \\\\ &amp;= 0 \\left( \\frac{1}{3} \\right) + 5 \\left( \\frac{0,4}{9} \\right) + 10 (0,0726) + 15 (0,5496) = 9,193\\\\ \\end{aligned}\\] Por lo tanto, \\[\\begin{aligned} \\mathrm{E}(S_N-15)_+ &amp;= \\mathrm{E}(S_N) - \\mathrm{E}(S_N \\wedge 15) \\\\ &amp;= 28 – 9,193 = 18,807 \\end{aligned}\\] Cálculo recursivo de la prima neta Stop-Loss. En el caso discreto, se puede calcular recursivamente como \\[\\begin{aligned} \\mathrm{E}\\left[ \\left( S_N-(j+1)h \\right) _{+} \\right]=\\mathrm{E}\\left[ ( S_N-jh )_{+} \\right] -h \\left( 1-F_{S_N}(jh) \\right) . \\end{aligned}\\] Se asume que el soporte de \\(S_N\\) está igualmente espaciado en unidades de \\(h\\). Para mostrar lo anterior, asumamos que \\(h=1\\). Se tiene que \\[\\begin{aligned} \\mathrm{E}\\left[ \\left( S_N-(j+1) \\right) _{+} \\right] &amp;=\\mathrm{E}(S_N) - \\mathrm{E}[S_N\\wedge (j+1)] \\ ,\\ \\text{ y } \\\\ \\mathrm{E}\\left[ \\left( S_N - j \\right)_+ \\right] &amp;=\\mathrm{E}(S_N) - \\mathrm{E}[S_N\\wedge j] \\end{aligned}\\] Por lo tanto, \\[\\begin{aligned} \\mathrm{E}\\left[ \\left(S_N-(j+1) \\right) _{+}\\right] - \\mathrm{E}\\left[ ( S_N-j )_{+} \\right] &amp;= \\left\\{\\mathrm{E}(S_N) - \\mathrm{E}(S_N\\wedge (j+1)) \\right\\} - \\left\\{\\mathrm{E}(S_N) - \\mathrm{E}(S_N\\wedge j) \\right\\} \\\\ &amp;= \\mathrm{E}\\left(S_N \\wedge j \\right) - \\mathrm{E}\\left[ S \\wedge (j+1) \\right] \\end{aligned}\\] Puede expresarse como \\[\\begin{aligned} \\mathrm{E}\\left[S_N\\wedge (j+1)\\right] &amp;= \\sum_{x=0}^{j}xf_{S_N}(x) + (j+1)~\\Pr(S_N \\ge j+1) \\\\ &amp;= \\sum_{x=0}^{j-1}x f_{S_N}(x) + j~\\Pr(S_N=j) + (j+1)~\\Pr(S_N \\ge j+1) \\end{aligned}\\] Del mismo modo, \\[\\begin{aligned} \\mathrm{E}(S_N\\wedge j) = \\sum_{x=0}^{j-1}xf_{S_N}(x) + j~\\Pr(S_N\\ge j) \\end{aligned}\\] Con estas expresiones se tiene que \\[\\begin{aligned} \\mathrm{E}\\left[ \\left( S_N-(j+1) \\right) _{+} \\right] - \\mathrm{E~}\\left[ ( S_N-j )_{+} \\right] &amp;= \\mathrm{E}\\left(S_N \\wedge j \\right) - \\mathrm{E}\\left[ S \\wedge (j+1) \\right] \\\\ &amp;= \\left\\{ \\sum_{x=0}^{j-1}xf_{S_N}(x) + j~\\Pr(S_N\\ge j) \\right\\} - \\left\\{ \\sum_{x=0}^{j-1}x f_{S_N}(x) + j~\\Pr(S_N=j) + (j+1)~\\Pr(S_N \\ge j+1) \\right\\} \\\\ &amp;= j~\\left[\\Pr(S_N \\geq j) - \\Pr(S_N=j) \\right]- (j+1)~\\Pr(S_N \\ge j+1) \\\\ &amp;= j~\\Pr( S_N &gt; j) - (j+1)~\\Pr(S_N \\ge j+1) ~~~~ \\text{ (nótese que } \\Pr(S_N &gt; j) = \\Pr(S_N \\geq j+1) \\text{)} \\\\ &amp;= -\\Pr(S_N\\ge j+1) = -\\left[1 - F_{S_N}(j)\\right], \\end{aligned}\\] como se buscaba. Ejemplo 5.3.7. Pregunta Examen Actuarial - Continuación. Recordemos que el objetivo de esta pregunta era calcular \\(\\mathrm{E~}(S_N-15)_+\\). Tenga en cuenta que el soporte de \\(S_N\\) está igualmente espaciado en unidades de 5, por lo que esta pregunta también puede resolverse recursivamente mediante la expresión anterior con \\(h=5\\): Paso 1: \\[\\begin{aligned} \\mathrm{E~}(S_N-5)_+ &amp;= \\mathrm{E}(S_N) - 5 [1-\\Pr(S_N \\leq 0) ]\\\\ %\\Pr (S_N\\geq 5) \\\\ &amp;= 28 - 5 \\left(1 - \\frac{1}{3}\\right) = \\frac{74}{3}=24,6667 \\end{aligned}\\] Paso 2: \\[\\begin{aligned} \\mathrm{E~}(S_N-10)_+ &amp;= \\mathrm{E~}(S_N-5)_+ - 5 [1-\\Pr(S_N \\leq 5)]\\\\ %\\Pr (S_N\\ge 10) \\\\ &amp;= \\frac{74}{3} - 5\\left( 1 - \\frac{1}{3} - \\frac{0,4}{9}\\right) = 21,555 \\end{aligned}\\] Paso 3: \\[\\begin{aligned} \\mathrm{E~}(S_N-15)_+ &amp;= \\mathrm{E~}(S_N-10)_+ - 5 [1-\\Pr(S_N \\leq 10)] \\\\ %\\Pr (S_N\\ge 15) \\\\ &amp;= \\mathrm{E~}(S_N-10)_+ - 5\\Pr (S_N\\ge 15) \\\\ &amp;= 21,555 - 5 (0,5496) = 18,807 \\end{aligned}\\] 5.3.3 Resultados analíticos Existen algunas combinaciones de distribuciones de frecuencia y severidad de los siniestros que generan una distribución fácil de utilizar para las pérdidas agregadas. Esta sección proporciona algunos ejemplos sencillos. Aunque estos ejemplos son convenientes desde el punto de vista computacional, por lo general son demasiado sencillos para ser utilizados en la práctica. Ejemplo 5.3.8. Se obtiene una expresión cerrada para la distribución de la pérdida agregada cuando se considera una distribución geométrica para la frecuencia y una distribución exponencial para la severidad. Supongamos que el número de siniestros \\(N\\) sigue una geométrica con media \\(\\mathrm{E}(N)=\\beta\\), y que la cuantía del siniestro \\(X\\) sigue una exponencial con \\(\\mathrm{E}(X)=\\theta\\). Recuerde que la pgf de \\(N\\) y la mgf de \\(X\\) son: \\[\\begin{aligned} P_N (z) &amp;=\\frac{1}{1- \\beta (z-1)}\\\\ M_{X}(t) &amp;=\\frac{1}{1-\\theta t} \\end{aligned}\\] Por lo tanto, la mgf de la pérdida agregada \\(S_N\\) puede expresarse de dos formas (para más detalles, véase Suplemento Técnico 5.A.3) \\[\\begin{eqnarray} M_{S_N}(t) &amp;=&amp; P_N [M_{X}(t)] = \\frac{1}{1 - \\beta \\left( \\frac{1}{1-\\theta t} - 1\\right)} \\nonumber\\\\ &amp;=&amp; 1+ \\frac{\\beta}{1+\\beta} \\left([1-\\theta(1+\\beta)t]^{-1}-1 \\right)\\\\ &amp;=&amp; \\frac{1}{1+\\beta}(1) +\\frac{\\beta}{1+\\beta} \\left( \\frac{1}{1-\\theta (1+\\beta)t}\\right) \\end{eqnarray}\\] A partir de (5.1), se aprecia que \\(S_N\\) es equivalente a una distribución compuesta de \\(S_N=X^{*}_1+\\cdots+X^{*}_{N^{*}}\\), donde \\(N^{*}\\) es una Bernoulli con media \\(\\beta/(1+\\beta)\\) y \\(X^{*}\\) es una exponencial con media \\(\\theta(1+\\beta)\\). Para obtenerlo, se analiza la mgf de \\(S\\): \\[\\begin{aligned} M_{S_N}(t) = P_N [M_{X}(t)] = P_{N^{*}} [M_{X^{*}}(t)], \\end{aligned}\\] donde \\[\\begin{aligned} P_{N^*} (z) &amp;=1+ \\frac{\\beta}{1+ \\beta} (z-1),\\\\ M_{X^*} (t) &amp;=\\frac{1}{1- {{\\theta(1+\\beta)}} t}. \\end{aligned}\\] A partir de (5.2), se aprecia que \\(S_N\\) es también equivalente a una mixtura de dos puntos en 0 y en \\(X^{*}\\). En concreto, \\[\\begin{eqnarray*} S_N &amp;=&amp; \\left\\{ \\begin{array}{cl} 0 &amp; {\\rm con~ probabilidad ~Pr}(N^*=0) = 1/(1+\\beta) \\\\ Y^{*} &amp; {\\rm con~ probabilidad ~Pr}(N^*=1) = \\beta/(1+\\beta) \\end{array} \\right.. \\end{eqnarray*}\\] La función de distribución de \\(S_N\\) es: \\[\\begin{eqnarray*} \\Pr(S_N=0) &amp;=&amp; \\frac{1}{1+\\beta}\\\\ \\Pr(S_N&gt;s) &amp;=&amp; \\Pr(X^*&gt;s) =\\frac{\\beta}{1+\\beta} \\exp\\left( -\\frac{s}{ \\theta (1+\\beta)}\\right) \\end{eqnarray*}\\] con pdf \\[\\begin{eqnarray*} f_{S_N}(s) = \\frac{\\beta}{\\theta (1+\\beta)^2}\\exp\\left( -\\frac{s}{ \\theta (1+\\beta)}\\right). \\end{eqnarray*}\\] Ejemplo 5.3.9. Supongamos un modelo de riesgo colectivo en el que la severidad sigue una exponencial y con una distribución de frecuencias arbitraria. Recordemos que si \\(X_i\\sim Exp(\\theta)\\), la suma de iid exponenciales, \\(S_n=X_1+\\cdots+X_n\\), sigue una distribución gamma, es decir, \\(S_n\\sim Gam(n,\\theta)\\). Su cdf es: \\[\\begin{eqnarray*} F_{X}^{\\ast n}(s) &amp;=&amp; \\Pr (S_n \\le s) = \\int_{0}^{s} \\frac{1}{\\Gamma(n)\\theta^n}s^{n-1}\\exp\\left(-\\frac{s}{\\theta}\\right) ds\\\\ &amp;=&amp; 1-\\sum_{j=0}^{n-1}\\frac{1}{j!}\\left( \\frac{s}{\\theta}\\right)^j e^{-s/\\theta } . \\end{eqnarray*}\\] La última igualdad se deriva aplicando integración por partes \\(n-1\\) veces. Para la distribución de pérdidas agregadas, se puede intercambiar el orden de las sumas en la segunda línea, obteniendo \\[\\begin{eqnarray*} F_{S}\\left(s\\right) &amp;=&amp; p_{0}+\\sum_{n=1}^{\\infty }p_n F_{X}^{\\ast n}\\left(s\\right)\\\\ &amp;=&amp; 1 - \\sum_{n=1}^{\\infty }p_n \\sum_{j=0}^{n-1}\\frac{1}{j!} \\left( \\frac{s}{\\theta}\\right)^j e^{-s/\\theta }\\\\ &amp;=&amp; 1-e^{-s/\\theta}\\sum_{j=0}^{\\infty} \\frac{1}{j!} \\left( \\frac{s}{\\theta} \\right)^j \\overline{P}_j \\end{eqnarray*}\\] donde \\(\\overline{P}_j =p_{j+1}+p_{j+2}+\\cdots = \\Pr (N&gt;j)\\) es la “función de supervivencia” de la distribución del número de siniestros. 5.3.4 Distribución Tweedie En esta sección se analiza una distribución compuesta concreta en la que el número de siniestros sigue una distribución de Poisson y la cuantía del siniestro sigue una distribución gamma. Esta especificación genera lo que se conoce como distribución Tweedie. La distribución Tweedie tiene masa de probabilidad en cero y una componente continua para valores positivos. Esta característica hace que sea ampliamente utilizada en la modelización de la siniestralidad en seguros, donde la masa en cero se interpreta como ningún siniestro y la componente positiva como el coste de los siniestros. Concretamente, consideremos el modelo de riesgo colectivo \\(S_N=X_1+\\cdots+X_N\\). Supongamos que \\(N\\) sigue una distribución Poisson con media \\(\\lambda\\), y cada \\(X_i\\) sigue una distribución gamma con parámetro de forma \\(\\alpha\\) y parámetro de escala \\(\\gamma\\). La distribución Tweedie se deriva como la suma de Poisson de variables gamma. Para comprender la distribución de \\(S_N\\), primero examinemos la masa de probabilidad en cero. La pérdida total es cero cuando no se producen siniestros, es decir, \\[{\\rm Pr}(S_N=0)= {\\rm Pr}(N=0)=e^{-\\lambda}.\\] Además, cabe señalar que \\(S_N\\) condicionada a \\(N=n\\), denotada como \\(S_n=X_1+\\cdots+X_n\\), sigue una distribución gamma con parámetro de forma \\(n\\alpha\\) y escala \\(\\gamma\\). Para \\(s&gt;0\\) la densidad de la distribución Tweedie se calcula como \\[\\begin{aligned} f_{S_n}(s)&amp;=\\sum_{n=1}^{\\infty} p_n f_{S_n}(s)\\\\ &amp;=\\sum_{n=1}^{\\infty}e^{-\\lambda}\\frac{(\\lambda)^n}{n!}\\frac{\\gamma^{na}}{\\Gamma(n\\alpha)}s^{n\\alpha-1}e^{-s\\gamma} \\end{aligned}\\] Así, la distribución Tweedie se puede interpretar como una mixtura en cero y una distribución para valores positivos, lo que la convierte en una herramienta adecuada para la modelización de la siniestralidad y para el cálculo de las primas puras en seguros. La media y la varianza del modelo Tweedie-Poisson compuesto son: \\[{\\rm E} (S_N)=\\lambda\\frac{\\alpha}{\\gamma}~~~~{\\rm y}~~~~{\\rm Var} (S)=\\lambda\\frac{\\alpha(1+\\alpha)}{\\gamma^2}.\\] Otra característica importante es que la distribución Tweedie es un caso especial de los modelos de dispersión exponencial, una clase de modelos utilizados para describir la componente aleatoria en los modelos lineales generalizados. Para apreciarlo, consideremos la siguiente reparametrización: \\[\\begin{equation*} \\lambda=\\frac{\\mu^{2-p}}{\\phi(2-p)},~~~~\\alpha=\\frac{2-p}{p-1},~~~~\\frac{1}{\\gamma}=\\phi(p-1)\\mu^{p-1} \\end{equation*}\\] A partir de estas relaciones se puede demostrar que la distribución de \\(S_N\\) es \\[f_{S_N}(s)=\\exp\\left[\\frac{1}{\\phi}\\left(\\frac{-s}{(p-1)\\mu^{p-1}}-\\frac{\\mu^{2-p}}{2-p}\\right)+C(s;\\phi)\\right]\\] donde \\[\\begin{equation*} C(s;\\phi/\\omega_i)=\\left\\{\\begin{array}{ll} \\displaystyle 0 &amp; {\\rm if}~ y=0 \\\\ \\displaystyle \\ln \\sum\\limits_{n\\ge 1} \\left\\{\\frac{(1/\\phi)^{1/(p-1)}y^{(2-p)/(p-1)}}{(2-p)(p-1)^{(2-p)/(p-1)}}\\right\\}^{n}\\frac{1}{n!\\Gamma(n(2-p)/(p-1))s} &amp; {\\rm if}~ y&gt;0 \\end{array}\\right. \\end{equation*}\\] Por tanto, la distribución de \\(S_N\\) pertenece a la familia exponencial con parámetros \\(\\mu\\), \\(\\phi\\), y \\(1 &lt; p &lt; 2\\), y se obtiene que \\[{\\rm E} (S_N)=\\mu~~~~{\\rm y}~~~~{\\rm Var} (S_N)=\\phi\\mu^{p}.\\] Lo anterior permite utilizar la distribución Tweedie para modelizar los siniestros en los modelos lineales generalizados. Cabe mencionar los dos casos límite del modelo Tweedie: \\(p\\rightarrow 1\\) conduce a la distribución Poisson y \\(p\\rightarrow 2\\) conduce a la distribución gamma. De este modo, el modelo Tweedie se sitúa entre las distribuciones gamma y Poisson, lo que intuitivamente tiene sentido ya que es la suma de Poisson de variables aleatorias gamma. 5.4 Cálculo de la distribución de pérdidas agregadas El cálculo de la distribución de pérdidas agregadas es un problema difícil e importante. Como se ha visto, tanto para el modelo de riesgo individual como para el modelo de riesgo colectivo, el cálculo de la distribución frecuentemente implica la evaluación de una convolución de orden \\(n\\). Para hacer manejable el problema, una posible estrategia es considerar una distribución que sea fácil de evaluar para aproximar la distribución de pérdidas agregadas. Por ejemplo, la distribución normal es una elección natural basada en el teorema central del límite, en el que los parámetros de la distribución normal pueden estimarse calculando los momentos. Este enfoque tiene ventajas y limitaciones. La principal ventaja es la facilidad de cálculo. La desventaja es: primero, el tamaño y la dirección del error de aproximación son desconocidos; segundo, la aproximación puede fallar en capturar algunas características especiales de la pérdida agregada tales como la masa en el punto cero. Esta sección describe dos enfoques prácticos para calcular la distribución de la pérdida agregada, el método recursivo y la simulación. 5.4.1 Método recursivo El método recursivo se aplica a los modelos compuestos en los que la componente de la frecuencia \\(N\\) pertenece a la clase \\((a,b,0)\\) o \\((a,b,1)\\) (véanse las Secciones 2.3 y 2.5.1) y la componente de la severidad \\(X\\) sigue una distribución discreta. En caso que \\(X\\) sea continua, una práctica habitual es primero discretizar la distribución de la severidad y, posteriormente, aplicar el método recursivo. Supongamos que \\(N\\) está en la clase \\((a,b,1)\\) tal que \\(p_{k}=\\left( a+\\frac{b}{k} \\right) p_{k-1}, k = 2,3,\\ldots\\). Supongamos además que el soporte de \\(X\\) es \\(\\{0,1,\\ldots,m\\}\\), discreto y finito. Entonces, la función de probabilidad de \\(S_N\\) es: \\[\\begin{aligned} f_{S_N}(s)&amp;=\\Pr (S=s) \\\\ &amp;=\\frac{1}{1-af_{X}(0)}\\left\\{ \\left[ p_1 -(a+b)p_{0}\\right] f_X (s)+\\sum_{x=1}^{s\\wedge m}\\left( a+\\frac{bx}{s} \\right) f_X (x)f_{S_N}(s-x)\\right\\}. \\end{aligned}\\] Si \\(N\\) está en la clase \\((a,b,0)\\), entonces \\(p_1=(a+b)p_0\\) y, por tanto, \\[ f_{S_N}(s)=\\frac{1}{1-af_X (0)}\\left\\{ \\sum_{x=1}^{s\\wedge m}\\left( a+\\frac{bx }{s}\\right) f_X (x)f_{S_N}(s-x)\\right\\}. \\] Caso particular: Frecuencia según una Poisson. Si \\(N \\sim Poi(\\lambda)\\), entonces \\(a=0\\) y \\(b=\\lambda\\), y, por tanto, \\[ f_{S_N}(s)=\\frac{\\lambda }{s}\\left\\{ \\sum_{x=1}^{s \\wedge m} x f_X (x) f_{S_N} (s-x)\\right\\} . \\] Ejemplo 5.4.1. Pregunta Examen Actuarial. El número de siniestros en un determinado período \\(N\\) sigue una distribución geométrica de media 4. La cuantía de cada siniestro \\(X\\) tiene \\({\\rm Pr} (X = x) = 0,25\\), para \\(x = 1,2,3,4\\). El número de siniestros y la cuantía de los mismos son independientes. \\(S_N\\) es el coste total de los siniestros en el período. Calcular \\(F_{S_N}(3)\\). Mostrar Ejemplo de Solución Solución. La distribución de severidad \\(X\\) es la siguiente \\[f_X (x) = \\frac{1}{4}, \\ \\ x=1, 2, 3, 4.\\] La distribución de frecuencias \\(N\\) es geométrica de media 4, la cual pertenece a la clase \\((a,b,0)\\) con \\(b=0\\), \\(a=\\frac{\\beta}{1+\\beta} = \\frac{4}{5}\\), y \\(p_0 = \\frac{1}{1+\\beta} = \\frac{1}{5}\\). El soporte de la componente de severidad \\(X\\) es \\(\\{1,\\ldots,m=4 \\}\\), discreto y finito. Por lo tanto, se puede utilizar el método recursivo \\[\\begin{aligned} f_{S_N} (x) &amp;= 1 \\sum_{y=1}^{x\\wedge m} (a+0) f_X (y) f_{S_N} (x-y) \\\\ &amp;= \\frac{4}{5} \\sum_{y=1}^{x\\wedge m} f_X (y) f_{S_N} (x-y) \\end{aligned}\\] En concreto, se tiene que \\[\\begin{aligned} f_{S_N} (0) &amp;= \\Pr(N=0) = p_0=\\frac{1}{5}\\\\ f_{S_N} (1) &amp;= \\frac{4}{5}\\sum_{y=1}^{1} f_X (y) f_{S_N} (1-y) = \\frac{4}{5} f_X(1) f_{S_N}(0)\\\\ &amp;= \\frac{4}{5}\\left( \\frac{1}{4}\\right)\\left(\\frac{1}{5} \\right) = \\frac{1}{25}\\\\ f_{S_N} (2) &amp;= \\frac{4}{5}\\sum_{y=1}^{2} f_X (y) f_{S_N} (2-y) = \\frac{4}{5} \\left[ f_X(1)f_{S_N}(1) + f_X(2) f_{S_N}(0) \\right] \\\\ &amp;= \\frac{4}{5}\\left[ \\frac{1}{4} \\left( \\frac{1}{25} + \\frac{1}{5}\\right) \\right] = \\frac{4}{5}\\left( \\frac{6}{100}\\right) = \\frac{6}{125}\\\\ f_{S_N} (3) &amp;= \\frac{4}{5} \\left[ f_X(1) f_{S_N}(2) + f_X(2)f_{S_N}(1) + f_X(3) f_{S_N}(0) \\right]\\\\ &amp;= \\frac{4}{5}\\left[ \\frac{1}{4} \\left( \\frac{1}{25} + \\frac{1}{5} + \\frac{6}{125}\\right) \\right] = \\frac{1}{5}\\left( \\frac{5+25+6}{125}\\right) = 0,0576\\\\ \\Rightarrow \\ F_{S_N} (3) &amp;= f_{S_N} (0)+f_{S_N} (1)+f_{S_N} (2) +f_{S_N} (3) = 0,3456 \\end{aligned}\\] 5.4.2 Simulación La distribución de pérdidas agregadas puede evaluarse mediante simulación de Monte Carlo. La idea es que se puede calcular la distribución empírica de \\(S_N\\) utilizando una muestra aleatoria. El valor esperado y la varianza de la pérdida agregada también pueden estimarse a partir de la media muestral y varianza muestral de los valores simulados. A continuación se resumen los procedimientos de simulación para los modelos de pérdidas agregadas. Supongamos que \\(m\\) es el tamaño de la muestra aleatoria generada de pérdidas agregadas. Modelo de Riesgo Individual \\(S_n=X_1+\\cdots+X_n\\) Supongamos el contador \\(j=1,\\ldots,m\\). Se fija \\(j=1\\). Se genera cada realización de pérdida individual \\(x_{ij}\\) para \\(i=1,\\ldots,n\\). Por ejemplo, se puede utilizar el método de transformación inversa (Sección 6.2). Se calcula la pérdida total \\(s_j = x_{1j} + \\cdots + x_{nj}\\). Se repiten los dos pasos anteriores para \\(j=2,\\ldots,m\\) hasta obtener una muestra de tamaño \\(m\\) de \\(S_n\\), es decir, \\(\\{s_1,\\ldots,s_m\\}\\). Modelo de riesgo colectivo \\(S_N=X_1+\\cdots+X_N\\) Supongamos el contador \\(j=1,\\ldots,m\\). Se fija \\(j=1\\). Se genera el número de siniestros \\(n_j\\) de la distribución de frecuencias \\(N\\). Dado \\(n_j\\), se genera a partir de la distribución de severidad \\(X\\) la cuantía de cada siniestro independiente, denotado por \\(x_{1j},\\ldots,x_{n_j j}\\). Se calcula la pérdida agregada \\(s_j = x_{1j} + \\cdots + x_{n_j j}\\). Se repiten los tres pasos anteriores para \\(j=2,\\ldots,m\\) hasta obtener una muestra de tamaño \\(m\\) de \\(S_N\\), es decir, \\(\\{s_1,\\ldots, s_m\\}\\). A partir de la muestra aleatoria de \\(S\\), la distribución empírica se puede calcular como \\[\\hat{F}_S(s)=\\frac{1}{m}\\sum_{i=1}^{m}I(s_i\\leq s),\\] donde \\(I(\\cdot)\\) es una función indicadora. La distribución empírica \\(\\hat{F}_S(s)\\) convergerá casi seguramente a \\({F}_S(s)\\) a medida que el tamaño muestral \\(m\\rightarrow \\infty\\). El procedimiento anterior asume que se conocen las distribuciones de probabilidad, incluidos los valores de los parámetros, de las distribuciones de frecuencia y severidad. En la práctica, primero habría que seleccionar estas distribuciones, estimar sus parámetros a partir de los datos, y luego evaluar la calidad del ajuste del modelo utilizando diferentes herramientas de validación del modelo (véase el capítulo 4). Por ejemplo, los supuestos del modelo de riesgo colectivo sugieren una estimación en dos etapas, en la que se construye un modelo para el número de siniestros \\(N\\) a partir de los datos de conteo de siniestros, y otro modelo para la severidad de los siniestros \\(X\\) a partir de los datos del importe de los siniestros. *** Ejemplo 5.4.2. Consideremos el ejemplo 5.3.5 con la frecuencia de siniestros del individuo \\(N \\sim Poi(\\lambda=25)\\) y severidad de los siniestros \\(X \\sim U(5,95)\\). A partir de una muestra simulada de 10.000 observaciones, estimar la media y la varianza de la pérdida agregada \\(S_N\\). Además, utilizar la muestra simulada para estimar la probabilidad que el coste total de la siniestralidad para esta persona será superior a 2000 y compararla con la estimación basada en la aproximación normal del ejemplo 5.3.5. Mostrar Ejemplo de Solución Solución. Se sigue el algoritmo para el modelo de riesgo colectivo, en el que primero se simulan las frecuencias \\(n_1,\\ldots,n_{10000}\\), y condicionado a \\(n_j,~j=1,\\ldots,10000\\), se simula cada pérdida individual \\(x_{ij},~i=1,\\ldots n_j\\). set.seed(4321) # Para reproducir los resultados m &lt;- 10000 # Número de observaciones a simular lambda &lt;- 25 # Parámetro de la distribución de frecuencias N a &lt;- 5; b &lt;- 95 # Parámetros de la distribución de severidad X S &lt;- rep(NA, m) # Creación un vector vacío para almacenar las observaciones S n &lt;- rpois(m, lambda) # Se generan m=10000 observaciones de N de una Poisson for(j in 1:m){ n_j &lt;- n[j] # A partir de cada n_j (j=1,...,m), se generan n_j observaciones de X de una uniforme x_j &lt;- runif(n_j, min=a, max=b) s_j &lt;- sum(x_j) # Se calcula la pérdida agregada s_j S[j] &lt;- s_j # Se almacena s_j en el vector de observaciones } mean(S) # Compararlo con el valor teórico de 1250 ## [1] 1248.09 var(S) # Compararlo con el valor teórico de 79375 ## [1] 77441.22 mean(S&gt;2000) # Proporción de observaciones simuladas s_j que son &gt; 2000 ## [1] 0.0062 # Compararlo con el método de aproximación normal de 0,003884 A partir de la simulación se estima que la media y varianza de la siniestralidad agregada es aproximadamente 1248 y 77441 respectivamente, en comparación con los valores teóricos de 1.250 y 79.375. Además, se estima que la probabilidad que las pérdidas agregadas excedan 2000 es 0.0062, en comparación con la estimación de aproximación normal de 0,003884. Se puede evaluar si es apropiada la aproximación normal comparando la distribución empírica de las pérdidas agregadas simuladas con la densidad de la distribución normal utilizada para la aproximación normal, \\(N(\\mu=1,250~, ~\\sigma^2=79,375)\\): Las pérdidas simuladas son ligeramente más asimétricas a la derecha que la distribución normal, con una cola a la derecha más pesada. Lo anterior explicaría el hecho que el estimador de \\(\\Pr(S_N &gt; 2000)\\) de la aproximación normal es menor que el estimador basado en la simulación. 5.5 Efectos de la modificación de las coberturas 5.5.1 Impacto de la exposición en la frecuencia Esta sección se centra en un modelo de riesgo individual para el número de siniestros. Recordemos que el modelo de riesgo individual implica un número fijo de contratos \\(n\\) y variables aleatorias de pérdidas independientes \\(X_i\\). Considere el número de siniestros de un grupo de pólizas \\(n\\): \\[S=X_1+\\cdots+X_n\\] donde se asume que las \\(X_i\\) son iid que representan el número de siniestros de cada póliza \\(i\\). En este caso, la exposición de la cartera es \\(n\\), utilizando la póliza como base de exposición. La pgf de \\(S\\) es \\[\\begin{aligned} P_{S}(z)&amp;={\\rm E}(z^S)={\\rm E}\\left(z^{\\sum_{i=1}^nX_i}\\right)\\\\ &amp;=\\prod_{i=1}^n{\\rm E}(z^{X_i})=[P_X(z)]^n \\end{aligned}\\] Caso particular: Poisson. Si \\(X_i\\sim Poi(\\lambda)\\), su pgf es \\(P_X(z)=e^{\\lambda(z-1)}\\). Entonces la pgf de \\(S\\) es \\[P_{S}(z)=[e^{\\lambda(z-1)}]^n=e^{n\\lambda(z-1)}.\\] Por tanto \\(S\\sim Poi(n\\lambda)\\). Es decir, la suma de \\(n\\) variables aleatorias de Poisson independientes, cada una de media \\(\\lambda\\), sigue una distribución de Poisson de media \\(n\\lambda\\). Caso particular: Binomial Negativa. Si \\(X_i\\sim NB(\\beta,r)\\), su pgf es \\(P_X(z)=[1-\\beta(z-1)]^{-r}\\). Entonces la pgf de \\(S\\) es \\[P_{S}(z)=[[1-\\beta(z-1)]^{-r}]^n=[1-\\beta(z-1)]^{-nr}.\\] Por tanto \\(S\\sim NB(\\beta,nr)\\). Ejemplo 5.5.1. Supongamos que el número de siniestros por vehículo sigue una Poisson con media \\(\\lambda\\). Dados los siguientes datos sobre el número observado de siniestros para cada hogar, estima \\(\\lambda\\) por máxima verosimilitud. \\[ {\\small \\begin{matrix} \\begin{array}{c|c|c} \\hline \\text{Hogar ID} &amp; \\text{Número de vehículos} &amp; \\text{Número de siniestros} \\\\ \\hline 1 &amp; 2 &amp; 0 \\\\ 2 &amp; 1 &amp; 2 \\\\ 3 &amp; 3 &amp; 2 \\\\ 4 &amp; 1 &amp; 0 \\\\ 5 &amp; 1 &amp; 1 \\\\ \\hline \\end{array} \\end{matrix} } \\] Mostrar Ejemplo de Solución Solución. Cada uno de los 5 hogares tiene un número de exposiciones \\(n_j\\) (número de vehículos) y un número de siniestros \\(S_j\\), \\(j=1,...,5\\). En cada hogar el número de siniestros \\(S_j \\sim Poi (n_j \\lambda)\\). La función de verosimilitud es \\[\\begin{aligned} L(\\lambda) &amp;= \\prod_{j=1}^5 \\Pr(S_j=s_j) = \\prod_{j=1}^5 \\frac{e^{-n_j\\lambda} (n_j \\lambda)^{s_j}}{s_j!} \\\\ &amp;= \\left(\\frac{e^{-2\\lambda} (2 \\lambda)^{0}}{0!} \\right) \\left(\\frac{e^{-1\\lambda} (1 \\lambda)^{2}}{2!} \\right) \\left(\\frac{e^{-3\\lambda} (3 \\lambda)^{2}}{2!} \\right) \\left(\\frac{e^{-1\\lambda} (1 \\lambda)^{0}}{0!} \\right) \\left(\\frac{e^{-1\\lambda} (1 \\lambda)^{1}}{1!} \\right) \\\\ &amp;\\propto e^{-8\\lambda} \\lambda^5 \\end{aligned}\\] Tomando el logaritmo de verosimilid, se tiene \\[\\begin{aligned} l(\\lambda) = \\log L(\\lambda) = -8\\lambda + 5\\log(\\lambda) \\end{aligned}\\] Igualando a cero la primera derivada del logaritmo de verosimilitud, se obtiene \\(\\hat{\\lambda} = \\frac{5}{8}\\) Si la exposición de la cartera cambia de \\(n_1\\) a \\(n_2\\), se puede establecer la siguiente relación entre el número total de siniestros: \\[P_{S_{n_2}}(z)=[P_X(z)]^{n_2}=[P_X(z)^{n_1}]^{n_2/n_1}=P_{S_{n_1}}(z)^{n_2/n_1}.\\] 5.5.2 Impacto de los deducibles en la frecuencia de siniestros Esta sección examina el efecto de los deducibles en la frecuencia de los siniestros. Intuitivamente, si se introduce un deducible en la póliza, disminuirán los siniestros reclamados ya que no se reclamará si la cuantía reclamada es inferior al deducible. Incluso si el asegurado realiza la reclamación, puede que no se realice ningún pago en la póliza, ya que puede denegarse el siniestro o que la cuantía del mismo se determine finalmente por debajo del deducible. Denotemos \\(N^L\\) el número de pérdidas (es decir, el número de siniestros sin deducible), y \\(N^P\\) el número de pagos cuando se establece un deducible \\(d\\). El objetivo es identificar la distribución de \\(N^P\\) dada la distribución de \\(N^L\\). A continuación se demuestra que la relación entre \\(N^L\\) y \\(N^P\\) puede establecerse en el marco del modelo de riesgo agregado. Cabe señalar que, en ocasiones, cambios en los deducibles podrían afectar al comportamiento de siniestralidad del asegurado. Suponemos aquí que esto no ocurre, es decir, que las distribuciones subyacentes de pérdidas, tanto para la frecuencia como para la severidad, se mantienen sin cambios cuando varía el deducible. Dado que ocurren \\(N^L\\) pérdidas, suponemos que \\(X_1,X_2\\ldots,X_{N^L}\\) son las cuantías asociadas de las pérdidas. Para \\(j=1,\\ldots,N^L\\), se define \\[\\begin{eqnarray*} I_j&amp;=&amp; \\left \\{ \\begin{array}{cc} 1 &amp; \\text{si} ~X_j&gt;d\\\\ 0 &amp; \\text{el resto de casos}\\\\ \\end{array} \\right.. \\end{eqnarray*}\\] Por tanto, se establece \\[N^P=I_1+I_2+\\cdots+I_{N_L},\\] Es decir, el número total de pagos es igual al número de pérdidas por encima del valor del deducible. Dado que las \\(I_j\\) son variables aleatorias de Bernoulli independientes con probabilidad de éxito \\(v=\\Pr(X&gt;d)\\), la suma de un número fijo de estas variables es una variable aleatoria binomial. Condicionado a \\(N^L\\), \\(N^P\\) sigue una distribución binomial, es decir, \\(N^P | N^L \\sim Bin(N^L, v)\\), donde \\(v=\\Pr(X&gt;d)\\). Lo anterior implica que \\[\\begin{aligned} \\mathrm{E}\\left(z^{N^P}|N^L\\right)&amp;= \\left[ 1+v(z-1)\\right]^{N^L} \\end{aligned}\\] Por tanto, la pgf de \\(N^P\\) es \\[\\begin{aligned} P_{N^P}(z)&amp;= \\mathrm{E}_{N^P}\\left(z^{N^P}\\right)=\\mathrm{E}_{N^L}\\left[\\mathrm{E}_{N^P}\\left(z^{N^P}|N^L\\right)\\right]\\\\ &amp;= \\mathrm{E}_{N^L}\\left[(1+v(z-1))^{N^L}\\right]\\\\ &amp;= P_{N^L}\\left(1+v(z-1)\\right) \\end{aligned}\\] Así, se puede definir la pgf de \\(N^P\\) como la pgf de \\(N^L\\), evaluada en un nuevo argumento \\(z^* = 1+v(z-1)\\). Esto es, \\(P_{N^P}(z)=P_{N^L}(z^*)\\). Casos particulares: \\(N^L\\sim Poi (\\lambda)\\). La pgf de \\(N^L\\) es \\(P_{N^L}=e^{\\lambda(z-1)}\\). De este modo, la pgf de \\(N^P\\) es \\[\\begin{aligned} P_{N^P}(z) &amp;= e^{ \\lambda(1+v(z-1)-1)} \\\\ &amp;= e^{\\lambda v(z-1)} , \\end{aligned}\\] Por tanto, \\(N^P \\sim Poi(\\lambda v)\\). Esto significa que el número de pagos tiene la misma distribución que el número de pérdidas, pero con un número esperado de pagos igual a \\(\\lambda v = \\lambda \\Pr(X&gt;d)\\). \\(N^L \\sim NB(\\beta, r)\\). La pgf de \\(N^L\\) es \\(P_{N^{L}}\\left( z\\right) =\\left[ 1-\\beta \\left( z-1\\right)\\right]^{-r}\\). De este modo, la pgf de \\(N^P\\) es \\[\\begin{aligned} P_{N^P}(z)&amp;= \\left( 1-\\beta (1+v(z-1)-1)\\right)^{-r}\\\\ &amp;= \\left( 1-\\beta v(z-1)\\right)^{-r}, \\end{aligned}\\] Por tanto, \\(N^P \\sim NB(\\beta v, r)\\). Esto significa que el número de pagos tiene la misma distribución que el número de pérdidas, pero con parámetros \\(\\beta v\\) y \\(r\\). Ejemplo 5.5.2. Supongamos que las pérdidas \\(X_i\\sim Pareto(\\alpha=4,\\ \\theta=150)\\). Sabemos que la frecuencia de pérdidas es \\(N^L\\sim Poi(\\lambda)\\) y la frecuencia de pagos es \\(N^{P}_1\\sim Poi(0,4)\\) con un deducible de valor igual a \\(d_1=30\\). Encontrar la distribución de la frecuencia de pagos \\(N^{P}_2\\) cuando el valor del deducible es \\(d_2=100\\). Mostrar Ejemplo de Solución Solución. Al ser la frecuencia de pérdidas \\(N^L\\) Poisson, las medias de la distribución de pérdidas \\(N^L\\) y la primera distribución de pagos \\(N^{P}_1\\) (con deducible \\(d_1=30\\)) se relacionan como \\(0,4 = \\lambda v_1\\), donde \\[\\begin{aligned} &amp;v_1 = \\Pr(X &gt; 30) = \\left( \\frac{150}{30+150}\\right)^4=\\left( \\frac{5}{6}\\right)^4 \\\\ \\Rightarrow \\ &amp; \\lambda = 0.4 \\left( \\frac{6}{5} \\right)^4 \\end{aligned}\\] Ahora, se puede definir la segunda distribución de pagos \\(N^{P}_2\\) (con deducible \\(d_2=100\\)) como Poisson con media \\(\\lambda_2 = \\lambda v_2\\), donde \\[\\begin{aligned} &amp; v_2 = \\Pr(X&gt;100)=\\left( \\frac{150}{100+150}\\right)^4=\\left( \\frac{3}{5}\\right)^4 \\\\ \\Rightarrow \\ &amp; \\lambda_2 = \\lambda v_2 = 0,4\\left( \\frac{6}{5} \\right)^4 \\left( \\frac{3}{5} \\right)^4 = 0,1075 \\end{aligned}\\] Ejemplo 5.5.3. Continuación. Ahora supongamos que la frecuencia de pérdidas es \\(N^L \\sim NB(\\beta,\\ r)\\) y para el deducible \\(d_1=30\\), la frecuencia de pagos \\(N^{P}_1\\) es negativa binomial con media \\(0,4\\). Encontrar la media de la frecuencia de pagos \\(N^{P}_2\\) para el deducible \\(d_2=100\\). Mostrar Ejemplo de Solución Solución. Al ser la frecuencia de pérdidas \\(N^L\\) una binomial negativa, el parámetro \\(\\beta\\) de la distribución \\(N^L\\) y el parámetro \\(\\beta_1\\) de la primera distribución de pagos \\(N^{P}_1\\) se relacionan como \\(\\beta_1 = \\beta v_1\\), donde \\[v_1 = \\Pr(X &gt; 30) = \\left( \\frac{5}{6} \\right)^4\\] Así, la media de \\(N^{P}_1\\) y la media de \\(N^L\\) se relacionan vía \\[\\begin{aligned} &amp;0,4 = r \\beta_1 = r \\left(\\beta v_1\\right) \\\\ \\Rightarrow \\ &amp; r\\beta = \\frac{0,4}{v_1} = 0,4 \\left(\\frac{6}{5} \\right)^4 \\end{aligned}\\] Nótese que \\(v_2 = \\Pr(X &gt; 100) = \\left( \\frac{3}{5}\\right)^4\\) como en el ejemplo original. Entonces, la segunda distribución de frecuencia de pagos con deducible \\(d_2=100\\) es \\(N^{P}_2 \\sim NB(\\beta v_2, \\ r)\\) con media \\[\\begin{aligned} r (\\beta v_2) = (r \\beta) v_2 = 0,4 \\left( \\frac{6}{5}\\right)^4 \\left( \\frac{3}{5} \\right)^4 = 0,1075 \\end{aligned}\\] A continuación, se examina el caso más general en el que \\(N^L\\) es una distribución cero modificada. Recordemos que una distribución cero modificada puede definirse en términos de una distribución no modificada (como se señala en la Sección 2.5.1). Es decir, \\[\\begin{aligned} p_k^M = c~p_k^0, {~\\rm para~} k=1,2,3,\\ldots, {~\\rm con~}c = \\frac{1-p_0^M}{1-p_0^0}, \\end{aligned}\\] donde \\(p^0_k\\) es la pmf de una distribución no modificada. En el caso que \\(p_0^M=0\\), se denomina una distribución cero truncada, o \\(ZT\\). Para otros valores arbitrarios de \\(p_0^M\\), es una distribución cero modificada, o \\(ZM\\). La pgf de la distribución modificada se obtiene como \\[\\begin{aligned} P^M(z) &amp;= 1-c+c~P^0(z), \\end{aligned}\\] expresada en términos de la pgf de la distribución no modificada, \\(P^0(z)\\). Cuando \\(N^L\\) sigue una distribución cero modificada, la distribución de \\(N^P\\) se establece usando la misma relación anterior, \\(P_{N^P}(z)=P_{N^L}\\left(1+v(z-1)\\right)\\). Casos particulares: \\(N^{L}\\) es una variable aleatoria ZM-Poisson con parámetros \\(\\lambda\\) y \\(p_0^{M}\\). La pgf de \\(N^L\\) es \\[P_{N^{L}}(z)=1-\\cfrac{1-p_0^{M}}{1-e^{-\\lambda}}+\\cfrac{1-p_0^{M}}{1-e^{-\\lambda}}\\left( e^{\\lambda(z-1)} \\right).\\] Por tanto, la pgf de \\(N^P\\) es \\[P_{N^{P}}(z)=1-\\cfrac{1-p_0^{M}}{1-e^{-\\lambda}}+\\cfrac{1-p_0^{M}}{1-e^{-\\lambda}}\\left( e^{\\lambda v(z-1)} \\right).\\] Así el número de pagos sigue también una distribución ZM-Poisson con parámetros \\(\\lambda v\\) y \\(p_0^{M}\\). La probabilidad en cero se puede evaluar mediante \\({\\rm Pr}(N^P=0) = P_{N^P}(0)\\). \\(N^{L}\\) es una variable aleatoria ZM-binomial negativa con parámetros \\(\\beta\\), \\(r\\), y \\(p_0^{M}\\). La pgf de \\(N^L\\) es \\[P_{N^{L}}(z)=1-\\cfrac{1-p_0^{M}}{1-(1+\\beta)^{-r}}+\\cfrac{1-p_0^{M}}{1-(1+\\beta)^{-r}}\\left[ 1-\\beta \\left( z-1\\right)\\right]^{-r}.\\] Por tanto, la pgf de \\(N^P\\) es \\[P_{N^{P}}(z)=1-\\cfrac{1-p_0^{M}}{1-(1+\\beta)^{-r}}+\\cfrac{1-p_0^{M}}{1-(1+\\beta)^{-r}}\\left[ 1-\\beta v\\left( z-1\\right)\\right]^{-r}.\\] Así, el número de pagos sigue también una distribución ZM-binomial negativa con parámetros \\(\\beta v\\), \\(r\\), y \\(p_0^{M}\\). Del mismo modo, la probabilidad en cero se puede evaluar mediante \\({\\rm Pr}(N^P=0) = P_{N^P}(0)\\). Ejemplo 5.5.4. Las pérdidas agregadas se modelizan de la siguiente manera: (i) El número de pérdidas sigue una distribución Poisson modificada en cero con \\(\\lambda=3\\) y \\(p_0^M = 0,5\\). (ii) La cuantía de la pérdida sigue una distribución Burr con \\(\\alpha=3, \\theta=50, \\gamma=1\\). (iii) Se introduce un deducible \\(d=30\\) para cada pérdida. (iv) El número de pérdidas y su cuantía son independientes entre sí. Calcular \\(\\mathrm{E}(N^P)\\) y \\(\\mathrm{Var}(N^P)\\). Mostrar Ejemplo de Solución Solución. Dado que \\(N^L\\) sigue una distribución ZM-Poisson con parámetros \\(\\lambda\\) y \\(p_0^M\\), sabemos que \\(N^P\\) también sigue una distribución ZM-Poisson, pero con parámetros \\(\\lambda v\\) y \\(p_0^M\\), donde \\[v = \\Pr(X&gt;30) = \\left( \\frac{1}{1+(30/50)} \\right)^3 = 0,2441\\] Por tanto, \\(N^P\\) sigue una distribución ZM-Poisson con parámetros \\(\\lambda^\\ast = \\lambda v= 0,7324\\) y \\(p_0^M = 0,5\\). Finalmente, \\[\\begin{aligned} \\mathrm{E} (N^P) &amp;= (1-p_0^M) \\frac{\\lambda^\\ast}{1-e^{-\\lambda^\\ast}} = 0,5 \\left( \\frac{0,7324}{1-e^{-0,7324}} \\right) \\\\ &amp;= 0,7053 \\\\ \\mathrm{Var} (N^P) &amp;= (1-p_0^M) \\left( \\frac{\\lambda^\\ast[1-(\\lambda^\\ast + 1) e^{-\\lambda^\\ast}]}{(1-e^{-\\lambda^\\ast})^2} \\right) + p_0^M(1-p_0^M) \\left(\\frac{\\lambda^\\ast}{1-e^{-\\lambda^\\ast}} \\right)^2 \\\\ &amp;= 0,5 \\left( \\frac{0,7324(1-1,7324 e^{-0,7324})}{(1-e^{-0,7324})^2} \\right) + 0,5^2 \\left( \\frac{0,7324}{1-e^{-0,7324}} \\right)^2 \\\\ &amp;= 0,7244 \\end{aligned}\\] 5.5.3 Impacto de las modificaciones de la póliza en la siniestralidad agregada En esta sección, se examina el efecto de un cambio en el deducible sobre los pagos agregados de una cartera de seguros. Se asume que la presencia de límites en la póliza (\\(u\\)), coaseguro (\\(\\alpha\\)) e inflación (\\(r\\)) no tienen ningún efecto en la distribución subyacente de la frecuencia de pagos realizados por la aseguradora. Al igual que en la sección anterior, asumimos que cambios en los deducibles tampoco afectan las distribuciones subyacentes de pérdidas, ni la de frecuencia ni la de severidad. Recordar la notación \\(N^L\\) para el número de pérdidas. Con la cuantía de la pérdida inicial \\(X\\) y el deducible de la póliza \\(d\\), se usa \\(N^P\\) para el número de pagos (como se definió en la sección anterior 5.5.2). Asimismo, se define el importe en base a las pérdidas \\[\\begin{eqnarray*} X^{L}&amp;=\\left\\{ \\begin{array}{ll} 0 ~, &amp; \\text{si } ~X&lt;\\cfrac{d}{1+r} \\\\ \\alpha[(1+r)X-d]~, &amp; \\text{si } ~\\cfrac{d}{1+r}\\leq X&lt;\\cfrac{u}{1+r} \\\\ \\alpha(u-d)~, &amp; \\text{si } ~X \\ge \\cfrac{u}{1+r}\\\\ \\end{array} \\right., \\end{eqnarray*}\\] y la cuantía en base a los pagos \\[\\begin{eqnarray*} X^{P}&amp;=\\left\\{ \\begin{array}{ll} {\\rm indeterminado} ~, &amp; \\text{si }~ X&lt;\\cfrac{d}{1+r} \\\\ \\alpha[(1+r)X-d]~, &amp; \\text{si }~ \\cfrac{d}{1+r}\\leq X&lt;\\cfrac{u}{1+r} \\\\ \\alpha(u-d)~, &amp; \\text{si } ~ X \\ge \\cfrac{u}{1+r}\\\\ \\end{array} \\right.. \\end{eqnarray*}\\] Aquí, \\(r\\), \\(u\\), y \\(\\alpha\\) representan la tasa de inflación, el límite de la póliza y el coseguro, respectivamente. Por lo tanto, los costes agregados (cuantías de los pagos) pueden expresarse ya sea en base a pérdidas o a pagos: \\[\\begin{aligned} S &amp;= X^L_1 + \\cdots + X^L_{N^L} \\\\ &amp;=X^P_1 + \\cdots + X^P_{N^P} ~. \\end{aligned}\\] Los fundamentos del modelo de riesgo colectivo pueden aplicarse. Por ejemplo, se tiene que: \\[\\begin{aligned} {\\rm E}(S) &amp;= {\\rm E}\\left(N^L\\right) {\\rm E}\\left(X^L\\right) = {\\rm E}\\left(N^P\\right) {\\rm E}\\left(X^P\\right)\\\\ {\\rm Var}(S) &amp;= {\\rm E}\\left(N^L\\right) {\\rm Var}\\left(X^L\\right) + \\left[{\\rm E}\\left(X^L\\right)\\right]^2 {\\rm Var}(N^L) \\\\ &amp;= {\\rm E}\\left(N^P\\right) {\\rm Var}\\left(X^P\\right) + \\left[{\\rm E}\\left(X^P\\right)\\right]^2 {\\rm Var}(N^P)\\\\ M_S(z)&amp;=P_{N^L}\\left[M_{X^L}(z)\\right]=P_{N^P}\\left[M_{X^P}(z)\\right] \\end{aligned}\\] Ejemplo 5.5.5. Pregunta Examen Actuarial. Una póliza dental colectiva sigue una distribución binomial negativa en el número de siniestros con media 300 y varianza 800. La severidad inicial se indica en la siguiente tabla: \\[ {\\small \\begin{matrix} \\begin{array}{ c | c } \\hline \\text{Severidad} &amp; \\text{Probabilidad}\\\\ \\hline 40 &amp; 0.25\\\\ 80 &amp; 0.25\\\\ 120 &amp; 0.25\\\\ 200 &amp; 0.25\\\\ \\hline \\end{array} \\end{matrix} } \\] Se espera que la severidad aumente un 50% sin cambiar de frecuencia. Se introduce un deducible de 100 por siniestro. Calcular el valor esperado de la pérdida agregada \\(S\\) después de estos cambios. Mostrar Ejemplo de Solución Solución. El coste por pérdida con un incremento en la severidad del 50% y un deducible por siniestro de 100 es \\[\\begin{eqnarray*} X^L &amp;=&amp; \\left\\{ \\begin{array}{cc} 0 &amp; 1,5x&lt;100 \\\\ 1,5x-100 &amp; 1,5x\\ge 100\\\\ \\end{array} \\right. \\end{eqnarray*}\\] El valor esperado es \\[\\begin{aligned} \\mathrm{E}(X^L) &amp;= \\frac{1}{4} \\left[ \\left(1,5(40)-100\\right)_+ + \\left(1,5(80)-100\\right)_+ + \\left(1,5(120)-100\\right)_+ + \\left(1,5(200)-100\\right)_+ \\right] \\\\ &amp;= \\frac{1}{4}\\left[ (60-100)_+ + (120-100)_+ + (180-100)_+ + (300-100)_+\\right] \\\\ &amp;= \\frac{1}{4}\\left[ 0 + 20 + 80 + 200 \\right] = 75 \\end{aligned}\\] Por tanto, la pérdida agregada esperada es \\[\\mathrm{E}(S)=\\mathrm{E}(N) ~ \\mathrm{E} \\left(X^L \\right)= 300 (75) = 22.500 .\\] Ejemplo 5.5.6. Continuación. ¿Cuál es la varianza de la pérdida agregada, \\(\\mathrm{Var~}(S)\\)? Mostrar Ejemplo de Solución Solución. En base a las pérdidas se tiene \\[\\begin{aligned} \\mathrm{Var}(S) &amp;= \\mathrm{E}(N) ~ \\mathrm{Var}\\left( X^L \\right) + \\left[ \\mathrm{E} \\left(X^L\\right) \\right]^2 ~ \\mathrm{Var} (N) \\end{aligned}\\] donde \\(\\mathrm{E}(N) = 300\\) y \\(\\mathrm{Var}(N) = 800\\). Se obtiene que \\[\\begin{aligned} &amp;\\mathrm{E} \\left[ (X^L)^2 \\right] = \\frac{1}{4} \\left[ 0^2 + 20^2 + 80^2 + 200^2 \\right] = 11.700 \\\\ \\Rightarrow \\ &amp; \\mathrm{Var}(X^L) = \\mathrm{E} \\left[ (X^L)^2 \\right] - \\left[ \\mathrm{E}(X^L) \\right]^2 = 11.700 - 75^2 = 6.075 \\end{aligned}\\] Por tanto, la varianza del coste total de siniestralidad es \\[\\begin{aligned} \\mathrm{Var}(S) &amp;= 300(6.075) + 75^2 (800) = 6.322.500 \\end{aligned}\\] Método alternativo: en base a los pagos. Anteriormente, se ha calculado el coste total esperado de siniestralidad multiplicando el número esperado de pérdidas por el coste esperado por pérdida. Recuerde que también podemos multiplicar el número esperado de pagos por el coste esperado por pago. En este caso, tenemos \\[S=X_1^P + \\cdots + X_{N_P}^P \\] La probabilidad de un pago es \\[\\Pr(1,5X \\ge 100)=\\Pr(X \\ge 66,\\bar{6})=\\frac{3}{4} .\\] Por tanto, el número de pagos, \\(N^P\\) tiene una distribución binomial negativa (véase el caso particular de la binomial negativa en Sección 5.5.2) con media \\[\\mathrm{E}(N^P) = \\mathrm{E}(N^L)~\\Pr(1,5X \\geq 100) = 300 \\left(\\frac{3}{4} \\right)=225\\] El coste por pago es \\[\\begin{eqnarray*} X^P &amp;=&amp; \\left\\{ \\begin{array}{ll} \\text{indeterminado}~, &amp; \\text{si }~ 1,5x&lt;100 \\\\ 1,5x-100~, &amp; \\text{si } ~ 1,5x\\ge 100\\\\ \\end{array} \\right. \\end{eqnarray*}\\] Su esperanza es \\[\\mathrm{E}(X^P)=\\frac{\\mathrm{E}(X^L)}{\\Pr(1,5X &gt; 100)}=\\frac{75}{(3/4)}=100\\] Por lo tanto, al igual que antes, la pérdida esperada agregada es \\[\\mathrm{E}(S)=\\mathrm{E}(X^P) ~ \\mathrm{E}(N^P) = 100(225)=22.500\\] Ejemplo 5.5.7. Pregunta Examen Actuarial. Una compañía asegura una flota de vehículos. Las pérdidas agregadas siguen una distribución compuesta de Poisson. El número esperado de pérdidas es 20. Las pérdidas, independientemente del tipo de vehículo, siguen una distribución exponencial con \\(\\theta=200\\). Para reducir el coste del seguro, se introducen dos modificaciones: (i) No se asegurará a un cierto tipo de vehículos. Se estima que reducirá la frecuencia de pérdidas en un 20\\(\\%\\). (ii) Se incluirá un deducible de 100 por pérdida. Calcular la cantidad total esperada que pagará la compañía después de las modificaciones. Mostrar Ejemplo de Solución Solución. En base a las pérdidas, se incluye un deducible de 100. Por tanto, el valor esperado por pérdida es \\[\\begin{aligned} \\mathrm{E}( X^L) &amp;= E[(X-100)_+] = E(X) - E(X\\wedge 100) \\\\ &amp;= 200 - 200(1-e^{-100/200}) = 121.31 \\end{aligned}\\] Dado que la frecuencia de pérdidas se ha reducido en un 20\\(\\%\\), el número esperado de pérdidas es \\[\\mathrm{E}(N^L) = 0,8(20) = 16\\] Por tanto, la cantidad total esperada que pagará después de las modificaciones es \\[\\mathrm{E}(S) = \\mathrm{E}(X^L)~ \\mathrm{E} (N^L) = 121,31(16) = 1.941\\] Método alternativo: en base a los pagos. La cantidad total esperada que pagará después de las modificaciones también se puede calcular en base a los pagos. Con el deducible de 100, la probabilidad que ocurra un pago es \\(\\Pr(X &gt; 100) = e^{-100/200}\\). Para la severidad por pago, tomando la expresión \\(\\mathrm{E}(X^L)\\) del ejemplo original, se tiene \\[\\begin{aligned} \\mathrm{E} (X^P) = \\frac{\\mathrm{E} (X^L)}{\\Pr(X &gt; 100)} = \\frac{200 - 200(1-e^{-100/200})}{e^{-100/200}} = 200 \\end{aligned}\\] Este resultado es esperable—cabe recordar que la distribución exponencial no tiene memoria, por lo que el coste esperado de los siniestros por encima de 100 sigue distribuyéndose según una exponencial de media 200. Ahora, tomemos la fecuencia de pagos \\[\\mathrm{E} (N^P) = \\mathrm{E}(N^L)~\\Pr(X&gt;100) = 16 ~e^{-100/200} = 9,7\\] Combinando ambos resultados, se obtiene la misma respuesta en base a los pagos que la obtenida anteriormente en base a las pérdidas \\[\\mathrm{E}(S) = \\mathrm{E} (X^P)~ \\mathrm{E} (N^P)= 200(9,7) = 1.941\\] 5.6 Otros recursos y colaboradores 5.6.0.1 Ejercicios Aquí se ofrece un conjunto de ejercicios que guían al lector a través de algunos de los fundamentos teóricos de Loss Data Analytics. Cada tutorial se basa en una o más preguntas de los exámenes actuariales profesionales, normalmente el Examen C de la Society of Acturies. Aggregate Loss Guided Tutorials Colaboradores Peng Shi y Lisa Gao, Universidad de Wisconsin-Madison, son los principales autores de la version inicial de este capítulo. Email: pshi@bus.wisc.edu para comentarios sobre los capítulos y posibles mejoras. Revisores de los capítulos, entre otros: Vytaras Brazauska, Mark Maxwell, Jiadong Ren, Di (Cindy) Xu. Traducción al español: Miguel Santolino (Universitat de Barcelona) ###TS 5.A.1. Propiedades del Modelo de Riesgo Individual {-} El valor esperado de la pérdida agregada en el modelo de riesgo individual, \\[\\begin{aligned} \\mathrm{E}(S_n) &amp;=\\sum_{i=1}^n ~ \\mathrm{E}(X_i) = \\sum_{i=1}^n ~ \\mathrm{E}(I_i \\times B_i) = \\sum_{i=1}^n ~ \\mathrm{E}(I_i) ~~ \\mathrm{E}(B_i) ~~~~ \\text{dada la independencia entre las } I_i \\text{ y las } B_i \\\\ &amp;= \\sum_{i=1}^n \\Pr(I_i=1) ~ \\mu_i ~~~~ \\text{ya que el valor esperado de la variable indicadora es igual a la probabilidad que sea } 1 \\\\ &amp;= \\sum_{i=1}^n ~ q_i ~ \\mu_i \\end{aligned}\\] La varianza de la pérdida agregada en el modelo de riesgo individual, \\[\\begin{aligned} \\mathrm{Var}(S_n) &amp;= \\sum_{i=1}^n \\mathrm{Var}(X_i) ~~~~ \\text{ dada la independencia entre las } X_i \\\\ &amp;= \\sum_{i=1}^n ~ \\left( ~ \\mathrm{E}\\left[ \\mathrm{Var}(X_i | I_i) \\right] + \\mathrm{Var}\\left[ \\mathrm{E}(X_i|I_i) \\right] ~ \\right) ~~~~ \\text{a partir de las formulas de varianza condicionada} \\\\ &amp;= \\sum_{i=1}^n \\left( q_i ~ \\sigma_i^2 ~ + ~ q_i ~ (1-q_i) ~ \\mu_i^2 \\right) \\end{aligned}\\] Para verlo, tenga en cuenta que \\[\\begin{aligned} \\mathrm{E}\\left[ \\mathrm{Var}(X_i | I_i) \\right] &amp;= \\mathrm{Var}(X_i|I_i=0) ~ \\Pr(I_i=0) + \\mathrm{Var}(X_i|I_i=1) ~ \\Pr(I_i=1) \\\\ &amp;= q_i ~ \\sigma_i^2 + (1-q_i) ~ (0) = q_i ~ \\sigma_i^2, \\end{aligned}\\] y \\[\\begin{aligned} \\mathrm{Var}\\left[ \\mathrm{E}(X_i|I_i) \\right] &amp;= q_i ~ (1-q_i) ~ \\mu_i^2~, \\end{aligned}\\] en base a la varianza de la Bernoulli ya que \\(\\mathrm{E}(X_i|I_i) = 0\\) cuando \\(I_i=0\\) (probabilidad \\(\\Pr(I_i=0) = 1-q_i\\)) y \\(\\mathrm{E}(X_i|I_i) = \\mu_i\\) cuando \\(I_i=1\\) (probabilidad \\(\\Pr(I_i=1)= q_i\\)). La función generadora de probabilidad de la pérdida agregada en el modelo de riesgo individual, \\[\\begin{aligned} P_{S_n}(z) &amp;= \\prod_{i=1}^n ~ P_{X_i}(z) ~~~~ \\text{dada la independencia de las } X_i \\\\ &amp;= \\prod_{i=1}^n ~ \\mathrm{E}(z^{~X_i}) = \\prod_{i=1}^n ~ \\mathrm{E}(z^{~I_i \\times B_i}) = \\mathrm{E} \\left[ \\mathrm{E}(z^{~I_i \\times B_i} | I_i) \\right] ~~~~ \\text{por la ley de esperanza iterada} \\\\ &amp;= \\prod_{i=1}^n \\left[ ~ E\\left(z^{~I_i \\times B_i} | I_i=0\\right) ~ \\Pr(I_i=0) + E\\left(z^{~I_i \\times B_i} | I_i=1\\right) ~ \\Pr(I_i=1) ~ \\right] \\\\ &amp;= \\prod_{i=1}^n ~ \\left[ ~ (1) ~ (1-q_i) + P_{B_i}(z) ~ q_i ~ \\right] = \\prod_{i=1}^n \\left(~ 1-q_i + q_i ~ P_{B_i}(z) ~\\right) \\end{aligned}\\] Por último, la función generadora de momentos de la pérdida agregada en el modelo de riesgo individual, \\[\\begin{aligned} M_{S_n}(t) &amp;= \\prod_{i=1}^n ~ M_{X_i}(t) ~~~~ \\text{dada la independencia de las } X_i \\\\ &amp;= \\prod_{i=1}^n ~ \\mathrm{E}(e^{t~X_i}) = \\prod_{i=1}^n ~ \\mathrm{E}\\left(e^{~t~(I_i \\times B_i)} \\right) = \\prod_{i=1}^n ~ \\mathrm{E} \\left[ \\mathrm{E} \\left( e^{~t~(I_i \\times B_i)} | I_i \\right) \\right] ~~~~ \\text{por la ley de esperanza iterada} \\\\ &amp;= \\prod_{i=1}^n ~ \\left[~ \\mathrm{E}\\left(e^{~t~(I_i \\times B_i)} | I_i=0 \\right) ~ \\Pr(I_i=0) + \\mathrm{E}\\left( e^{~t~(I_i \\times B_i)} | I_i=1 \\right) ~ \\Pr(I_i=1) ~\\right] \\\\ &amp;= \\prod_{i=1}^n ~ \\left[ ~ (1) ~ (1-q_i) + M_{B_i}(t) ~ q_i ~ \\right] = \\prod_{i=1}^n \\left(~ 1-q_i + q_i ~ M_{B_i}(t) ~\\right) \\end{aligned}\\] ###TS 5.A.2. Relación entre las funciones generadoras de probabilidad de \\(X_i\\) y \\(X_i^T\\) {-} Supongamos que \\(X_i\\) pertenece a la clase \\((a,b,0)\\) con pmf \\(p_{ik} = \\Pr(X_i = k)\\) para \\(k=0,1,\\ldots\\) y \\(X_i^T\\) es la distribución asociada truncada en cero de la clase \\((a,b,1)\\) con pmf \\(p_{ik}^T = p_{ik}/(1-p_{i0})\\) para \\(k=1,2,\\ldots\\). La relación entre la pgf de \\(X_i\\) y la pgf de \\(X_i^T\\) es la siguiente \\[\\begin{aligned} P_{X_i}(z) &amp;= \\mathrm{E~}(z^{X_i}) = \\mathrm{E}\\left[ \\mathrm{E}\\left( z^{X_i} | X_i \\right) \\right] ~~~~ \\text{por la ley de esperanza iterada} \\\\ &amp;= \\mathrm{E}\\left( z^{X_i} | X_i=0 \\right)~ \\Pr(X_i=0) + \\mathrm{E}\\left( z^{X_i} | X_i&gt;0 \\right) ~ \\Pr(X_i&gt;0) \\\\ &amp;= (1)~ p_{i0} + \\mathrm{E}(z^{X_i^T}) ~ (1-p_{i0}) ~~~~ \\text{dado que } (X_i | X_i&gt;0) \\text{ es la variable aleatoria truncada en cero } X_i^T \\\\ &amp;= p_{i0} +(1-p_{i0}) P_{X_i^{T}}(z) \\end{aligned}\\] ###TS 5.A.3. Ejemplo 5.3.8 Función generadora de momentos de la pérdida agregada \\(S_N\\) {-} En el caso que \\(N\\sim Geo(\\beta)\\) y \\(X\\sim Exp(\\theta)\\), se obtiene \\[\\begin{aligned} P_N (z) &amp;=\\frac{1}{1- \\beta (z-1)}\\\\ M_{X}(t) &amp;=\\frac{1}{1-\\theta t} \\end{aligned}\\] Por tanto, la mgf de la pérdida agregada \\(S_N\\) es \\[\\begin{aligned} M_{S_N}(t) &amp;= P_N [M_{X}(t)] = \\frac{1}{1 - \\beta \\left( \\frac{1}{1-\\theta t} - 1\\right)} \\\\ &amp;= \\frac{1}{1 - \\beta \\left( \\frac{\\theta t}{1-\\theta t} \\right)} + 1 - 1 = 1+ \\frac{\\beta \\left( \\frac{\\theta t}{1-\\theta t} \\right)}{1 - \\beta \\left( \\frac{\\theta t}{1-\\theta t} \\right)} \\\\ &amp;= 1 + \\frac{\\beta \\theta t}{(1-\\theta t) - \\beta \\theta t} = 1+ \\frac{\\beta \\theta t}{1-\\theta t (1+\\beta)} \\cdot \\frac{1+\\beta}{1+\\beta} \\\\ &amp;= 1 + \\frac{\\beta}{1+\\beta} \\left[ \\frac{\\theta (1+\\beta) t}{1-\\theta(1+\\beta)t} \\right] \\\\ &amp;= 1 + \\frac{\\beta}{1+\\beta} \\left[ \\frac{1}{1-\\theta(1+\\beta)t} - 1 \\right], \\\\ \\end{aligned}\\] que coincide con la expresión (5.1). Para la expresión alternativa de la mgf (5.2), se puede continuar a partir de aquí: \\[\\begin{aligned} M_{S_N}(t) &amp;= 1 + \\frac{\\beta}{1+\\beta} \\left[ \\frac{\\theta (1+\\beta) t}{1-\\theta(1+\\beta)t} \\right] \\\\ &amp;= \\frac{1+\\beta}{1+\\beta} + \\frac{\\beta}{1+\\beta} \\left[ \\frac{\\theta (1+\\beta) t}{1-\\theta(1+\\beta)t} \\right] \\\\ &amp;= \\frac{1}{1+\\beta} + \\frac{\\beta}{1+\\beta} + \\frac{\\beta}{1+\\beta} \\left[ \\frac{\\theta (1+\\beta) t}{1-\\theta(1+\\beta)t} \\right] \\\\ &amp;= \\frac{1}{1+\\beta} + \\frac{\\beta}{1+\\beta}\\left[1 + \\frac{\\theta (1+\\beta) t}{1-\\theta (1+\\beta)t} \\right] \\\\ &amp;= \\frac{1}{1+\\beta} +\\frac{\\beta}{1+\\beta} \\left[ \\frac{1}{1-\\theta (1+\\beta)t}\\right] \\end{aligned}\\] "],
["C-Simulation.html", "Chapter 6 Simulation and Resampling 6.1 Simulation Fundamentals 6.2 Bootstrapping and Resampling 6.3 Cross-Validation 6.4 Importance Sampling 6.5 Monte Carlo Markov Chain (MCMC) 6.6 Further Resources and Contributors", " Chapter 6 Simulation and Resampling Chapter Preview. Simulation is a computationally intensive method used to solve difficult problems. Instead of creating physical processes and experimenting with them in order to understand their operational characteristics, a simulation study is based on a computer representation - it considers various hypothetical conditions as inputs and summarizes the results. Through simulation, a vast number of hypothetical conditions can be quickly and inexpensively examined. Section 6.1 introduces simulation, a wonderful computational tool that is especially useful in complex, multivariate settings. We can also use simulation to draw from an empirical distribution - this process is known as resampling. Resampling allows us to assess the uncertainty of estimates in complex models. Section 6.2 introduces resampling in the context of bootstrapping to determine the precision of estimators. Subsequent sections introduce other topics in resampling. Section 6.3 on cross-validation shows how to use it for model selection and validation. Section 6.4 on importance sampling describes resampling in specific regions of interest, such as long-tailed actuarial applications. Section 6.5 on Monte Carlo Markov Chain (MCMC) introduces the simulation and resampling engine underpinning much of modern Bayesian analysis. 6.1 Simulation Fundamentals In this section, you learn how to: Generate approximately independent realizations that are uniformly distributed Transform the uniformly distributed realizations to observations from a probability distribution of interest Calculate quantities of interest and determining the precision of the calculated quantities 6.1.1 Generating Independent Uniform Observations The simulations that we consider are generated by computers. A major strength of this approach is that they can be replicated, allowing us to check and improve our work. Naturally, this also means that they are not really random. Nonetheless, algorithms have been produced so that results appear to be random for all practical purposes. Specifically, they pass sophisticated tests of independence and can be designed so that they come from a single distribution - our iid assumption, identically and independently distributed. To get a sense as to what these algorithms do, we consider a historically prominent method. Linear Congruential Generator. To generate a sequence of random numbers, start with \\(B_0\\), a starting value that is known as a seed. This value is updated using the recursive relationship \\[B_{n+1} = a B_n + c \\text{ modulo }m, ~~ n=0, 1, 2, \\ldots .\\] This algorithm is called a linear congruential generator. The case of \\(c=0\\) is called a multiplicative congruential generator; it is particularly useful for really fast computations. For illustrative values of \\(a\\) and \\(m\\), Microsoft’s Visual Basic uses \\(m=2^{24}\\), \\(a=1,140,671,485\\), and \\(c = 12,820,163\\) (see https://en.wikipedia.org/wiki/Linear_congruential_generator). This is the engine underlying the random number generation in Microsoft’s Excel program. The sequence used by the analyst is defined as \\(U_n=B_n/m.\\) The analyst may interpret the sequence {\\(U_{i}\\)} to be (approximately) identically and independently uniformly distributed on the interval (0,1). To illustrate the algorithm, consider the following. Example 6.1.1. Illustrative Sequence. Take \\(m=15\\), \\(a=3\\), \\(c=2\\) and \\(B_0=1\\). Then we have: step \\(n\\) \\(B_n\\) \\(U_n\\) 0 \\(B_0=1\\) 1 \\(B_1 =\\mod(3 \\times 1 +2) = 5\\) \\(U_1 = \\frac{5}{15}\\) 2 \\(B_2 =\\mod(3 \\times 5 +2) = 2\\) \\(U_2 = \\frac{2}{15}\\) 3 \\(B_3 =\\mod(3 \\times 2 +2) = 8\\) \\(U_3 = \\frac{8}{15}\\) 4 \\(B_4 =\\mod(3 \\times 8 +2) = 11\\) \\(U_4 = \\frac{11}{15}\\) Sometimes computer generated random results are known as pseudo-random numbers to reflect the fact that they are machine generated and can be replicated. That is, despite the fact that {\\(U_{i}\\)} appears to be i.i.d, it can be reproduced by using the same seed number (and the same algorithm). Example 6.1.2. Generating uniform random numbers in R. The following code shows how to generate three uniform (0,1) numbers in R using the runif command. The set.seed() function sets the initial seed. In many computer packages, the initial seed is set using the system clock unless specified otherwise. Three Uniform Random Variates set.seed(2017) U &lt;- runif(3) knitr::kable(U, digits=5, align = &quot;c&quot;, col.names = &quot;Uniform&quot;) Uniform 0.92424 0.53718 0.46920 The linear congruential generator is just one method of producing pseudo-random outcomes. It is easy to understand and is (still) widely used. The linear congruential generator does have limitations, including the fact that it is possible to detect long-run patterns over time in the sequences generated (recall that we can interpret independence to mean a total lack of functional patterns). Not surprisingly, advanced techniques have been developed that address some of this method’s drawbacks. 6.1.2 Inverse Transform Method With the sequence of uniform random numbers, we next transform them to a distribution of interest, say \\(F\\). A prominent technique is the inverse transform method, defined as \\[ X_i=F^{-1}\\left( U_i \\right) . \\] Here, recall from Section 4.1.1 that we introduced the inverse of the distribution function, \\(F^{-1}\\), and referred to it also as the quantile function. Specifically, it is defined to be \\[ F^{-1}(y) = \\inf_x ~ \\{ F(x) \\ge y \\} . \\] Recall that \\(\\inf\\) stands for infimum or the greatest lower bound. It is essentially the smallest value of x that satisfies the inequality \\(\\{F(x) \\ge y\\}\\). The result is that the sequence {\\(X_{i}\\)} is approximately iid with distribution function \\(F\\). The inverse transform result is available when the underlying random variable is continuous, discrete or a hybrid combination of the two. We now present a series of examples to illustrate its scope of applications. Example 6.1.3. Generating exponential random numbers. Suppose that we would like to generate observations from an exponential distribution with scale parameter \\(\\theta\\) so that \\(F(x) = 1 - e^{-x/\\theta}\\). To compute the inverse transform, we can use the following steps: \\[ \\begin{aligned} y = F(x) &amp;\\Leftrightarrow y = 1-e^{-x/\\theta} \\\\ &amp;\\Leftrightarrow -\\theta \\ln(1-y) = x = F^{-1}(y) . \\end{aligned} \\] Thus, if \\(U\\) has a uniform (0,1) distribution, then \\(X = -\\theta \\ln(1-U)\\) has an exponential distribution with parameter \\(\\theta\\). The following R code shows how we can start with the same three uniform random numbers as in Example 6.1.2 and transform them to independent exponentially distributed random variables with a mean of 10. Alternatively, you can directly use the rexp function in R to generate random numbers from the exponential distribution. The algorithm built into this routine is different so even with the same starting seed number, individual realizations will differ. set.seed(2017) U &lt;- runif(3) X1 &lt;- -10*log(1-U) set.seed(2017) X2 &lt;- rexp(3, rate = 1/10) Three Uniform Random Variates Uniform Exponential 1 Exponential 2 0.92424 25.80219 3.25222 0.53718 7.70409 8.47652 0.46920 6.33362 5.40176 Example 6.1.4. Generating Pareto random numbers. Suppose that we would like to generate observations from a Pareto distribution with parameters \\(\\alpha\\) and \\(\\theta\\) so that \\(F(x) = 1 - \\left(\\frac{\\theta}{x+\\theta} \\right)^{\\alpha}\\). To compute the inverse transform, we can use the following steps: \\[ \\begin{aligned} y = F(x) &amp;\\Leftrightarrow 1-y = \\left(\\frac{\\theta}{x+\\theta} \\right)^{\\alpha} \\\\ &amp;\\Leftrightarrow \\left(1-y\\right)^{-1/\\alpha} = \\frac{x+\\theta}{\\theta} = \\frac{x}{\\theta} +1 \\\\ &amp;\\Leftrightarrow \\theta \\left((1-y)^{-1/\\alpha} - 1\\right) = x = F^{-1}(y) .\\end{aligned} \\] Thus, \\(X = \\theta \\left((1-U)^{-1/\\alpha} - 1\\right)\\) has a Pareto distribution with parameters \\(\\alpha\\) and \\(\\theta\\). Inverse Transform Justification. Why does the random variable \\(X = F^{-1}(U)\\) have a distribution function \\(F\\)? Show A Snippet of Theory This is easy to establish in the continuous case. Because \\(U\\) is a Uniform random variable on (0,1), we know that \\(\\Pr(U \\le y) = y\\), for \\(0 \\le y \\le 1\\). Thus, \\[ \\begin{aligned} \\Pr(X \\le x) &amp;= \\Pr(F^{-1}(U) \\le x) \\\\ &amp;= \\Pr(F(F^{-1}(U)) \\le F(x)) \\\\ &amp;= \\Pr(U \\le F(x)) = F(x) \\end{aligned} \\] as required. The key step is that \\(F(F^{-1}(u)) = u\\) for each \\(u\\), which is clearly true when \\(F\\) is strictly increasing. We now consider some discrete examples. Example 6.1.5. Generating Bernoulli random numbers. Suppose that we wish to simulate random variables from a Bernoulli distribution with parameter \\(p=0.85\\). Figure 6.1: Distribution Function of a Binary Random Variable A graph of the cumulative distribution function in Figure 6.1 shows that the quantile function can be written as \\[ \\begin{aligned} F^{-1}(y) = \\left\\{ \\begin{array}{cc} 0 &amp; 0&lt;y \\leq 0.85 \\\\ 1 &amp; 0.85 &lt; y \\leq 1.0 . \\end{array} \\right. \\end{aligned} \\] Thus, with the inverse transform we may define \\[ \\begin{aligned} X = \\left\\{ \\begin{array}{cc} 0 &amp; 0&lt;U \\leq 0.85 \\\\ 1 &amp; 0.85 &lt; U \\leq 1.0 \\end{array} \\right. \\end{aligned} \\] For illustration, we generate three random numbers to get set.seed(2017) U &lt;- runif(3) X &lt;- 1*(U &gt; 0.85) Three Random Variates Uniform Binary X 0.92424 1 0.53718 0 0.46920 0 Example 6.1.6. Generating random numbers from a discrete distribution. Consider the time of a machine failure in the first five years. The distribution of failure times is given as: Discrete Distribution \\(~~~~~~~~~~\\) \\(~~~~~~~~~~\\) \\(~~~~~~~~~~\\) \\(~~~~~~~~~~\\) \\(~~~~~~~~~~\\) Time 1.0 2.0 3.0 4.0 5.0 Probability 0.1 0.2 0.1 0.4 0.2 Distribution Function \\(F(x)\\) 0.1 0.3 0.4 0.8 1.0 Figure 6.2: Distribution Function of a Discrete Random Variable Using the graph of the distribution function in Figure 6.2, with the inverse transform we may define \\[ \\small{ \\begin{aligned} X = \\left\\{ \\begin{array}{cc} 1 &amp; 0&lt;U \\leq 0.1 \\\\ 2 &amp; 0.1 &lt; U \\leq 0.3\\\\ 3 &amp; 0.3 &lt; U \\leq 0.4\\\\ 4 &amp; 0.4 &lt; U \\leq 0.8 \\\\ 5 &amp; 0.8 &lt; U \\leq 1.0 . \\end{array} \\right. \\end{aligned} } \\] For general discrete random variables there may not be an ordering of outcomes. For example, a person could own one of five types of life insurance products and we might use the following algorithm to generate random outcomes: \\[ {\\small \\begin{aligned} X = \\left\\{ \\begin{array}{cc} \\textrm{whole life} &amp; 0&lt;U \\leq 0.1 \\\\ \\textrm{endowment} &amp; 0.1 &lt; U \\leq 0.3\\\\ \\textrm{term life} &amp; 0.3 &lt; U \\leq 0.4\\\\ \\textrm{universal life} &amp; 0.4 &lt; U \\leq 0.8 \\\\ \\textrm{variable life} &amp; 0.8 &lt; U \\leq 1.0 . \\end{array} \\right. \\end{aligned} } \\] Another analyst may use an alternative procedure such as: \\[ {\\small \\begin{aligned} X = \\left\\{ \\begin{array}{cc} \\textrm{whole life} &amp; 0.9&lt;U&lt;1.0 \\\\ \\textrm{endowment} &amp; 0.7 \\leq U &lt; 0.9\\\\ \\textrm{term life} &amp; 0.6 \\leq U &lt; 0.7\\\\ \\textrm{universal life} &amp; 0.2 \\leq U &lt; 0.6 \\\\ \\textrm{variable life} &amp; 0 \\leq U &lt; 0.2 . \\end{array} \\right. \\end{aligned} } \\] Both algorithms produce (in the long-run) the same probabilities, e.g., \\(\\Pr(\\textrm{whole life})=0.1\\), and so forth. So, neither is incorrect. You should be aware that “there is more than one way to skin a cat.” (What an old expression!) Similarly, you could use an alternative algorithm for ordered outcomes (such as failure times 1, 2, 3, 4, or 5, above). Example 6.1.7. Generating random numbers from a hybrid distribution. Consider a random variable that is 0 with probability 70% and is exponentially distributed with parameter \\(\\theta= 10,000\\) with probability 30%. In an insurance application, this might correspond to a 70% chance of having no insurance claims and a 30% chance of a claim - if a claim occurs, then it is exponentially distributed. The distribution function, depicted in Figure 6.3, is given as \\[ \\begin{aligned} F(y) = \\left\\{ \\begin{array}{cc} 0 &amp; x&lt;0 \\\\ 1 - 0.3 \\exp(-x/10000) &amp; x \\ge 0 . \\end{array} \\right. \\end{aligned} \\] Figure 6.3: Distribution Function of a Hybrid Random Variable From Figure 6.3, we can see that the inverse transform for generating random variables with this distribution function is \\[ \\begin{aligned} X = F^{-1}(U) = \\left\\{ \\begin{array}{cc} 0 &amp; 0&lt; U \\leq 0.7 \\\\ -1000 \\ln (\\frac{1-U}{0.3}) &amp; 0.7 &lt; U &lt; 1 . \\end{array} \\right. \\end{aligned} \\] For discrete and hybrid random variables, the key is to draw a graph of the distribution function that allows you to visualize potential values of the inverse function. 6.1.3 Simulation Precision From the prior subsections, we now know how to generate independent simulated realizations from a distribution of interest. With these realizations, we can construct an empirical distribution and approximate the underlying distribution as precisely as needed. As we introduce more actuarial applications in this book, you will see that simulation can be applied in a wide variety of contexts. Many of these applications can be reduced to the problem of approximating \\(\\mathrm{E~}h(X)\\), where \\(h(\\cdot)\\) is some known function. Based on \\(R\\) simulations (replications), we get \\(X_1,\\ldots,X_R\\). From this simulated sample, we calculate an average \\[ \\overline{h}_R=\\frac{1}{R}\\sum_{i=1}^{R} h(X_i) \\] that we use as our simulated approximate (estimate) of \\(\\mathrm{E~}h(X)\\). To estimate the precision of this approximation, we use the simulation variance \\[ s_{h,R}^2 = \\frac{1}{R-1} \\sum_{i=1}^{R}\\left( h(X_i) -\\overline{h}_R \\right) ^2. \\] From the independence, the standard error of the estimate is \\(s_{h,R}/\\sqrt{R}\\). This can be made as small as we like by increasing the number of replications \\(R\\). Example. 6.1.8. Portfolio management. In Section 3.4, we learned how to calculate the expected value of policies with deductibles. For an example of something that cannot be done with closed form expressions, we now consider two risks. This is a variation of a more complex example that will be covered as Example 10.3.6. We consider two property risks of a telecommunications firm: \\(X_1\\) - buildings, modeled using a gamma distribution with mean 200 and scale parameter 100. \\(X_2\\) - motor vehicles, modeled using a gamma distribution with mean 400 and scale parameter 200. Denote the total risk as \\(X = X_1 + X_2.\\) For simplicity, you assume that these risks are independent. To manage the risk, you seek some insurance protection. You wish to manage internally small building and motor vehicles amounts, up to \\(M\\), say. Your retained risk is \\(Y_{retained}=\\) \\(\\min(X_1 + X_2,M)\\). The insurer’s portion is \\(Y_{insurer} = X- Y_{retained}\\). To be specific, we use \\(M=\\) 400 as well as \\(R=\\) 1000000 simulations. a. With the settings, we wish to determine the expected claim amount and the associated standard deviation of (i) that retained, (ii) that accepted by the insurer, and (iii) the total overall amount. Show R Code to Define the Risks # Simulate the risks nSim &lt;- 1e6 #number of simulations set.seed(2017) #set seed to reproduce work X1 &lt;- rgamma(nSim,alpha1,scale = theta1) X2 &lt;- rgamma(nSim,alpha2,scale = theta2) # Portfolio Risks X &lt;- X1 + X2 Yretained &lt;- pmin(X, M) Yinsurer &lt;- X - Yretained Here is the code for the expected claim amounts. Show R Code To Compute Amounts # Expected Claim Amounts ExpVec &lt;- t(as.matrix(c(mean(Yretained),mean(Yinsurer),mean(X)))) sdVec &lt;- t(as.matrix(c(sd(Yretained),sd(Yinsurer),sd(X)))) outMat &lt;- rbind(ExpVec, sdVec) colnames(outMat) &lt;- c(&quot;Retained&quot;, &quot;Insurer&quot;,&quot;Total&quot;) row.names(outMat) &lt;- c(&quot;Mean&quot;,&quot;Standard Deviation&quot;) round(outMat,digits=2) Retained Insurer Total Mean 365.17 235.01 600.18 Standard Deviation 69.51 280.86 316.36 The results of these calculations are: round(outMat,digits=2) Retained Insurer Total Mean 365.17 235.01 600.18 Standard Deviation 69.51 280.86 316.36 b. For insured claims, the standard error of the simulation approximation is \\(s_{h,R}/\\sqrt{1000000} =\\) 280.86 \\(/\\sqrt{1000000} =\\) 0.281. For this example, simulation is quick and so a large value such as 1000000 is an easy choice. However, for more complex problems, the simulation size may be an issue. Show R Code To Set up the Visualization Yinsurefct &lt;- function(numSim){ X1 &lt;- rgamma(numSim,alpha1,scale = theta1) X2 &lt;- rgamma(numSim,alpha2,scale = theta2) # Portfolio Risks X &lt;- X1 + X2 Yinsurer &lt;- X - pmin(X, M) return(Yinsurer) } R &lt;- 1e3 nPath &lt;- 20 set.seed(2017) simU &lt;- matrix(Yinsurefct(R*nPath),R,nPath) sumP2 &lt;- apply(simU, 2, cumsum)/(1:R) Figure 6.4 allows us to visualize the development of the approximation as the number of simulations increases. matplot(1:R,sumP2[,1:20],type=&quot;l&quot;,col=rgb(1,0,0,.2), ylim=c(100, 400), xlab=expression(paste(&quot;Number of Simulations (&quot;, italic(&#39;R&#39;), &quot;)&quot;)), ylab=&quot;Expected Insurer Claims&quot;) abline(h=mean(Yinsurer),lty=2) bonds &lt;- cbind(1.96*sd(Yinsurer)*sqrt(1/(1:R)),-1.96*sd(Yinsurer)*sqrt(1/(1:R))) matlines(1:R,bonds+mean(Yinsurer),col=&quot;red&quot;,lty=1) Figure 6.4: Estimated Expected Insurer Claims versus Number of Simulations. Determination of Number of Simulations How many simulated values are recommended? 100? 1,000,000? We can use the central limit theorem to respond to this question. As one criterion for your confidence in the result, suppose that you wish to be within 1% of the mean with 95% certainty. That is, you want \\(\\Pr \\left( |\\overline{h}_R - \\mathrm{E~}h(X)| \\le 0.01 \\mathrm{E~}h(X) \\right) \\le 0.95\\). According to the central limit theorem, your estimate should be approximately normally distributed and so we want to have \\(R\\) large enough to satisfy \\(0.01 \\mathrm{E~}h(X)/\\sqrt{\\mathrm{Var~}h(X)/R}) \\ge 1.96\\). (Recall that 1.96 is the 97.5th percentile from the standard normal distribution.) Replacing \\(\\mathrm{E~}h(X)\\) and \\(\\mathrm{Var~}h(X)\\) with estimates, you continue your simulation until \\[ \\frac{.01\\overline{h}_R}{s_{h,R}/\\sqrt{R}}\\geq 1.96 \\] or equivalently \\[\\begin{equation} R \\geq 38,416\\frac{s_{h,R}^2}{\\overline{h}_R^2}. \\tag{6.1} \\end{equation}\\] This criterion is a direct application of the approximate normality. Note that \\(\\overline{h}_R\\) and \\(s_{h,R}\\) are not known in advance, so you will have to come up with estimates, either by doing a small pilot study in advance or by interrupting your procedure intermittently to see if the criterion is satisfied. Example. 6.1.8. Portfolio management - continued For our example, the average insurance claim is 235.011 and the corresponding standard deviation is 280.862. Using equation (6.1), to be within 10% of the mean, we would only require at least 54.87 thousand simulations. However, to be within 1% we would want at least 5.49 million simulations. Example. 6.1.9. Approximation choices. An important application of simulation is the approximation of \\(\\mathrm{E~}h(X)\\). In this example, we show that the choice of the \\(h(\\cdot)\\) function and the distribution of \\(X\\) can play a role. Consider the following question : what is \\(\\Pr[X&gt;2]\\) when \\(X\\) has a Cauchy distribution, with density \\(f(x) =\\left(\\pi(1+x^2)\\right)^{-1}\\), on the real line? The true value is \\[ \\Pr\\left[X&gt;2\\right] = \\int_2^\\infty \\frac{dx}{\\pi(1+x^2)} . \\] One can use an R numerical integration function (which works usually well on improper integrals) true_value &lt;- integrate(function(x) 1/(pi*(1+x^2)),lower=2,upper=Inf)$value which is equal to 0.14758. Alternatively, one can use simulation techniques to approximate that quantity. From calculus, you can check that the quantile function of the Cauchy distribution is \\(F^{-1}(y) = \\tan \\left( \\pi(y-0.5) \\right)\\). Then, with simulated uniform (0,1) variates, \\(U_1, \\ldots, U_R\\), we can construct the estimator \\[ p_1 = \\frac{1}{R}\\sum_{i=1}^R \\mathrm{I}(F^{-1}(U_i)&gt;2) = \\frac{1}{R}\\sum_{i=1}^R \\mathrm{I}(\\tan \\left( \\pi(U_i-0.5) \\right)&gt;2) . \\] Show the R Code Q &lt;- function(u) tan(pi*(u-.5)) R &lt;- 1e6 set.seed(1) X &lt;- Q(runif(R)) p1 &lt;- mean(X&gt;2) se.p1 &lt;- sd(X&gt;2)/sqrt(R) p1 [1] 0.147439 se.p1 [1] 0.0003545432 With one million simulations, we obtain an estimate of 0.14744 with standard error 0.355 (divided by 1000). One can prove that the variance of \\(p_1\\) is of order \\(0.127/R\\). With other choices of \\(h(\\cdot)\\) and \\(F(\\cdot)\\), it is actually possible to reduce uncertainty even using the same number of simulations R. To begin, one can use the symmetry of the Cauchy distribution to write \\(\\Pr[X&gt;2]=0.5\\cdot\\Pr[|X|&gt;2]\\). With this, can construct a new estimator \\[ p_2 = \\frac{1}{2R}\\sum_{i=1}^R \\mathrm{I}(|F^{-1}(U_i)|&gt;2) . \\] With one million simulations, we obtain an estimate of 0.14748 with standard error 0.228 (divided by 1000). One can prove that the variance of \\(p_2\\) is of order \\(0.052/R\\). But one can go one step further. The improper integral can be written as a proper one by a simple symmetry property (since the function is symmetry and the integral on the real line is equal to \\(1\\)) \\[ \\int_2^\\infty \\frac{dx}{\\pi(1+x^2)}=\\frac{1}{2}-\\int_0^2\\frac{dx}{\\pi(1+x^2)} . \\] From this expression, a natural approximation would be \\[ p_3 = \\frac{1}{2}-\\frac{1}{R}\\sum_{i=1}^R h_3(2U_i), ~~~~~~\\text{where}~h_3(x)=\\frac{2}{\\pi(1+x^2)} . \\] With one million simulations, we obtain an estimate of 0.14756 with standard error 0.169 (divided by 1000). One can prove that the variance of \\(p_3\\) is of order \\(0.0285/R\\). Finally, one can also consider some change of variable in the integral \\[ \\int_2^\\infty \\frac{dx}{\\pi(1+x^2)}=\\int_0^{1/2}\\frac{y^{-2}dy}{\\pi(1-y^{-2})} . \\] From this expression, a natural approximation would be \\[ p_4 = \\frac{1}{R}\\sum_{i=1}^R h_4(U_i/2),~~~~~\\text{where}~h_4(x)=\\frac{1}{2\\pi(1+x^2)} . \\] The expression seems rather similar to the previous one, With one million simulations, we obtain an estimate of 0.14759 with standard error 0.01 (divided by 1000). One can prove that the variance of \\(p_4\\) is of order \\(0.00009/R\\), which is much smaller than what we had so far ! Table 6.1 summarizes the four choices of \\(h(\\cdot)\\) and \\(F(\\cdot)\\) to approximate \\(\\Pr[X&gt;2] =\\) 0.14758. The standard error varies dramatically. Thus, if we have a desired degree of accuracy, then the number of simulations depends strongly on how we write the integrals we try to approximate. Table 6.1. Summary of Four Choices to Approximate \\(\\Pr[X&gt;2]\\). Estimator Definition Support Function Estimate Standard Error \\(p_1\\) \\(\\frac{1}{R}\\sum_{i=1}^R \\mathrm{I}(F^{-1}(U_i)&gt;2)\\) \\(~~~~~~F^{-1}(u)=\\tan \\left( \\pi(u-0.5) \\right)~~~~~~~\\) 0.147439 0.000355 \\(p_2\\) \\(\\frac{1}{2R}\\sum_{i=1}^R \\mathrm{I}(|F^{-1}(U_i)|&gt;2)\\) \\(F^{-1}(u)=\\tan \\left( \\pi(u-0.5) \\right)\\) 0.147477 0.000228 \\(p_3\\) \\(\\frac{1}{2}-\\frac{1}{R}\\sum_{i=1}^R h_3(2U_i)\\) \\(h_3(x)=\\frac{2}{\\pi(1+x^2)}\\) 0.147558 0.000169 \\(p_4\\) \\(\\frac{1}{R}\\sum_{i=1}^R h_4(U_i/2)\\) \\(h_4(x)=\\frac{1}{2\\pi(1+x^2)}\\) 0.147587 0.000010 6.1.4 Simulation and Statistical Inference Simulations not only help us approximate expected values but are also useful in calculating other aspects of distribution functions. In particular, they are very useful when distributions of test statistics are too complicated to derive; in this case, one can use simulations to approximate the reference distribution. We now illustrate this with the Kolmogorov-Smirnov test that we learned about in Section 4.1.2.2. Example. 6.1.10. Kolmogorov-Smirnov Test of Distribution. Suppose that we have available \\(n=100\\) observations \\(\\{x_1,\\cdots,x_n\\}\\) that, unknown to the analyst, was generated from a gamma distribution with parameters \\(\\alpha = 6\\) and \\(\\theta=2\\). The analyst believes that the data come from a lognormal distribution with parameters 1 and 0.4 and would like to test this assumption. The first step is to visualize the data. Show R Code To Set up The Visualization set.seed(1) n &lt;- 100 x &lt;- rgamma(n, 6, 2) u=seq(0,7,by=.01) vx = c(0,sort(x)) vy = (0:n)/n With this set-up, Figure 6.5 provides a graph of a histogram and empirical distribution. For reference, superimposed are red dashed lines from the lognormal distribution. par(mfrow=c(1,2)) hist(x,probability = TRUE,main=&quot;Histogram&quot;, col=&quot;light blue&quot;,border=&quot;white&quot;,xlim=c(0,7),ylim=c(0,.4)) lines(u,dlnorm(u,1,.4),col=&quot;red&quot;,lty=2) plot(vx,vy,type=&quot;l&quot;,xlab=&quot;x&quot;,ylab=&quot;Cumulative Distribution&quot;,main=&quot;Empirical cdf&quot;) lines(u,plnorm(u,1,.4),col=&quot;red&quot;,lty=2) Figure 6.5: Histogram and Empirical Distribution Function of Data used in Kolmogorov-Smirnov Test. The red dashed lines are fits based on (incorrectly) hypothesized lognormal distribution. Recall that the Kolmogorov-Smirnov statistic equals the largest discrepancy between the empirical and the hypothesized distribution. This is \\(\\max_x |F_n(x)-F_0(x)|\\), where \\(F_0\\) is the hypothesized lognormal distribution. We can calculate this directly as: Show R Code for a Direct Calculation of the KS Statistic # test statistic D &lt;- function(data, F0){ F &lt;- Vectorize(function(x) mean((data&lt;=x))) n &lt;- length(data) x &lt;- sort(data) d1=abs(F(x+1e-6)-F0(x+1e-6)) d2=abs(F(x-1e-6)-F0(x-1e-6)) return(max(c(d1,d2))) } D(x,function(x) plnorm(x,1,.4)) [1] 0.09703627 Fortunately, for the lognormal distribution, R has built-in tests that allow us to determine this without complex programming: ks.test(x, plnorm, mean=1, sd=0.4) One-sample Kolmogorov-Smirnov test data: x D = 0.097037, p-value = 0.3031 alternative hypothesis: two-sided However, for many distributions of actuarial interest, pre-built programs are not available. We can use simulation to test the relevance of the test statistic. Specifically, to compute the \\(p\\)-value, let us generate thousands of random samples from a \\(LN(1,0.4)\\) distribution (with the same size), and compute empirically the distribution of the statistic, Show R Code for the Simulation Distribution of the KS Statistic ns &lt;- 1e4 d_KS &lt;- rep(NA,ns) # compute the test statistics for a large (ns) number of simulated samples for(s in 1:ns) d_KS[s] &lt;- D(rlnorm(n,1,.4),function(x) plnorm(x,1,.4)) mean(d_KS&gt;D(x,function(x) plnorm(x,1,.4))) [1] 0.2843 hist(d_KS,probability = TRUE,col=&quot;light blue&quot;,border=&quot;white&quot;,xlab=&quot;Test Statistic&quot;,main=&quot;&quot;) lines(density(d_KS),col=&quot;red&quot;) abline(v=D(x,function(x) plnorm(x,1,.4)),lty=2,col=&quot;red&quot;) Figure 6.6: Simulated Distribution of the Kolmogorov-Smirnov Test Statistic. The vertical red dashed line marks the test statistic for the sample of 100. The simulated distribution based on 10,000 random samples is summarized in Figure 6.6. Here, the statistic exceeded the empirical value (0.09704) in 28.43% of the scenarios, while the theoretical \\(p\\)-value is 0.3031. For both the simulation and the theoretical \\(p\\)-values, the conclusions are the same; the data do not provide sufficient evidence to reject the hypothesis of a lognormal distribution. Although only an approximation, the simulation approach works in a variety of distributions and test statistics without needing to develop the nuances of the underpinning theory for each situation. We summarize the procedure for developing simulated distributions and p-values as follows: Draw a sample of size n, say, \\(X_1, \\ldots, X_n\\), from a known distribution function \\(F\\). Compute a statistic of interest, denoted as \\(\\hat{\\theta}(X_1, \\ldots, X_n)\\). Call this \\(\\hat{\\theta}^r\\) for the rth replication. Repeat this \\(r=1, \\ldots, R\\) times to get a sample of statistics, \\(\\hat{\\theta}^1, \\ldots,\\hat{\\theta}^R\\). From the sample of statistics in Step 2, \\(\\{\\hat{\\theta}^1, \\ldots,\\hat{\\theta}^R\\}\\), compute a summary measure of interest, such as a p-value. 6.2 Bootstrapping and Resampling In this section, you learn how to: Generate a nonparametric bootstrap distribution for a statistic of interest Use the bootstrap distribution to generate estimates of precision for the statistic of interest, including bias, standard deviations, and confidence intervals Perform bootstrap analyses for parametric distributions 6.2.1 Bootstrap Foundations Simulation presented up to now is based on sampling from a known distribution. Section 6.1 showed how to use simulation techniques to sample and compute quantities from known distributions. However, statistical science is dedicated to providing inferences about distributions that are unknown. We gather summary statistics based on this unknown population distribution. But how do we sample from an unknown distribution? Naturally, we cannot simulate draws from an unknown distribution but we can draw from a sample of observations. If the sample is a good representation from the population, then our simulated draws from the sample should well approximate the simulated draws from a population. The process of sampling from a sample is called resampling or bootstrapping. The term bootstrap comes from the phrase “pulling oneself up by one’s bootstraps” (Efron, 1979). With resampling, the original sample plays the role of the population and estimates from the sample play the role of true population parameters. The resampling algorithm is the same as introduced in Section 6.1.4 except that now we use simulated draws from a sample. It is common to use \\(\\{X_1, \\ldots, X_n\\}\\) to denote the original sample and let \\(\\{X_1^*, \\ldots, X_n^*\\}\\) denote the simulated draws. We draw them with replacement so that the simulated draws will be independent from one another, the same assumption as with the original sample. For each sample, we also use n simulated draws, the same number as the original sample size. To distinguish this procedure from the simulation, it is common to use B (for bootstrap) to be the number of simulated samples. We could also write \\(\\{X_1^{(b)}, \\ldots, X_n^{(b)}\\}\\), \\(b=1,\\ldots, B\\) to clarify this. There are two basic resampling methods, model-free and model-based, which are, respectively, as nonparametric and parametric. In the nonparametric approach, no assumption is made about the distribution of the parent population. The simulated draws come from the empirical distribution function \\(F_n(\\cdot)\\), so each draw comes from \\(\\{X_1, \\ldots, X_n\\}\\) with probability 1/n. In contrast, for the parametric approach, we assume that we have knowledge of the distribution family F. The original sample \\(X_1, \\ldots, X_n\\) is used to estimate parameters of that family, say, \\(\\hat{\\theta}\\). Then, simulated draws are taken from the \\(F(\\hat{\\theta})\\). Section 6.2.4 discusses this approach in further detail. Nonparametric Bootstrap The idea of the nonparametric bootstrap is to use the inverse method on \\(F_n\\), the empirical cumulative distribution function, depicted in Figure 6.7. Figure 6.7: Inverse of an Empirical Distribution Function Because \\(F_n\\) is a step-function, \\(F_n^{-1}\\) takes values in \\(\\{x_1,\\cdots,x_n\\}\\). More precisely, as illustrated in Figure 6.8. if \\(y\\in(0,1/n)\\) (with probability \\(1/n\\)) we draw the smallest value (\\(\\min\\{x_i\\}\\)) if \\(y\\in(1/n,2/n)\\) (with probability \\(1/n\\)) we draw the second smallest value, … if \\(y\\in((n-1)/n,1)\\) (with probability \\(1/n\\)) we draw the largest value (\\(\\max\\{x_i\\}\\)). Figure 6.8: Inverse of an Empirical Distribution Function Using the inverse method with \\(F_n\\) means sampling from \\(\\{x_1,\\cdots,x_n\\}\\), with probability \\(1/n\\). Generating a bootstrap sample of size \\(B\\) means sampling from \\(\\{x_1,\\cdots,x_n\\}\\), with probability \\(1/n\\), with replacement. See the following illustrative R code. Show R Code For Creating a Bootstrap Sample set.seed(1) n &lt;- 10 x &lt;- rexp(n, 1/6) m &lt;- 8 bootvalues &lt;- sample(x, size=m, replace=TRUE) [1] 2.6164 5.7394 5.7394 2.6164 2.6164 7.0899 0.8823 5.7394 Observe that value 0.8388 was obtained three times. 6.2.2 Bootstrap Precision: Bias, Standard Deviation, and MSE We summarize the nonparametric bootstrap procedure as follows: From the sample \\(\\{X_1, \\ldots, X_n\\}\\), draw a sample of size n (with replacement), say, \\(X_1^*, \\ldots, X_n^*\\). From the simulated draws compute a statistic of interest, denoted as \\(\\hat{\\theta}(X_1^*, \\ldots, X_n^*)\\). Call this \\(\\hat{\\theta}_b^*\\) for the bth replicate. Repeat this \\(b=1, \\ldots, B\\) times to get a sample of statistics, \\(\\hat{\\theta}_1^*, \\ldots,\\hat{\\theta}_B^*\\). From the sample of statistics in Step 2, \\(\\{\\hat{\\theta}_1^*, \\ldots, \\hat{\\theta}_B^*\\}\\), compute a summary measure of interest. In this section, we focus on three summary measures, the bias, the standard deviation, and the mean square error (MSE). Table 6.2 summarizes these three measures. Here, \\(\\overline{\\hat{\\theta^*}}\\) is the average of \\(\\{\\hat{\\theta}_1^*, \\ldots,\\hat{\\theta}_B^*\\}\\). \\[ {\\small \\begin{matrix} \\text{Table 6.2. Bootstrap Summary Measures}\\\\ \\begin{array}{l|c|c|c} \\hline \\text{Population Measure}&amp; \\text{Population Definition}&amp;\\text{Bootstrap Approximation}&amp;\\text{Bootstrap Symbol}\\\\ \\hline \\text{Bias} &amp; \\mathrm{E}(\\hat{\\theta})-\\theta&amp;\\overline{\\hat{\\theta^*}}-\\hat{\\theta}&amp; Bias_{boot}(\\hat{\\theta}) \\\\\\hline \\text{Standard Deviation} &amp; \\sqrt{\\mathrm{Var}(\\hat{\\theta})} &amp; \\sqrt{\\frac{1}{B-1} \\sum_{b=1}^{B}\\left(\\hat{\\theta}_b^* -\\overline{\\hat{\\theta^*}} \\right) ^2}&amp;s_{boot}(\\hat{\\theta}) \\\\\\hline \\text{Mean Square Error} &amp;\\mathrm{E}(\\hat{\\theta}-\\theta)^2 &amp; \\frac{1}{B} \\sum_{b=1}^{B}\\left(\\hat{\\theta}_b^* -\\hat{\\theta} \\right)^2&amp;MSE_{boot}(\\hat{\\theta})\\\\ \\hline \\end{array}\\end{matrix} } \\] Example 6.2.1. Bodily Injury Claims and Loss Elimination Ratios. To show how the bootstrap can be used to quantify the precision of estimators, we return to the Example 4.1.11 bodily injury claims data where we introduced a nonparametric estimator of the loss elimination ratio. Table 6.3 summarizes the results of the bootstrap estimation. For example, at \\(d=14000\\), we saw in Example 4.1.11 that the nonparametric estimate of LER is 0.97678. This has an estimated bias of 0.00018 with a standard deviation of 0.00701. For some applications, you may wish to apply the estimated bias to the original estimate to give a bias-corrected estimator. This is the focus of the next example. For this illustration, the bias is small and so such a correction is not relevant. Show R Code For Bootstrap Estimates of LER # Example from Derrig et al BIData &lt;- read.csv(&quot;../../Data/DerrigResampling.csv&quot;, header =T) BIData$Censored &lt;- 1*(BIData$AmountPaid &gt;= BIData$PolicyLimit) BIDataUncensored &lt;- subset(BIData, Censored == 0) LER.boot &lt;- function(ded, data, indices){ resample.data &lt;- data[indices,] sumClaims &lt;- sum(resample.data$AmountPaid) sumClaims_d &lt;- sum(pmin(resample.data$AmountPaid,ded)) LER &lt;- sumClaims_d/sumClaims return(LER) } ##Derrig et al set.seed(2019) dVec2 &lt;- c(4000, 5000, 10500, 11500, 14000, 18500) OutBoot &lt;- matrix(0,length(dVec2),6) colnames(OutBoot) &lt;- c(&quot;d&quot;,&quot;NP Estimate&quot;,&quot;Bootstrap Bias&quot;, &quot;Bootstrap SD&quot;, &quot;Lower Normal 95% CI&quot;, &quot;Upper Normal 95% CI&quot;) for (i in 1:length(dVec2)) { OutBoot[i,1] &lt;- dVec2[i] results &lt;- boot(data=BIDataUncensored, statistic=LER.boot, R=1000, ded=dVec2[i]) OutBoot[i,2] &lt;- results$t0 biasboot &lt;- mean(results$t)-results$t0 -&gt; OutBoot[i,3] sdboot &lt;- sd(results$t) -&gt; OutBoot[i,4] temp &lt;- boot.ci(results) OutBoot[i,5] &lt;- temp$normal[2] OutBoot[i,6] &lt;- temp$normal[3] } Table 6.3. Bootstrap Estimates of LER at Selected Deductibles d NP Estimate Bootstrap Bias Bootstrap SD Lower Normal 95% CI Upper Normal 95% CI 4000 0.54113 0.00011 0.01237 0.51678 0.56527 5000 0.64960 0.00027 0.01412 0.62166 0.67700 10500 0.93563 0.00004 0.01017 0.91567 0.95553 11500 0.95281 -0.00003 0.00941 0.93439 0.97128 14000 0.97678 0.00016 0.00687 0.96316 0.99008 18500 0.99382 0.00014 0.00331 0.98719 1.00017 The bootstrap standard deviation gives a measure of precision. For one application of standard deviations, we can use the normal approximation to create a confidence interval. For example, the R function boot.ci produces the normal confidence intervals at 95%. These are produced by creating an interval of twice the length of 1.95994 bootstrap standard deviations, centered about the bias-corrected estimator (1.95994 is the 97.5th quantile of the standard normal distribution). For example, the lower normal 95% CI at \\(d=14000\\) is \\((0.97678-0.00018)- 1.95994*0.00701\\) \\(= 0.96286\\). We further discuss bootstrap confidence intervals in the next section. Example 6.2.2. Estimating \\(\\exp(\\mu)\\). The bootstrap can be used to quantify the bias of an estimator, for instance. Consider here a sample \\(\\mathbf{x}=\\{x_1,\\cdots,x_n\\}\\) that is iid with mean \\(\\mu\\). sample_x &lt;- c(2.46,2.80,3.28,3.86,2.85,3.67,3.37,3.40,5.22,2.55, 2.79,4.50,3.37,2.88,1.44,2.56,2.00,2.07,2.19,1.77) Suppose that the quantity of interest is \\(\\theta=\\exp(\\mu)\\). A natural estimator would be \\(\\widehat{\\theta}_1=\\exp(\\overline{x})\\). This estimator is biased (due to the Jensen inequality) but is asymptotically unbiased. For our sample, the estimate is as follows. (theta_1 &lt;- exp(mean(sample_x))) [1] 19.13463 One can use the central limit theorem to get a correction using \\[ \\overline{X}\\approx\\mathcal{N}\\left(\\mu,\\frac{\\sigma^2}{n}\\right)\\text{ where }\\sigma^2=\\text{Var}[X_i] , \\] so that, with the normal moment generating function, we have \\[ \\mathrm{E}~\\exp[\\overline{X}] \\approx \\exp\\left(\\mu+\\frac{\\sigma^2}{2n}\\right) . \\] Hence, one can consider naturally \\[ \\widehat{\\theta}_2=\\exp\\left(\\overline{x}-\\frac{\\widehat{\\sigma}^2}{2n}\\right) . \\] For our data, this turns out to be as follows. n &lt;- length(sample_x) (theta_2 &lt;- exp(mean(sample_x)-var(sample_x)/(2*n))) [1] 18.73334 As another strategy (that we do not pursue here), one can also use Taylor’s approximation to get a more accurate estimator (as in the delta method), \\[ g(\\overline{x})=g(\\mu)+(\\overline{x}-\\mu)g&#39;(\\mu)+(\\overline{x}-\\mu)^2\\frac{g&#39;&#39;(\\mu)}{2}+\\cdots \\] The alternative we do explore is to use a bootstrap strategy: given a bootstrap sample, \\(\\mathbf{x}^{\\ast}_{b}\\), let \\(\\overline{x}^{\\ast}_{b}\\) denotes its mean, and set \\[ \\widehat{\\theta}_3=\\frac{1}{B}\\sum_{b=1}^B\\exp(\\overline{x}^{\\ast}_{b}) . \\] To implement this, we have the following code. Show R Code for Creating Bootstrap Samples library(boot) results &lt;- boot(data=sample_x, statistic=function(y,indices) exp(mean(y[indices])), R=1000) theta_3 &lt;- mean(results$t) Then, you can plot(results) and print(results) to see the following. Figure 6.9: Distribution of Bootstrap Replicates. The left-hand panel is a histogram of replicates. The right-hand panel is a quantile-quantile plot, comparing the bootstrap distribution to the standard normal distribution. ORDINARY NONPARAMETRIC BOOTSTRAP Call: boot(data = sample_x, statistic = function(y, indices) exp(mean(y[indices])), R = 1000) Bootstrap Statistics : original bias std. error t1* 19.13463 0.2536551 3.909725 This results in three estimators, the raw estimator \\(\\widehat{\\theta}_1=\\) 19.135, the second-order correction \\(\\widehat{\\theta}_2=\\) 18.733, and the bootstrap estimator \\(\\widehat{\\theta}_3=\\) 19.388. How does this work with differing sample sizes? We now suppose that the \\(x_i\\)’s are generated from a lognormal distribution \\(LN(0,1)\\), so that \\(\\mu = \\exp(0 + 1/2) = 1.648721\\) and \\(\\theta = \\exp(1.648721)\\) \\(= 5.200326\\). We use simulation to draw the sample sizes but then act as if they were a realized set of observations. See the following illustrative code. Show R Code for Creating Bootstrap Samples param &lt;- function(x){ n &lt;- length(x) theta_1 &lt;- exp(mean(x)) theta_2 &lt;- exp(mean(x)-var(x)/(2*n)) results &lt;- boot(data=x, statistic=function(y,indices) exp(mean(y[indices])), R=999) theta_3 &lt;- mean(results$t) return(c(theta_1,theta_2,theta_3)) } set.seed(2074) ns&lt;- 200 est &lt;- function(n){ call_param &lt;- function(i) param(rlnorm(n,0,1)) V &lt;- Vectorize(call_param)(1:ns) apply(V,1,median) } VN=seq(15,100,by=5) Est &lt;- Vectorize(est)(VN) The results of the comparison are summarized in Figure 6.10. This figure shows that the bootstrap estimator is closer to the true parameter value for almost all sample sizes. The bias of all three estimators decreases as the sample size increases. matplot(VN,t(Est),type=&quot;l&quot;, col=2:4, lty=2:4, ylim=exp(exp(1/2))+c(-1,1), xlab=&quot;sample size (n)&quot;, ylab=&quot;estimator&quot;) abline(h=exp(exp(1/2)),lty=1, col=1) legend(&quot;topleft&quot;, c(&quot;raw estimator&quot;, &quot;second order correction&quot;, &quot;bootstrap&quot;), col=2:4,lty=2:4, bty=&quot;n&quot;) Figure 6.10: Comparision of Estimates. True value of the parameter is given by the solid horizontal line at 5.20. 6.2.3 Confidence Intervals The bootstrap procedure generates B replicates \\(\\hat{\\theta}_1^*, \\ldots,\\hat{\\theta}_B^*\\) of the estimator \\(\\hat{\\theta}\\). In Example 6.2.1, we saw how to use standard normal approximations to create a confidence interval for parameters of interest. However, given that a major point is to use bootstrapping to avoid relying on assumptions of approximate normality, it is not surprising that there are alternative confidence intervals available. For an estimator \\(\\hat{\\theta}\\), the basic bootstrap confidence interval is \\[\\begin{equation} \\left(2 \\hat{\\theta} - q_U, 2 \\hat{\\theta} - q_L \\right) , \\tag{6.2} \\end{equation}\\] where \\(q_L\\) and \\(q_U\\) are lower and upper 2.5% quantiles from the bootstrap sample \\(\\hat{\\theta}_1^*, \\ldots,\\hat{\\theta}_B^*\\). To see where this comes from, start with the idea that \\((q_L, q_U)\\) provides a 95% interval for \\(\\hat{\\theta}_1^*, \\ldots,\\hat{\\theta}_B^*\\). So, for a random \\(\\hat{\\theta}_b^*\\), there is a 95% chance that \\(q_L \\le \\hat{\\theta}_b^* \\le q_U\\). Reversing the inequalities and adding \\(\\hat{\\theta}\\) to each side gives a 95% interval \\[ \\hat{\\theta} -q_U \\le \\hat{\\theta} - \\hat{\\theta}_b^* \\le \\hat{\\theta} -q_L . \\] So, \\(\\left( \\hat{\\theta}-q_U, \\hat{\\theta} -q_L\\right)\\) is an 95% interval for \\(\\hat{\\theta} - \\hat{\\theta}_b^*\\). The bootstrap approximation idea says that this is also a 95% interval for \\(\\theta - \\hat{\\theta}\\). Adding \\(\\hat{\\theta}\\) to each side gives the 95% interval in equation (6.2). Many alternative bootstrap intervals are available. The easiest to explain is the percentile bootstrap interval which is defined as \\(\\left(q_L, q_U\\right)\\). However, this has the drawback of potentially poor behavior in the tails which can be of concern in some actuarial problems of interest. Example 6.2.3. Bodily Injury Claims and Risk Measures. To see how the bootstrap confidence intervals work, we return to the bodily injury auto claims considered in Example 6.2.1. Instead of the loss elimination ratio, suppose we wish to estimate the 95th percentile \\(F^{-1}(0.95)\\) and a measure defined as \\[ TVaR_{0.95)}[X] = \\mathrm{E}[X | X &gt; F^{-1}(0.95)] . \\] This measure is called the tail value-at-risk; it is the expected value of \\(X\\) conditional on \\(X\\) exceeding the 95th percentile. Section 10.2 explains how quantiles and the tail value-at-risk are the two most important examples of so-called risk measures. For now, we will simply think of these as measures that we wish to estimate. For the percentile, we use the nonparametric estimator \\(F^{-1}_n(0.95)\\) defined in Section 4.1.1.3. For the tail value-at-risk, we use the plug-in principle to define the nonparametric estimator \\[ TVaR_{n,0.95}[X] = \\frac{\\sum_{i=1}^n X_i I(X_i &gt; F^{-1}_n(0.95))}{\\sum_{i=1}^n I(X_i &gt; F^{-1}_n(0.95))} ~. \\] In this expression, the denominator counts the number of observations that exceed the 95th percentile \\(F^{-1}_n(0.95)\\). The numerator adds up losses for those observations that exceed \\(F^{-1}_n(0.95)\\). Table 6.4 summarizes the estimator for selected fractions. Show R Code for Creating Quantile Bootstrap Samples # Example from Derrig et al #BIData &lt;- read.csv(&quot;./Data/DerrigResampling.csv&quot;, header =T) BIData$Censored &lt;- 1*(BIData$AmountPaid &gt;= BIData$PolicyLimit) BIDataUncensored &lt;- subset(BIData, Censored == 0) set.seed(2017) PercentVec &lt;- c(0.50, 0.80, 0.90, 0.95, 0.98) OutBoot1 &lt;- matrix(0,5,10) colnames(OutBoot1) &lt;- c(&quot;Fraction&quot;,&quot;NP Estimate&quot;, &quot;Bootstrap Bias&quot;, &quot;Bootstrap SD&quot;, &quot;Lower Normal 95% CI&quot;, &quot;Upper Normal 95% CI&quot;, &quot;Lower Basic 95% CI&quot;, &quot;Upper Basic 95% CI&quot;, &quot;Lower Percentile 95% CI&quot;, &quot;Upper Percentile 95% CI&quot;) for (i in 1:length(PercentVec)) { OutBoot1[i,1] &lt;- PercentVec[i] results &lt;- boot(data=BIDataUncensored$AmountPaid, statistic=function(X,indices) quantile(X[indices],PercentVec[i]), R=1000) if (i==1){bootreal &lt;- results$t} OutBoot1[i,2] &lt;- results$t0 OutBoot1[i,3] &lt;- mean(results$t)-results$t0 OutBoot1[i,4] &lt;- sd(results$t) temp &lt;- boot.ci(results, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;)) OutBoot1[i,5] &lt;- temp$normal[2] OutBoot1[i,6] &lt;- temp$normal[3] OutBoot1[i,7] &lt;- temp$basic[4] OutBoot1[i,8] &lt;- temp$basic[5] OutBoot1[i,9] &lt;- temp$percent[4] OutBoot1[i,10] &lt;- temp$percent[5] } Table 6.4. Bootstrap Estimates of Quantiles at Selected Fractions Fraction NP Estimate Bootstrap Bias Bootstrap SD Lower Normal 95% CI Upper Normal 95% CI Lower Basic 95% CI Upper Basic 95% CI Lower Percentile 95% CI Upper Percentile 95% CI 0.50 6500.00 -128.02 200.36 6235.32 7020.72 6300.00 7000.00 6000.00 6700.00 0.80 9078.40 89.51 200.27 8596.38 9381.41 8533.20 9230.40 8926.40 9623.60 0.90 11454.00 55.95 480.66 10455.96 12340.13 10530.49 12415.00 10493.00 12377.51 0.95 13313.40 13.59 667.74 11991.07 14608.55 11509.70 14321.00 12305.80 15117.10 0.98 16758.72 101.46 1273.45 14161.34 19153.19 14517.44 19326.95 14190.49 19000.00 For example, when the fraction is 0.50, we see that lower and upper 2.5th quantiles of the bootstrap simulations are \\(q_L=\\) 6000 and \\(q_u=\\) 6700, respectively. These form the percentile bootstrap confidence interval. With the nonparametric estimator 6500, these yield the lower and upper bounds of the basic confidence interval 6300 and 7000, respectively. Table 6.4 also shows bootstrap estimates of the bias, standard deviation, and a normal confidence interval, concepts introduced in the prior section. Table 6.5 shows similar calculations for the tail value-at-risk. In each case, we see that the bootstrap standard deviation increases as the fraction increases. This is a reflection of the fewer observations available to estimate quantiles as the fraction increases, hence greater imprecision. Width of confidence intervals also increase. Interestingly, there does not seem to be the same pattern in the estimates of the bias. Show R Code for Creating TVar Bootstrap Samples CTE.boot &lt;- function(data, indices, RiskLevel){ resample.data &lt;- data[indices,] X &lt;- resample.data$AmountPaid cutoff &lt;- quantile(X, RiskLevel) CTE &lt;- sum(X*(X &gt; cutoff))/sum(X &gt; cutoff) return(CTE) } set.seed(2017) PercentVec &lt;- c(0.50, 0.80, 0.90, 0.95, 0.98) OutBoot1 &lt;- matrix(0,5,10) colnames(OutBoot1) &lt;- c(&quot;Fraction&quot;,&quot;NP Estimate&quot;, &quot;Bootstrap Bias&quot;, &quot;Bootstrap SD&quot;, &quot;Lower Normal 95% CI&quot;, &quot;Upper Normal 95% CI&quot;, &quot;Lower Basic 95% CI&quot;, &quot;Upper Basic 95% CI&quot;, &quot;Lower Percentile 95% CI&quot;, &quot;Upper Percentile 95% CI&quot;) for (i in 1:length(PercentVec)) { OutBoot1[i,1] &lt;- PercentVec[i] results &lt;- boot(data=BIDataUncensored, statistic=CTE.boot, R=1000, RiskLevel=PercentVec[i]) OutBoot1[i,2] &lt;- results$t0 OutBoot1[i,3] &lt;- mean(results$t)-results$t0 OutBoot1[i,4] &lt;- sd(results$t) temp &lt;- boot.ci(results, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;)) OutBoot1[i,5] &lt;- temp$normal[2] OutBoot1[i,6] &lt;- temp$normal[3] OutBoot1[i,7] &lt;- temp$basic[4] OutBoot1[i,8] &lt;- temp$basic[5] OutBoot1[i,9] &lt;- temp$percent[4] OutBoot1[i,10] &lt;- temp$percent[5] } Table 6.5. Bootstrap Estimates of TVaR at Selected Risk Levels Fraction NP Estimate Bootstrap Bias Bootstrap SD Lower Normal 95% CI Upper Normal 95% CI Lower Basic 95% CI Upper Basic 95% CI Lower Percentile 95% CI Upper Percentile 95% CI 0.50 9794.69 -120.82 273.35 9379.74 10451.27 9355.14 10448.87 9140.51 10234.24 0.80 12454.18 30.68 481.88 11479.03 13367.96 11490.62 13378.52 11529.84 13417.74 0.90 14720.05 17.51 718.23 13294.82 16110.25 13255.45 16040.72 13399.38 16184.65 0.95 17072.43 5.99 1103.14 14904.31 19228.56 14924.50 19100.88 15043.97 19220.36 0.98 20140.56 73.43 1587.64 16955.40 23178.85 16942.36 22984.40 17296.71 23338.75 6.2.4 Parametric Bootstrap The idea of the nonparametric bootstrap is to resample by drawing independent variables from the empirical cumulative distribution function \\(F_n\\). In contrast, with parametric bootstrap, we draw independent variables from \\(F_{\\widehat{\\theta}}\\) where the underlying distribution is assume to be in a parametric family \\(\\mathcal{F}=\\{F_{\\theta},\\theta\\in\\Theta\\}\\). Typically, parameters from this distribution are estimated based on a sample and denoted as \\(\\hat{\\theta}\\). Example 6.2.4. Lognormal distribution. Consider again the dataset sample_x &lt;- c(2.46,2.80,3.28,3.86,2.85,3.67,3.37,3.40, 5.22,2.55,2.79,4.50,3.37,2.88,1.44,2.56,2.00,2.07,2.19,1.77) The classical (nonparametric) bootstrap was based on samples x &lt;- sample(sample_x,replace=TRUE) while for the parametric bootstrap, we have to assume that the distribution of \\(x_i\\)’s is from a specific family, for instance a lognormal distribution. library(MASS) fit &lt;- fitdistr(sample_x, dlnorm, list(meanlog = 1, sdlog = 1)) fit meanlog sdlog 1.03630697 0.30593440 (0.06840901) (0.04837027) Then we draw from that distribution. x &lt;- rlnorm(length(sample_x), meanlog=fit$estimate[1], sdlog=fit$estimate[2]) Show R Code for Parametric Bootstrap Samples set.seed(2074) CV &lt;- matrix(NA,1e5,2) for(s in 1:nrow(CV)){ x1 &lt;- sample(sample_x,replace=TRUE) x2 &lt;- rlnorm(length(sample_x), meanlog=fit$estimate[1], sdlog=fit$estimate[2]) CV[s,] &lt;- c(sd(x1)/mean(x1),sd(x2)/mean(x2)) } Figure 6.11 compares the bootstrap distributions for the coefficient of variation, one based on the nonparametric approach and the other based on a parametric approach, assuming a lognormal distribution. plot(density(CV[,1]),col=&quot;red&quot;,main=&quot;&quot;,xlab=&quot;Coefficient of Variation&quot;, lty=1) lines(density(CV[,2]),col=&quot;blue&quot;,lty=2) abline(v=sd(sample_x)/mean(sample_x),lty=3) legend(&quot;topright&quot;,c(&quot;nonparametric&quot;,&quot;parametric(LN)&quot;), col=c(&quot;red&quot;,&quot;blue&quot;),lty=1:2,bty=&quot;n&quot;) Figure 6.11: Comparision of Nonparametric and Parametric Bootstrap Distributions for the Coefficient of Variation Example 6.2.5. Bootstrapping Censored Observations. The parametric bootstrap draws simulated realizations from a parametric estimate of the distribution function. In the same way, we can draw simulated realizations from estimates of a distribution function. As one example, we might draw from smoothed estimates of a distribution function introduced in Section 4.1.1.4. Another special case, considered here, is to draw an estimate from the Kaplan-Meier estimator introduced in Section 4.3.2.2. In this way, we can handle observations that are censored. Specifically, return to the bodily injury data in Examples 6.2.1 and 6.2.3 but now we include the 17 claims that were censored by policy limits. In Example 4.3.6, we used this full dataset to estimate the Kaplan-Meier estimator of the survival function introduced in Section 4.3.2.2. Table 6.6 present bootstrap estimates of the quantiles from the Kaplan-Meier survival function estimator. These include the bootstrap precision estimates, bias and standard deviation, as well as the basic 95% confidence interval. Show R Code For Bootstrap Kaplan-Meier Estimates # Example from Derrig et al library(survival) # for Surv(), survfit() BIData$UnCensored &lt;- 1*(BIData$AmountPaid &lt; BIData$PolicyLimit) ## KM estimate KM0 &lt;- survfit(Surv(AmountPaid, UnCensored) ~ 1, type=&quot;kaplan-meier&quot;, data=BIData) set.seed(2019) PercentVec &lt;- c(0.50, 0.80, 0.90, 0.95, 0.98) OutBoot1 &lt;- matrix(NA,5,6) colnames(OutBoot1) &lt;- c(&quot;Fraction&quot;,&quot;KM NP Estimate&quot;, &quot;Bootstrap Bias&quot;, &quot;Bootstrap SD&quot;, &quot;Lower Basic 95% CI&quot;, &quot;Upper Basic 95% CI&quot;) KM.survobj &lt;- Surv(BIData$AmountPaid, BIData$UnCensored) for (i in 1:length(PercentVec)) { OutBoot1[i,1] &lt;- PercentVec[i] results &lt;- bootkm(KM.survobj, q=1-PercentVec[i], B=1000, pr = FALSE) if (i==1){bootreal &lt;- results} OutBoot1[i,2] &lt;- quantile(KM0, PercentVec[i])$quantile OutBoot1[i,3] &lt;- mean(results)-OutBoot1[i,2] OutBoot1[i,4] &lt;- sd(results) # temp &lt;- boot.ci(results, type = c(&quot;norm&quot;, &quot;basic&quot;,&quot;perc&quot;)) OutBoot1[i,5] &lt;- 2*OutBoot1[i,2]-quantile(results,.975, type=6) OutBoot1[i,6] &lt;- 2*OutBoot1[i,2]-quantile(results,.025, type=6) } Table 6.6. Bootstrap Kaplan-Meier Estimates of Quantiles at Selected Fractions Fraction KM NP Estimate Bootstrap Bias Bootstrap SD Lower Basic 95% CI Upper Basic 95% CI 0.50 6500 18.77 177.38 6067 6869 0.80 9500 167.08 429.59 8355 9949 0.90 12756 37.73 675.21 10812 13677 0.95 18500 Inf NaN 12500 22300 0.98 25000 Inf NaN -Inf 27308 Results in Table 6.6 are consistent with the results for the uncensored subsample in Table 6.4. In Table 6.6, we note the difficulty in estimating quantiles at large fractions due to the censoring. However, for moderate size fractions (0.50, 0.80, and 0.90), the Kaplan-Meier nonparametric (KM NP) estimates of the quantile are consistent with those Table 6.4. The bootstrap standard deviation is smaller at the 0.50 (corresponding to the median) but larger at the 0.80 and 0.90 levels. The censored data analysis summarized in Table 6.6 uses more data than the uncensored subsample analysis in Table 6.4 but also has difficulty extracting information for large quantiles. 6.3 Cross-Validation In this section, you learn how to: Compare and contrast cross-validation to simulation techniques and bootstrap methods. Use cross-validation techniques for model selection Explain the jackknife method as a special case of cross-validation and calculate jackknife estimates of bias and standard errors Cross-validation, briefly introduced in Section 4.2.4, is a technique based on simulated outcomes and so let’s think about its purposes in contrast to other simulation techniques already introduced in this chapter. Simulation, or Monte-Carlo, introduced in Section 6.1, allow us to compute expected values and other summaries of statistical distributions, such as \\(p\\)-values, readily. Bootstrap, and other resampling methods introduced in Section 6.2, provide estimators of the precision, or variability, of statistics. Cross-validation is important when assessing how accurately a predictive model will perform in practice. Overlap exists but nonetheless it is helpful to think about the broad goals as associated with each statistical method. To discuss cross-validation, let us recall from Section 4.2 some of the key ideas of model validation. When assessing, or validating, a model, we look to performance measured on new data, or at least not those that were used to fit the model. A classical approach, described in Section 4.2.3, is to split the sample in two: a subpart (the training dataset) is used to fit the model and another one (the testing dataset) is used to validate. However, a limitation of this approach is that results depend on the split; even though the overall sample is fixed, the split between training and test subsamples varies randomly. A different training sample means that model estimated parameters will differ. Different model parameters and a different test sample means that validation statistics will differ. Two analysts may use the same data and same models yet reach different conclusions about the viability of a model (based on different random splits), a frustrating situation. 6.3.1 k-Fold Cross-Validation To mitigate this difficulty, it is common to use a cross-validation approach as introduced in Section 4.2.4. The key idea is to emulate the basic test/training approach to model validation by repeating it many times through averaging over different splits of the data. A key advantage is that the validation statistic is not tied to a specific parametric (or nonparametric) model - one can use a nonparametric statistic or a statistic that has economic interpretations - and so this can be used to compare models that are not nested (unlike likelihood ratio procedures). Example 6.3.1. Wisconsin Property Fund. For the 2010 property fund data introduced in Section 1.3, we fit gamma and Pareto distributions to the 1,377 claims data. For details of the related goodness of fit, see Appendix Section 15.4.4. We now consider the Kolmogorov-Smirnov statistic introduced in Section 4.1.2.2. When the entire dataset was fit, the Kolmogorov-Smirnov goodness of fit statistic for the gamma distribution turns out to be 0.0478 and for the Pareto distribution is 0.2639. The lower value for the Pareto distribution indicates that this distribution is a better fit than the gamma. To see how k-fold cross-validation works, we randomly split the data into \\(k=8\\) groups, or folds, each having about \\(1377/8 \\approx 172\\) observations. Then, we fit gamma and Pareto models to a data set with the first seven folds (about \\(172*7 = 1204\\) observations), determine estimated parameters, and then used these fitted models with the held-out data to determine the Kolmogorov-Smirnov statistic. Show R Code for Kolmogorov-Smirnov Cross-Validation # Randomly re-order the data - &quot;shuffle it&quot; n &lt;- nrow(claim_data) set.seed(12347) cvdata &lt;- claim_data[sample(n), ] # Number of folds k &lt;- 8 cvalvec &lt;- matrix(0,2,k) for (i in 1:k) { indices &lt;- (((i-1) * round((1/k)*nrow(cvdata))) + 1):((i*round((1/k) * nrow(cvdata)))) # Pareto fit.pareto &lt;- vglm(Claim ~ 1, paretoII, loc = 0, data = cvdata[-indices,]) ksResultPareto &lt;- ks.test(cvdata[indices,]$Claim, &quot;pparetoII&quot;, loc = 0, shape = exp(coef(fit.pareto)[2]), scale = exp(coef(fit.pareto)[1])) cvalvec[1,i] &lt;- ksResultPareto$statistic # Gamma fit.gamma &lt;- glm(Claim ~ 1, data = cvdata[-indices,], family = Gamma(link = log)) gamma_theta &lt;- exp(coef(fit.gamma)) * gamma.dispersion(fit.gamma) alpha &lt;- 1 / gamma.dispersion(fit.gamma) ksResultGamma &lt;- ks.test(cvdata[indices,]$Claim, &quot;pgamma&quot;, shape = alpha, scale = gamma_theta) cvalvec[2,i] &lt;- ksResultGamma$statistic } KScv &lt;- rowSums(cvalvec)/k The results appear in Figure 6.12 where horizontal axis is Fold=1. This process was repeated for the other seven folds. The results summarized in Figure 6.12 show that the Pareto consistently provides a more reliable predictive distribution than the gamma. # Plot the statistics matplot(1:k,t(cvalvec),type=&quot;b&quot;, col=c(1,3), lty=1:2, ylim=c(0,0.4), pch = 0, xlab=&quot;Fold&quot;, ylab=&quot;KS Statistic&quot;) legend(&quot;left&quot;, c(&quot;Pareto&quot;, &quot;Gamma&quot;), col=c(1,3),lty=1:2, bty=&quot;n&quot;) Figure 6.12: Cross Validated Kolmogorov-Smirnov (KS) Statistics for the Property Fund Claims Data. The solid black line is for the Pareto distribution, the green dashed line is for the gamma distribution. The KS statistic measures the largest deviation between the fitted distribution and the empirical distribution for each of 8 groups, or folds, of randomly selected data. 6.3.2 Leave-One-Out Cross-Validation A special case where \\(k=n\\) is known as leave-one-out cross validation. This case is historically prominent and is closely related to jackknife statistics, a precursor of the bootstrap technique. Even though we present it as a special case of cross-validation, it is helpful to given an explicit definition. Consider a generic statistic \\(\\widehat{\\theta}=t(\\boldsymbol{x})\\) that is an estimator for a parameter of interest \\(\\theta\\). The idea of the jackknife is to compute \\(n\\) values \\(\\widehat{\\theta}_{-i}=t(\\boldsymbol{x}_{-i})\\), where \\(\\boldsymbol{x}_{-i}\\) is the subsample of \\(\\boldsymbol{x}\\) with the \\(i\\)-th value removed. The average of these values is denoted as \\[ \\overline{\\widehat{\\theta}}_{(\\cdot)}=\\frac{1}{n}\\sum_{i=1}^n \\widehat{\\theta}_{-i} . \\] These values can be used to create estimates of the bias of the statistic \\(\\widehat{\\theta}\\) \\[\\begin{equation} Bias_{jack} = (n-1) \\left(\\overline{\\widehat{\\theta}}_{(\\cdot)} - \\widehat{\\theta}\\right) \\tag{6.3} \\end{equation}\\] as well as a standard deviation estimate \\[\\begin{equation} s_{jack} =\\sqrt{\\frac{n-1}{n}\\sum_{i=1}^n \\left(\\widehat{\\theta}_{-i} -\\overline{\\widehat{\\theta}}_{(\\cdot)}\\right)^2} ~. \\tag{6.4} \\end{equation}\\] Example 6.3.2. Coefficient of Variation. To illustrate, consider a small fictitious sample \\(\\boldsymbol{x}=\\{x_1,\\ldots,x_n\\}\\) with realizations sample_x &lt;- c(2.46,2.80,3.28,3.86,2.85,3.67,3.37,3.40, 5.22,2.55,2.79,4.50,3.37,2.88,1.44,2.56,2.00,2.07,2.19,1.77) Suppose that we are interested in the coefficient of variation \\(\\theta = CV = \\sqrt{\\mathrm{Var~}X}/\\mathrm{E~}X\\). With this dataset, the estimator of the coefficient of variation turns out to be 0.31196. But how reliable is it? To answer this question, we can compute the jackknife estimates of bias and its standard deviation. The following code shows that the jackknife estimator of the bias is \\(Bias_{jack} =\\) -0.00627 and the jackknife standard deviation is \\(s_{jack} =\\) 0.01293. CVar &lt;- function(x) sqrt(var(x))/mean(x) JackCVar &lt;- function(i) sqrt(var(sample_x[-i]))/mean(sample_x[-i]) JackTheta &lt;- Vectorize(JackCVar)(1:length(sample_x)) BiasJack &lt;- (length(sample_x)-1)*(mean(JackTheta) - CVar(sample_x)) sd(JackTheta) Example 6.3.3. Bodily Injury Claims and Loss Elimination Ratios. In Example 6.2.1, we showed how to compute bootstrap estimates of the bias and standard deviation for the loss elimination ratio using the Example 4.1.11 bodily injury claims data. We follow up now by providing comparable quantities using jackknife statistics. Table 6.7 summarizes the results of the jackknife estimation. It shows that jackknife estimates of the bias and standard deviation of the loss elimination ratio \\(\\mathrm{E}~\\min(X,d)/\\mathrm{E}~X\\) are largely consistent with the bootstrap methodology. Moreover, one can use the standard deviations to construct normal based confidence intervals, centered around a bias-corrected estimator. For example, at \\(d=14000\\), we saw in Example 4.1.11 that the nonparametric estimate of LER is 0.97678. This has an estimated bias of 0.00010, resulting in the (jackknife) bias-corrected estimator 0.97688. The 95% confidence intervals are produced by creating an interval of twice the length of 1.96 jackknife standard deviations, centered about the bias-corrected estimator (1.96 is the approximate 97.5th quantile of the standard normal distribution). Show the R Code # Example from Derrig et al BIData &lt;- read.csv(&quot;../../Data/DerrigResampling.csv&quot;, header =T) BIData$Censored &lt;- 1*(BIData$AmountPaid &gt;= BIData$PolicyLimit) BIDataUncensored &lt;- subset(BIData, Censored == 0) LER.boot &lt;- function(ded, data, indices){ resample.data &lt;- data[indices,] sumClaims &lt;- sum(resample.data$AmountPaid) sumClaims_d &lt;- sum(pmin(resample.data$AmountPaid,ded)) LER &lt;- sumClaims_d/sumClaims return(LER) } x &lt;- BIDataUncensored$AmountPaid LER.jack&lt;- function(ded,i){ LER &lt;- sum(pmin(x[-i],ded))/sum(x[-i]) return(LER) } LER &lt;- function(ded) sum(pmin(x,ded))/sum(x) ##Derrig et al set.seed(2019) dVec2 &lt;- c(4000, 5000, 10500, 11500, 14000, 18500) OutJack &lt;- matrix(0,length(dVec2),8) colnames(OutJack) &lt;- c(&quot;d&quot;,&quot;NP Estimate&quot;,&quot;Bootstrap Bias&quot;, &quot;Bootstrap SD&quot;, &quot;Jackknife Bias&quot;, &quot;Jackknife SD&quot;,&quot;Lower Jackknife 95% CI&quot;, &quot;Upper Jackknife 95% CI&quot;) for (j in 1:length(dVec2)) { OutJack[j,1] &lt;- dVec2[j] results &lt;- boot(data=BIDataUncensored, statistic=LER.boot, R=1000, ded=dVec2[j]) OutJack[j,2] &lt;- results$t0 biasboot &lt;- mean(results$t)-results$t0 -&gt; OutJack[j,3] sdboot &lt;- sd(results$t) -&gt; OutJack[j,4] temp &lt;- boot.ci(results) LER.jack.ded&lt;- function(i) LER.jack(ded=dVec2[j],i) JackTheta.ded &lt;- Vectorize(LER.jack.ded)(1:length(x)) OutJack[j,5] &lt;- BiasJack.ded &lt;- (length(x)-1)*(mean(JackTheta.ded) - LER(ded=dVec2[j])) OutJack[j,6] &lt;- sd(JackTheta.ded) OutJack[j,7:8] &lt;- mean(JackTheta.ded)+qt(c(0.025,0.975),length(x)-1)*OutJack[j,6] } Table 6.7. Jackknife Estimates of LER at Selected Deductibles d NP Estimate Bootstrap Bias Bootstrap SD Jackknife Bias Jackknife SD Lower Jackknife 95% CI Upper Jackknife 95% CI 4000 0.54113 0.00011 0.01237 0.00031 0.00061 0.53993 0.54233 5000 0.64960 0.00027 0.01412 0.00033 0.00068 0.64825 0.65094 10500 0.93563 0.00004 0.01017 0.00019 0.00053 0.93460 0.93667 11500 0.95281 -0.00003 0.00941 0.00016 0.00047 0.95189 0.95373 14000 0.97678 0.00016 0.00687 0.00010 0.00034 0.97612 0.97745 18500 0.99382 0.00014 0.00331 0.00003 0.00017 0.99350 0.99415 Discussion. One of the many interesting things about the leave-one-out special case is the ability to replicate estimates exactly. That is, when the size of the fold is only one, then there is no additional uncertainty induced by the cross-validation. This means that analysts can exactly replicate work of one another, an important consideration. Jackknife statistics were developed to understand precision of estimators, producing estimators of bias and standard deviation in equations (6.3) and (6.4). This crosses into goals that we have associated with bootstrap techniques, not cross-validation methods. This demonstrates how statistical techniques can be used to achieve different goals. 6.3.3 Cross-Validation and Bootstrap The bootstrap is useful in providing estimators of the precision, or variability, of statistics. It can also be useful for model validation. The bootstrap approach to model validation is similar to the leave-one-out and k-fold validation procedures: Create a bootstrap sample by re-sampling (with replacement) \\(n\\) indices in \\(\\{1,\\cdots,n\\}\\). That will be our training sample. Estimate the model under consideration based on this sample. The test, or validation sample, consists of those observations not selected for training. Evaluate the fitted model (based on the training data) using the test data. Repeat this process many (say \\(B\\)) times. Take an average over the results and choose the model based on the average evaluation statistic. Example 6.3.4. Wisconsin Property Fund. Return to Example 6.3.1 where we investigate the fit of the gamma and Pareto distributions on the property fund data. We again compare the predictive performance using the Kolmogorov-Smirnov statistic but this time using the bootstrap procedure to split the data between training and testing samples. The following provides illustrative code. Show R Code for Bootstrapping Validation Procedures # library(MASS) # library(VGAM) # library(goftest) # claim_lev &lt;- read.csv(&quot;../../Data/CLAIMLEVEL.csv&quot;, header = TRUE) # # 2010 subset # claim_data &lt;- subset(claim_lev, Year == 2010); n &lt;- nrow(claim_data) set.seed(12347) indices &lt;- 1:n # Number of Bootstrap Samples B &lt;- 100 cvalvec &lt;- matrix(0,2,B) for (i in 1:B) { bootindex &lt;- unique(sample(indices, size=n, replace= TRUE)) traindata &lt;- claim_data[bootindex,] testdata &lt;- claim_data[-bootindex,] # Pareto fit.pareto &lt;- vglm(Claim ~ 1, paretoII, loc = 0, data = traindata) ksResultPareto &lt;- ks.test(testdata$Claim, &quot;pparetoII&quot;, loc = 0, shape = exp(coef(fit.pareto)[2]), scale = exp(coef(fit.pareto)[1])) cvalvec[1,i] &lt;- ksResultPareto$statistic # Gamma fit.gamma &lt;- glm(Claim ~ 1, data = traindata, family = Gamma(link = log)) gamma_theta &lt;- exp(coef(fit.gamma)) * gamma.dispersion(fit.gamma) alpha &lt;- 1 / gamma.dispersion(fit.gamma) ksResultGamma &lt;- ks.test(testdata$Claim, &quot;pgamma&quot;, shape = alpha, scale = gamma_theta) cvalvec[2,i] &lt;- ksResultGamma$statistic } KSBoot &lt;- rowSums(cvalvec)/B We did the sampling using \\(B=\\) 100 replications. The average KS statistic for the Pareto distribution was 0.058 compared to the average for the gamma distribution, 0.262. This is consistent with earlier results and provides another piece of evidence that the Pareto is a better model for these data than the gamma. 6.4 Importance Sampling Section 6.1 introduced Monte Carlo techniques using the inversion technique : to generate a random variable \\(X\\) with distribution \\(F\\), apply \\(F^{-1}\\) to calls of a random generator (uniform on the unit interval). What if we what to draw according to \\(X\\), conditional on \\(X\\in[a,b]\\) ? One can use an accept-reject mechanism : draw \\(x\\) from distribution \\(F\\) if \\(x\\in[a,b]\\) : keep it (“accept”) if \\(x\\notin[a,b]\\) : draw another one (“reject”) Observe that from \\(n\\) values initially generated, we keep here only \\([F(b)-F(a)]\\cdot n\\) draws, on average. Example 6.4.1. Draws from a Normal Distribution. Suppose that we draw from a normal distribution with mean 2.5 and variance 1, \\(N(2.5,1)\\), but are only interested in draws greater that \\(a \\ge 2\\) and less than \\(b \\le 4\\). That is, we can only use \\(F(4)-F(2) = \\Phi(4-2.5)-\\Phi(2-2.5)\\) = 0.9332 - 0.3085 = 0.6247 proportion of the draws. Figure 6.13 demonstrates that some draws lie with the interval \\((2,4)\\) and some are outside. Show R Code for Accept-Reject Mechanism mu = 2.5 sigma = 1 a = 2 b = 4 Fa = pnorm(a,mu,sigma) Fb = pnorm(b,mu,sigma) pic_ani = function(){ u=seq(0,5,by=.01) plot(u,pnorm(u,mu,sigma),col=&quot;white&quot;,ylab=&quot;&quot;,xlab=&quot;&quot;) rect(-1,-1,6,2,col=rgb(1,0,0,.2),border=NA) rect(a,Fa,b,Fb,col=&quot;white&quot;,border=NA) lines(u,pnorm(u,mu,sigma),lwd=2) abline(v=c(a,b),lty=2,col=&quot;red&quot;) ru &lt;- runif(1) clr &lt;- &quot;red&quot; if((qnorm(ru,mu,sigma)&gt;=a)&amp;(qnorm(ru,mu,sigma)&lt;=b)) clr &lt;- &quot;blue&quot; segments(-1,ru,qnorm(ru,mu,sigma),ru,col=clr,lwd=2) arrows(qnorm(ru,mu,sigma),ru,qnorm(ru,mu,sigma),0,col=clr,lwd=2,length = .1) } for (i in 1:numAnimation) {pic_ani()} Figure 6.13: Animated Demonstration of Draws In and Outside of (2,4) Instead, one can draw according to the conditional distribution \\(F^{\\star}\\) defined as \\[ F^{\\star}(x) = \\Pr(X \\le x | a &lt; X \\le b) =\\frac{F(x)-F(a)}{F(b)-F(a)}, \\ \\ \\ \\text{for } a &lt; x \\le b . \\] Using the inverse transform method in Section 6.1.2, we have that the draw \\[ X^\\star=F^{\\star-1}\\left( U \\right) = F^{-1}\\left(F(a)+U\\cdot[F(b)-F(a)]\\right) \\] has distribution \\(F^{\\star}\\). Expressed another way, define \\[ \\tilde{U} = (1-U)\\cdot F(a)+U\\cdot F(b) \\] and then use \\(F^{-1}(\\tilde{U})\\). With this approach, each draw counts. This can be related to the importance sampling mechanism : we draw more frequently in regions where we expect to have quantities that have some interest. This transform can be considered as a “a change of measure.” Show R Code for Importance Sampling by the Inverse Transform Method pic_ani = function(){ u=seq(0,5,by=.01) plot(u,pnorm(u,mu,sigma),col=&quot;white&quot;,ylab=&quot;&quot;,xlab=&quot;&quot;) rect(-1,-1,6,2,col=rgb(1,0,0,.2),border=NA) rect(a,Fa,b,Fb,col=&quot;white&quot;,border=NA) lines(u,pnorm(u,mu,sigma),lwd=2) abline(h=pnorm(c(a,b),mu,sigma),lty=2,col=&quot;red&quot;) ru &lt;- runif(1) rutilde &lt;- (1-ru)*Fa+ru*Fb segments(-1,rutilde,qnorm(rutilde,mu,sigma),rutilde,col=&quot;blue&quot;,lwd=2) arrows(qnorm(rutilde,mu,sigma),rutilde,qnorm(rutilde,mu,sigma),0,col=&quot;blue&quot;,lwd=2,length = .1) } for (i in 1:numAnimation) {pic_ani()} In Example 6.4.1., the inverse of the normal distribution is readily available (in R, the function is qnorm). However, for other applications, this is not the case. Then, one simply uses numerical methods to determine \\(X^\\star\\) as the solution of the equation \\(F(X^\\star) =\\tilde{U}\\) where \\(\\tilde{U}=(1-U)\\cdot F(a)+U\\cdot F(b)\\). See the following illustrative code. Show R Code for Importance Sampling via Numerical Solutions pic_ani = function(){ u=seq(0,5,by=.01) plot(u,pnorm(u,mu,sigma),col=&quot;white&quot;,ylab=&quot;&quot;,xlab=&quot;&quot;) rect(-1,-1,6,2,col=rgb(1,0,0,.2),border=NA) rect(2,-1,4,2,col=&quot;white&quot;,border=NA) lines(u,pnorm(u,mu,sigma),lty=2) pnormstar &lt;- Vectorize(function(x){ y=(pnorm(x,mu,sigma)-Fa)/(Fb-Fa) if(x&lt;=a) y &lt;- 0 if(x&gt;=b) y &lt;- 1 return(y) }) qnormstar &lt;- function(u) as.numeric(uniroot((function (x) pnormstar(x) - u), lower = 2, upper = 4)[1]) lines(u,pnormstar(u),lwd=2) abline(v=c(2,4),lty=2,col=&quot;red&quot;) ru &lt;- runif(1) segments(-1,ru,qnormstar(ru),ru,col=&quot;blue&quot;,lwd=2) arrows(qnormstar(ru),ru,qnormstar(ru),0,col=&quot;blue&quot;,lwd=2,length = .1) } for (i in 1:numAnimation) {pic_ani()} 6.5 Monte Carlo Markov Chain (MCMC) This section is being written and is not yet complete nor edited. It is here to give you a flavor of what will be in the final version. The idea of Monte Carlo techniques rely on the law of large number (that insures the convengence of the average towards the integral) and the central limit theorem (that is used to quantify uncertainty in the computations). Recall that if \\((X_i)\\) is an i.id. sequence of random variables with distribution \\(F\\), then \\[ \\frac{1}{\\sqrt{n}}\\left(\\sum_{i=1}^n h(X_i)-\\int h(x)dF(x)\\right)\\overset{\\mathcal{L}}{\\rightarrow }\\mathcal{N}(0,\\sigma^2),\\text{ as }n\\rightarrow\\infty. \\] for some variance \\(\\sigma^2&gt;0\\). But actually, the ergodic theorem can be used to weaker the previous result, since it is not necessary to have independence of the variables. More precisely, if \\((X_i)\\) is a Markov Process with invariant measure \\(\\mu\\), under some additional technical assumptions, we can obtain that \\[ \\frac{1}{\\sqrt{n}}\\left(\\sum_{i=1}^n h(X_i)-\\int h(x)d\\mu(x)\\right)\\overset{\\mathcal{L}}{\\rightarrow }\\mathcal{N}(0,\\sigma_\\star^2),\\text{ as }n\\rightarrow\\infty. \\] for some variance \\(\\sigma_\\star^2&gt;0\\). Hence, from this property, we can see that it is possible not necessarily to generate independent values from \\(F\\), but to generate a markov process with invariante measure \\(F\\), and to consider means over the process (not necessarily independent). Consider the case of a constraint Gaussian vector : we want to generate random pairs from a random vector \\(\\boldsymbol{X}\\), but we are interested only on the case where the sum of the composants is large enough, which can be written \\(\\boldsymbol{X}^T\\boldsymbol{1}&gt; m\\) for some real valued \\(m\\). Of course, it is possible to use the accept-reject algorithm, but we have seen that it might be quite inefficient. One can use Hastings Metropolis and Gibbs sampler to generate a Markov process with such an invariant measure. 6.5.1 Hastings Metropolis The algorithm is rather simple to generate from \\(f\\) : we start with a feasible value \\(x_1\\). Then, at step \\(t\\), we need to specify a transition kernel : given \\(x_t\\), we need a conditional distribution for \\(X_{t+1}\\) given \\(x_t\\). The algorithm will work well if that conditional distribution can easily be simulated. Let \\(\\pi(\\cdot|x_t)\\) denote that probability. Draw a potential value \\(x_{t+1}^\\star\\), and \\(u\\), from a uniform distribution. Compute \\[ R= \\frac{f(x_{t+1}^\\star)}{f(x_t)} \\] and if \\(u &lt; r\\), then set \\(x_{t+1}=x_t^\\star\\) if \\(u\\leq r\\), then set \\(x_{t+1}=x_t\\) Here \\(r\\) is called the acceptance-ratio: we accept the new value with probability \\(r\\) (or actually the smallest between \\(1\\) and \\(r\\) since \\(r\\) can exceed \\(1\\)). For instance, assume that \\(f(\\cdot|x_t)\\) is uniform on \\([x_t-\\varepsilon,x_t+\\varepsilon]\\) for some \\(\\varepsilon&gt;0\\), and where \\(f\\) (our target distribution) is the \\(\\mathcal{N}(0,1)\\). We will never draw from \\(f\\), but we will use it to compute our acceptance ratio at each step. Show R Code metrop1 &lt;- function(n=1000,eps=0.5){ vec &lt;- matrix(NA, n, 3) x=0 vec[1] &lt;- x for (i in 2:n) { innov &lt;- runif(1,-eps,eps) mov &lt;- x+innov R &lt;- min(1,dnorm(mov)/dnorm(x)) u &lt;- runif(1) if (u &lt; R) x &lt;- mov vec[i,] &lt;- c(x,mov,R) } return(vec)} In the code above, vec contains values of \\(\\boldsymbol{x}=(x_1,x_2,\\cdots)\\), innov is the innovation. Show R Code #install.packages(&#39;gifski&#39;) #if (packageVersion(&#39;knitr&#39;) &lt; &#39;1.20.14&#39;) { # remotes::install_github(&#39;yihui/knitr&#39;) #} vec &lt;- metrop1(25) u=seq(-3,3,by=.01) pic_ani = function(k){ plot(1:k,vec[1:k,1],pch=19,xlim=c(0,25),ylim=c(-2,2),xlab=&quot;&quot;,ylab=&quot;&quot;) if(vec[k+1,1]==vec[k+1,2]) points(k+1,vec[k+1,1],col=&quot;blue&quot;,pch=19) if(vec[k+1,1]!=vec[k+1,2]) points(k+1,vec[k+1,1],col=&quot;red&quot;,pch=19) points(k+1,vec[k+1,2],cex=1.5) arrows(k+1,vec[k,1]-.5,k+1,vec[k,1]+.5,col=&quot;green&quot;,angle=90,code = 3,length=.1) polygon(c(k+dnorm(u)*10,rep(k,length(u))),c(u,rev(u)),col=rgb(0,1,0,.3), border=NA) segments(k,vec[k,1],k+dnorm(vec[k,1])*10,vec[k,1]) segments(k,vec[k+1,2],k+dnorm(vec[k+1,2])*10,vec[k+1,2]) text(k,2,round(vec[k+1,3],digits=3)) } for (k in 2:23) {pic_ani(k)} Now, if we use more simulations, we get vec &lt;- metrop1(10000) simx &lt;- vec[1000:10000,1] par(mfrow=c(1,4)) plot(simx,type=&quot;l&quot;) hist(simx,probability = TRUE,col=&quot;light blue&quot;,border=&quot;white&quot;) lines(u,dnorm(u),col=&quot;red&quot;) qqnorm(simx) acf(simx,lag=100,lwd=2,col=&quot;light blue&quot;) 6.5.2 Gibbs sampler Consider some vector \\(\\boldsymbol{X}=(X_1,\\cdots,X_d)\\) with ind'ependent components, \\(X_i\\sim\\mathcal{E}(\\lambda_i)\\). We sample to sample from \\(\\boldsymbol{X}\\) given \\(\\boldsymbol{X}^T\\boldsymbol{1}&gt;s\\) for some threshold \\(s&gt;0\\). start with some starting point \\(\\boldsymbol{x}_0\\) such that pick up (randomly) \\(i\\in\\{1,\\cdots,d\\}\\) \\(X_i\\) given \\(X_i &gt; s-\\boldsymbol{x}_{(-i)}^T\\boldsymbol{1}\\) has an Exponential distribution \\(\\mathcal{E}(\\lambda_i)\\) draw \\(Y\\sim \\mathcal{E}(\\lambda_i)\\) and set \\(x_i=y +(s-\\boldsymbol{x}_{(-i)}^T\\boldsymbol{1})_+\\) until \\(\\boldsymbol{x}_{(-i)}^T\\boldsymbol{1}+x_i&gt;s\\) Show R Code sim &lt;- NULL lambda &lt;- c(1,2) X &lt;- c(3,3) s &lt;- 5 for(k in 1:1000){ i &lt;- sample(1:2,1) X[i] &lt;- rexp(1,lambda[i])+max(0,s-sum(X[-i])) while(sum(X)&lt;s){ X[i] &lt;- rexp(1,lambda[i])+max(0,s-sum(X[-i])) } sim &lt;- rbind(sim,X) } plot(sim,xlim=c(1,11),ylim=c(0,4.3)) polygon(c(-1,-1,6),c(-1,6,-1),col=&quot;red&quot;,density=15,border=NA) abline(5,-1,col=&quot;red&quot;) The construction of the sequence (MCMC algorithms are iterative) can be visualized below Show R Code lambda &lt;- c(1,2) X &lt;- c(3,3) sim &lt;- X s &lt;- 5 for(k in 1:100){ set.seed(k) i &lt;- sample(1:2,1) X[i] &lt;- rexp(1,lambda[i])+max(0,s-sum(X[-i])) while(sum(X)&lt;s){ X[i] &lt;- rexp(1,lambda[i])+max(0,s-sum(X[-i])) } sim &lt;- rbind(sim,X) } pic_ani = function(n){ plot(sim[1:n,],xlim=c(1,11),ylim=c(0,5),xlab=&quot;&quot;,ylab=&quot;&quot;) i=which(apply(sim[(n-1):n,],2,diff)==0) if(i==1) abline(v=sim[n,1],col=&quot;grey&quot;) if(i==2) abline(h=sim[n,2],col=&quot;grey&quot;) if(n&gt;=1) points(sim[n,1],sim[n,2],pch=19,col=&quot;blue&quot;,cex=1.4) if(n&gt;=2) points(sim[n-1,1],sim[n-1,2],pch=19,col=&quot;red&quot;,cex=1.4) polygon(c(-1,-1,6),c(-1,6,-1),col=&quot;red&quot;,density=15,border=NA) abline(5,-1,col=&quot;red&quot;) } for (i in 2:100) {pic_ani(i)} 6.6 Further Resources and Contributors Include historical references for jackknife (Quenouille, Tukey, Efron) Here are some links to learn more about reproducibility and randomness and how to go from a random generator to a sample function. Contributors Arthur Charpentier, Université du Quebec á Montreal, and Edward W. (Jed) Frees, University of Wisconsin-Madison, are the principal authors of the initial version of this chapter. Email: jfrees@bus.wisc.edu and/or arthur.charpentier@gmail.com for chapter comments and suggested improvements. Chapter reviewers include: Write Jed or Arthur; to add you name here. 6.6.1 TS 6.A. Bootstrap Applications in Predictive Modeling This section is being written. "],
["C-PremiumFoundations.html", "Chapter 7 Premium Foundations 7.1 Introduction to Ratemaking 7.2 Aggregate Ratemaking Methods 7.3 Pricing Principles 7.4 Heterogeneous Risks 7.5 Development and Trending 7.6 Selecting a Premium 7.7 Further Resources and Contributors", " Chapter 7 Premium Foundations Chapter Preview. Setting prices for insurance products, premiums, is an important task for actuaries and other data analysts. This chapter introduces the foundations for pricing non-life products. 7.1 Introduction to Ratemaking In this section, you learn how to: Describe expectations as a baseline method for determining insurance premiums Analyze an accounting equation for relating premiums to losses, expenses and profits Summarize a strategy for extending pricing to include heterogeneous risks and trends over time This chapter explains how you can think about determining the appropriate price for an insurance product. As described in Section 1.2, one of the core actuarial functions is ratemaking, where the analyst seeks to determine the right price for a risk. As this is a core function, let us first take a step back to define terms. A price is a quantity, usually of money, that is exchanged for a good or service. In insurance, we typically use the word premium for the amount of money charged for insurance protection against contingent events. The amount of protection varies by risk being insured. For example, in homeowners insurance the amount of insurance protection depends on the value of the house. In life insurance, the amount of protection depends on a policyholder’s financial status (e.g. income and wealth) as well as a perceived need for financial security. So, it is common to express insurance prices as a unit of the protection being purchased, for example, an amount per thousands (e.g., of dollars or Euros) for coverage of a home or benefit in the event of death. Because they are expressed in standardized units, these prices/premiums are known as rates. To determine premiums, it is common in economics to consider the supply and demand of a product. The demand is sensitive to price as well as the existence of competiting firms and substitute products. The supply is a function of the resources required for production. For the individual firm, the price is set to meet some objective such as profit maximization which is met by choosing the output level that balances costs and revenues at the margins. However, a peculiarity of insurance is that the costs of insurance protection are not known at the sale of the contract. If the insured contingent event, such as the loss of a house or life, does not occur, then the contract costs are only administrative (to set up the contract) and are relatively minor. If the insured event occurs, then the cost includes not only administrative costs but also payment of the amount insured and expenses to settle claims. So, the cost is random; when the contract is written, by design neither the insurer nor the insured knows the contract costs. Moreover, costs may not be revealed for months or years. For example, a typical time to settlement in medical malpractice is five years. Because costs are unknown at the time of sale, insurance pricing differs from common economic approaches. This chapter squarely addresses the uncertain nature of costs by introducing traditional actuarial approaches that determine prices as a function of insurance costs. As we will see, this pricing approach is sufficient for some insurance markets such as personal automobile or homeowners where the insurer has a portfolio of many independent risks. However, there are other insurance markets where actuarial prices only provide an input to general market prices. To reinforce this distinction, actuarial cost-based premiums are sometimes known as technical prices. From the perspective of economists, corporate decisions such as pricing are to be evaluated with reference to their impact on the firm’s market value. This objective is more comprehensive than the static notion of profit maximization. That is, you can think of the value of the firm represents the capitalized value of all future expected profits. Decisions impacting this value in turn affect all groups having claims on the firm, including stockholders, bondholders, policyowners (in the case of mutual companies), and so forth. For cost-based prices, it is helpful to think of a premium as revenue source that provides for claim payments, contract expenses, and an operating margin. We formalize this in an accounting equation \\[\\begin{equation} \\small{ \\text{Premium = Loss + Expense + UW Profit} . } \\tag{7.1} \\end{equation}\\] Expenses can be split into those that vary by premium (such as sales commissions) and those that do not (such as building costs and employee salaries). The term UW Profit is a residual that stands for underwriting profit. It may also include include a cost of capital (for example, an annual dividend to company investors). Because fixed expenses and costs of capital are difficult to interpret for individual contracts, we think of the equation (7.1) relationship as holding over the sum of many contracts (a portfolio) and work with it in aggregate. Then, in Section 7.2 we use this approach to help us think about setting premiums, for example by setting profit objectives. Specifically, Sections 7.2.1 and 7.2.2 introduce two prevailing methods used in practice for determining premiums, the pure premium and the loss ratio methods. The Loss in equation (7.1) is random and so, as a baseline, we use the expected costs to determine rates. There are several ways to motivate this perspective that we expand upon in Section 7.3. For now, we will suppose that the insurer enters into many contracts with risks that are similar except, by pure chance, in some cases the insured event occurs and in others it does not. The insurer is obligated to pay the total amount of claims payments for all contracts. If risks are similar, then all policyholders should be responsible for the same amount which is the average claim payment. So, from this perspective, it makes sense to look at the average claim payment over many insureds. From probability theory, specifically the law of large numbers, we know that the average of iid risks is close to the expected amount, so we use the expectation as a baseline pricing principle. Nonetheless, by using expected losses, we essentially assume that the uncertainty is non-existent. If the insurers sells enough independent policies, this may be a reasonable approximation. However, there will be other cases, such as a single contract issued to a large corporation to insure all of its buildings against fire damage, where the use of only an expectation for pricing is not sufficient. So, Section 7.3 also summarizes alternative premium principles that incorporate uncertainty into our pricing. Note that an emphasis of this text is estimation of the entire distribution of losses so the analyst is not restricted to working only with expectations. The aggregate methods derived from equation (7.1) focus on collections of homogeneous risks that are similar except for the occurrence of random losses. In statistical language that we have introduced, this is a discussion about risks that have identical distributions. Naturally, when examining risks that insurers work with, there are many variations in the risks being insured including the features of the contracts and the people being insured. Section 7.4 extends pricing considerations to heterogeneous collections of risks. Section 7.5 introduces ideas of development and trending. When developing rates, we want to use the most recent loss experience because the goal is to develop rates that are forward looking. However, at contract initiation, recent loss experience is often not known; it may be several years until it is fully realized. So, this section introduces concepts needed for incorporating recent loss experience into our premium development. Development and trending of experience is related to but also differs from the idea of experience rating that suggests that experience reveals hidden information about the insured and so should be incorporated in our forward thinking viewpoint. Chapter 9 discusses this idea in more detail. The final section of this chapter introduces methods for selecting a premium. This is done by comparing a premium rating method to losses from a held-out portfolio and selecting the method that produces the best match with the held-out data. For a typical insurance portfolio, most policies produce zero losses, that is, do not have a claim. Because the distribution of held-out losses is a combination of (a large number of) zeros and continuous amounts, special techniques are useful. Section 7.6 introduces concepts of concentration curves and corresponding Gini statistics to help in this selection. The chapter also includes a technical supplement on government regulation of insurance rates to keep our work grounded in applications. 7.2 Aggregate Ratemaking Methods In this section, you learn how to: Define a pure premium as a loss cost as well as in terms of frequency and severity Calculate an indicated rate using pure premiums, expenses, and profit loadings Define a loss ratio Calculate an indicated rate change using loss ratios Compare the pure premium and loss ratio methods for determining premiums It is common to consider an aggregate portfolio of insurance experience. Consistent with earlier notation, consider a collection of n contracts with losses \\(X_1, \\ldots, X_n\\). In this section, we assume that contracts have the same loss distribution, that is they form a homogeneous portfolio, and so are iid. For motivation, you can think about personal insurance such as auto or homeowners where insurers write many contracts on risks that appear very similar. Further, the assumption of identical distributions is not as limiting as you might think. In Section 7.4.1 we will introduce the idea of an exposure variable that allows us to rescale experience to make it comparable. For example, by rescaling losses we will be able to treat homeowner losses from a 100,000 house and a 200,000 house as coming from the same distribution. For now, we simply assume that \\(X_1, \\ldots, X_n\\) are iid. 7.2.1 Pure Premium Method If the number in the group, n, is large, then the average provides a good approximation of the expected loss \\[ \\small{ \\mathrm{E}(X) \\approx \\frac{\\sum_{i=1}^n X_i}{n} = \\frac{\\text{Loss}}{\\text{Exposure}} = \\text{Pure Premium}. } \\] With this as motivation, we define the pure premium to be the sum of losses divided by the exposure; it is also known as a loss cost. In the case of homogeneous risks, all policies are treated the same and we can use the number of policies n for the exposure. In Section 7.4.1 we extend the concept of exposure when policies are not the same. We can multiply and divide by the number of claims, claim count, to get \\[ \\small{ \\text{Pure Premium} = \\frac{\\text{claim count}}{\\text{Exposure}} \\times \\frac{\\text{Loss}}{\\text{claim count}} = \\text{frequency} \\times \\text{severity} . } \\] So, when premiums are determined using the pure premium method, we either take the average loss (loss cost) or use the frequency severity approach. To get a bit closer to applications in practice, we now return to equation (7.1) that includes expenses. Equation (7.1) also refers to UW Profit for underwriting profit. When rescaled by premiums, this is known as the profit loading. Because claims are uncertain, the insurer must hold capital to ensure that all claims are paid. Holding this extra capital is a cost of doing business, investors in the company need to be compensated for this, thus the extra loading. We now decompose Expenses into those that vary by premium, Variable, and those that do not, Fixed so that Expenses = Variable + Fixed. Thinking of variable expenses and profit as a fraction of premiums, we define \\[ \\small{ V = \\frac{\\text{Variable}}{\\text{Premium}} ~~~ \\text{and}~~~ Q = \\frac{\\text{UW Profit}}{\\text{Premium}} ~. } \\] With these definitions and equation (7.1), we may write \\[ \\small{ \\begin{matrix} \\begin{array}{ll} \\text{Premium} &amp;= \\text{Losses + Fixed} + \\text{Premium} \\times \\frac{\\text{Variable + UW Profit}}{\\text{Premium}} \\\\ &amp; = \\text{Losses + Fixed} + \\text{Premium} \\times (V+Q) . \\end{array} \\end{matrix} } \\] Solving for premiums yields \\[\\begin{equation} \\small{ \\text{Premium} = \\frac{\\text{Losses + Fixed}}{1-V-Q} . } \\tag{7.2} \\end{equation}\\] Dividing by exposure, the rate can be calculated as \\[ \\begin{matrix} \\begin{array}{ll} \\text{Rate} &amp;= \\frac{\\text{Premium}}{\\text{Exposure}} = \\frac{\\text{Losses/Exposure + Fixed/Exposure}}{1-V-Q} \\\\ &amp;= \\frac{\\text{Pure Premium + Fixed/Exposure}}{1-V-Q} ~. \\end{array} \\end{matrix} \\] In words, this is \\[ \\small{ \\text{Rate} =\\frac{\\text{pure premium + fixed expense per exposure}}{\\text{1 - variable expense factor - profit and contingencies factor}} . } \\] Example. CAS Exam 5, 2004, Number 13. Determine the indicated rate per exposure unit, given the following information: Frequency per exposure unit = 0.25 Severity = $100 Fixed expense per exposure unit = $10 Variable expense factor = 20% Profit and contingencies factor = 5% Show Example Solution Solution. Under the pure premium method, the indicated rate is \\[ \\begin{matrix} \\begin{array}{ll} \\text{Rate} &amp;= \\frac{\\text{pure premium + fixed expense per exposure}}{\\text{1 - variable expense factor - profit and contingencies factor}}\\\\ &amp;= \\frac{\\text{frequency} \\times \\text{severity} ~+~10}{1-0.20-0.05} = \\frac{0.25 \\times 100 +10}{1-0.20-0.05} = 46.67 . \\end{array} \\end{matrix} \\] From the example, note that the rates produced by the pure premium method are commonly known as indicated rates. From our development, note also that the profit is associated with underwriting aspect of the contract and not investments. Premiums are typically paid at the beginning of a contract and insurers receive investment income from holding this money. However, due in part to the short-term nature of the contracts, investment income is typically ignored in pricing. This builds a bit of conservatism into the process that insurers welcome. It is probably most relevant in the very long “tail” lines such as workers’ compensation and medical malpractice. In these lines, it can sometimes take 20 years or even longer to settle claims. But, these are also the most volatile lines; claim payments far in the future are less extreme when viewed in discounted sense. 7.2.2 Loss Ratio Method The loss ratio is the ratio of the sum of losses to the premium \\[ \\small{ \\text{Loss Ratio} = \\frac{\\text{Loss}}{\\text{Premium}} . } \\] When determining premiums, it is a bit counter-intuitive to emphasize this ratio because the premium component is built into the denominator. As we will see, the idea is that the loss ratio method develops rate changes rather than rates; we can use rate changes to update past experience to get a current rate. To do this, rate changes consist of the ratio of the experience loss ratio to the target loss ratio. This adjustment factor is then applied to current rates to get new indicated rates. To see how this works in a simple context, let us return to equation (7.1) but now ignore expenses to get \\(\\small{\\text{Premium = Losses + UW Profit}}\\). Dividing by premiums yields \\[ \\small{ \\frac{\\text{UW Profit}}{\\text{Premium}} = 1 - LR = 1 - \\frac{\\text{Loss}}{\\text{Premium}} . } \\] Suppose that we have in mind a new “target” profit loading, say \\(Q_{target}\\). Assuming that losses, exposure, and other things about the contract stay the same, then to achieve the new target profit loading we adjust the premium. Use the ICF for the indicated change factor that is defined through the expression \\[ \\small{ \\frac{\\text{new UW Profit}}{\\text{Premium}} = Q_{target} = 1 - \\frac{\\text{Loss}}{ICF \\times \\text{Premium}}. } \\] Solving for ICF, we get \\[ \\small{ ICF = \\frac{\\text{Loss}}{\\text{Premium} \\times (1-Q_{target})} = \\frac{LR}{1-Q_{target}}. } \\] So, for example, if we have a current loss ratio = 85% and a target profit loading \\(\\small{Q_{target}=0.20}\\), then \\(\\small{ICF = 0.85/0.80 = 1.0625}\\), meaning that we increase premiums by 6.25%. Now let’s see how this works with expenses in equation (7.1). We can use the same development as in Section 7.2.1 and so start with equation (7.2), solve for the profit loading to get \\[ \\small{ Q = 1 - \\frac{\\text{Loss+Fixed}}{\\text{Premium}} - V . } \\] We interpret the quantity Fixed /Premium + V as the “operating expense ratio.” Now, fix the profit percentage Q at a target and adjust premiums through the “indicated change factor” \\(ICF\\) \\[ \\small{ Q_{target} = 1 -\\frac{\\text{Loss + Fixed}}{\\text{Premium}\\times ICF} - V . } \\] Solving for \\(ICF\\) yields \\[\\begin{equation} \\small{ ICF = \\frac{\\text{Loss + Fixed}}{\\text{Premium} \\times (1 - V - Q_{target})} . } \\tag{7.3} \\end{equation}\\] Example. Loss Ratio Indicated Change Factor. Assume the following information: Projected ultimate loss and LAE ratio = 65% Projected fixed expense ratio = 6.5% Variable expense = 25% Target UW profit = 10% With these assumptions, with equation (7.3), the indicated change factor can be calculated as \\[ \\small{ ICF = \\frac{\\text{(Losses + Fixed)}/\\text{Premium}}{ 1 - V - Q_{target}} = \\frac{0.65 + 0.065}{1- 0.25 - 0.10} = 1.10 . } \\] This means that overall average rate level should be increased by 10%. We later provide a comparison of the pure premium and loss ratio methods in Section 7.5.3. As inputs, this section will require discussions of trended exposures and on-level premiums defined in Section 7.5. 7.3 Pricing Principles In this section, you learn how to: Describe common actuarial pricing principles Describe properties of pricing principles Choose a pricing principle based on a desired property Approaches to pricing vary by the type of contract. For example, personal automobile is common (it is known as part of the retail general insurance market in the United Kingdom). Here, one can expect to do pricing based on a large pool of independent contracts, a situation in which expectations of losses provide an excellent starting point. In contrast, an actuary may wish to price an insurance contract issued to a large employer that covers complex health benefits for thousands of employees. In this example, knowledge of the entire distribution of potential losses, not just the expected value, is critical for starting the pricing negotiations. To cover a range of potential applications, this section describes general premium principles and their properties that one can use to decide whether or not a specific principle is applicable in a given situation. 7.3.1 Premium Principles This chapter introduces traditional actuarial pricing principles that provide a price based only on the insurance loss distribution; the price does not depend on the demand for insurance or other aspects of the costs such as expenses. Assume that the loss \\(X\\) has a distribution function \\(F(\\cdot)\\) and that there exists some functional \\(H\\) that takes \\(F(\\cdot)\\) into the positive real line, denoted as \\(P = H(F)\\). For notation purposes, it is often convenient to substitute the random variable \\(X\\) for its distribution function and write \\(P = H(X)\\). Table 7.1 provides several examples. Table 7.1: Common Premium Principles Description Definition (\\(H(X)\\)) Net (pure) premium \\(E[X]\\) Expected value \\((1+\\alpha)E[X]\\) Standard deviation \\(E[X]+\\alpha ~SD(X)\\) Variance \\(E[X]+\\alpha ~Var(X)\\) Zero utility solution of \\(u(w) = E ~u(w + P - X)\\) Exponential \\(\\frac{1}{\\alpha} \\ln E ~e^{\\alpha X}\\) A premium principle is similar to a risk measure that is introduced in Section 10.3. Mathematically, both are functions that maps the loss rv of interest to a numerical value. From a practical viewpoint, a premium principle provides a guide as to how much an insurer will charge for accepting a risk \\(X\\). In contrast, a risk measure quantifies the level of uncertainty, or riskiness, that an insurer can use to decide on a capital level to be assured of remaining solvent. As noted above, the net, or pure, premium essentially assumes no uncertainty. The expected value, standard deviation, and variance principles each add an explicit loading for riskiness through parameter \\(\\alpha \\ge 0\\). For the principle of zero utility, we think of an insurer with utility function \\(u(\\cdot)\\) and wealth w as being indifferent to accepting and not accepting risk \\(X\\). In this case, \\(P\\) is known as an indifference price or, in economics, a reservation price. With exponential utilility, the principle of zero utility reduces to the exponential premium principle, that is, assuming \\(u(x) = (1-e^{-\\alpha x})/\\alpha\\). For small values of risk parameters, the variance principle is approximately equal to exponential premium principle, as illustrated in the following special case. Special Case: Gamma Distribution. Consider a loss that is gamma distributed with parameters \\(\\alpha\\) and \\(\\theta\\). From the Appendix D in 17, the mean is \\(\\alpha \\theta\\) and the variance is \\(\\alpha \\theta^2\\). Using \\(\\alpha_{Var}\\) for the risk parameter, the variance premium is \\(H_{Var}(X) = \\alpha \\theta+\\alpha_{Var} ~(\\alpha \\theta^2)\\). From this appendix, it is straightforward to derive the well-known moment generating function, \\(M(t) = E e^{tX} = (1-t\\theta)^{-\\alpha}\\). With this and a risk parameter \\(\\alpha_{Exp}\\), we may express the exponential premium as \\[ H_{Exp}(X) = \\frac{-\\alpha}{\\alpha_{Exp}} \\ln\\left(1-\\alpha_{Exp} \\theta\\right). \\] To see the relationship between \\(H_{Var}(X)\\) and \\(H_{Var}(X)\\), we choose \\(\\alpha_{Exp} = 2 \\alpha_{Var}\\). With an approximation from calculus (\\(\\ln(1-x) = -x - x^2/2 - x^3/3 - \\cdots\\)), we write \\[ H_{Exp}(X) = \\frac{-\\alpha}{\\alpha_{Exp}} \\ln\\left(1-\\alpha_{Exp} \\theta\\right) = \\frac{-\\alpha}{\\alpha_{Exp}} \\left\\{ -\\alpha_{Exp} \\theta -(\\alpha_{Exp} \\theta)^2/2 - \\cdots\\right\\} \\\\ \\approx \\alpha \\theta + \\frac{\\alpha_{Exp}}{2}(\\alpha \\theta^2 ) = H_{Var}(X). \\] 7.3.2 Properties of Premium Principles Properties of premium principles help guide the selection of a premium principle in applications. Table 7.2 provides examples of properties of premium principles. Table 7.2: Common Properties of Premium Principles Description Definition Nonnegative loading \\(H(X) \\ge E[X]\\) Additivity \\(H(X_1+X_2) = H(X_1) + H(X_2)\\), for independent \\(X_1, X_2\\) Scale invariance \\(H(cX) = c H(X)\\), for \\(c \\ge 0\\) Consistency \\(H(c+X) = c + H(X)\\) No rip-off \\(H(X) \\le max ~range ~\\{X\\}\\) This is simply a subset of the many properties quoted in the actuarial literature. For example, the review paper of Young (2014) lists 15 properties. See also the properties described as coherent axioms that we introduce for risk measures in Section 10.3. Some of the properties listed in Table 7.2 are mild in the sense that they will nearly always be satisfied. For example, the no rip-off property indicates that the premium charge will be smaller than the maximal value of the loss \\(X\\). Other properties may not be so mild. For example, for a portfolio of independent risks, the actuary may want the additivity property to hold. It is easy to see that this property holds for the expected value, variance, and exponential premium principles but not for the standard deviation principle. Another example is the consistency property that does not hold for the expected value principle when the risk loading parameter \\(\\alpha\\) is positive. The scale invariance principle is known as homogeneity of degree one in economics. It allows, for example, us to work in different currencies (e.g., from dollars to Euros) as well as a host of other applications and will be discussed further in the following Section 7.4. Although a generally accepted principle, we note that this principle does not hold for a large values of \\(X\\) that may border on a surplus constraint of an insurer; if an insurer has a large probability of becoming insolvent, then that insurer may not wish to use linear pricing. It is easy to check that this principle holds for the expected value and standard deviation principles, although not for the variance and exponential principles. 7.4 Heterogeneous Risks In this section, you learn how to: Describe insurance exposures in terms of scale distributions Explain an exposure in terms of common types of insurance such as auto and homeowners insurance Describe how rating factors can be used to account for the heterogeneity among risks in a collection Measure the impact of a rating factor through relativities As noted in Section 7.1, there are many variations in the risks being insured, the features of the contracts, and the people being insured. As an example, you might have a twin brother or sister who works in the same town and earns a roughly similar amount of money. Still, when it comes to selecting choices in rental insurance to insure contents of your apartment, you can imagine differences in the amount of contents to be insured, choices of deductibles for the amount of risk retained, and perhaps different levels of uncertainty given the relative safety of your neighborhoods. People, and risks that they insure, are different. When thinking about a collection of different, or heterogeneous, risks, one option is to price all risks the same. This is common, for example, in government sponsored programs for flood or health insurance. However, it is also common to have different prices where the differences are commensurate with the risk being insured. 7.4.1 Exposure to Risk One easy way to make heterogeneous risks comparable is through the concept of an exposure. To explain exposures, let us use scale distributions that we learned about in Chapter 3. To recall a scale distribution, suppose that \\(X\\) has a parametric distribution and define a rescaled version \\(R = X/E\\), \\(E &gt; 0\\). If \\(R\\) is in the same parametric family as \\(X\\), then the distribution is said to be a scale distribution. As we have seen, the gamma, exponential, and Pareto distributions are examples of scale distributions. Intuitively, the idea behind exposures is to make risks more comparable to one another. For example, it may be that risks \\(X_1, \\ldots, X_n\\) come from different distributions and yet, with the choice of the right exposures, the rates \\(R_1, \\ldots, R_n\\) come from the same distribution. Here, we interpret the rate \\(R_i = X_i/E_i\\) to be the loss divided by exposure. Table 7.3 provides a few examples. We remark that this table refers to “earned” car and house years, concepts that will be explained in Section 7.5. \\[ \\small{ \\begin{matrix} \\begin{array}{ll} \\text{Type of Insurance} &amp; \\text{Exposure Basis} \\\\\\hline \\text{Personal Automobile} &amp; \\text{Earned Car Year, Amount of Insurance Coverage} \\\\ \\text{Homeowners} &amp; \\text{Earned House Year, Amount of Insurance Coverage}\\\\ \\text{Workers Compensation} &amp; \\text{Payroll}\\\\ \\text{Commercial General Liability} &amp; \\text{Sales Revenue, Payroll, Square Footage, Number of Units}\\\\ \\text{Commercial Business Property} &amp; \\text{Amount of Insurance Coverage}\\\\ \\text{Physician&#39;s Professional Liability} &amp; \\text{Number of Physician Years}\\\\ \\text{Professional Liability} &amp; \\text{Number of Professionals (e.g., Lawyers or Accountants)}\\\\ \\text{Personal Articles Floater} &amp; \\text{Value of Item} \\\\ \\hline \\end{array} \\end{matrix} } \\] Table 7.3 : Commonly used Exposures in Different Types of Insurance An exposure is a type of rating factor, a concept that we define explicitly in the next Section 7.4.2. It is typically the most important rating factor, so important that both premiums and losses are quoted on a “per exposure” basis. For frequency and severity modeling, it is customary to think about the frequency aspect as proportional to exposure and the severity aspect in terms of loss per claim (not dependent upon exposure). However, this does not cover the entire story. For many lines of business, it is convenient for exposures to be proportional to inflation. Inflation is typically viewed as unrelated to frequency but proportional to severity. Criteria for Choosing an Exposure An exposure base should meet the following criteria. It should: be an accurate measure of the quantitative exposure to loss be easy for the insurer to determine (at the time the policy is calculated) and not subject to manipulation by the insured, be easy to understand by the insured and to calculate by the insurer, consider any preexisting exposure base established within the industry, and for some lines of business, it is proportional to inflation. In this way, rates are not sensitive to the changing value of money over time as these changes are captured in exposure base. To illustrate, consider personal automobile coverage. Instead of the exposure basis “earned car year,” a more accurate measure of the quantitative exposure to loss might be number of miles driven. However, this measure is difficult to determine at the time the policy is issued and subject to potential manipulation by the insured. As another example, the exposure measure in commercial business property, e.g. fire insurance, is typically the amount of insurance coverage. As property values grow with inflation, so will the amount of insurance coverage. Thus, rates quoted on a per amount of insurance coverage are less sensitive to inflation than otherwise. 7.4.2 Rating Factors A rating factor, or rating variable, is simply a characteristic of the policyholder or risk being insured by which rates vary. For example, when you purchase auto insurance, it is likely that the insurer has rates that differ by age, gender, type of car and where it is garaged, accident history, and so forth. These variables are known as rating factors. Although some variables may be continuous, such as age, most are categorical - factor is a label that is used for categorical variables. In fact, even with continuous variables such as age, it is common to categorize them by creating groups such as “young,” “intermediate,” and “old” for rating purposes. Table 7.4 provides just a few examples. In many jurisdictions, the personal insurance market (e.g., auto and homeowners) is very competitive - using 10 or 20 variables for rating purposes is not uncommon. \\[ \\small{ \\begin{matrix} \\begin{array}{l|l}\\hline \\text{Type of Insurance} &amp; \\text{Rating Factors}\\\\\\hline\\hline \\text{Personal Automobile} &amp; \\text{Driver Age and Gender, Model Year, Accident History}\\\\ \\text{Homeowners} &amp; \\text{Amount of Insurance, Age of Home, Construction Type}\\\\ \\text{Workers Compensation} &amp; \\text{Occupation Class Code}\\\\ \\text{Commercial General Liability} &amp; \\text{Classification, Territory, Limit of Liability}\\\\ \\text{Medical Malpractice} &amp; \\text{Specialty, Territory, Limit of Liability}\\\\ \\text{Commercial Automobile} &amp; \\text{Driver Class, Territory, Limit of Liability}\\\\ \\hline \\end{array} \\end{matrix} } \\] Table 7.4 : Commonly used Rating Factors in Different Types of Insurance Example. Losses and Premium by Amount of Insurance and Territory. To illustrate, Table 7.5 presents a small fictitious data set from Werner and Modlin (2016). The data consists of loss and loss adjustment expenses (LossLAE), decomposed by three levels of AOI, amount of insurance, and three territories (Terr). For each combination of AOI and Terr, we also have available the number of policies issued, given as the Exposure. \\[ \\small{ \\begin{matrix} \\begin{array}{cc|rrr} \\hline AOI &amp; Terr &amp; Exposure &amp; LossLAE &amp; Premium \\\\\\hline \\text{Low} &amp; 1 &amp; 7 &amp; 210.93 &amp; 335.99 \\\\ \\text{Medium} &amp; 1 &amp; 108 &amp; 4,458.05 &amp; 6,479.87 \\\\ \\text{High} &amp; 1 &amp; 179 &amp; 10,565.98 &amp; 14,498.71 \\\\\\hline \\text{Low} &amp; 2 &amp; 130 &amp; 6,206.12 &amp; 10,399.79 \\\\ \\text{Medium} &amp; 2 &amp; 126 &amp; 8,239.95 &amp; 12,599.75 \\\\ \\text{High} &amp; 2 &amp; 129 &amp; 12,063.68 &amp; 17,414.65 \\\\\\hline \\text{Low} &amp; 3 &amp; 143 &amp; 8,441.25 &amp; 14,871.70 \\\\ \\text{Medium} &amp; 3 &amp; 126 &amp; 10,188.70 &amp; 16,379.68 \\\\ \\text{High} &amp; 3 &amp; 40 &amp; 4,625.34 &amp; 7,019.86 \\\\ \\hline \\text{Total} &amp; &amp; 988 &amp; 65,000.00 &amp; 99,664.01 \\\\\\hline \\hline \\end{array} \\end{matrix} } \\] Table 7.5 : Losses and Premium by Amount of Insurance and Territory In this case, the rating factors AOI and Terr produce nine cells. Note that one might combine the cell “territory one with a low amount of insurance”\" with another cell because there are only 7 policies in that cell. Doing so is perfectly acceptable - considerations of this sort is one of the main jobs of the analyst. An outline on selecting variables is in Chapter 8, including Technical Supplement TS 8.B. Alternatively, you can also think about reinforcing information about the cell (Terr 1, Low AOI) by “borrowing” information from neighboring cells (e.g., other territories with the same AOI, or other amounts of AOI within Terr 1). This is the subject of credibility that is introduced in Chapter 9. To understand the impact of rating factors, it is common to use relativities. A relativity is the difference of the expected risk between a specific level of a rating factor and an accepted baseline value. In this book, we work with relativities defined through ratios; it is also possible to define relativities through arithmetic differences. Thus, our relativity is defined as \\[ \\text{Relativity}_j = \\frac{\\text{(Loss/Exposure)}_j}{\\text{(Loss/Exposure)}_{Base}} . \\] Example. Losses and Premium by Amount of Insurance and Territory - Continued. Traditional classification methods consider only one classification variable at a time - they are univariate. Thus, if we wanted relativities losses and expenses (LossLAE) by amount of insurance, we might sum over territories to get the information displayed in Table 7.6. \\[ \\small{ \\begin{matrix} \\begin{array}{c|rrrr} \\hline AOI &amp; Exposure &amp; LossLAE &amp; Loss/Exp &amp;Relativity \\\\\\hline \\text{Low} &amp; 280 &amp; 14858.3 &amp; 53.065 &amp;0.835 \\\\ \\text{Medium} &amp; 360 &amp; 22886.7 &amp; 63.574 &amp;1.000 \\\\ \\text{High} &amp; 348 &amp; 27255.0 &amp; 78.319 &amp; 1.232 \\\\\\hline \\text{Total} &amp; 988 &amp; 65,000.0 &amp; \\\\\\hline \\hline \\end{array} \\end{matrix} } \\] Table 7.6 : Losses and Relativities by Amount of Insurance Thus, for example, losses and expenses per unit of exposure are 23.2% higher for risks with a high amount of insurance compared to those with a medium amount. These relativities do not control for territory. The introduction of rating factors allows the analyst to create cells that define small collections of risks – the goal is to choose the right combination of rating factors so that all risks within a cell may be treated the same. In statistical terminology, we want all risks within a cell to have the same distribution (subject to rescaling by an exposure variable). This is the foundation of insurance pricing. All risks within a cell have the same price yet risks from different cells may have different prices. Said another way, insurers are allowed to charge different rates for different risks; discrimination of risks is legal and routinely done. Nonetheless, the basis of discrimination, the choice of risk factors, is the subject of extensive debate. The actuarial community, insurance management, regulators, and consumer advocates are all active participants in this debate. Technical Supplement TS 7.A describes these issues from a regulatory perspective. In addition to statistical criteria for assessing the significance of a rating factor, analysts much pay attention to business concerns of the company (e.g., is it expensive to implement a rating factor?), social criteria (is a variable under the control of a policyholder?), legal criteria (are there regulations that prohibit the use of a rating factor such as gender?), and other societal issues. These questions are largely beyond the scope of this text. Nonetheless, because they are so fundamental to pricing of insurance, a brief overview is given in Chapter 8, including Technical Supplement TS 8.B. 7.5 Development and Trending In this section, you learn how to: Define and calculate different types of exposure and premium summary measures that appear in financial reports Describe the development of a claim over several payments and link that to various unpaid claim measures, including those incurred but not reported (IBNR) as well as case reserves Compare and contrast relative strengths and weaknesses of the pure premium and loss ratio methods for ratemaking As we have seen in Section 7.2, insurers consider aggregate information for ratemaking such as exposures to risk, premiums, expenses, claims, and payments. This aggregate information is also useful for managing an insurers’ activities; financial reports are commonly created at least annually and oftentimes quarterly. At any given financial reporting date, information about recent policies and claims will be ongoing and necessarily incomplete; this section introduces concepts for projecting risk information so that it is usful for ratemaking purposes. Information about the risks, such as exposures, premium, claim counts, losses, and rating factors, is typically organized into three databases: policy database - contains information about the risk being insured, the policyholder, and the contract provisions claims database - contains information about each claim; these are linked to the policy database. payment database - contains information on each claims transaction, typically payments but may also changes to case reserves. These are linked to the claims database. With these detailed databases, it is straightforward (in principle) to sum up policy level detail to aggregate information needed for financial reports. This section describes various summary measures commonly used. 7.5.1 Exposures and Premiums A financial reporting period is a length of time that is fixed in the calendar; we use January 1 to December 31 for the examples in this book although other reporting periods are also common. The reporting period is fixed but policies may begin at any time during the year. Even if all policies have a common contract length of (say) one year, because of the differing starting time, they can end at any time during the financial reporting. Figure 7.1 presents four illustrative policies. Because of these differing starting and end times, there needs to be some standards as to what types of measures are most useful for summarizing experience in a given reporting period. Figure 7.1: Timeline of Exposures for Four 12-Month Policies. Some commonly used exposure measures are: written exposures, the amount of exposures on policies issued (underwritten or written) during the period in question, earned exposures, the exposure units actually exposed to loss during the period, that is, where coverage has already been provided unearned exposures, represent the portion of the written exposures for which coverage has not yet been provided as of that point in time, and in force exposures, exposure units exposed to loss at a given point in time. Table 7.12 gives detailed illustrative calculations for the four illustrative policies. \\[ \\small{ \\begin{matrix} \\begin{array}{cl|cc|cc|cc|c} \\hline &amp; &amp; &amp; &amp; &amp; &amp; &amp;&amp;\\text{In-Force} \\\\ &amp;\\text{Effective} &amp; \\text{Written}&amp; \\text{Exposure} &amp; \\text{Earned} &amp;\\text{Exposure}&amp; \\text{Unearned} &amp;\\text{Exposure}&amp; \\text{Exposure} \\\\ {Policy} &amp;\\text{Date} &amp; 2019 &amp; 2020 &amp; 2019 &amp; 2020 &amp; 2019 &amp; 2020 &amp; \\text{1 Jan 2020} \\\\ \\hline \\text{A}&amp;\\text{1 Jan 2019} &amp; 1.00 &amp; 0.00 &amp; 1.00 &amp; 0.00&amp; 0.00 &amp; 0.00 &amp; 0.00 \\\\ \\text{B}&amp;\\text{1 April 2019} &amp; 1.00 &amp; 0.00 &amp; 0.75 &amp; 0.25 &amp; 0.25 &amp; 0.00&amp; 1.00 \\\\ \\text{C}&amp;\\text{1 July 2019} &amp; 1.00 &amp; 0.00 &amp; 0.50 &amp; 0.50 &amp; 0.50 &amp; 0.00&amp; 1.00 \\\\ \\text{D}&amp;\\text{1 Oct 2019} &amp; 1.00 &amp; 0.00 &amp; 0.25 &amp; 0.75 &amp; 0.75 &amp; 0.00&amp; 1.00 \\\\ \\hline &amp; Total &amp; 4.00 &amp; 0.00 &amp; 2.50 &amp; 1.50 &amp; 1.50 &amp; 0.00 &amp; 3.00 \\\\ \\hline \\hline \\end{array} \\end{matrix} } \\] Table 7.12: Exposures for Four 12-Month Policies This summarization is sometimes known as the calendar year method of aggregation to serve as a contrast to the policy year method. In the latter method, all policies start at the beginning of the year. This method is useful for ratemaking methods based on individual contracts and we do not pursue this further here. In the same way as exposures, one can summarizes premiums. Premiums, like exposures, can be either written, earned, unearned, or in force. Consider the following example. Example. 7.5.1. CAS Exam 5, 2003, Number 10. A 12-month policy is written on March 1, 2002 for a premium of $900. As of December 31, 2002, which of the following is true? \\[ \\small{ \\begin{matrix} \\begin{array}{l|ccc} \\hline &amp; \\text{Calendar Year} &amp; \\text{Calendar Year} \\\\ &amp; \\text{2002 Written} &amp; \\text{2002 Earned} &amp; \\text{Inforce} \\\\ &amp; \\text{Premium} &amp; \\text{Premium} &amp; \\text{Premium} \\\\\\hline A. &amp; 900 &amp; 900 &amp; 900 \\\\ B. &amp; 750 &amp; 750 &amp; 900 \\\\ C. &amp; 900 &amp; 750 &amp; 750 \\\\ D. &amp; 750 &amp; 750 &amp; 750 \\\\ E. &amp; 900 &amp; 750 &amp; 900 \\\\\\hline \\end{array} \\end{matrix} } \\] Show Example Solution Only earned premium differs from written premium and inforce premium and therefore needs to be computed. Thus, earned premium at Dec 31, 2002, equals \\(\\$900 \\times 10/12 = \\$750\\). Answer E. 7.5.2 Losses, Claims, and Payments Broadly speaking, the terms loss and claim refer to the amount of compensation paid or potentially payable to the claimant under the terms of the insurance policy. Definitions can vary: Sometimes, the term claim is used interchangeably with the term loss. In some insurance and actuarial sources, the term loss is used for the amount of damage sustained in an insured event. The claim is the amount paid by the insurer with differences typically due to deductibles, upper policy limits, and the like. In economic usages, a claim is a demand for payment by an insured or by an injured third-party under the terms and conditions of insurance contract and the loss is the amount paid by the insurer. This text will follow the second bullet. However, when reading other sources, you will need to take care when thinking about definitions for the terms loss and claim. To establish additional terminology, it is helpful to follow the timeline of a claim as it develops. In Figure 7.2, the claim occurs at time \\(t_1\\) and the insuring company is notified at time \\(t_3\\). There can be a long gap between occurrence and notification such that the end of a company financial reporting period, known as a valuation date, occurs (\\(t_2\\)). In this case, the claim is said to be incurred but not reported at this valuation date. After claim notification, there may one or more loss payments. Not all of the payments may be made by the next valuation date (\\(t_4\\)). As the claim develops, eventually the company deems its financial obligations on the claim to be resolved and declares the claim closed. However, it is possible that new facts arise and the claim must be re-opened, giving rise to additional loss payments prior to being closed again. Figure 7.2: Timeline of Claim Development. Accident date - the date of the occurrence which gave rise to the claim. This is also known as the date of loss or the occurrence date. Report date - the date the insurer receives notice of the claim. Claims not currently known by the insurer are referred to as unreported claims or incurred but not reported (IBNR) claims. Until the claim is settled, the reported claim is considered an open claim. Once the claim is settled, it is categorized as a closed claim. In some instances, further activity may occur after the claim is closed, and the claim may be re-opened. Recall that a loss is the amount paid or payable to claimants under the terms of insurance policies. Further, we have Paid losses are those losses for a particular period that have actually been paid to claimants. Where there is an expectation that payment will be made in the future, a claim will have an associated case reserve representing the estimated amount of that payment. Reported Losses, also known as case incurred, is Paid Losses + Case Reserves The ultimate loss is the amount of money required to close and settle all claims for a defined group of policies. 7.5.3 Comparing Pure Premium and Loss Ratio Methods Now that we have learned how exposures, premiums, and claims develop over time, we can consider how they can be used for ratemaking. We have seen that insurers offer many different types of policies that cover different policyholders and amounts of risks. This aggregation is sometimes loosely referred to as the mix of business. Importantly, the mix changes over time as policyholders come and go, amounts of risks change, and so forth. The exposures, premiums, and types of risks from a prior financial reporting may not be representative of the period that rates are being developed for. The process of extrapolating exposures, premiums, and risk types is known as trending. For example, an on-level earned premium is that earned premium that would have resulted for the experience period had the current rates been in effect for the entire period. Most trending methods used in practice are mathematically straight-forward although they can become complicated given contractual and administrative complexities. We refer the reader to standard references that describe approaches in detail such as Werner and Modlin (2016) and Friedland (2013). Loss Ratio Method The expression for the loss ratio method indicated change factor in equation (7.3) assumes a certain amount of consistency in the portfolio experience over time. For another approach, we can define the experience loss ratio to be: \\[ \\small{ LR_{experience} = \\frac{\\text{experience losses}}{\\text{experience period earned exposure}\\times \\text{current rate}} . } \\] Here, we think of the experience period earned exposure \\(\\times\\) current rate as the experience premium. Using equation (7.2), we can write a loss ratio as \\[ \\small{ LR = \\frac{\\text{Losses}}{\\text{Premium}}=\\frac{1-V-Q}{\\text{(Losses + Fixed)}/\\text{Losses}}=\\frac{1-V-Q}{1+G} ~, } \\] where \\(G = \\text{Fixed} / \\text{Losses}\\), the ratio of fixed expenses to premiums. With this expression, we define the target loss ratio \\[ \\small{ LR_{target} = \\frac{1-V-Q}{1+G} = \\frac{1-\\text{premium related expense factor - profit and contingencies factor}} {1+\\text{ratio of non-premium related expenses to losses}} . } \\] With these, the indicated change factor is \\[\\begin{equation} \\small{ ICF =\\frac{LR_{experience}}{LR_{target}}. } \\tag{7.4} \\end{equation}\\] Comparing equation (7.3) to (7.4), we see that the latter offers more flexibility to explicitly incorporate trended experience. As the loss ratio method is based on rate changes, this flexibility is certainly warranted. Comparison of Methods Assuming that exposures, premiums, and claims have been trended to be representative of a period that rates are being developed for, we are now in a position to compare the pure premium and loss ratio methods for ratemaking. We start with the observation that for the same data inputs, these two approaches produce the same results. That is, they are algebraically equivalent. However, the rely on different inputs: \\[ \\small{ \\begin{array}{l|l}\\hline \\text{Pure Premium Method} &amp; \\text{Loss Ratio Method} \\\\ \\hline \\text{Based on exposures} &amp; \\text{Based on premiums} \\\\ \\text{Does not require existing rates} &amp; \\text{Requires existing rates} \\\\ \\text{Does not use on-level premiums} &amp; \\text{Uses on-level premiums} \\\\ \\text{Produces indicated rates} &amp; \\text{Produces indicated rate changes} \\\\ \\hline \\end{array} } \\] Comparing the pure premium and loss ratio methods, we note that: The pure premium method requires well-defined, responsive exposures. The loss ratio method cannot be used for new business because it produces indicated rate changes. The pure premium method is preferable where on-level premium is difficult to calculate. In some instances, such as commercial lines where individual risk rating adjustments are made to individual policies, it is difficult to determine the on-level earned premium required for the loss ratio method. In many developed countries like the US where lines of business have been in existence, the loss ratio approach is more popular. Example. 7.5.2. CAS Exam 5, 2006, Number 36. You are given the following information: Experience period on-level earned premium = $500,000 Experience period trended and developed losses = $300,000 Experience period earned exposure = 10,000 Premium-related expenses factor = 23% Non-premium related expenses = $21,000 Profit and contingency factor = 5% Calculate the indicated rate level change using the loss ratio method. Calculate the indicated rate level change using the pure premium method. Describe one situation in which it is preferable to use the loss ratio method, and one situation in which it is preferable to use the pure premium method. Show Example Solution We will calculate the experience and target loss ratios, then take the ratio to get the indicated rate change. The experience loss ratio is \\[ \\small{ LR_{experience} = \\frac{\\text{experience losses}}{\\text{experience period premium}} =\\frac{300000}{500000} = 0.60. } \\] The target loss ratio is: \\[ \\small{ \\begin{matrix} \\begin{array}{ll} LR_{target} &amp;= \\frac{1-V-Q}{1+G} = \\frac{1-\\text{premium related expense factor - profit and contingencies factor}} {1+\\text{ratio of non-premium related expenses to losses}}\\\\ &amp;= \\frac{1-0.23 - 0.05}{1+0.07} = 0.673 . \\end{array} \\end{matrix} } \\] Here, the ratio of non-premium related expenses to losses is \\(G = \\frac{21000}{300000} = 0.07\\). Thus, the (new) indicated rate level change is \\[ \\small{ ICF =\\frac{LR_{experience}}{LR_{target}} -1 = \\frac{0.60}{0.673} -1 = -10.8\\%. } \\] (b) Using the pure premium method, the indicated change factor, \\(ICF\\), is \\[ \\small{ \\begin{matrix} \\begin{array}{ll} ICF &amp;= \\frac{\\text{Losses + Fixed}}{\\text{Premium} \\times (1 - Q - V)}\\\\ &amp;= \\frac{300000+ 21000}{500000 \\times (1 - 0.23 - 0.05)} = 0.892 . \\end{array} \\end{matrix} } \\] Thus, the indicated rate level change is \\(0.892 -1 = -10.8\\%\\). The loss ratio method is preferable when the exposure unit is not available. The loss ratio method is preferable when the exposure unit is not reasonably consistent between risks. The pure premium method is preferable for a new line of business. The pure premium method is preferable where on-level premiums are difficult to calculate. 7.6 Selecting a Premium In this section, you learn how to: Describe skewed distributions via a Lorenz curve and Gini index Define a concentration curve and the corresponding Gini statistic Use the concentration curve and Gini statistic for premium selection base on out-of-sample validation For a portfolio of insurance contracts, insurers collect premiums and pay out losses. After making adjustments for expenses and profit considerations, tools for comparing distributions of premiums and losses can be helpful when selecting a premium calculation principle. 7.6.1 Classic Lorenz Curve In welfare economics, it is common to compare distributions via the Lorenz curve, developed by Max Otto Lorenz (Lorenz 1905). A Lorenz curve is a graph of the proportion of a population on the horizontal axis and a distribution function of interest on the vertical axis. It is typically used to represent income distributions. When the income distribution is perfectly aligned with the population distribution, the Lorenz curve results in a 45 degree line that is known as the line of equality. Because the graph compares two distribution functions, one can also think of a Lorenz curve as a type of pp plot that was introduced in Section 4.1.2.1. The area between the Lorenz curve and the line of equality is a measure of the discrepancy between the income and population distributions. Two times this area is known as the Gini index, introduced by Corrado Gini in 1912. Example – Classic Lorenz Curve. For an insurance example, Figure 7.3 shows a distribution of insurance losses. This figure is based on a random sample of 2000 losses. The left-hand panel shows a right-skewed histogram of losses. The right-hand panel provides the corresponding Lorenz curve, showing again a skewed distribution. For example, the arrow marks the point where 60 percent of the policyholders have 30 percent of losses. The 45 degree line is the line of equality; if each policyholder has the same loss, then the loss distribution would be at this line. The Gini index, twice the area between the Lorenz curve and the 45 degree line, is 37.6 percent for this data set. Figure 7.3: Distribution of Insurance Losses. The left-hand panel is a density plot of losses. The right-hand panel presents the same data using a Lorenz curve. 7.6.2 Performance Curve and a Gini Statistic We now introduce a modification of the classic Lorenz curve and Gini statistic that is useful in insurance applications. Specifically, we introduce a performance curve that, in this case, is a graph of the distribution of losses versus premiums, where both losses and premiums are ordered by premiums. To make the ideas concrete, we provide some notation and consider \\(i=1, \\ldots, n\\) policies. For the \\(i\\)th policy, let \\(y_i\\) denote the insurance loss, \\(\\mathbf{x}_i\\) be a set of rating variables known to the analyst, and \\(P_i=P(\\mathbf{x}_i)\\) be the associated premium that is a function of \\(\\mathbf{x}_i\\). The set of information used to calculate the performance curve for the \\(i\\)th policy is \\((y_i, P_i)\\). Performance Curve It is convenient to first sort the set of policies based on premiums (from smallest to largest) and then compute the premium and loss distributions. The premium distribution is \\[\\begin{equation} \\hat{F}_P(s) = \\frac{ \\sum_{i=1}^n P_i ~\\mathrm{I}(P_i \\leq s) }{\\sum_{i=1}^n P_i} , \\tag{7.5} \\end{equation}\\] and the loss distribution is \\[\\begin{equation} \\hat{F}_{L}(s) = \\frac{ \\sum_{i=1}^n y_i ~\\mathrm{I}(P_i \\leq s) }{\\sum_{i=1}^n y_i} , \\tag{7.6} \\end{equation}\\] where \\(\\mathrm{I}(\\cdot)\\) is the indicator function, returning a 1 if the event is true and zero otherwise. For a given value \\(s\\), \\(\\hat{F}_P(s)\\) gives the proportion of premiums less than or equal to \\(s\\), and \\(\\hat{F}_{L}(s)\\) gives the proportion of losses for those policyholders with premiums less than or equal to \\(s\\). The graph \\(\\left(\\hat{F}_P(s),\\hat{F}_{L}(s) \\right)\\) is known as a performance curve. Example – Loss Distribution. Suppose we have \\(n=5\\) policyholders with experience as follows. The data have been ordered by premiums. Variable \\(i\\) 1 2 3 4 5 Premium \\(P(\\mathbf{x}_i)\\) 2 4 5 7 16 Cumulative Premiums \\(\\sum_{j=1}^i P(\\mathbf{x}_j)\\) 2 6 11 18 34 Loss \\(y_i\\) 2 5 6 6 17 Cumulative Loss \\(\\sum_{j=1}^i y_j\\) 2 7 13 19 36 Figure 7.4 compares the Lorenz to the performance curve. The left-hand panel shows the Lorenz curve. The horizontal axis is the cumulative proportion of policyholders (0, 0.2, 0.4, and so forth) and the vertical axis is the cumulative proportion of losses (0, 2/36, 7/36, and so forth). For the Lorenz curve, you first order by the loss size (which turns out to be the same order as premiums for this simple dataset). This figure shows a large separation between the distributions of losses and policyholders. The right-hand panel shows the performance curve. Because observations are sorted by premiums, the first point after the origin (reading from left to right) is (2/34, 2/36). The second point is (6/34, 7/36), with the pattern continuing. From the figure, we see that there is little separation between losses and premiums. Figure 7.4: Lorenz versus Performance Curve The performance curve can be helpful to the analyst who thinks about forming profitable portfolios for the insurer. For example, suppose that \\(s\\) is chosen to represent the 95th percentile of the premium distribution. Then, the horizontal axis, \\(\\hat{F}_P(s)\\), represents the fraction of premiums for this portfolio and the vertical axis, \\(\\hat{F}_L(s)\\), the fraction of losses for this portfolio. When developing premium principles, analysts wish to avoid unprofitable situations and make profits, or at least break even. The expectation of the numerator in equation (7.6) is \\(\\sum_{i=1}^n \\mathrm{E}~ y_i=\\sum_{i=1}^n \\mu_i\\). Thus, if the premium principle is chosen such that \\(P_i= \\mu_i\\), then we anticipate a close relation between the premium and loss distributions, resulting in a 45 degree line. The 45 degree line presents equality between losses and premiums, a break-even situation which is the benchmark for insurance pricing. Gini Statistic The classic Lorenz curve shows the proportion of policyholders on the horizontal axis and the loss distribution function on the vertical axis. The performance curve extends the classical Lorenz curve in two ways, (1) through the ordering of risks and prices by prices and (2) by allowing prices to vary by observation. We summarize the performance curve in the same way as the classic Lorenz curve using a Gini statistic, defined as twice the area between the curve and a 45 degree line. The analyst seeks ordered performance curves that approach passing through the 45 degree line; these have least separation between the loss and premium distributions and therefore small Gini statistics. Specifically, the Gini statistic can be calculated as follows. Suppose that the empirical performance curve is given by \\(\\{ (a_0=0, b_0=0), (a_1, b_1), \\ldots,\\) \\((a_n=1, b_n=1) \\}\\) for a sample of \\(n\\) observations. Here, we use \\(a_j = \\hat{F}_P(P_j)\\) and \\(b_j = \\hat{F}_{L}(P_j)\\). Then, the empirical Gini statistic is \\[\\begin{eqnarray} \\widehat{Gini} &amp;=&amp; 2\\sum_{j=0}^{n-1} (a_{j+1} - a_j) \\left \\{ \\frac{a_{j+1}+a_j}{2} - \\frac{b_{j+1}+b_j}{2} \\right\\} \\nonumber \\\\ &amp;=&amp; 1 - \\sum_{j=0}^{n-1} (a_{j+1} - a_j) (b_{j+1}+b_j) . \\tag{7.7} \\end{eqnarray}\\] Show Gini Formula Details To understand the formula for the Gini statistic, here is a sketch of a parallelogram connecting points \\((a_1, b_1)\\), \\((a_2, b_2)\\), and a 45 degree line. You can use basic geometry to check that the area of the figure is \\(Area = (a_2 - a_1) \\left \\{\\frac{a_2+a_1}{2} - \\frac{b_2+b_1}{2} \\right\\}\\). The definition of the Gini statistic in equation (7.7) is simply twice the sum of the parallelograms. The second equality in equation (7.7) is the result of some straight-forward algebra. Example – Loss Distribution: Continued. The Gini statistic for the Lorenz curve (left-hand panel of Figure 7.4) is 34.4 percent. In contrast, the Gini statistic for performance curve (right-hand panel) is 1.7 percent. 7.6.3 Out-of-Sample Validation The benefits of out-of-sample validation for model selection were introduced in Section 4.2. We now demonstrate the use of the a Gini statistic and performance curve in this context. The procedure follows: Use an in-sample data set to estimate several competing models, each producing a premium function. Designate an out-of-sample, or validation, data set of the form \\(\\{(y_i, \\mathbf{x}_i), i=1,\\ldots,n\\}\\). Use the explanatory variables from the validation sample to form premiums of the form \\(P(\\mathbf{x}_i)\\). Compute the Gini statistic for each model. Choose the model with the lowest Gini statistic. Example – Community Rating versus Premiums that Vary by State. Suppose that we have experience from 25 states and that, for each state, we have available 200 observations that can be used to predict future losses. For simplicity, assume that the analyst knows that these losses were generated by a gamma distribution with a common shape parameter equal to 5. Unknown to the analyst, the scale parameters vary by state, from a low of 20 to 66. To compute base premiums, the analyst assumes a scale parameter that is common to all states that is to be estimated from the data. You can think of this common premium as based on a community rating principle. As an alternative, the analyst allows the scale parameters to vary by state and will again use the data to estimate these parameters. An out of sample validation set of 100 losses from each state is available. For each of the two rating procedures, determine the performance curve and the corresponding Gini statistic. Choose the rate procedure with the lower Gini statistic. Show Example Solution Recall for the gamma distribution that the mean equals the shape times the scale or, 5 times the scale parameter, for our example. So, you can check that the maximum likelihood estimates are simply the average experience. For our base premium, we assume a common distribution among all states. For these simulated data, the average in-sample loss is \\(P_1\\)=221.36. As an alternative, we use averages that are state-specific; these averages form our premiums \\(P_2\\). Because this illustration uses means that vary by states, we anticipate this alternative rating procedure to be preferred to the community rating procedure. Out of sample claims were generated from the same gamma distribution as the in-sample model, with 100 observations for each state. The following R code shows how to calculate the performance curves. y &lt;- Outy P1 &lt;- Flatpred P2 &lt;- Predvec n1 = length(y) XYmat = data.frame(cbind(y,P1,P2)) XYmatPOrder = XYmat[order(P1),] # Sort by premiums P1 DFy1 = c(0,cumsum(XYmatPOrder$y)/sum(y)) DFx1 = c(0,cumsum(XYmatPOrder$P1)/sum(P1)) XYmatPOrder = XYmat[order(P2),] # Sort by premiums P2 DFy2 = c(0,cumsum(XYmatPOrder$y)/sum(y)) DFx2 = c(0,cumsum(XYmatPOrder$P2)/sum(P2)) # FIGURE 3 par(mfrow=c(1, 2)) # Lorenz Curve plot(DFx1,DFy1,xlim=c(0,1),ylim=c(0,1), type=&quot;b&quot;, cex= 0.2, xlab=&quot;Premium Distn&quot;,ylab=&quot;&quot;, main=&quot;Flat&quot;);abline(0,1) mtext(&quot;Loss Distn&quot;, side=2, line=-0.5, at=1.1, las=1, cex=1.0) # Performance Curve plot(DFx2,DFy2,xlim=c(0,1),ylim=c(0,1), type=&quot;b&quot;, cex= 0.2, xlab=&quot;Premium Distn&quot;,ylab=&quot;&quot;, main=&quot;State Specific&quot;);abline(0,1) mtext(&quot;Loss Distn&quot;, side=2, line=-0.5, at=1.1, las=1, cex=1.0) For these data, the Gini statistics are 19.6 percent for the flat rate premium and -0.702 percent for the state-specific alternative. This indicates that the state-specific alternative procedure is strongly preferred to the base community rating procedure. Discussion In insurance claims modeling, standard out-of-sample validation measures are not the most informative due to the high proportions of zeros (corresponding to no claim) and the skewed fat-tailed distribution of the positive values. In contrast, the Gini statistic works well with many zeros (see the demonstration in (Edward W. Frees, Meyers, and Cummings 2014)). The value of the performance curves and Gini statistics have been recently advanced in the paper of Denuit, Sznajder, and Trufin (2019). Properties of an extended version, dealing with relatives for new premiums, were developed by Frees, Meyers, and Cummings (2011) and Edward W. Frees, Meyers, and Cummings (2014). In these articles you can find formulas for the standard errors and additional background information. 7.7 Further Resources and Contributors This chapter serves as a bridge between the technical introduction of this book and an introduction to pricing and ratemaking for practicing actuaries. For readers interested in learn practical aspects of pricing, we recommend introductions by the Society of Actuaries in Friedland (2013) and by the Casualty Actuarial Society in Werner and Modlin (2016). For a classic risk management introduction to pricing, see Niehaus and Harrington (2003). See also Finger (2006) and Edward W Frees (2014). Bühlmann (1985) was the first in the academic literature to argue that pricing should be done first at the portfolio level (he referred to this as a top down approach) which would be subsequently reconciled with pricing of individual contracts. See also the discussion in Kaas et al. (2008), Chapter 5. For more background on pricing principles, a classic treatment is by Gerber (1979) with a more modern approach in Kaas et al. (2008). For more discussion of a pricing from a financial economics viewpoint, see Bauer, Phillips, and Zanjani (2013). Edward W. (Jed) Frees, University of Wisconsin-Madison, and José Garrido, Concordia University are the principal authors of the initial version of this chapter. Email: jfrees@bus.wisc.edu and/or jose.garrido@concordia.ca for chapter comments and suggested improvements. Chapter reviewers include: Write Jed or José to add you name here. TS 7.A. Rate Regulation Insurance regulation helps to ensure the financial stability of insurers and to protect consumers. Insurers receive premiums in return for promises to pay in the event of a contingent (insured) event. Like other financial institutions such as banks, there is a strong public interest in promoting the continuing viability of insurers. Market Conduct To help protect consumers, regulators impose administrative rules on the behavior of market participants. These rules, known as market conduct regulation, provide systems of regulatory controls that require insurers to demonstrate that they are providing fair and reliable services, including rating, in accordance with the statutes and regulations of a jurisdiction. Product regulation serves to protect consumers by ensuring that insurance policy provisions are reasonable and fair, and do not contain major gaps in coverage that might be misunderstood by consumers and leave them unprotected. The insurance product is the insurance contract (policy) and the coverage it provides. Insurance contracts are regulated for these reasons: Insurance policies are complex legal documents that are often difficult to interpret and understand. Insurers write insurance policies and sell them to the public on a “take it or leave it” basis. Market conduct includes rules for intermediaries such as agents (who sell insurance to individuals) and brokers (who sell insurance to businesses). Market conduct also includes competition policy regulation, designed to ensure an efficient and competitive marketplace that offers low prices to consumers. Rate Regulation Rate regulation helps guide the development of premiums and so is the focus of this chapter. As with other aspects of market conduct regulation, the intent of these regulations is to ensure that insurers not take unfair advantage of consumers. Rate (and policy form) regulation is common worldwide. The amount of regulatory scrutiny varies by insurance product. Rate regulation is uncommon in life insurance. Further, in non-life insurance, most commercial lines and reinsurance are free from regulation. Rate regulation is common in automobile insurance, health insurance, workers compensation, medical malpractice, and homeowners insurance. These are markets in which insurance is mandatory or in which universal coverage is thought to be socially desirable. There are three principles that guide rate regulation: rates should be adequate (to maintain insurance company solvency), but not excessive (not so high as to lead to exorbitant profits), nor unfairly discriminatory (price differences must reflect expected claim and expense differences). Recently, in auto and home insurance, the twin issues of availability and affordability, which are not explicitly included in the guiding principles, have been assuming greater importance in regulatory decisions. Rates are Not Unfairly Discriminatory Some government regulations of insurance restrict the amount, or level, of premium rates. These are based on the first two of the three guiding rate regulation principles, that rates be adequate but not excessive. This type of regulation is discussed further in the following section on types of rate regulation. Other government regulations restrict the type of information that can be used in risk classification. These are based on the third guiding principle, that rates not be unfairly discriminatory. “Discrimination” in an insurance context has a different meaning than commonly used; for our purposes, discrimination means the ability to distinguish among things or, in our case, policyholders. The real issue is what is meant by the adjective “fair.” In life insurance, it has long been held that it is reasonable and fair to charge different premium rates by age. For example, a life insurance premium differs dramatically between an 80 year old and someone aged 20. In contrast, it is unheard of to use rates that differ by: ethnicity/race, political affiliation, or religion. It is not a matter of whether data can be used to establish statistical significance among the levels of any of these variables. Rather, it is a societal decision as to what constitutes notions of “fairness.” Different jurisdictions have taken different stances on what constitutes a fair rating variable. For example, in some juridictions for some insurance products, gender is no longer a permissible variable. As an illustration, the European Union now prohibits the use of gender for automobile rating. As another example, in the U.S., many discussions have revolved around the use of credit ratings to be used in automobile insurance pricing. Credit ratings are designed to measure consumer financial reponsibility. Yet, some argue that credit rates are good proxies for ethnicity and hence should be prohibited. In an age where more data is being used in imaginative ways, discussions of what constitutes a fair rating variable will only become more important going forward and much of that discussion is beyond the scope of this text. However, it is relevant to the discussion to remark that actuaries and other data analysts can contribute to societal discussions on what constitutes a “fair” rating variable in unique ways by establishing the magnitude of price differences when using variables under discussion. Types of Rate Regulation There are several methods, that vary by the level of scrutiny, by which regulators may restrict the rates that insurers offer. The most restrictive is a government prescribed regulatory system, where the government regulator determines and promulgates the rates, classifications, forms, and so forth, to which all insurers must adhere. Also restrictive are prior approval systems. Here, the insurer must file rates, rules, and so forth, with government regulators. Depending on the statute, the filing becomes effective when a specified waiting period elapses (if the government regulator does not take specific action on the filing, it is deemed approved automatically) or when the government regulator formally approves the filing. The least restrictive is a no file or record maintenance system where the insurer need not file rates, rules, and so forth, with the government regulator. The regulator may periodically examine the insurer to ensure compliance with the law. Another relatively flexible system is the file only system, also known as competitive rating, where the insurer simply keeps files to ensure compliance with the law. In between these two extremes are the (1) file and use, (2) use and file, (3) modified prior approval, and (4) flex rating systems. File and Use: The insurer must file rates, rules, and so forth, with the government regulator. The filing becomes effective immediately or on a future date specified by the filer. Use and File: The filing becomes effective when used. The insurer must file rates, rules, and so forth, with the government regulator within a specified time period after first use. Modified Prior Approval: This is a hybrid of “prior approval” and “file and use” laws. If the rate revision is based solely on a change in loss experience then “file and use” may apply. However, if the rate revision is based on a change in expense relationships or rate classifications, then “prior approval” may apply. Flex (or Band) Rating: The insurer may increase or decrease a rate within a “flex band,” or range, without approval of the government regulator. Generally, either “file and use” or “use and file” provisions apply. For a broad introduction to government insurance regulation from a global perspective, see the website of the International Association of Insurance Supervisors (IAIS). ﻿ Bibliography "],
["C-RiskClass.html", "Chapter 8 Clasificación de riesgos 8.1 Introducción 8.2 Modelo de Regresión de Poisson 8.3 Variables Categóricas y Tarifa Multiplicativa 8.4 Más recursos y colaboradores", " Chapter 8 Clasificación de riesgos Resumen del capítulo. Este capítulo motiva el uso de la clasificación de riesgos en la fijación de precios de seguros y presenta a los lectores la regresión de Poisson como un ejemplo destacado de clasificación de riesgos. En la Sección ?? explicamos por qué las aseguradoras necesitan incorporar diversas características de riesgo, o factores de tarificación, de los asegurados individuales en los precios de los contratos de seguro. Luego presentamos la Sección 8.2 donde mostramos la regresión de Poisson como una herramienta de fijación de precios para lograr diferencias en las primas. El concepto de exposición también se introduce en esta sección. Como la mayoría de los factores de tarificación son categóricos, en la Sección 8.3 mostramos cómo se puede incorporar el modelo de tarifa multiplicativa en el modelo de regresión de Poisson en la práctica, junto con ejemplos numéricos para ilustrarlo. 8.1 Introducción En esta sección, se aprende: Por qué las primas deben variar entre los asegurados según sus diferentes clases de riesgo. El significado de la espiral de selección adversa. La necesidad de clasificar los riesgos. A través de los contratos de seguro, los asegurados transfieren de manera efectiva sus riesgos a la aseguradora a cambio de primas. Para que la aseguradora permanezca en el negocio, el ingreso de la prima recaudada de un grupo de asegurados debe ser al menos igual al beneficio que se obtiene. En los productos de seguros generales donde se cobra una prima por un solo período, por ejemplo, anual, la prima bruta del seguro basada en el principio de equivalencia se define como \\[ \\text{Prima Pura = Pérdidas esperadas + Gastos esperados + Beneficio}. \\] Por lo tanto, ignorando los gastos denominados “de fricción” asociados con los gastos administrativos y el beneficio, la prima neta o pura cobrada por el asegurador debe ser igual a las pérdidas esperadas que se producen por el riesgo que se transfiere por parte del tomador del seguro. Si todos los asegurados en una cartera tienen perfiles de riesgo idénticos, la aseguradora simplemente cobra la misma prima para todos los asegurados porque tienen la misma pérdida esperada. En realidad, sin embargo, los asegurados no son necesariamente homogéneos. Por ejemplo, el riesgo de mortalidad en el seguro de vida depende de las características del asegurado, como la edad, el sexo y el estilo de vida. En el seguro de automóviles, esas características pueden incluir la edad, la ocupación, el tipo o el uso del automóvil y el área donde reside el conductor. El conocimiento de estas características o variables puede mejorar la capacidad de calcular primas justas para los asegurados individuales, ya que pueden usarse para estimar o predecir las pérdidas esperadas con mayor precisión. Selección adversa. De hecho, si el asegurador no diferencia las características de riesgo de los asegurados individuales y simplemente cobra la misma prima a todos los asegurados en función de la pérdida promedio en la cartera, el asegurador se enfrenta a la llamada selección adversa , una situación en la que las personas con una mayor probabilidad de pérdidas son atraídas hacia la cartera y las personas de bajo riesgo son repelidas. Por ejemplo, consideremos una entidad de seguros de salud donde el tabaquismo es un factor de riesgo importante para la mortalidad y la morbilidad. La mayoría de las aseguradoras de salud en el mercado establecen primas diferentes según la condición de fumador, por lo que los fumadores pagan primas más altas que los no fumadores, con otras características idénticas. Ahora supongamos que hay una aseguradora, llamémosla EquitabAll, que ofrece la misma prima a todos los asegurados, independientemente de su condición de fumador, a diferencia de otros competidores. La prima neta de EquitabAll se calcula, naturalmente, a partir de una pérdida con la mortalidad promedio que representa tanto a los fumadores como a los no fumadores. Es decir, la prima neta es un promedio ponderado de las pérdidas, siendo las ponderaciones la proporción de fumadores y no fumadores, respectivamente. Por lo tanto, es fácil ver que un fumador tiene un mayor incentivo para contratar un seguro de EquitabAll que de otras aseguradoras, ya que la prima ofrecida por EquitabAll es relativamente menor. Al mismo tiempo, los no fumadores prefieren contratar un seguro en otra compañía donde se ofrezcan primas más bajas, calculadas sólo para el grupo de no fumadores. Como resultado, habrá más fumadores y menos no fumadores en la cartera de EquitabAll, lo que conduce a pérdidas mayores de lo esperado y, por lo tanto, a una prima más alta para los asegurados en el próximo período para cubrir los costos más altos. Con el aumento de la nueva prima en el próximo período, los no fumadores en EquitabAll tendrán incentivos aún mayores para cambiar de aseguradora. A medida que este ciclo continúa con el tiempo, EquitabAll retendría gradualmente a más fumadores y menos no fumadores en su cartera con la prima elevándose continuamente, lo que eventualmente llevaría al colapso del negocio. En la literatura, este fenómeno se conoce como espiral de selección adversa o espiral de muerte. Por lo tanto, incorporar y diferenciar características de riesgo importantes de las personas en el proceso de fijación de precios del seguro es una componente relevante tanto para la determinación de la prima justa para los asegurados individuales como para la sostenibilidad a largo plazo de las aseguradoras. Factores de tarificación. Para incorporar las características de riesgo relevantes de los asegurados en el proceso de fijación de precios, las aseguradoras mantienen un sistema de clasificación que asigna cada asegurado a una de las clases de riesgo en función de un número relativamente pequeño de características de riesgo que se consideran las más relevantes. Estas características utilizadas en el sistema de clasificación se denominan factores de tarificación, que son variables a priori en el sentido de que se conocen antes de que comience el contrato (por ejemplo, sexo, estado de salud, tipo de vehículo, etc., se conocen durante la suscripción). Todos los asegurados que comparten factores de riesgo idénticos se asignan a la misma clase de riesgo y se consideran homogéneos desde el punto de vista de los precios; la aseguradora en consecuencia les cobra la misma prima o precio. Con respecto a los factores de riesgo y las primas, el Estándar de Práctica Actuarial (ASOP No. 12) de Actuarial Standards Board (2018) establece que el actuario debe seleccionar las características de riesgo que están relacionadas con los resultados esperados, y que las primas dentro de un sistema de clasificación de riesgos se consideran equitativas si sus diferencias reflejan diferencias materiales en el coste esperado de las características de riesgo. En el proceso de elección de los factores de riesgo, ASOP también requiere que el actuario considere lo siguiente: relación de las características de riesgo y los resultados esperados, causalidad, objetividad, practicidad, ley aplicable, prácticas de la industria y prácticas comerciales. En el lado cuantitativo, una tarea importante para el actuario en la construcción de cualquier clasificación de riesgos es construir un modelo estadístico que pueda determinar la pérdida esperada dados los diversos factores de clasificación de un asegurado. El enfoque estándar es adoptar un modelo de regresión que produzca la pérdida esperada como resultado cuando los factores de riesgo relevantes se den como inputs. En este capítulo aprendemos la regresión de Poisson, que se puede usar cuando la pérdida es una variable de conteo, como un ejemplo destacado de una herramienta de fijación de precios de seguros. 8.2 Modelo de Regresión de Poisson El modelo de regresión de Poisson se ha utilizado con éxito en una amplia gama de aplicaciones y tiene la ventaja de permitir expresiones de forma cerrada para cantidades importantes, lo que proporciona una intuición e interpretación informativa. En esta sección presentamos la regresión de Poisson como una extensión natural de la distribución de Poisson. En esta sección, se aprende a: Entender las regresiones de Poisson como una herramienta útil para combinar distribuciones individuales de Poisson de manera unificada. Conocer el concepto de exposición y su importancia. Aprender formalmente cómo formular el modelo de regresión de Poisson utilizando variables indicadoras cuando las variables explicativas son categóricas. 8.2.1 Necesidad de la Regresión de Poisson Distribución de Poisson Para presentar la regresión de Poisson, consideremos una cartera hipotética de seguros de salud donde todos los asegurados son de la misma edad y solo un factor de riesgo, el tabaquismo, es relevante. Por lo tanto, el estado de ser fumador es una variable categórica que contiene dos tipos diferentes: fumador y no fumador. En la literatura estadística, los diferentes tipos en una variable categórica dada se denominan comúnmente niveles. Como hay dos niveles para el estado de fumar, podemos denotar fumadores y no fumadores por nivel 1 y 2, respectivamente. Aquí la numeración es arbitraria y nominal. Supongamos ahora que estamos interesados en fijar el precio de un seguro de salud en el que la prima de cada asegurado se determina por la cantidad de visitas ambulatorias al consultorio del médico durante un año. Se supone que el coste médico para cada visita es el mismo, independientemente del estado de si es fumador o no por simplicidad. Por lo tanto, si creemos que el tabaquismo es un factor de riesgo válido en este seguro de salud, es natural considerar los datos por separado para cada grupo de tabaquismo. En la [Tabla 8.1] presentamos los datos para esta cartera. \\[ {\\small \\begin{matrix} \\begin{array}{cc|cc|cc} \\hline \\text{Fumador} &amp; \\text{(Nivel 1)} &amp; \\text{No fumador}&amp;\\text{(Nivel 2)} &amp; &amp; \\text{Ambos}\\\\ \\text{Valor} &amp; \\text{Observaciones} &amp; \\text{Valor} &amp; \\text{Observaciones} &amp; \\text{Valor} &amp; \\text{Observaciones} \\\\ \\hline 0 &amp; 2213 &amp; 0 &amp; 6671 &amp; 0 &amp; 8884 \\\\ 1 &amp; 178 &amp; 1 &amp; 430 &amp; 1 &amp; 608 \\\\ 2 &amp; 11 &amp; 2 &amp; 25 &amp; 2 &amp; 36 \\\\ 3 &amp; 6 &amp; 3 &amp; 9 &amp; 3 &amp; 15 \\\\ 4 &amp; 0 &amp; 4 &amp; 4 &amp; 4 &amp; 4 \\\\ 5 &amp; 1 &amp; 5 &amp; 2 &amp; 5 &amp; 3 \\\\ \\hline \\text{Total} &amp; 2409 &amp; \\text{Total} &amp; 7141 &amp; \\text{Total} &amp; 9550 \\\\ \\text{Media} &amp; 0,0926 &amp; \\text{Media} &amp; 0,0746 &amp; \\text{Media} &amp; 0,0792 \\\\ \\hline \\end{array} \\end{matrix} } \\] Table 8.1 : Número de visitas a la consulta médica el año pasado Como este conjunto de datos contiene recuentos aleatorios, intentamos ajustar una distribución de Poisson para cada nivel. Como se introdujo en la Sección 2.2.3.2, la función de densidad de probabilidad de Poisson con media \\(\\mu\\) viene dada por: \\[\\begin{equation} \\Pr(Y=y)=\\frac{\\mu^y e^{-\\mu}}{y!},\\qquad y=0,1,2, \\ldots \\tag{8.1} \\end{equation}\\] y \\(\\mathrm{E~}{(Y)}=\\mathrm{Var~}{(Y)}=\\mu\\). En contextos de regresión, es habitual usar \\(\\mu\\) para parámetros que denotan la media en lugar del parámetro de Poisson \\(\\lambda\\), aunque ciertamente ambos símbolos son adecuados. Como vimos en la sección 2.4, la mle de la distribución de Poisson viene dada por la media muestral. Por lo tanto, si denotamos el parámetro media de Poisson para cada nivel por \\(\\mu_{(1)}\\) (fumador) y \\(\\mu_{(2)}\\) (no fumador), vemos en la [Tabla 8.1] que \\(\\hat{\\mu}_{(1)}= 0,0926\\) y \\(\\hat{\\mu}_{(2)} = 0,0746\\). Este simple ejemplo muestra la idea básica de clasificación de riesgo. Dependiendo de la condición de fumador, un asegurado tendrá una característica de riesgo diferente y ésta puede incorporarse a través del parámetro variable de Poisson en el cálculo de la prima justa. En este ejemplo, la proporción de frecuencias de pérdida esperadas es \\(\\frac{\\hat{\\mu} _{(1)}}{\\hat{\\mu}_{(2)}}= 1,2402\\), lo que implica que los fumadores tienden a visitar la consulta médica 24,02\\(\\%\\) veces más frecuentemente en comparación con los no fumadores. También es informativo tener en cuenta que si la aseguradora cobra la misma prima a todos los asegurados, independientemente del estado de ser fumador, en función de la característica promedio de la cartera, como fue el caso de la compañía EquitabAll descrito en la Introducción, la frecuencia esperada (o la prima) \\(\\hat{\\mu}\\) es 0,0792, obtenida de la última columna de [Tabla 8.1]. Se verifica fácilmente que: \\[\\begin{equation} \\hat{\\mu} = \\left(\\frac{n_1}{n_1+n_2}\\right)\\hat{\\mu}_{(1)}+\\left(\\frac{n_2}{n_1+n_2}\\right)\\hat{\\mu}_{(2)}=0,0792, \\tag{8.2} \\end{equation}\\] donde \\(n_i\\) es el número de observaciones en cada nivel. Claramente, esta prima es un promedio ponderado de las primas para cada nivel con un peso igual a la proporción de asegurados en ese nivel. Una regresión de Poisson simple En el ejemplo anterior, hemos ajustado una distribución de Poisson para cada nivel por separado, pero en realidad podemos combinarlos de manera unificada para que un solo modelo de Poisson pueda abarcar los estados de fumadores y no fumadores. Esto se puede hacer relacionando el parámetro medio de Poisson con el factor de riesgo. En otras palabras, hacemos que la media de Poisson, que es la frecuencia de pérdida esperada, responda al cambio en el estado de ser o no fumador. El enfoque convencional para tratar con una variable categórica es adoptar indicadores o variables ficticias que toman valores 1 o 0, de modo que activemos el interruptor para un nivel y lo apaguemos para otros. Por lo tanto, podemos proponernos usar: \\[\\begin{equation} \\mu=\\beta_0+\\beta_1 x_1 \\tag{8.3} \\end{equation}\\] o bien, como se hace habitualmente, en forma log lineal: \\[\\begin{equation} \\log \\mu=\\beta_0+\\beta_1 x_1, \\tag{8.4} \\end{equation}\\] donde \\(x_1\\) es una variable indicadora con \\[\\begin{equation} x_1= \\begin{cases} 1 &amp; \\text{si fuma}, \\\\ 0 &amp; \\text{en caso contrario}. \\end{cases} \\tag{8.5} \\end{equation}\\] En general, preferimos la relación log lineal (8.4) frente a la lineal de (8.3) para prevenir los efectos no deseados de producir valores negativos para \\(\\mu\\), que podrían darse cuando hay una gran variedad de factores de riesgo diferentes y niveles distintos. La especificación de (8.4) y (8.5) entonces proporciona parámetros de frecuencia de Poisson diferentes dependiendo del nivel del correspondiente factor de riesgo: \\[\\begin{equation} \\log \\mu= \\begin{cases} \\beta_0+\\beta_1 \\\\ \\beta_0 \\end{cases} \\quad \\text{o equivalentemente,}\\qquad \\mu= \\begin{cases} e^{\\beta_0+\\beta_1} &amp; \\text{si fuma (nivel 1)}, \\\\ e^{\\beta_0} &amp; \\text{si no fuma (nivel 2)}, \\end{cases} \\tag{8.6} \\end{equation}\\] consiguiendo el resultado que perseguimos. Ésta es la forma más simple de la regresión de Poisson. Tengamos en cuenta que requerimos una sola variable indicadora para modelar dos niveles en este caso. Alternativamente, también es posible usar dos variables indicadoras a través de un esquema de codificación diferente. Este esquema requiere eliminar el término constante para que (8.4) quede como \\[\\begin{equation} \\log \\mu=\\beta_1 x_1+\\beta_2 x_2, \\tag{8.7} \\end{equation}\\] donde \\(x_2\\) es la segunda variable indicadora tal que \\[\\begin{equation} x_2= \\begin{cases} 1 &amp; \\text{si no fuma}, \\\\ 0 &amp; \\text{en caso contrario}. \\end{cases} \\tag{8.8} \\end{equation}\\] Entonces obtenemos, a partir de (8.7), \\[\\begin{equation} \\log \\mu= \\begin{cases} \\beta_1 \\\\ \\beta_2 \\end{cases} \\quad \\text{or}\\qquad \\mu= \\begin{cases} e^{\\beta_1} &amp; \\text{si fuma (level 1)}, \\\\ e^{\\beta_2} &amp; \\text{si no fuma (level 2)}. \\end{cases} \\tag{8.9} \\end{equation}\\] El resultado numérico de (8.6) es el mismo que (8.9) ya que todos los coeficientes se dan como números en la estimación real, siendo la configuración inicial más común en la mayoría textos; usaremos la inicial aquí también. Con este modelo de regresión de Poisson, podemos comprender fácilmente cómo los coeficientes \\(\\beta_0\\) y \\(\\beta_1\\) están vinculados a la frecuencia de pérdida esperada en cada nivel. Según (8.6), la media de Poisson de los fumadores, \\(\\mu_{(1)}\\), viene dada por \\[\\begin{equation} \\mu_{(1)}=e^{\\beta_0+\\beta_1}=\\mu_{(2)} \\,e^{\\beta_1} \\quad \\text{or}\\quad \\mu_{(1)}/\\mu_{(2)} =e^{\\beta_1} \\tag{8.10} \\end{equation}\\] donde \\(\\mu_{(2)}\\) es la media de la distribución de Poisson para los no fumadores. Esta relación entre los fumadores y los no fumadores sugiere una forma útil de comparar los riesgos incluidos en diferentes niveles de un factor de riesgo dado. Es decir, el aumento proporcional en la frecuencia de pérdida esperada de los fumadores en comparación con la de los no fumadores se da simplemente por un factor multiplicativo \\(e^{\\beta_1}\\). Dicho de otra manera, si establecemos la frecuencia de pérdida esperada de los no fumadores como el valor base, la frecuencia de pérdida esperada de los fumadores se obtiene aplicando el factor \\(e^{\\beta_1}\\) al valor base. Manejo de casos de niveles múltiples Podemos extender fácilmente el caso de dos niveles a uno de varios niveles en el que intervienen \\(l\\) diferentes niveles para un solo factor de tarificación. Para esto, generalmente necesitamos \\(l-1\\) variables indicadoras para formular \\[\\begin{equation} \\log \\mu=\\beta_0+\\beta_1 x_1+\\cdots+\\beta_{l-1} x_{l-1}, \\tag{8.11} \\end{equation}\\] donde \\(x_k\\) es una variable indicadora que toma el valor 1 si la póliza pertenece al nivel \\(k\\) y 0 en caso contrario, para \\(k=1,2, \\ldots, l-1\\). Al omitir la variable indicadora asociada con el último nivel en (8.11) , elegimos efectivamente el nivel \\(l\\) como el caso base, pero esta elección es arbitraria y no importa numéricamente. El parámetro de Poisson resultante para las pólizas el nivel \\(k\\) se convierte, a partir de (8.11), \\[\\begin{equation} \\nonumber \\mu= \\begin{cases} e^{\\beta_0+\\beta_k} &amp; \\text{si la póliza pertenece al nivel $k$ (k=1,2, ..., l-1)}, \\\\ e^{\\beta_0} &amp; \\text{si la póliza pertenece al nivel $l$}. \\end{cases} \\end{equation}\\] Por lo tanto, si denotamos el parámetro de Poisson para pólizas en el nivel \\(k\\) como \\(\\mu_{(k)}\\), podemos relacionar el parámetro de Poisson para diferentes niveles a través de \\(\\mu_{(k)} = \\mu_{(l)}\\, e^{\\beta_k}\\), \\(k= 1,2,\\ldots, l-1\\). Esto indica que, al igual que en el caso de dos niveles, la frecuencia de pérdida esperada del nivel \\(k\\)-ésimo se obtiene a partir del valor base multiplicado por el factor relativo \\(e^{\\beta_k}\\). Esta interpretación relativa se vuelve extremadamente útil cuando hay muchos factores de riesgo con niveles múltiples, y nos lleva a una mejor comprensión del riesgo subyacente y una predicción más precisa de las pérdidas futuras. Finalmente, observamos que la media de una distribución de Poisson está completamente determinada por los parámetros \\(\\beta_k\\)’s, que se estiman a partir del conjunto de datos; El procedimiento de estimación de parámetros se discute más adelante en este capítulo. 8.2.2 Regresión de Poisson Ahora describimos la regresión de Poisson en un entorno formal y más general. Supongamos que hay \\(n\\) asegurados independientes con un conjunto de factores de tarificación caracterizados por un vector variable de dimensión \\(k\\)9. El factor de tarificación del asegurado \\(i\\)-ésimo se denota así por el vector \\(\\mathbf{ x}_i=(1, x_{i1}, \\ldots, x_{ik})^{\\prime}\\), y el asegurado se dice que ha registrado un valor de pérdidas igual a \\(y_i \\in \\{0,1,2, \\ldots \\}\\) desde el último período de observación de pérdidas, para \\(i=1, \\ldots, n\\). En la literatura de regresión, los valores \\(x_{i1}, \\ldots, x_{ik}\\) se conocen generalmente como variables explicativas, ya que estas son medidas que proporcionan información sobre la variable de interés \\(y_i\\). En esencia, el análisis de regresión es un método para cuantificar la relación entre una variable de interés y variables explicativas. También asumimos, por ahora, que todos los asegurados tienen un mismo período de observación de pérdidas igual a una unidad, o la misma exposición de 1, para mantener las cosas simples; discutiremos más detalles sobre la exposición en la siguiente subsección. Como se hizo anteriormente, describimos la regresión de Poisson a través de su función de la media. Para esto, primero denotamos que \\(\\mu_i\\) es el número entero que representa las pérdida esperada del titular de la póliza \\(i\\)-ésima mediante la especificación de Poisson (8.1): \\[\\begin{equation} \\mu_i=\\mathrm{E~}{(y_i|\\mathbf{ x}_i)}, \\qquad y_i \\sim Pois(\\mu_i), \\, i=1, \\ldots, n. \\tag{8.12} \\end{equation}\\] La condición dentro de la operación de la esperanza en (8.12)) indica que la frecuencia de pérdida \\(\\mu_i\\) es el output del modelo que responde al conjunto dado de factores de riesgo o variables explicativas. En principio, la media condicional \\(\\mathrm{E~}{(y_i|\\mathbf{ x}_i)}\\) en (8.12) puede tomar diferentes formas dependiendo de cómo especifiquemos la relación entre \\(\\mathbf{x}\\) y \\(y\\). La opción estándar para la regresión de Poisson es adoptar la función exponencial, como mencionamos anteriormente, de forma que \\[\\begin{equation} \\mu_i=\\mathrm{E~}{(y_i|\\mathbf{ x}_i)}=e^{\\mathbf{ x}^{\\prime}_i\\beta}, \\qquad y_i \\sim Pois(\\mu_i), \\, i=1, \\ldots, n. \\tag{8.13} \\end{equation}\\] Aquí \\(\\beta=(\\beta_0, \\ldots, \\beta_k)^{\\prime}\\) es el vector de coeficientes de manera que \\(\\mathbf{ x}^{\\prime}_i\\beta=\\beta_0+\\beta_1x_{i1} +\\ldots+\\beta_k x_{ik}\\). La función exponencial en (8.13) asegura que \\(\\mu_i &gt;0\\) para cualquier conjunto de factores de tarificación \\(\\mathbf{ x}_i\\). A menudo (8.13) se reescribe en forma log lineal \\[\\begin{equation} \\log \\mu_i=\\log \\mathrm{E~}{(y_i|\\mathbf{ x}_i)}=\\mathbf{ x}^{\\prime}_i\\beta, \\qquad y_i \\sim Pois(\\mu_i), \\, i=1, \\ldots, n \\tag{8.14} \\end{equation}\\] para poner explícitamente que la relación entre la parte de la derecha está expresada en forma lineal, \\(\\mathbf{ x}^{\\prime}_i\\beta\\). De nuevo, vemos que la correspondencia funciona bien dado que ambos lados de (8.14), \\(\\log \\mu_i\\) y \\(\\mathbf{ x}_i\\beta\\), pueden cubrir todos los valores reales. Esta es la formulación de la regresión de Poisson, suponiendo que todos los asegurados tienen el mismo período unitario de exposición. Sin embargo, cuando las exposiciones difieren entre los asegurados, como es el caso en la mayoría de los casos prácticos, necesitamos revisar esta formulación agregando el componente de exposición como un término adicional en (8.14). 8.2.3 Incorporación de la exposición Concepto de Exposición Para determinar el tamaño de las pérdidas potenciales en cualquier tipo de seguro, siempre se debe conocer la exposición correspondiente. El concepto de exposición es un ingrediente extremadamente importante en la fijación de precios de seguros, aunque generalmente lo damos por sentado. Por ejemplo, cuando decimos que la frecuencia de reclamaciones esperada de una póliza de seguro de salud es 0,2, no significa nada sin la especificación de la exposición, como, en este caso, por mes o por año. De hecho, todas las primas y pérdidas necesitan especificar la exposición con precisión y deben explicitarse en consecuencia; de lo contrario, todos los análisis estadísticos y predicciones posteriores se distorsionarán. En la sección anterior asumimos la misma unidad de exposición para todos los asegurados, pero esto no es realista en la práctica. En el seguro de salud, por ejemplo, dos asegurados diferentes con diferentes períodos de cobertura de seguro (por ejemplo, 3 meses y 12 meses, respectivamente) podrían haber registrado el mismo número de reclamaciones. Como el número esperado de reclamaciones sería proporcional a la duración de la cobertura, no debemos tratar las experiencias de pérdida de estos dos asegurados de manera idéntica en el proceso de modelización. Esto motiva la necesidad de usar el concepto de exposición en la regresión de Poisson. La distribución de Poisson en (8.1) se parametriza a través de su media. Para comprender la exposición, parametrizamos alternativamente el parametro de la pmf de Poisson en términos del parámetro tasa \\(\\lambda\\), según la definición del proceso de Poisson: \\[\\begin{equation} \\Pr(Y=y)=\\frac{(\\lambda t)^y e^{-\\lambda t}}{y!},\\qquad y=0,1,2, \\ldots \\tag{8.15} \\end{equation}\\] con \\(\\mathrm{E~}{(Y)}=\\mathrm{Var~}{(Y)}=\\lambda t\\). Aquí \\(\\lambda\\) se conoce como la tasa o intensidad por unidad de período del proceso de Poisson y \\(t\\) representa el período de tiempo o exposición, que ha de ser un valor constante conocido. Para \\(\\lambda\\) dados, la distribución de Poisson (8.15) produce un mayor valor en el conteo de pérdidas esperadas a medida que la exposición \\(t\\) aumenta. Claramente, (8.15) se reduce a (8.1) cuando \\(t=1\\), lo que significa que la media y la tasa se vuelven iguales para la unidad de exposición, el caso que consideramos en la subsección anterior. En principio, la exposición no necesita ser medida en unidades de tiempo y puede representar diferentes cosas dependiendo del problema en cuestión. Por ejemplo: En el seguro de salud, la tasa puede ser la aparición de una enfermedad específica por cada 1.000 personas y la exposición es el número de personas consideradas en la unidad de 1.000. En el seguro de automóviles, la tasa puede ser el número de accidentes por año de un conductor y la exposición es la duración del período observado para el conductor en la unidad de un año. En la compensación a trabajadores que cubre la pérdida salarial como resultado de una lesión o enfermedad relacionada con el trabajo de un empleado, la tasa puede ser la probabilidad de lesión durante el tiempo del empleo por dólar y la exposición es la cuantía de la nómina en dólares. En marketing, la tasa puede ser la cantidad de clientes que ingresan a una tienda por hora y la exposición es la cantidad de horas observadas. En ingeniería civil, la tasa puede ser el número de grietas importantes en el camino pavimentado 10 kms y la exposición es la longitud del camino considerado en la unidad de 10 kms. En la modelización del riesgo de crédito, la tasa puede ser el número de eventos de incumplimiento por cada 1000 empresas y la exposición es el número de empresas consideradas en unidades de 1.000. Los actuarios pueden usar diferentes bases de exposición para una pérdida asegurable determinada. Por ejemplo, en el seguro de automóviles, tanto el número de kilómetros recorridos como el número de meses cubiertos por el seguro pueden usarse como bases de exposición. Aquí, el primero es más preciso y útil para modelizar las pérdidas por accidentes automovilísticos, pero es más difícil de medir y administrar para las aseguradoras. Por lo tanto, una buena base de exposición puede no ser la mejor en teoría debido a varias limitaciones prácticas. Por regla general, una base de exposición debe ser fácil de determinar, medible con precisión, legal y socialmente aceptable y libre de posibles manipulaciones por parte de los asegurados. Incorporación de la exposición en la regresión de Poisson Como las exposiciones afectan la media de Poisson, la construcción de regresiones de Poisson requiere que separemos cuidadosamente la tasa y la exposición en el proceso de modelización. Centrándonos en el contexto del seguro, denotemos la tasa del evento de pérdida del asegurado \\(i\\)-ésimo como \\(\\lambda_i\\), la exposición conocida (la duración de la cobertura) como \\(m_i\\) y el valor del conteo de pérdidas esperado bajo la exposición dada por \\(\\mu_i\\). Luego, la formulación de regresión de Poisson en (8.13) y (8.14) debe revisarse según (8.15) como \\[\\begin{equation} \\mu_i=\\mathrm{E~}{(y_i|\\mathbf{ x}_i)}=m_i \\,\\lambda_i=m_i \\, e^{\\mathbf{ x}^{\\prime}_i\\beta}, \\qquad y_i \\sim Pois(\\mu_i), \\, i=1, \\ldots, n, \\tag{8.16} \\end{equation}\\] lo que produce \\[\\begin{equation} \\log \\mu_i=\\log m_i+\\mathbf{ x}^{\\prime}_i\\beta, \\qquad y_i \\sim Pois(\\mu_i), \\, i=1, \\ldots, \\tag{8.17} \\end{equation}\\] Añadiendo \\(\\log m_i\\) en (8.17) no supone ningún problema en el ajuste dado que siempre podemos especificar esto como una variable explicativa adicional, puesto que es una constante conocida, y fijar su coeficiente a 1. En la literatura, el logaritmo de la exposición, \\(\\log m_i\\), se suele denominar el offset. 8.2.4 Ejercicios Respecto a la Table 8.1 contestad lo siguiente. Verificad la media de los valores de la tabla. Verificad el número en la ecuación (8.2). Producid los valores de conteo ajustados en la distribución de Poisson para cada nivel de la situación de fumador en la tabla. En la formulación de la regresión de Poisson (8.12), considera el uso de \\(\\mu_i=\\mathrm{E~}{(y_i|\\mathbf{ x}_i)}=({\\mathbf{ x}^{\\prime}_i\\beta})^2\\), para \\(i=1, \\ldots, n\\), en lugar de la función exponencial. ¿Qué problema potencial puede aperecer? 8.3 Variables Categóricas y Tarifa Multiplicativa En esta sección, se aprende: El modelo de tarifa multiplicativa cuando los factores de tarificación son categóricos. Cómo construir el modelo de regresión de Poisson basado en la estructura tarifaria multiplicativa. 8.3.1 Factores de Tarificación y Tarifa En la práctica, la mayoría de los factores de tarificación en seguros son variables categóricas, lo que significa que toman uno de la cantidad predeterminada de valores posibles. Los ejemplos de variables categóricas incluyen el sexo, el tipo de automóviles, la región de residencia y la ocupación del conductor. Las variables continuas, como la edad o el kilometraje del vehículo, también pueden agruparse por intervalos y tratarse como variables categóricas. Por lo tanto, podemos imaginar que, con un pequeño número de factores de tarificación, habrá muchos asegurados que caigan en la misma clase de riesgo, y pagarán la misma prima. Para el resto de este capítulo asumimos que todos los factores de tarificación son variables categóricas. Para ilustrar cómo se utilizan las variables categóricas en el proceso de fijación de precios, consideramos un seguro hipotético para automóviles con solo dos factores: Tipo de vehículo: Tipo A (propiedad personal) y B (propiedad de la empresa). Usamos el índice \\(j = 1\\) y \\(2\\) para representar respectivamente cada nivel de este factor de tarificación. Grupo de edad del conductor: joven (edad \\(&lt;\\) 25), adulto (25 \\(\\le\\) edad \\(&lt;\\) 60) y mayor (edad \\(\\ge\\) 60). Utilizamos el índice \\(k = 1, 2\\) y \\(3\\), respectivamente, para este factor. A partir de esta regla de clasificación, podemos crear una tabla o lista organizada, como la que se muestra en la [Tabla 8.2], que recopila a todos los asegurados. Claramente hay \\(2\\times 3 = 6\\) diferentes clases de riesgo en total. Cada fila de la tabla muestra una combinación de diferentes características de riesgo de los asegurados individuales. Nuestro objetivo es calcular seis primas diferentes para cada una de estas combinaciones. Una vez que se ha determinado la prima para cada fila utilizando la exposición y el número de reclamaciones dadas, la aseguradora puede reemplazar las dos últimas columnas en la [Tabla 8.2] con una sola columna que contiene las primas calculadas. Esta nueva tabla puede servir como un manual para determinar la prima para un nuevo asegurado dados los factores de tarificación durante el proceso de suscripción. En los seguros no de vida, una tabla (o un conjunto de tablas) o una lista que contiene cada conjunto de factores de tarificación y la prima asociada se conoce como una tarifa. Cada combinación única de los factores de calificación en una tarifa se llama celda de tarifa; así, en la [Tabla 8.2] el número de celdas de tarifa es seis, igual que el número de clases de riesgo. \\[ {\\small \\begin{matrix} \\begin{array}{ccrrc} \\hline \\text{Factores} &amp;\\text{Tarificación} &amp; \\text{Exposición} &amp; \\text{Número de reclamaciones} \\\\ \\text{Tipo }(j) &amp; \\text{Edad }(k) &amp; \\text{anual} &amp; \\text{observadas}\\\\ \\hline \\hline j=1 &amp; k=1 &amp; 89,1 &amp; 9\\\\ 1 &amp; 2 &amp; 208,5&amp; 8\\\\ 1 &amp; 3 &amp; 155,2 &amp; 6 \\\\ 2 &amp; 1 &amp; 19,3 &amp; 1 \\\\ 2 &amp; 2 &amp; 360,4 &amp; 13 \\\\ 2 &amp; 3 &amp; 276,7 &amp; 6 \\\\ \\hline \\end{array} \\end{matrix} } \\] Table 8.2 : Ilustración de registro de pérdidas en el seguro de automóviles Veamos ahora la información sobre pérdidas en la [Tabla 8.2] más de cerca. La exposición en cada fila representa la suma de la duración de las coberturas de seguro, o los tiempos vigentes, en la unidad de año, de todos los asegurados en esa celda de tarifa. Del mismo modo, el recuento de reclamaciones en cada fila es el número de reclamaciones en cada celda. Naturalmente, las exposiciones y los recuentos de reclamaciones varían debido a la diferente cantidad de conductores en las celdas, así como a diferentes períodos de tiempo de vigencia entre los conductores dentro de cada celda. En el marco de la regresión de Poisson, denotamos la exposición y el recuento de reclamaciones de la celda \\((j, k)\\) como \\(m_ {jk}\\) y \\(y_ {jk}\\), respectivamente, y definimos el recuento de reclamaciones por unidad de exposición como \\[\\begin{equation} \\nonumber z_{jk}= \\frac{y_{jk}}{ m_{jk}}, \\qquad j=1,2;\\, k=1, 2,3. \\end{equation}\\] Por ejemplo, \\(z_{12}=8/208,5=0,03837\\), lo que significa que un asegurado en la celda de tarifa (1,2) tendría 0,03837 accidentes si estuviera asegurado durante un año completo en promedio. El conjunto de valores de \\(z_{ij}\\) corresponde al parámetro de tasa media en la distribución de Poisson (8.15), ya que son las tasas de ocurrencia de eventos por unidad de exposición. Es decir, tenemos \\(z_{jk}=\\hat{\\lambda}_{jk}\\) donde \\({\\lambda}_{jk}\\) es el parámetro tasa de la Poisson. Sin embargo, generando los valores de \\(z_ {ij}\\) lo que se hace simplemente es comparar las frecuencias de pérdida promedio entre las clases de riesgo. Para explotar completamente el conjunto de datos, construiremos un modelo de precios a partir de la [Tabla 8.2] utilizando la regresión de Poisson en el resto del capítulo. Comentar que los registros de pérdidas reales utilizados por las aseguradoras generalmente incluyen muchos más factores de riesgo, en cuyo caso el número de celdas crece exponencialmente. La tarifa consiste entonces en un conjunto de tablas, en lugar de una, separadas por algunos de los factores básicos de tarificación, como el sexo o el territorio. 8.3.2 Modelo de Tarifa Multiplicativa En esta subsección, presentamos el modelo de tarifa multiplicativa, una estructura de precios muy utilizada que puede usarse naturalmente dentro del marco de regresión de Poisson. Los desarrollos aquí se basan en la [Tabla 8.2]. Recordemos que el recuento de pérdidas de un asegurado se describe mediante el modelo de regresión de Poisson con tasa o media \\(\\lambda\\) y exposición \\(m\\), de modo que el recuento de pérdidas esperado se convierte en \\(m \\lambda\\). Como \\(m\\) es una constante conocida, estamos esencialmente interesados en modelizar \\(\\lambda\\), de modo que responda al cambio en los factores de tarificación. Entre otras formas funcionales posibles, comúnmente elegimos la relación multiplicativa10 para modelar la tasa de Poisson \\(\\lambda_{jk}\\) para el factor de tarificación (\\(j,k\\)): \\[\\begin{equation} \\lambda_{jk}= f_0 \\times f_{1j} \\times f_{2k}, \\qquad j=1,2;\\, k=1, 2,3. \\tag{8.18} \\end{equation}\\] Aquí \\(\\{ f_{1j}, j=1,2\\}\\) son los parámetros asociados con los dos niveles en el primer factor de calificación, tipo de automóvil y \\(\\{ f_{2k}, k=1,2,3\\}\\) están asociados con los tres niveles de la franja de edad, el segundo factor de tarificación. Por ejemplo, la media de Poisson para un asegurado de mediana edad (adulto) con un vehículo Tipo B viene dada por \\(\\lambda_{22}=f_0 \\times f_{12} \\times f_{22}\\). El primer término \\(f_0\\) es un valor base que se discutirá en breve. Por lo tanto, estos seis parámetros se entienden como representaciones numéricas de los niveles dentro de cada factor de tarificación y deben estimarse a partir del conjunto de datos. La forma multiplicativa (8.18) ) es fácil de entender y usar, porque muestra claramente cómo cambia el recuento de pérdidas esperadas (por unidad de exposición) a medida que varía cada factor de tarificación. Por ejemplo, si \\(f_{11}=1\\) y \\(f_{12}=1,2\\), el recuento de pérdidas esperadas de un asegurado con un vehículo del tipo B sería un 20\\(\\%\\) mayor que el tipo A, cuando el resto de factores son los mismos. En los seguros no de vida, los parámetros \\(f_{1j}\\) y \\(f_{2k}\\) se conocen como relatividades, ya que determinan la cantidad de pérdida esperada que debería cambiar en relación con el valor base \\(f_0\\). La idea de la relatividad es bastante útil en la práctica, ya que podemos decidir la prima para un asegurado simplemente multiplicando una serie de relatividades correspondientes al valor base. Eliminar un factor de calificación existente o agregar uno nuevo también es transparente con esta estructura multiplicativa. Además, la aseguradora puede ajustar fácilmente la prima general para todos los asegurados controlando el valor base \\(f_0\\) sin cambiar las relatividades individuales. Sin embargo, al adoptar la forma multiplicativa, asumimos implícitamente que no existe una interacción importante entre los factores de riesgo. Cuando se usa la forma multiplicativa, debemos abordar un problema de identificación. Es decir, para cualquier \\(c&gt; 0\\), podemos escribir \\[\\begin{equation} \\lambda_{jk}= f_0 \\times \\frac{f_{1j}}{c} \\times c\\,f_{2k}. \\end{equation}\\] Al comparar con (8.18)), vemos que se puede obtener exactamente el mismo parámetro de tasa \\(\\lambda_{jk}\\) para relatividades individuales muy diferentes. Esta sobre-parametrización, que significa que muchos conjuntos diferentes de parámetros llegan a un modelo idéntico, obviamente requiere alguna restricción sobre \\(f_{1j}\\) y \\(f_{2k}\\). La práctica estándar es hacer que una relatividad en cada factor de tarificación sea igual a uno. Esto puede hacerse arbitrariamente en teoría, pero la práctica estándar es hacer que la relatividad de la clase más común (clase base) sea igual a uno. Asumiremos que los vehículos de tipo A y los conductores jóvenes son las clases más frecuentes, es decir, \\(f_{11} = 1\\) y \\(f_{21} = 1\\). De esta manera, todas las demás relatividades se determinan de manera única. La celda de tarifa \\((j,k) = (1,1)\\) se llama entonces celda de tarifa base, donde la tasa simplemente se convierte en \\(\\lambda_{11} = f_0\\), correspondiente al valor base de acuerdo con (8.18). Por lo tanto, el valor base \\(f_0\\) generalmente se interpreta como la media de Poisson de la celda de tarifa base. De nuevo, (8.18) se transforma mediante el logaritmo y puede re-escribirse como: \\[\\begin{equation} \\log \\lambda_{jk}= \\log f_0 + \\log f_{1j} + \\log f_{2k}, \\tag{8.19} \\end{equation}\\] ya que es más fácil trabajar en el proceso de estimación, similar a (8.14). Esta forma lineal de registro hace que las relatividades de registro del nivel base en cada factor de tarificación sean iguales a cero, es decir, \\(\\log f_{11}=\\log f_{21}=0\\), y nos lleva a la siguiente alternativa, que es una expresión más explícita para (8.19): \\[\\begin{equation} \\log \\lambda=\\begin{cases} \\log f_0 + \\quad 0 \\quad \\,\\,+ \\quad 0 \\quad \\,\\,&amp; \\text{para una póliza en a celda $(1,1)$}, \\\\ \\log f_0+ \\quad 0 \\quad \\,\\,+\\log f_{22}&amp; \\text{para una póliza en a celda $(1,2)$}, \\\\ \\log f_0+ \\quad 0 \\quad \\,\\,+\\log f_{23}&amp; \\text{para una póliza en a celda $(1,3)$}, \\\\ \\log f_0+\\log f_{12}+ \\quad 0 \\quad \\,\\,&amp; \\text{para una póliza en a celda $(2,1)$}, \\\\ \\log f_0+\\log f_{12}+\\log f_{22}&amp; \\text{para una póliza en a celda $(2,2)$}, \\\\ \\log f_0+\\log f_{12}+\\log f_{23}&amp; \\text{para una póliza en a celda $(2,3)$}. \\\\ \\end{cases} \\tag{8.20} \\end{equation}\\] Esto muestra claramente que el parámetro de Poisson \\(\\lambda\\) varía según las diferentes celdas de la tarifa, con la misma forma lineal logarítmica utilizada en el marco de la regresión de Poisson. De hecho, se puede ver que(8.20) es una versión extendida de la expresión anterior (8.6) con múltiples factores de riesgo y que las relatividades logarítmicas ahora juegan el papel de los parámetros \\(\\beta_i\\). Por lo tanto, todas las relatividades pueden estimarse fácilmente mediante el ajuste de una regresión de Poisson con un conjunto de variables indicadoras elegidas adecuadamente. 8.3.3 Regresión de Poisson para la Tarifa Multiplicativa Variables Indicadoras para las Celdas de Tarifa Ahora explicamos cómo se pueden incorporar las relatividades en la regresión de Poisson. Como se vio al principio de este capítulo, utilizamos variables indicadoras para tratar con variables categóricas. Por lo tanto, para nuestra aseguradora de automóviles del ejemplo, definimos una variable indicadora para el primer factor de calificación como \\[\\begin{equation} x_1= \\begin{cases} 1 &amp; \\text{ para vehículos de tipo B}, \\\\ 0 &amp; \\text{ en caso contrario}. \\end{cases} \\end{equation}\\] Para el segundo factor de tarificación, empleamos dos variables indicadoras para el grupo de edad, es decir, \\[\\begin{equation} x_2= \\begin{cases} 1 &amp; \\text{para el grupo de edad 2}, \\\\ 0 &amp; \\text{en caso contrario}. \\end{cases} \\end{equation}\\] y \\[\\begin{equation} x_3= \\begin{cases} 1 &amp; \\text{para el grupo de edad3}, \\\\ 0 &amp; \\text{en caso contrario}. \\end{cases} \\end{equation}\\] La tripleta \\((x_1, x_2, x_3)\\) puede determinar de manera efectiva y única cada clase de riesgo. Al observar que las variables indicadoras asociadas con el Tipo A y el grupo de edad 1 se omiten, vemos que la celda de tarifa \\((j, k) = (1,1)\\) juega el papel de la celda base. Hacemos hincapié en que nuestra elección de las tres variables indicadoras anteriores se ha realizado cuidadosamente para que sea coherente con la elección de los niveles base en el modelo de tarifa multiplicativa en la subsección anterior (es decir, \\(f_{11}=1\\) and \\(f_{21}=1\\)). Con las variables indicadoras propuestas, podemos reescribir la tasa de registro (8.19) como \\[\\begin{equation} \\log \\lambda_{}= \\log f_0+ \\log f_{12} \\times x_1 + \\log f_{22} \\times x_2 +\\log f_{23} \\times x_3, \\tag{8.21} \\end{equation}\\] que es idéntico a (8.20) cuando cada valor de la tripleta se aplica como corresponde. Por ejemplo, podemos verificar que la celda de tarifa base \\((j,k)=(1,1)\\) corresponde a \\((x_1, x_2,x_3)=(0, 0, 0)\\), y a su vez produce \\(\\log \\lambda=\\log f_0\\) o \\(\\lambda=f_0\\) en (8.21) según sea necesario. Regresion de Poisson para el modelo de tarificación Bajo esta especificación, consideremos a los \\(n\\) asegurados en la cartera con las características de riesgo del asegurado \\(i\\)-ésimo dadas por un vector de variables explicativas \\(\\mathbf{ x}_i=(x_{i1}, x_{i2},x_{i3})^{\\prime}\\), para \\(i = 1, \\ldots, n\\). Entonces establecemos (8.21) como \\[\\begin{equation} \\log \\lambda_{i}= \\beta_0+ \\beta_1 \\, x_{i1} + \\beta_{2} \\, x_{i2} +\\beta_3 \\, x_{i3}=\\mathbf{ x}^{\\prime}_i\\beta, \\qquad i=1, \\ldots, n, \\end{equation}\\] donde \\(\\beta_0, \\ldots, \\beta_3\\) se pueden asignar a las relatividades de registro correspondientes en (8.21). Ésta es exactamente la misma configuración que en (8.17) excepto por el componente de exposición. Por lo tanto, al incorporar la exposición en cada clase de riesgo, el modelo de regresión de Poisson para este modelo de tarifa multiplicativa finalmente se convierte en \\[\\begin{equation} \\log \\mu_i=\\log \\lambda_{i}+\\log m_i= \\log m_i+ \\beta_0+ \\beta_1 \\, x_{i1} + \\beta_{2} \\, x_{i2} +\\beta_3 \\, x_{i3}=\\log m_i+\\mathbf{ x}^{\\prime}_i\\beta, \\end{equation}\\] para \\(i=1, \\ldots, n\\). Como resultado, las relatividades vienen dadas por \\[\\begin{equation} {f}_0=e^{\\beta_0}, \\quad {f}_{12}=e^{\\beta_1}, \\quad {f}_{22}=e^{\\beta_2} \\quad \\text{and}\\quad {f}_{23}=e^{\\beta_3}, \\tag{8.22} \\end{equation}\\] con \\(f_{11}=1\\) y \\(f_{21}=1\\) de la especificación inicial. Para el conjunto de datos real, \\(\\beta_i\\), \\(i = 0,1, 2, 3\\), se reemplaza con su estimación mle \\(b_i\\) usando el método en el suplemento técnico al final de este capítulo (Sección 8.A). 8.3.4 Ejemplos numéricos Presentamos dos ejemplos numéricos de la regresión de Poisson. En el primer ejemplo, construimos un modelo de regresión de Poisson a partir de la [Tabla 8.2], que es un conjunto de datos de una hipotética compañía de seguro del automóvil. El segundo ejemplo utiliza un conjunto de datos real de una entidad aseguradora con más factores de riesgo. Como nuestro propósito es mostrar cómo se puede usar el modelo de regresión de Poisson bajo una regla de clasificación dada, no nos preocupa la calidad del ajuste del modelo de Poisson en este capítulo. Ejemplo 8.1: Regresión de Poisson para el seguro del automóvil del ejemplo En las últimas subsecciones anteriores, hemos considerado un conjunto de datos de una compañía aseguradora hipotética de automóviles con dos factores de riesgo, como se muestra en la [Tabla 8.2]. Ahora aplicamos el modelo de regresión de Poisson a este conjunto de datos. Como se hizo anteriormente, hemos establecido \\((j, k) = (1,1)\\) como la celda de tarifa base, de modo que \\(f_{11} = f_{21} = 1\\). El resultado de la regresión da las estimaciones de coeficientes siguientes \\((b_0, b_1, b_2, b_3) = (- 2,3359, -0,3004, -0,7837, -1,0655)\\), que a su vez produce las correspondientes relatividades \\[\\begin{equation} \\nonumber {f}_0=0,0967, \\quad {f}_{12}= 0,7405, \\quad {f}_{22}=0,4567 \\quad \\text{y}\\quad {f}_{23}=0,3445. \\end{equation}\\] a partir de la relación dada por (8.22). El programa en R y los resultados son los siguientes Muestral código R &gt; mydat1&lt;- read.csv(&quot;eg1_v1a.csv&quot;) &gt; mydat1 Vtype Agebnd Expsr Claims 1 1 1 89.1 9 2 1 2 208.5 8 3 1 3 155.2 6 4 2 1 19.3 1 5 2 2 360.4 13 6 2 3 276.7 6 &gt; VtypeF &lt;- relevel(factor(Vtype), ref=&quot;1&quot;) # treat Vtype as factors with 1 as base. &gt; AgebndF &lt;- relevel(factor(Agebnd), ref=&quot;1&quot;) # treat Age band as factors. &gt; Pois_reg1 = glm(Claims ~ VtypeF + AgebndF, data = mydat1, family = poisson(link = log), offset = log(Expsr) ) &gt; Pois_reg1 Coefficients: (Intercept) VtypeF2 AgebndF2 AgebndF3 -2.3359 -0.3004 -0.7837 -1.0655 Degrees of Freedom: 5 Total (i.e. Null); 2 Residual Null Deviance: 8.774 Residual Deviance: 0.6514 AIC: 30.37 Ejemplo 8.2. Regresión de Poisson para datos de siniestros en seguros en Singapur Este conjunto de datos real es un subconjunto de los datos utilizados por (Frees and Valdez 2008). Los datos provienen de la Asociación de Seguros Generales de Singapur, una organización que agrupa aseguradoras de no vida en Singapur. Los datos contienen el número de accidentes automovilísticos para \\(n = 7.483\\) pólizas de seguro de auto con varias variables explicativas categóricas y la exposición para cada póliza. Las variables explicativas incluyen cuatro factores de riesgo: el tipo de vehículo asegurado (automóvil (A) u otro (O), denotado por \\(\\tt{Vtype}\\)), la edad del vehículo en años (\\(\\tt{Vage}\\)), el sexo del titular de la póliza (\\(\\tt{Sex}\\)) y la edad del titular de la póliza (en años, agrupados en siete categorías, indicados \\(\\tt{Age}\\)). Según la descripción de los datos, hay varias cosas a recordar antes de construir un modelo. Primero, hay 3.842 pólizas con vehículo tipo A (automóvil) y 3.641 pólizas con otros tipos de vehículos. Sin embargo, la información sobre edad y sexo está disponible solo para las pólizas del vehículo tipo A; Se registra que los conductores de todos los demás tipos de vehículos tienen 21 años de edad o menos con sexo no especificado, excepto en una póliza, lo que indica que no se ha recopilado información del conductor para vehículos que no sean automóviles. Segundo, todos los vehículos tipo A están clasificados como vehículos privados y los demás tipos no. Cuando incluimos estos factores de riesgo, asumimos que todo sexo no especificado es masculino. Como la información sobre la edad solo es aplicable a los vehículos tipo A, configuramos el modelo en consecuencia. Es decir, aplicamos la variable de edad solo a los vehículos del tipo A. También utilizamos cinco franjas de antigüedad del vehículo, simplificando los siete grupos originales, combinando las edades de los vehículos 0, 1 y 2; el intervalo combinado se codifica como nivel 211 en el archivo de datos. Por lo tanto, nuestro modelo de Poisson tiene la siguiente forma explícita: \\[\\begin{align*} \\log \\mu_i= \\mathbf{ x}^{\\prime}_i\\beta+&amp;\\log m_i=\\beta_0+\\beta_1 I(Sex_i=M)+ \\sum_{t=2}^6 \\beta_t\\, I(Vage_i=t) \\\\ &amp;+ \\sum_{t=7}^{13} \\beta_t \\,I(Vtype_i=A)\\times I(Age_i=t-7)+\\log m_i. \\end{align*}\\] El resultado del ajuste se proporciona en la Table 8.3, para la que hacemos varios comentarios. La frecuencia de reclamaciones es mayor para hombres en un 17,3%, cuando otros factores de tarificación se mantienen fijos. Sin embargo, esto puede estar afectado por el hecho de que todo el sexo no especificado se ha asignado como hombre. Con respecto a la edad del vehículo, la frecuencia de reclamaciones disminuye gradualmente a medida que el vehículo envejece, cuando otros factores de tarificación se mantienen fijos. El nivel comienza desde 2 para esta variable pero, nuevamente, la numeración es nominal y no afecta el resultado numérico. La variable de edad del titular de la póliza solo se aplica al vehículo tipo A (automóvil), y no existe una póliza en el primer grupo de edad. Podemos especular que los conductores más jóvenes, menores de 21 años, conducen los automóviles de sus padres en lugar de tener el suyo debido a las altas primas de seguro o las regulaciones relacionadas. La falta de relatividad puede estimarse mediante alguna interpolación o a juicio profesional del actuario. La frecuencia de siniestros es la más baja para las franjas de edad 3 y 4, pero se vuelve sustancialmente más alta para los grupos de mayor edad, un patrón razonable visto en muchos conjuntos de datos de costes en el seguro de automóviles. También observamos que no existe un nivel base en la variable de edad del titular de la póliza, en el sentido de que ninguna relatividad es igual a 1. Esto se debe a que la variable solo es aplicable al tipo de vehículo A. Esto no causa un problema numérico, pero se puede establecer la relatividad básica de la siguiente manera si es necesario para otros fines. Como no hay ninguna póliza en el grupo de edad 0, consideramos el grupo 1 como el caso base. Específicamente, tratamos su relatividad como un producto de 0,918 y 1, donde la primera es la relatividad común (es decir, la reducción de prima común) aplicada a todas las pólizas con vehículo tipo A y la segunda es el valor base para la franja de edad 1. Entonces, la relatividad de la franja de edad 2 puede obtenerse como \\(0,917 = 0,918 \\times 0,999\\), donde 0,999 se entiende como la relatividad para la franja de edad 2. Los grupos de edad restantes pueden tratarse de manera similar. \\[ {\\small \\begin{matrix} \\begin{array}{clcc} \\hline \\text{Factor} &amp; \\text{Nivel} &amp; \\text{Relatividad en la tarifa} &amp; \\text{Nota}\\\\ \\hline\\hline \\text{Valor base} &amp; &amp; 0.167 &amp; f_0\\\\ \\hline \\text{Sexo} &amp; 1 (F) &amp; 1.000 &amp; \\text{Base}\\\\ &amp; 2 (M) &amp; 1.173 &amp;\\\\\\hline \\text{Edad del vehículo} &amp; 2 (0-2\\text{ años}) &amp; 1.000 &amp; \\text{Base}\\\\ &amp; 3 (3-5\\text{ años}) &amp; 0,843 \\\\ &amp; 4 (6-10\\text{ años}) &amp; 0,553 \\\\ &amp; 5 (11-15\\text{ años}) &amp; 0,269 \\\\ &amp; 6 (16+\\text{ años}) &amp; 0,189 &amp;\\\\\\hline \\text{Edad del asegurado} &amp; 0 (0-21) &amp; \\text{N. D.} &amp; \\text{Sin pólizas} \\\\ \\text{(Sólo aplicable a} &amp; 1 (22-25) &amp; 0,918 \\\\ \\text{Tipo de vehículo A)} &amp; 2 (26-35) &amp; 0,917 \\\\ &amp; 3 (36-45) &amp; 0,758 \\\\ &amp; 4 (46-55) &amp; 0,632 \\\\ &amp; 5 (56-65) &amp; 1,102\\\\ &amp; 6 (65+) &amp; 1,179\\\\ \\hline \\hline \\end{array} \\end{matrix} } \\] Table 8.3 : Datos de siniestros en seguros en Singapur Probemos varios ejemplos basados en la [Tabla 8.3]. Supongamos que un titular de póliza masculino de 40 años que posee un vehículo de tipo A de 7 años de edad. La frecuencia de reclamaciones esperada para este titular de póliza viene dada por \\[\\begin{equation} \\lambda=0,167 \\times 1,173 \\times 0,553 \\times 0,758 = 0,082. \\end{equation}\\] Como otro ejemplo, considere a una asegurada de 60 años que posee un vehículo de 3 años del tipo O. La frecuencia de reclamaciones esperada para este asegurado es \\[\\begin{equation} \\lambda=0,167 \\times 1 \\times 0,843 = 0,141. \\end{equation}\\] Tengamos en cuenta que para esta póliza, la variable de grupo de edad no se utiliza ya que el tipo de vehículo no es A. La secuencia de comandos R se proporciona de la siguiente manera. Muestra código R mydat &lt;- read.csv(&quot;SingaporeAuto.csv&quot;, quote = &quot;&quot;, header = TRUE) attach(mydat) # create vehicle type as factor TypeA = 1 * (VehicleType == &quot;A&quot;) table(VehicleType) VtypeF &lt;- as.character(VehicleType) VtypeF[VtypeF != &quot;A&quot;] &lt;- &quot;O&quot; VtypeF = relevel(factor(VtypeF), ref=&quot;A&quot;) # create gender as factor Female = 1 * (SexInsured == &quot;F&quot; ) Sex = as.character(SexInsured) Sex[Sex != &quot;F&quot;] &lt;- &quot;M&quot; SexF = relevel(factor(Sex), ref = &quot;F&quot;) # create driver age as factor AgeCat = pmax(AgeCat - 1, 0) AgeCatF = relevel(factor(AgeCat), ref = &quot;0&quot;) table(AgeCatF) # No policy in the first age band # create vehicle age as factor VAgeCatF = relevel( factor(VAgeCat), ref = &quot;0&quot; ) VAgecat1 = factor(VAgecat1, labels = c(&quot;Vage0-2&quot;, &quot;Vage3-5&quot;, &quot;Vage6-10&quot;, &quot;Vage11-15&quot;, &quot;Vage15+&quot;) ) VAgecat1F = relevel( factor(VAgecat1), ref = &quot;Vage0-2&quot; ) # Poisson reg model Pois_reg2 = glm(Clm_Count ~ SexF + TypeA:AgeCatF + VAgecat1F, offset = LNWEIGHT, poisson(link = log) ) summary(Pois_reg2) # compute relativities exp(Pois_reg2$coefficients) detach(mydat) Como observación final, comentar que la regresión de Poisson no es el único modelo de regresión posible para datos de conteo. En realidad, la distribución de Poisson puede ser restrictiva en el sentido de que tiene un único parámetro y su media y la varianza son siempre iguales. Existen otros modelos de regresión para conteos que permiten una estructura de distribución más flexible, como las regresiones binomiales negativas y las regresiones infladas en cero (ZI); Los detalles de estas regresiones alternativas se pueden encontrar en otros textos enumerados en la siguiente sección. 8.4 Más recursos y colaboradores Más Información y Referencias La regresión de Poisson es un caso especial de una clase de modelo de regresión más general conocido como modelo lineal generalizado (glm). El glm establece un marco de regresión unificado para conjuntos de datos cuando las variables de respuesta son continuas, binarias o discretas. El modelo de regresión lineal clásico con error normal también es miembro del glm. Hay muchos textos estadísticos estándar que tratan sobre el glm, incluido (McCullagh and Nelder 1989). Los textos más accesibles son (Dobson and Barnett 2008), (Agresti 1996) y (Faraway 2016). Para las aplicaciones actuariales y de seguros del glm, consulte (Edward W. Frees 2009a), (De Jong and Heller 2008). Además, (Ohlsson and Johansson 2010) analiza el glm en el contexto de fijación de precios de seguros no vida con análisis de tarifas. Colaboradores Joseph H. T. Kim, Yonsei University, es el autor principal de la versión inicial de este capítulo. Email: jhtkim@yonsei.ac.kr para comentarios del capítulo y sugerencias de mejora. Revisores del capítulo: Chun Yong Chew, Lina Xu, Jeffrey Zheng. Traducción al español: Montserrat Guillen (Universitat de Barcelona) TS 8.A – Estimación de Modelos de Regresión de Poisson Los principios de la estimación de máxima verosimilitud (mle) se presentan en las Secciones 2.4.1 y 3.5, definidos en la Sección 14.2.2, y desarrollados teóricamente en el Capítulo 16. Aquí presentamos el procedimiento mle de la regresión de Poisson para que el lector pueda ver cómo se tratan las variables explicativas para maximizar la función de verosimilitud en el ámbito de la regresión. Máxima Verosimilitud para Datos Individuales En la regresión de Poisson, la media de la distribución de Poisson está determinada por los parámetros \\(\\beta_i\\)’s, como se muestra en (8.17). En esta subsección usamos el método de máxima verosimilitud para estimar estos parámetros. Nuevamente, asumimos que hay \\(n\\) asegurados y el asegurado \\(i\\)-ésimo se caracteriza por \\(\\mathbf{ x}_i=(1, x_{i1}, \\ldots, x_{ik})^{\\prime}\\) con la pérdida observada como una frecuencia \\(y_i\\). Luego, partiendo de (8.16) y @ref(eq: mean-ft-Pois-7), la función log-verosimilitud del vector\\(\\beta=(\\beta_0, \\dots, \\beta_k)\\) viene dada por \\[\\begin{align} \\nonumber \\log L(\\beta) &amp;= l(\\beta)=\\sum^n_{i=1} \\left( -\\mu_i +y_i \\, \\log \\mu_i -\\log y_i! \\right) \\\\ &amp; = \\sum^n_{i=1} \\left( -m_i \\exp(\\mathbf{ x}^{\\prime}_i\\beta) +y_i \\,(\\log m_i+\\mathbf{ x}^{\\prime}_i\\beta) -\\log y_i! \\right) \\tag{8.23} \\end{align}\\] Para obtener la mle de \\(\\beta=(\\beta_0, \\ldots, \\beta_k)^{\\prime}\\), diferenciamos12 \\(l(\\beta)\\) respecto al vector \\(\\beta\\) e igualamos a cero: \\[\\begin{equation} \\frac{\\partial}{\\partial \\beta}l(\\beta)\\Bigg{|}_{\\beta=\\mathbf{b}}=\\sum^n_{i=1} \\left(y_i -m_i \\exp(\\mathbf{ x}^{\\prime}_i \\mathbf{ b}) \\right)\\mathbf{ x}_i=\\mathbf{ 0}. \\tag{8.24} \\end{equation}\\] Solucionando numéricamente este sistema de ecuaciones obtenemos la mle de \\(\\beta\\), denotada como \\(\\mathbf{ b}=(b_0, b_1, \\ldots, b_k)^{\\prime}\\). Es importante ver que, como \\(\\mathbf{ x}_i=(1, x_{i1}, \\ldots, x_{ik})^{\\prime}\\) es un vector columna, la ecuación (8.24) es un sistema con \\(k+1\\) ecuaciones donde ambos lados están escritos como un vector columna de dimensión \\(k+1\\). Si denotamos \\(\\hat{\\mu}_i=m_i \\exp(\\mathbf{ x}^{\\prime}_i \\mathbf{ b})\\), podemos escribir (8.24) como \\[\\begin{equation} \\sum^n_{i=1} \\left(y_i -\\hat{\\mu}_i \\right)\\mathbf{ x}_i=\\mathbf{ 0}. \\end{equation}\\] Dado que la solución \\(\\mathbf{ b}\\) satisface esta ecuación, se deduce que la primera de las \\(k+1\\) ecuaciones, que corresponde al primer elemento constante de \\(\\mathbf{ x}_i\\), implica que \\[\\begin{equation} \\sum^n_{i=1}\\left( y_i -\\hat{\\mu}_i \\right)\\times 1={ 0}, \\end{equation}\\] lo que implica que tenemos \\[\\begin{equation} n^{-1}\\sum_{i=1}^n y_i =\\bar{y}=n^{-1}\\sum_{i=1}^n \\hat{\\mu}_i. \\end{equation}\\] Esta es una propiedad interesante que dice que el promedio de las pérdidas individuales observadas, \\(\\bar{y}\\), es el mismo que el promedio de los valores estimados. Es decir, la media muestral se conserva bajo el modelo de regresión de Poisson ajustado. Estimación por Máxima Verosimilitud con Datos Agrupados Algunas veces los datos no están disponibles a nivel de póliza individual. Por ejemplo, la [Tabla 8.2] proporciona información sobre pérdidas colectivas para cada clase de riesgo después de agrupar pólizas individuales. Cuando este es el caso, \\(y_i\\) y \\(m_i\\), las cantidades necesarias para el cálculo de la mle en (8.24) no están disponibles para cada \\(i\\). Sin embargo, esto no plantea un problema siempre que tengamos los recuentos de pérdidas totales y la exposición total para cada clase de riesgo. Para ver el detalle, supongamos que hay \\(K\\) diferentes clases de riesgo, y además que, en la clase de riesgo \\(k\\)-ésima, tenemos \\(n_k\\) pólizas con la exposición total \\(m_{(k)}\\) y el promedio pérdidas \\(\\bar{y}_{(k)}\\), para \\(k = 1, \\ldots, K\\); el recuento total de pérdidas para la clase de riesgo \\(k\\)-ésima es entonces \\(n_k \\, \\bar {y} _ {(k)}\\). Denotamos el conjunto de índices de las pólizas que pertenecen a la clase \\(k\\)-ésima para \\(C_k\\). Como todas las pólizas en una clase de riesgo dada comparten las mismas características de riesgo, podemos denotar \\(\\mathbf{x} _i = \\mathbf{x} _{(k)}\\) para las pólizas \\(i \\in C_k\\). Con esta notación, podemos reescribir (8.24) como \\[\\begin{align} \\nonumber \\sum^n_{i=1} \\left(y_i -m_i \\exp(\\mathbf{ x}^{\\prime}_i \\mathbf{ b}) \\right)\\mathbf{ x}_i &amp;= \\sum^K_{k=1}\\Big{\\{}\\sum_{i \\in C_k} \\left(y_i -m_i \\exp(\\mathbf{ x}^{\\prime}_i \\mathbf{ b}) \\right)\\mathbf{ x}_i \\Big{\\}} \\\\ \\nonumber &amp; =\\sum^K_{k=1}\\Big{\\{} \\sum_{i \\in C_k} \\left(y_i -m_i \\exp(\\mathbf{ x}^{\\prime}_{(k)} \\mathbf{ b}) \\right)\\mathbf{ x}_{(k)} \\Big{\\}} \\\\ \\nonumber &amp; =\\sum^K_{k=1}\\Big{\\{} \\Big(\\sum_{i \\in C_k}y_i -\\sum_{i \\in C_k}m_i \\exp(\\mathbf{ x}^{\\prime}_{(k)} \\mathbf{ b}) \\Big)\\mathbf{ x}_{(k)} \\Big{\\}} \\\\ &amp; =\\sum^K_{k=1} \\Big(n_k\\, \\bar{y}_{(k)}-m_{(k)} \\exp(\\mathbf{ x}^{\\prime}_{(k)} \\mathbf{ b}) \\Big)\\mathbf{ x}_{(k)} =0. \\tag{8.25} \\end{align}\\] Como \\(n_k \\, \\bar{y}_{(k)}\\) en (8.25) representa el recuento total de pérdidas para la clase de riesgo \\(k\\)-ésima y \\(m_{( k)}\\) es su exposición total, vemos que para la regresión de Poisson la mle de \\(\\mathbf {b}\\) es el misma si usamos los datos individuales o los datos agrupados. Matriz de Información La Sección 16.1 define las matrices de información. Tomando las segundas derivadas en (8.23) proporciona la matriz de información de los estimadores mle, \\[\\begin{equation} \\mathbf{ I}(\\beta)=-\\mathrm{E~}{\\left( \\frac{\\partial^2}{\\partial \\beta\\partial \\beta^{\\prime}}l(\\beta) \\right)}=\\sum^n_{i=1}m_i \\exp(\\mathbf{ x}^{\\prime}_i \\mathbf{ \\beta})\\mathbf{ x}_i \\mathbf{ x}_i^{\\prime}=\\sum^n_{i=1} {\\mu}_i \\mathbf{ x}_i \\mathbf{ x}_i^{\\prime}. \\tag{8.26} \\end{equation}\\] Para conjuntos de datos individuales, \\({\\mu}_i\\) en (8.26) se reemplaza por \\(\\hat{\\mu}_i=m_i \\exp(\\mathbf{ x}^{\\prime}_i \\mathbf{ b})\\) para estimar las varianzas y covarianzas relevantes de los estimadores mle \\(\\mathbf{ b}\\) o sus funciones. Para conjuntos de datos agrupados, tenemos \\[\\begin{equation} \\mathbf{ I}(\\beta)=\\sum^K_{k=1} \\Big{\\{}\\sum_{i \\in C_k}m_i \\exp(\\mathbf{ x}^{\\prime}_i \\mathbf{ \\beta})\\mathbf{ x}_i \\mathbf{ x}_i^{\\prime} \\Big{\\}}=\\sum^K_{k=1} m_{(k)} \\exp(\\mathbf{ x}^{\\prime}_{(k)} \\mathbf{ \\beta})\\mathbf{ x}_{(k)} \\mathbf{ x}_{(k)}^{\\prime}. \\end{equation}\\] Bibliography "],
["C-Credibility.html", "Chapter 9 Experience Rating Using Credibility Theory 9.1 Introduction to Applications of Credibility Theory 9.2 Limited Fluctuation Credibility 9.3 Bühlmann Credibility 9.4 Bühlmann-Straub Credibility 9.5 Bayesian Inference and Bühlmann Credibility 9.6 Estimating Credibility Parameters 9.7 Further Resources and Contributors", " Chapter 9 Experience Rating Using Credibility Theory Chapter Preview. This chapter introduces credibility theory which is an important actuarial tool for estimating pure premiums, frequencies, and severities for individual risks or classes of risks. Credibility theory provides a convenient framework for combining the experience for an individual risk or class with other data to produce more stable and accurate estimates. Several models for calculating credibility estimates will be discussed including limited fluctuation, Bühlmann, Bühlmann-Straub, and nonparametric and semiparametric credibility methods. The chapter will also show a connection between credibility theory and Bayesian estimation which was introduced in Chapter 4. 9.1 Introduction to Applications of Credibility Theory What premium should be charged to provide insurance? The answer depends upon the exposure to the risk of loss. A common method to compute an insurance premium is to rate an insured using a classification rating plan. A classification plan is used to select an insurance rate based on an insured’s rating characteristics such as geographic territory, age, etc. All classification rating plans use a limited set of criteria to group insureds into a “class” and there will be variation in the risk of loss among insureds within the class. An experience rating plan attempts to capture some of the variation in the risk of loss among insureds within a rating class by using the insured’s own loss experience to complement the rate from the classification rating plan. One way to do this is to use a credibility weight \\(Z\\) with \\(0\\leq Z \\leq 1\\) to compute \\[\\begin{equation*} \\hat{R}=Z\\bar{X}+(1-Z)M, \\end{equation*}\\] \\[\\begin{eqnarray*} \\hat{R}&amp;=&amp;\\textrm{credibility weighted rate for risk,}\\\\ \\bar{X}&amp;=&amp;\\textrm{average loss for the risk over a specified time period,}\\\\ M&amp;=&amp;\\textrm{the rate for the classification group, often called the manual rate.}\\\\ \\end{eqnarray*}\\] For a risk whose loss experience is stable from year to year, \\(Z\\) might be close to 1. For a risk whose losses vary widely from year to year, \\(Z\\) may be close to 0. Credibility theory is also used for computing rates for individual classes within a classification rating plan. When classification plan rates are being determined, some or many of the groups may not have sufficient data to produce stable and reliable rates. The actual loss experience for a group will be assigned a credibility weight \\(Z\\) and the complement of credibility \\(1-Z\\) may be given to the average experience for risks across all classes. Or, if a class rating plan is being updated, the complement of credibility may be assigned to the current class rate. Credibility theory can also be applied to the calculation of expected frequencies and severities. Computing numeric values for \\(Z\\) requires analysis and understanding of the data. What are the variances in the number of losses and sizes of losses for risks? What is the variance between expected values across risks? Show Quiz Solution 9.2 Limited Fluctuation Credibility In this section, you learn how to: Calculate full credibility standards for number of claims, average size of claims, and aggregate losses. Learn how the relationship between means and variances of underlying distributions affects full credibility standards. Determine credibility-weight \\(Z\\) using the square-root partial credibility formula. Limited fluctuation credibility, also called “classical credibility”, was given this name because the method explicitly attempts to limit fluctuations in estimates for claim frequencies, severities, or losses. For example, suppose that you want to estimate the expected number of claims \\(N\\) for a group of risks in an insurance rating class. How many risks are needed in the class to ensure that a specified level of accuracy is attained in the estimate? First the question will be considered from the perspective of how many claims are needed. 9.2.1 Full Credibility for Claim Frequency Let \\(N\\) be a random variable representing the number of claims for a group of risks, for example, risks within a particular rating classification. The observed number of claims will be used to estimate \\(\\mu_N=\\mathrm{E}[N]\\), the expected number of claims. How big does \\(\\mu_N\\) need to be to get a good estimate? One way to quantify the accuracy of the estimate would be a statement like: ``The observed value of \\(N\\) should be within 5\\(\\%\\) of \\(\\mu_N\\) at least 90\\(\\%\\) of the time.\" Writing this as a mathematical expression would give \\(\\Pr[0.95\\mu_N\\leq N \\leq1.05\\mu_N] \\geq 0.90\\). Generalizing this statement by letting \\(k\\) replace 5\\(\\%\\) and probability \\(p\\) replace 0.90 gives the equation \\[\\begin{equation} \\Pr[(1-k)\\mu_N\\leq N \\leq(1+k)\\mu_N] \\geq p. \\tag{9.1} \\end{equation}\\] The expected number of claims required for the probability on the left-hand side of (9.1) to equal \\(p\\) is called the full credibility standard. If the expected number of claims is greater than or equal to the full credibility standard then full credibility can be assigned to the data so \\(Z=1\\). Usually the expected value \\(\\mu_N\\) is not known so full credibility will be assigned to the data if the actual observed number of claims \\(n\\) is greater than or equal to the full credibility standard. The \\(k\\) and \\(p\\) values must be selected and the actuary may rely on experience, judgment, and other factors in making the choices. Subtracting \\(\\mu_N\\) from each term in (9.1) and dividing by the standard deviation \\(\\sigma_N\\) of \\(N\\) gives \\[\\begin{equation} \\Pr\\left[\\frac{-k\\mu_N}{\\sigma_N}\\leq \\frac{N-\\mu_N}{\\sigma_N} \\leq \\frac{k\\mu_N}{\\sigma_N}\\right] \\geq p. \\tag{9.2} \\end{equation}\\] In limited fluctuation credibility the standard normal distribution is used to approximate the distribution for \\((N-\\mu_N)/\\sigma_N\\). If \\(N\\) is the sum of many claims from a large group of similar risks and the claims are independent, then the approximation may be reasonable. Let \\(y_p\\) be the value such that \\(\\Pr[-y_p\\leq (N-\\mu_N)/\\sigma_N \\leq y_p]=\\Phi(y_p)-\\Phi(-y_p)=p\\) where \\(\\Phi( )\\) is the cumulative distribution function of the standard normal. Because \\(\\Phi(-y_p)=1-\\Phi(y_p)\\), the equality can be rewritten as \\(2\\Phi(y_p)-1=p\\). Solving for \\(y_p\\) gives \\(y_p=\\Phi^{-1}((p+1)/2)\\) where \\(\\Phi^{-1}( )\\) is the inverse of \\(\\Phi( )\\). Equation (9.2) will be satisfied if \\(k\\mu_N/\\sigma_N \\geq y_p\\) assuming the normal approximation. First we will consider this inequality for the case when \\(N\\) has a Poisson distribution: \\(\\Pr[N=n] = \\lambda^n\\textrm{e}^{-\\lambda}/n!\\). Because \\(\\lambda=\\mu_N=\\sigma_N^2\\) for the Poisson, taking square roots yields \\(\\mu_N^{1/2}=\\sigma_N\\). So, \\(k\\mu_N/\\mu_N^{1/2} \\geq y_p\\) which is equivalent to \\(\\mu_N \\geq (y_p/k)^2\\). Let’s define \\(\\lambda_{kp}\\) to be the value of \\(\\mu_N\\) for which equality holds. Then the full credibility standard for the Poisson distribution is \\[\\begin{equation} \\lambda_{kp} = \\left(\\frac{y_p}{k}\\right)^2 \\textrm{with } y_p=\\Phi^{-1}((p+1)/2). \\tag{9.3} \\end{equation}\\] If the expected number of claims \\(\\mu_N\\) is greater than or equal to \\(\\lambda_{kp}\\) then equation (9.1) is assumed to hold and full credibility can be assigned to the data. As noted previously, because \\(\\mu_N\\) is usually unknown, full credibility is given if the observed number of claims \\(n\\) satisfies \\(n \\geq \\lambda_{kp}.\\) Example 9.2.1. The full credibility standard is set so that the observed number of claims is to be within 5% of the expected value with probability \\(p=0.95\\). If the number of claims has a Poisson distribution find the number of claims needed for full credibility. Show Example Solution Solution Referring to a normal table, \\(y_p=\\Phi^{-1}((p+1)/2)=\\Phi^{-1}((0.95+1)/2)\\)=\\(\\Phi^{-1}(0.975)=1.960\\). Using this value and \\(k=.05\\) then \\(\\lambda_{kp} = (y_p/k)^{2}=(1.960/0.05)^{2}=1,536.64\\). After rounding up the full credibility standard is 1,537. If claims are not Poisson distributed then equation (9.2) does not imply (9.3). Setting the upper bound of \\((N-\\mu_N)/\\sigma_N\\) in (9.2) equal to \\(y_p\\) gives \\(k\\mu_N/\\sigma_N=y_p\\). Squaring both sides and moving everything to the right side except for one of the \\(\\mu_N\\)’s gives \\(\\mu_N=(y_p/k)^2(\\sigma_N^2/\\mu_N)\\). This is the full credibility standard for frequency and will be denoted by \\(n_f\\), \\[\\begin{equation} n_f=\\left(\\frac{y_p}{k}\\right)^2\\left(\\frac{\\sigma_N^2}{\\mu_N}\\right)=\\lambda_{kp}\\left(\\frac{\\sigma_N^2}{\\mu_N}\\right). \\tag{9.4} \\end{equation}\\] This is the same equation as the Poisson full credibility standard except for the \\((\\sigma_N^2/\\mu_N)\\) multiplier. When the claims distribution is Poisson this extra term is one because the variance equals the mean. Example 9.2.2. The full credibility standard is set so that the total number of claims is to be within 5\\(\\%\\) of the observed value with probability \\(p=0.95\\). The number of claims has a negative binomial distribution \\[\\begin{equation*} \\Pr(N=x)={x+r-1\\choose x} \\left(\\frac{1}{1+\\beta}\\right)^r \\left(\\frac{\\beta}{1+\\beta}\\right)^x \\end{equation*}\\] with \\(\\beta=1\\). Calculate the full credibility standard. Show Example Solution Solution From the prior example, \\(\\lambda_{kp} =1,536.64\\). The mean and variance for the negative binomial are \\(\\mathrm{E}(N)=r\\beta\\) and \\(\\mathrm{Var}(N)=r\\beta(1+\\beta)\\) so \\((\\sigma_N^2/\\mu_N)=(r\\beta(1+\\beta)/(r\\beta))=1+\\beta\\) which equals 2 when \\(\\beta=1\\). So, \\(n_f=\\lambda_{kp}(\\sigma_N^2/\\mu_N)=1,536.64(2)=3,073.28\\) and rounding up gives a full credibility standard of 3,074. We see that the negative binomial distribution with \\((\\sigma_N^2/\\mu_N)&gt;1\\) requires more claims for full credibility than a Poisson distribution for the same \\(k\\) and \\(p\\) values. The next example shows that a binomial distribution which has \\((\\sigma_N^2/\\mu_N)&lt;1\\) will need fewer claims for full credibility. Example 9.2.3. The full credibility standard is set so that the total number of claims is to be within 5\\(\\%\\) of the observed value with probability \\(p=0.95\\). The number of claims has a binomial distribution \\[\\begin{equation*} \\Pr(N=x)={m\\choose x}q^x(1-q)^{m-x}. \\end{equation*}\\] Calculate the full credibility standard for \\(q=1/4\\). Show Example Solution Solution From the first example in this section \\(\\lambda_{kp} =1,536.64\\). The mean and variance for a binomial are \\(\\mathrm{E}(N)=mq\\) and \\(\\mathrm{Var}(N)=mq(1-q)\\) so \\((\\sigma_N^2/\\mu_N)=(mq(1-q)/(mq))=1-q\\) which equals 3/4 when \\(q=1/4\\). So, \\(n_f=\\lambda_{kp}(\\sigma_N^2/\\mu_N)=1,536.64(3/4)=1,152.48\\) and rounding up gives a full credibility standard of 1,153. Rather than using expected number of claims to define the full credibility standard, the number of exposures can be used for the full credibility standard. An exposure is a measure of risk. For example, one car insured for a full year would be one car-year. Two cars each insured for exactly one-half year would also result in one car-year. Car-years attempt to quantify exposure to loss. Two car-years would be expected to generate twice as many claims as one car-year if the vehicles have the same risk of loss. To translate a full credibility standard denominated in terms of number of claims to a full credibility standard denominated in exposures one needs a reasonable estimate of the expected number of claims per exposure. Example 9.2.4. The full credibility standard should be selected so that the observed number of claims will be within 5\\(\\%\\) of the expected value with probability \\(p=0.95\\). The number of claims has a Poisson distribution. If one exposure is expected to have about 0.20 claims per year, find the number of exposures needed for full credibility. Show Example Solution Solution With \\(p=0.95\\) and \\(k=.05\\), \\(\\lambda_{kp} = (y_p/k)^{2}=(1.960/0.05)^{2}=1,536.64\\) claims are required for full credibility. The claims frequency rate is 0.20 claims/exposures. To convert the full credibility standard to a standard denominated in exposures the calculation is: (1,536.64 claims)/(0.20 claims/exposures) = 7,683.20 exposures. This can be rounded up to 7,684. Frequency can be defined as the number of claims per exposure. Letting \\(m\\) represent number of exposures then the observed claim frequency is \\(N/m\\) which is used to estimate \\(\\mathrm{E}(N/m)\\): \\[\\begin{equation*} \\Pr[(1-k)\\mathrm{E}(N/m)\\leq N/m \\leq(1+k)\\mathrm{E}(N/m)] \\geq p. \\end{equation*}\\] Because the number of exposures is not a random variable, \\(\\mathrm{E}(N/m)=\\mathrm{E}(N)/m=\\mu_N/m\\) and the prior equation becomes \\[\\begin{equation*} \\Pr\\left[(1-k)\\frac{\\mu_N}{m}\\leq \\frac{N}{m} \\leq(1+k)\\frac{\\mu_N}{m}\\right] \\geq p. \\end{equation*}\\] Multiplying through by \\(m\\) results in equation (9.1) at the beginning of the section. The full credibility standards that were developed for estimating expected number of claims also apply to frequency. 9.2.2 Full Credibility for Aggregate Losses and Pure Premium Aggregate losses are the total of all loss amounts for a risk or group of risks. Letting \\(S\\) represent aggregate losses then \\[\\begin{equation*} S=X_1+X_2+\\cdots+X_N. \\end{equation*}\\] The random variable \\(N\\) represents the number of losses and random variables \\(X_1, X_2,\\ldots,X_N\\) are the individual loss amounts. In this section it is assumed that \\(N\\) is independent of the loss amounts and that \\(X_1, X_2,\\ldots,X_N\\) are iid. The mean and variance of \\(S\\) are \\[\\begin{equation*} \\mu_S=\\mathrm{E}(S)=\\mathrm{E}(N)\\mathrm{E}(X)=\\mu_N\\mu_X\\textrm{ and} \\end{equation*}\\] \\[\\begin{equation*} \\sigma^{2}_S=\\mathrm{Var}(S)=\\mathrm{E}(N)\\mathrm{Var}(X)+[\\mathrm{E}(X)]^{2}\\mathrm{Var}(N)=\\mu_N\\sigma^{2}_X+\\mu^{2}_X\\sigma^{2}_N. \\end{equation*}\\] where \\(X\\) is the amount of a single loss. Observed losses \\(S\\) will be used to estimate expected losses \\(\\mu_S=\\mathrm{E}(S)\\). As with the frequency model in the previous section, the observed losses must be close to the expected losses as quantified in the equation \\[\\begin{equation*} \\Pr[(1-k)\\mu_S\\leq S \\leq(1+k)\\mu_S] \\geq p. \\end{equation*}\\] After subtracting the mean and dividing by the standard deviation, \\[\\begin{equation*} \\Pr\\left[\\frac{-k\\mu_S}{\\sigma_S}\\leq (S-\\mu_S)/\\sigma_S \\leq \\frac{k\\mu_S}{\\sigma_S}\\right] \\geq p \\end{equation*}\\]. As done in the previous section the distribution for \\((S-\\mu_S)/\\sigma_S\\) is assumed to be normal and \\(k\\mu_S/\\sigma_S=y_p=\\Phi^{-1}((p+1)/2)\\). This equation can be rewritten as \\(\\mu_S^2=(y_p/k)^2\\sigma_S^2\\). Using the prior formulas for \\(\\mu_S\\) and \\(\\sigma_{S}^2\\) gives \\((\\mu_N\\mu_X)^2=(y_p/k)^2(\\mu_N\\sigma^{2}_X+\\mu^{2}_X\\sigma^{2}_N)\\). Dividing both sides by \\(\\mu_N\\mu_X^2\\) and reordering terms on the right side results in a full credibility standard \\(n_S\\) for aggregate losses \\[\\begin{equation} n_S=\\left(\\frac{y_p}{k}\\right)^2\\left[\\left(\\frac{\\sigma_N^2}{\\mu_N}\\right)+\\left(\\frac{\\sigma_X}{\\mu_X}\\right)^2\\right]=\\lambda_{kp}\\left[\\left(\\frac{\\sigma_N^2}{\\mu_N}\\right)+\\left(\\frac{\\sigma_X}{\\mu_X}\\right)^2\\right]. \\tag{9.5} \\end{equation}\\] Example 9.2.5. The number of claims has a Poisson distribution. Individual loss amounts are independently and identically distributed with a Type II Pareto distribution \\(F(x)=1-[\\theta/(x+\\theta)]^{\\alpha}\\). The number of claims and loss amounts are independent. If observed aggregate losses should be within 5\\(\\%\\) of the expected value with probability \\(p=0.95\\), how many losses are required for full credibility? Show Example Solution Solution Because the number of claims is Poisson, \\((\\sigma_N^2/\\mu_N)=1\\). The mean of the Pareto is \\(\\mu_X=\\theta/(\\alpha-1)\\) and the variance is \\(\\sigma_X^2=\\theta^{2}\\alpha/[(\\alpha-1)^{2}(\\alpha-2)]\\) so \\((\\sigma_X/\\mu_X)^2=\\alpha/(\\alpha-2)\\). Combining the frequency and severity terms gives \\([(\\sigma_N^2/\\mu_N)+(\\sigma_X/\\mu_X)^2]=2(\\alpha-1)/(\\alpha-2)\\). From a normal table \\(y_p=\\Phi^{-1}((0.95+1)/2)=1.960\\). The full credibility standard is \\(n_S=(1.96/0.05)^{2}[2(\\alpha-1)/(\\alpha-2)]=3,073.28(\\alpha-1)/(\\alpha-2)\\). Suppose \\(\\alpha=3\\) then \\(n_S=6,146.56\\) for a full credibility standard of 6,147. Note that considerably more claims are needed for full credibility for aggregate losses than frequency alone. When the number of claims is Poisson distributed then equation (9.5) can be simplified using \\((\\sigma_N^2/\\mu_N)=1\\). It follows that \\([(\\sigma_N^2/\\mu_N)+(\\sigma_X/\\mu_X)^2]=[1+(\\sigma_X/\\mu_X)^2]=[(\\mu_X^2+\\sigma_X^2)/\\mu_X^2]=\\mathrm{E}(X^2)/\\mathrm{E}(X)^2\\) using the relationship \\(\\mu_X^2+\\sigma_X^2=\\mathrm{E}(X^2)\\). The full credibility standard is \\(n_S=\\lambda_{kp}\\mathrm{E}(X^2)/\\mathrm{E}(X)^2\\). The pure premium \\(PP\\) is equal to aggregate losses \\(S\\) divided by exposures \\(m\\): \\(PP=S/m\\). The full credibility standard for pure premium will require \\[\\begin{equation*} \\Pr\\left[(1-k)\\mu_{PP}\\leq PP \\leq(1+k)\\mu_{PP}\\right] \\geq p. \\end{equation*}\\] The number of exposures \\(m\\) is assumed fixed and not a random variable so \\(\\mu_{PP}=\\mathrm{E}(S/m)=\\mathrm{E}(S)/m=\\mu_S/m\\). \\[\\begin{equation*} \\Pr\\left[(1-k)\\left(\\frac{\\mu_S}{m}\\right)\\leq \\left(\\frac{S}{m}\\right) \\leq(1+k)\\left(\\frac{\\mu_S}{m}\\right)\\right] \\geq p. \\end{equation*}\\] Multiplying through by exposures \\(m\\) returns the bounds for losses \\[\\begin{equation*} \\Pr[(1-k)\\mu_S\\leq S \\leq(1+k)\\mu_S] \\geq p. \\end{equation*}\\] This means that the full credibility standard \\(n_{PP}\\) for the pure premium is the same as that for aggregate losses \\[\\begin{equation*} n_{PP}=n_S=\\lambda_{kp}\\left[\\left(\\frac{\\sigma_N^2}{\\mu_n}\\right)+\\left(\\frac{\\sigma_X}{\\mu_X}\\right)^2\\right]. \\end{equation*}\\] 9.2.3 Full Credibility for Severity Let \\(X\\) be a random variable representing the size of one claim. Claim severity is \\(\\mu_X=\\mathrm{E}(X)\\). Suppose that \\({X_1,X_2, \\ldots, X_n}\\) is a random sample of \\(n\\) claims that will be used to estimate claim severity \\(\\mu_X\\). The claims are assumed to be iid. The average value of the sample is \\[\\begin{equation*} \\bar{X}=\\frac{1}{n}\\left(X_1+X_2+\\cdots+X_n\\right). \\end{equation*}\\] How big does \\(n\\) need to be to get a good estimate? Note that \\(n\\) is not a random variable whereas it is in the aggregate loss model. In Section 9.2.1 the accuracy of an estimator for frequency was defined by requiring that the number of claims lie within a specified interval about the mean number of claims with a specified probability. For severity this requirement is \\[\\begin{equation*} \\Pr[(1-k)\\mu_X\\leq \\bar{X} \\leq(1+k)\\mu_X ]\\geq p \\end{equation*}\\] where \\(k\\) and \\(p\\) need to be specified. Following the steps in Section 9.2.1, the mean claim severity \\(\\mu_X\\) is subtracted from each term and the standard deviation of the claim severity estimator \\(\\sigma_{\\bar{X}}\\) is divided into each term yielding \\[\\begin{equation*} \\Pr\\left[\\frac{-k\\mu_X}{\\sigma_{\\bar{X}}}\\leq (\\bar{X}-\\mu_X)/\\sigma_{\\bar{X}} \\leq \\frac{k\\mu_X}{\\sigma_{\\bar{X}}}\\right] \\geq p \\end{equation*}\\]. As in prior sections, it is assumed that \\((\\bar{X}-\\mu_X)/\\sigma_{\\bar{X}}\\) is approximately normally distributed and the prior equation is satisfied if \\(k\\mu_X/\\sigma_{\\bar{X}}\\geq y_p\\) with \\(y_p=\\Phi^{-1}((p+1)/2)\\). Because \\(\\bar{X}\\) is the average of individual claims \\(X_1, X_2,\\dots, X_n\\), its standard deviation is equal to the standard deviation of an individual claim divided by \\(\\sqrt{n}\\): \\(\\sigma_{\\bar{X}}=\\sigma_X/\\sqrt{n}\\). So, \\(k\\mu_X/(\\sigma_X/\\sqrt{n})\\geq y_p\\) and with a little algebra this can be rewritten as \\(n \\geq (y_p/k)^2(\\sigma_X/\\mu_X)^2\\). The full credibility standard for severity is \\[\\begin{equation} n_X=\\left(\\frac{y_p}{k}\\right)^2\\left(\\frac{\\sigma_X}{\\mu_X}\\right)^2=\\lambda_{kp}\\left(\\frac{\\sigma_X}{\\mu_X}\\right)^2. \\tag{9.6} \\end{equation}\\] Note that the term \\(\\sigma_X/\\mu_X\\) is the coefficient of variation for an individual claim. Even though \\(\\lambda_{kp}\\) is the full credibility standard for frequency given a Poisson distribution, there is no assumption about the distribution for the number of claims. Example 9.2.6. Individual loss amounts are independently and identically distributed with a Type II Pareto distribution \\(F(x)=1-[\\theta/(x+\\theta)]^{\\alpha}\\). How many claims are required for the average severity of observed claims to be within 5\\(\\%\\) of the expected severity with probability \\(p=0.95\\)? Show Example Solution Solution The mean of the Pareto is \\(\\mu_X=\\theta/(\\alpha-1)\\) and the variance is \\(\\sigma_X^2=\\theta^{2}\\alpha/[(\\alpha-1)^{2}(\\alpha-2)]\\) so \\((\\sigma_X/\\mu_X)^2=\\alpha/(\\alpha-2)\\). From a normal table \\(y_p=\\Phi^{-1}((0.95+1)/2)=1.960\\). The full credibility standard is \\(n_X=(1.96/0.05)^{2}[\\alpha/(\\alpha-2)]=1,536.64\\alpha/(\\alpha-2)\\). Suppose \\(\\alpha=3\\) then \\(n_X=4,609.92\\) for a full credibility standard of 4,610. 9.2.4 Partial Credibility In prior sections full credibility standards were calculated for estimating frequency (\\(n_f\\)), pure premium (\\(n_{PP}\\)), and severity (\\(n_X\\)) - in this section these full credibility standards will be denoted by \\(n_{0}\\). In each case the full credibility standard was the expected number of claims required to achieve a defined level of accuracy when using empirical data to estimate an expected value. If the observed number of claims is greater than or equal to the full credibility standard then a full credibility weight \\(Z=1\\) is given to the data. In limited fluctuation credibility, credibility weights \\(Z\\) assigned to data are \\[\\begin{equation*} Z=\\quad \\sqrt{\\frac{n}{n_{0}}} \\quad \\textrm{if} \\quad n &lt; n_{0} \\quad \\textrm{and} \\quad Z=\\quad 1 \\quad \\textrm{for} \\quad n \\geq n_{0} \\end{equation*}\\] where \\(n_0\\) is the full credibility standard. The quantity \\(n\\) is the number of claims for the data that is used to estimate the expected frequency, severity, or pure premium. Example 9.2.7. The number of claims has a Poisson distribution. Individual loss amounts are independently and identically distributed with a Type II Pareto distribution \\(F(x)=1-[\\theta/(x+\\theta)]^{\\alpha}\\). Assume that \\(\\alpha=3\\). The number of claims and loss amounts are independent. The full credibility standard is that the observed pure premium should be within 5\\(\\%\\) of the expected value with probability \\(p=0.95\\). What credibility \\(Z\\) is assigned to a pure premium computed from 1,000 claims? Show Example Solution Solution Because the number of claims is Poisson, \\[ \\frac{\\mathrm{E}(X^2)}{[\\mathrm{E}~(X)]^2} =\\frac{\\sigma_N^2}{\\mu_N}+\\left(\\frac{\\sigma_X}{\\mu_X}\\right)^2. \\] The mean of the Pareto is \\(\\mu_X=\\theta/(\\alpha-1)\\) and the second moment is \\(\\mathrm{E}(X^2)=2\\theta^{2}/[(\\alpha-1)(\\alpha-2)]\\) so \\(\\mathrm{E}(X^2)/[\\mathrm{E}~(X)]^2=2(\\alpha-1)/(\\alpha-2)\\). From a normal table \\(y_p=\\Phi^{-1}((0.95+1)/2)=1.960\\). The full credibility standard is \\[n_{PP}=(1.96/0.05)^{2}[2(\\alpha-1)/(\\alpha-2)]=3,073.28(\\alpha-1)/(\\alpha-2)\\] and if \\(\\alpha=3\\) then \\(n_0=n_{PP}=6,146.56\\) or 6,147 if rounded up. The credibility assigned to 1,000 claims is \\(Z=(1,000/6,147)^{1/2}=0.40\\). Limited fluctuation credibility uses the formula \\(Z=\\sqrt{n/n_0}\\) to limit the fluctuation in the credibility-weighted estimate to match the fluctuation allowed for data with expected claims at the full credibility standard. Variance or standard deviation is used as the measure of fluctuation. Next we show an example to explain why the square-root formula is used. Suppose that average claim severity is being estimated from a sample of size \\(n\\) that is less than the full credibility standard \\(n_0=n_X\\). Applying credibility theory the estimate \\(\\hat{\\mu}_X\\) would be \\[\\begin{equation*} \\hat{\\mu}_X=Z\\bar{X}+(1-Z)M_X \\end{equation*}\\] with \\(\\bar{X}=(X_1+X_2+\\cdots+X_n)/n\\) and \\(iid\\) random variables \\(X_i\\) representing the sizes of individual claims. The complement of credibility is applied to \\(M_X\\) which could be last year’s estimated average severity adjusted for inflation, the average severity for a much larger pool of risks, or some other relevant quantity selected by the actuary. It is assumed that the variance of \\(M_X\\) is zero or negligible. With this assumption \\[\\begin{equation*} \\mathrm{Var}(\\hat{\\mu}_X)=\\mathrm{Var}(Z\\bar{X})=Z^2\\mathrm{Var}(\\bar{X})=\\frac{n}{n_0}\\mathrm{Var}(\\bar{X}). \\end{equation*}\\] Because \\(\\bar{X}=(X_1+X_2+\\cdots+X_n)/n\\) it follows that \\(\\mathrm{Var}(\\bar{X})=\\mathrm{Var}(X_i)/n\\) where random variable \\(X_i\\) is one claim. So, \\[\\begin{equation*} \\mathrm{Var}(\\hat{\\mu}_X)=\\frac{n}{n_0}\\mathrm{Var}(\\bar{X})=\\frac{n}{n_0}\\frac{\\mathrm{Var}(X_i)}{n}=\\frac{\\mathrm{Var}(X_i)}{n_0}. \\end{equation*}\\] The last term is exactly the variance of a sample mean \\(\\bar{X}\\) when the sample size is equal to the full credibility standard \\(n_0=n_X\\). Show Quiz Solution 9.3 Bühlmann Credibility In this section, you learn how to: Compute a credibility-weighted estimate for the expected loss for a risk or group of risks. Determine the credibility \\(Z\\) assigned to observations. Calculate the values required in Bühlmann credibility including the Expected Value of the Process Variance (EPV), Variance of the Hypothetical Means (VHM) and collective mean \\(\\mu\\). Recognize situations when the Bühlmann model is appropriate. A classification rating plan groups policyholders together into classes based on risk characteristics. Although policyholders within a class have similarities, they are not identical and their expected losses will not be exactly the same. An experience rating plan can supplement a class rating plan by credibility weighting an individual policyholder’s loss experience with the class rate to produce a more accurate rate for the policyholder. In the presentation of Buhlmann credibility it is convenient to assign a risk parameter \\(\\theta\\) to each policyholder. Losses \\(X\\) for the policyholder will have a common distribution function \\(F_{\\theta}(x)\\) with mean \\(\\mu(\\theta)=\\mathrm{E}(X|\\theta)\\) and variance \\(\\sigma^2(\\theta)=\\mathrm{Var}(X|\\theta)\\). Losses \\(X\\) can represent pure premiums, aggregate losses, number of claims, claim severities, or some other measure of loss for a period of time, often one year. Risk parameter \\(\\theta\\) may be continuous or discrete and may be multivariate depending on the model. If a policyholder with risk parameter \\(\\theta\\) had losses \\(X_1, \\ldots, X_n\\) during \\(n\\) time periods then the goal is to find E(\\(\\mu(\\theta)|X_1,\\ldots, X_n)\\), the conditional expectation of \\(\\mu(\\theta)\\) given \\(X_1,\\ldots, X_n\\). The Bühlmann credibility-weighted estimate for E(\\(\\mu(\\theta)|X_1,\\ldots, X_n)\\) for the policyholder is \\[\\begin{equation} \\hat{\\mu}(\\theta)=Z\\bar{X}+(1-Z)\\mu \\tag{9.7} \\end{equation}\\] with \\[\\begin{eqnarray*} \\theta&amp;=&amp;\\textrm{a risk parameter that identifies a policyholder&#39;s risk level}\\\\ \\hat{\\mu}(\\theta)&amp;=&amp;\\textrm{estimated expected loss for a policyholder with parameter }\\theta\\\\ &amp; &amp; \\textrm{and loss experience } \\bar{X}\\\\ \\bar{X}&amp;=&amp;(X_1+\\cdots+X_n)/n \\textrm{ is the average of $n$ observations of the policyholder } \\\\ Z&amp;=&amp;\\textrm{credibility assigned to $n$ observations } \\\\ \\mu&amp;=&amp;\\textrm{the expected loss for a randomly chosen policyholder in the class.}\\\\ \\end{eqnarray*}\\] For a selected policyholder, random variables \\(X_j\\) are assumed to be iid for \\(j=1,\\ldots,n\\) because it is assumed that the policyholder’s exposure to loss is not changing through time. The quantity \\(\\bar{X}\\) is the average of \\(n\\) observations and \\(\\mathrm{E}(\\bar{X}|\\theta)=\\mathrm{E}(X_j|\\theta)=\\mu(\\theta)\\). If a policyholder is randomly chosen from the class and there is no loss information about the risk then the expected loss is \\(\\mu=\\mathrm{E}(\\mu(\\theta))\\) where the expectation is taken over all \\(\\theta\\)’s in the class. In this situation \\(Z=0\\) and the expected loss is \\(\\hat\\mu(\\theta)=\\mu\\) for the risk. The quantity \\(\\mu\\) can also be written as \\(\\mu=\\mathrm{E}(X_j)\\) or \\(\\mu=\\mathrm{E}(\\bar{X})\\) and is often called the overall mean or collective mean. Note that E(\\(X_j\\)) is evaluated with the law of total expectation: E(\\(X_j\\))=E(E(\\(X_j|\\theta)\\)). Example 9.3.1. The number of claims \\(X\\) for an insured in a class has a Poisson distribution with mean \\(\\theta&gt;0\\). The risk parameter \\(\\theta\\) is exponentially distributed within the class with pdf \\(f(\\theta)=e^{-\\theta}\\). What is the expected number of claims for an insured chosen at random from the class? Show Example Solution Solution Random variable \\(X\\) is Poisson with parameter \\(\\theta\\) and E\\((X|\\theta)=\\theta\\). The expected number of claims for a randomly chosen insured is \\(\\mu=\\mathrm{E}(\\mu(\\theta))=\\mathrm{E}(\\mathrm{E}(X|\\theta))=\\)E\\((\\theta)=\\int_{0}^{\\infty}\\theta e^{-\\theta} d\\theta=1\\). In the prior example the risk parameter \\(\\theta\\) is a random variable with an exponential distribution. In the next example there are three types of risks and the risk parameter has a discrete distribution. Example 9.3.2. For any risk (policyholder) in a population the number of losses \\(N\\) in a year has a Poisson distribution with parameter \\(\\lambda\\). Individual loss amounts \\(X_i\\) for a risk are independent of \\(N\\) and are iid with Type II Pareto distribution \\(F(x)=1-[\\theta/(x+\\theta)]^{\\alpha}\\). There are three types of risks in the population as follows: \\[\\begin{matrix} \\begin{array}{|c|c|c|c|} \\hline \\text{Risk } &amp; \\text{Percentage} &amp; \\text{Poisson} &amp; \\text{Pareto} \\\\ \\text{Type} &amp; \\text{of Population} &amp; \\text{Parameter} &amp; \\text{Parameters} \\\\ \\hline A &amp; 50\\% &amp; \\lambda=0.5 &amp; \\theta=1000, \\alpha=2.0 \\\\ B &amp; 30\\% &amp; \\lambda=1.0 &amp; \\theta=1500, \\alpha=2.0 \\\\ C &amp; 20\\% &amp; \\lambda=2.0 &amp; \\theta=2000, \\alpha=2.0 \\\\ \\hline \\end{array} \\end{matrix}\\] If a risk is selected at random from the population, what is the expected aggregate loss in a year? Show Example Solution Solution The expected number of claims for a risk is E(\\(N|\\lambda\\))=\\(\\lambda\\). The expected value for a Pareto distributed random variable is E(\\(X | \\theta, \\alpha\\))=\\(\\theta/(\\alpha-1)\\). The expected value of the aggregate loss random variable \\(S=X_1+\\cdots+X_N\\) for a risk with parameters \\(\\lambda\\), \\(\\alpha\\), and \\(\\theta\\) is E(\\(S\\))=E(\\(N\\))E(\\(X\\))=\\(\\lambda\\theta/(\\alpha-1)\\). The expected aggregate loss for a risk of type A is E(\\(S_{\\textrm{A}}\\))=(0.5)(1000)/(2-1)=500. The expected aggregate loss for a risk selected at random from the population is E(\\(S\\))=0.5[(0.5)(1000)]+0.3[(1.0)(1500)]+0.2[(2.0)(2000)]=1500. What is the risk parameter for a risk (policyholder) in the prior example? One could say that the risk parameter has three components \\((\\lambda,\\theta,\\alpha)\\) with possible values (0.5,1000,2.0), (1.0,1500,2.0), and (2.0,2000,2.0) depending on the type of risk. Note that in both of the examples the risk parameter is a random quantity with its own probability distribution. We do not know the value of the risk parameter for a randomly chosen risk. Although formula (9.7) was introduced using experience rating as an example, the Bühlmann credibility model has wider application. Suppose that a rating plan has multiple classes. Credibility formula (9.7) can be used to determine individual class rates. The overall mean \\(\\mu\\) would be the average loss for all classes combined, \\(\\bar{X}\\) would be the experience for the individual class, and \\(\\hat{\\mu}(\\theta)\\) would be the estimated loss for the class. 9.3.1 Credibility Z, EPV, and VHM When computing the credibility estimate \\(\\hat{\\mu}(\\theta)=Z\\bar{X}+(1-Z)\\mu\\), how much weight \\(Z\\) should go to experience \\(\\bar{X}\\) and how much weight \\((1-Z)\\) to the overall mean \\(\\mu\\)? In Bühlmann credibility there are three factors that need to be considered: How much variation is there in a single observation \\(X_j\\) for a selected risk? With \\(\\bar{X}=(X_1+\\cdots+X_n)/n\\) and assuming that the observations are iid conditional on \\(\\theta\\), it follows that Var(\\(\\bar{X}|\\theta)\\)=Var(\\(X_j|\\theta)/n\\). For larger Var(\\(\\bar{X}|\\theta)\\) less credibility weight \\(Z\\) should be given to experience \\(\\bar{X}\\). The Expected Value of the Process Variance, abbreviated EPV, is the expected value of Var(\\(X_j|\\theta\\)) across all risks: \\[\\begin{equation*} EPV=\\mathrm{E}(\\mathrm{Var}(X_j|\\theta)). \\end{equation*}\\] Because Var(\\(\\bar{X}|\\theta)\\)=Var(\\(X_j|\\theta)/n\\) it follows that E(Var(\\(\\bar{X}|\\theta)\\))=EPV/\\(n\\). How homogeneous is the population of risks whose experience was combined to compute the overall mean \\(\\mu\\)? If all the risks are similar in loss potential then more weight \\((1-Z)\\) would be given to the overall mean \\(\\mu\\) because \\(\\mu\\) is the average for a group of similar risks whose means \\(\\mu(\\theta)\\) are not far apart. The homogeneity or heterogeneity of the population is measured by the Variance of the Hypothetical Means with abbreviation VHM: \\[\\begin{equation*} VHM=\\mathrm{Var}(\\mathrm{E}(X_j|\\theta))=\\mathrm{Var}(\\mathrm{E}(\\bar{X}|\\theta)). \\end{equation*}\\] Note that we used \\(\\mathrm{E}(\\bar{X}|\\theta)=\\mathrm{E}(X_j|\\theta)\\) for the second equality. How many observations \\(n\\) were used to compute \\(\\bar{X}\\)? A larger sample would infer a larger \\(Z\\). Example 9.3.3. The number of claims \\(N\\) in a year for a risk in a population has a Poisson distribution with mean \\(\\lambda&gt;0\\). The risk parameter \\(\\lambda\\) is uniformly distributed over the interval \\((0,2)\\). Calculate the EPV and VHM for the population. Show Example Solution Solution Random variable \\(N\\) is Poisson with parameter \\(\\lambda\\) so Var\\((N|\\lambda)=\\lambda\\). The Expected Value of the Process variance is EPV=E(Var(\\(N|\\lambda\\)))=E\\((\\lambda)=\\int_{0}^{2}\\lambda \\frac{1}{2} d\\lambda=1\\). The Variance of the Hypothetical Means is VHM=Var(E(N\\(|\\lambda\\)))= Var(\\(\\lambda\\))=E(\\(\\lambda^2)-(\\mathrm{E}(\\lambda))^2=\\int_{0}^{2}\\lambda^2 \\frac{1}{2} d\\lambda-(1)^2=\\frac{1}{3}\\). The Bühlmann credibility formula includes values for \\(n\\), EPV, and VHM: \\[\\begin{equation} Z=\\frac{n}{n+K} \\quad , \\quad K =\\frac{EPV}{VHM}. \\tag{9.8} \\end{equation}\\] If the VHM increases then \\(Z\\) increases. If the EPV increases then \\(Z\\) gets smaller. Unlike limited fluctuation credibility where \\(Z=1\\) when the expected number of claims is greater than the full credibility standard, \\(Z\\) can approach but not equal 1 as the number of observations \\(n\\) goes to infinity. If you multiply the numerator and denominator of the \\(Z\\) formula by (VHM/\\(n\\)) then \\(Z\\) can be rewritten as \\[\\begin{equation*} Z=\\frac{VHM}{VHM+(EPV/n)} . \\end{equation*}\\] The number of observations \\(n\\) is captured in the term (EPV/\\(n\\)). As shown in bullet (1) at the beginning of the section, E(Var(\\(\\bar{X}|\\theta)\\))=EPV/\\(n\\). As the number of observations get larger, the expected variance of \\(\\bar{X}\\) gets smaller and credibility \\(Z\\) increases so that more weight gets assigned to \\(\\bar{X}\\) in the credibility-weighted estimate \\(\\hat{\\mu}(\\theta)\\). Example 9.3.4. Use the law of total variance to show that Var(\\(\\bar{X}\\)) = VHM + (EPV/n) and derive a formula for \\(Z\\) in terms of \\(\\bar{X}\\). Show Example Solution Solution The quantity Var(\\(\\bar{X}\\)) is called the unconditional variance or the total variance of \\(\\bar{X}\\). The law of total variance says \\[\\begin{equation*} \\mathrm{Var}(\\bar{X})=\\textrm{E(Var}(\\bar{X}|\\theta))+\\textrm{Var(E}(\\bar{X}|\\theta)). \\end{equation*}\\] In bullet (1) at the beginning of this section we showed E(Var(\\(\\bar{X}|\\theta)\\))=EPV/\\(n\\). In the second bullet (2), Var(E(\\(\\bar{X}|\\theta\\)))=VHM. Reordering the right hand side gives Var(\\(\\bar{X}\\))= VHM +(EPV/\\(n\\)). Another way to write the formula for credibility \\(Z\\) is \\(Z\\)=Var(E(\\(\\bar{X}|\\theta\\)))/Var(\\(\\bar{X}\\)). This implies \\((1-Z)\\)=E(Var(\\(\\bar{X}|\\theta\\)))/Var(\\(\\bar{X}\\)). The following long example and solution demonstrate how to compute the credibility-weighted estimate with frequency and severity data. Example 9.3.5. For any risk in a population the number of losses \\(N\\) in a year has a Poisson distribution with parameter \\(\\lambda\\). Individual loss amounts \\(X\\) for a selected risk are independent of \\(N\\) and are iid with exponential distribution \\(F(x)=1-e^{-x/\\beta}\\). There are three types of risks in the population as shown below. A risk was selected at random from the population and all losses were recorded over a five-year period. The total amount of losses over the five-year period was 5,000. Use Bühlmann credibility to estimate the annual expected aggregate loss for the risk. \\[\\begin{matrix} \\begin{array}{|c|c|c|c|} \\hline \\text{Risk } &amp; \\text{Percentage} &amp; \\text{Poisson} &amp; \\text{Exponential} \\\\ \\text{Type} &amp; \\text{of Population} &amp; \\text{Parameter} &amp; \\text{Parameter} \\\\ \\hline A &amp; 50\\% &amp; \\lambda=0.5 &amp; \\beta=1000 \\\\ B &amp; 30\\% &amp; \\lambda=1.0 &amp; \\beta=1500 \\\\ C &amp; 20\\% &amp; \\lambda=2.0 &amp; \\beta=2000 \\\\ \\hline \\end{array} \\end{matrix}\\] Show Example Solution Solution Because individual loss amounts \\(X\\) are exponentially distributed, E(\\(X| \\beta\\))=\\(\\beta\\) and Var(\\(X| \\beta\\))=\\(\\beta^2\\). For aggregate loss \\(S=X_1+\\cdots+X_N\\), the mean is E(\\(S\\))=E(\\(N\\))E(\\(X\\)) and process variance is Var(\\(S\\))=E(\\(N\\))Var(\\(X\\))+[E(\\(X\\))]\\(^2\\)Var(\\(N\\)). With Poisson frequency and exponentially distributed loss amounts, E(\\(S| \\lambda, \\beta\\))=\\(\\lambda\\beta\\) and Var(\\(S| \\lambda, \\beta\\)) = \\(\\lambda\\beta^2+\\beta^2\\lambda=2\\lambda\\beta^2\\). Population mean \\(\\mu\\): Risk means are \\(\\mu\\)(A)=0.5(1000)=500; \\(\\mu\\)(B)=1.0(1500)=1500; \\(\\mu\\)(C)=2.0(2000)=4000; and \\(\\mu\\)=0.50(500)+0.30(1500)+0.20(4000)=1,500. VHM: VHM=\\(0.50(500-1500)^2+0.30(1500-1500)^2+0.20(4000-1500)^2\\)=1,750,000. EPV: Process variances are \\(\\sigma^2(A)=2(0.5)(1000)^2=1,000,000\\); \\(\\sigma^2(B)=2(1.0)(1500)^2=4,500,000\\); \\(\\sigma^2(C)=2(2.0)(2000)^2=16,000,000\\); and EPV=0.50(1,000,000)+0.30(4,500,000)+0.20(16,000,000)=5,050,000. \\(\\mathbf{\\bar{X}}\\): \\(\\bar{X}_5=5,000/5\\)=1,000. \\(\\mathbf{K}\\): \\(K=5,050,000/1,750,000\\)=2.89. \\(\\mathbf{Z}\\): There are five years of observations so \\(n=5\\). \\(Z=5/(5+2.89)\\)=0.63. \\(\\boldsymbol{\\hat{\\mu}(\\theta)}\\): \\(\\hat{\\mu}(\\theta)=0.63(1,000)+(1-0.63)1,500=\\boxed{\\mathbf{1,185.00}}\\). In real world applications of Bühlmann credibility the value of \\(K=EPV/VHM\\) must be estimated. Sometimes a value for \\(K\\) is selected using judgment. A smaller \\(K\\) makes estimator \\(\\hat{\\mu}(\\theta)\\) more responsive to actual experience \\(\\bar{X}\\) whereas a larger \\(K\\) produces a more stable estimate by giving more weight to \\(\\mu\\). Judgment may be used to balance responsiveness and stability. A later section in this chapter will discuss methods for determining \\(K\\) from data. For a policyholder with risk parameter \\(\\theta\\), Bühlmann credibility uses a linear approximation \\(\\hat{\\mu}(\\theta)=Z\\bar{X}+(1-Z)\\mu\\) to estimate E(\\(\\mu(\\theta)|X_1,\\ldots,X_n\\)), the expected loss for the policyholder given prior losses \\(X_1,\\ldots, X_n\\). We can rewrite this as \\(\\hat{\\mu}(\\theta)=a+b\\bar{X}\\) which makes it obvious that the credibility estimate is a linear function of \\(\\bar{X}\\). If E(\\(\\mu(\\theta)|X_1,\\ldots,X_n\\)) is approximated by the linear function \\(a+b\\bar{X}\\) and constants \\(a\\) and \\(b\\) are chosen so that E[(E(\\(\\mu(\\theta)|X_1,\\ldots,X_n)-(a+b\\bar{X}))^2\\)] is minimized, what are \\(a\\) and \\(b\\)? The answer is \\(b=n/(n+K)\\) and \\(a=(1-b)\\mu\\) with \\(K=EPV/VHM\\) and \\(\\mu=E(\\mu(\\theta))\\). More details can be found in references (Bühlmann 1967), (Bühlmann and Gisler 2005), (Klugman, Panjer, and Willmot 2012), and (Tse 2009). Bühlmann credibility is also called least-squares credibility, greatest accuracy credibility, or Bayesian credibility. Show Quiz Solution 9.4 Bühlmann-Straub Credibility In this section, you learn how to: Compute a credibility-weighted estimate for the expected loss for a risk or group of risks using the Bühlmann-Straub model. Determine the credibility \\(Z\\) assigned to observations. Calculate required values including the Expected Value of the Process Variance (EPV), Variance of the Hypothetical Means (VHM) and collective mean \\(\\mu\\). Recognize situations when the Bühlmann-Straub model is appropriate. With standard Bühlmann or least-squares credibility as described in the prior section, losses \\(X_1,\\ldots,X_n\\) arising from a selected policyholder are assumed to be iid. If the subscripts indicate year 1, year 2 and so on up to year \\(n\\), then the iid assumption means that the policyholder has the same exposure to loss every year. For commercial insurance this assumption is frequently violated. Consider a commercial policyholder that uses a fleet of vehicles in its business. In year 1 there are \\(m_1\\) vehicles in the fleet, \\(m_2\\) vehicles in year 2, .., and \\(m_n\\) vehicles in year \\(n\\). The exposure to loss from ownership and use of this fleet is not constant from year to year. The annual losses for the fleet are not iid. Define \\(Y_{jk}\\) to be the loss for the \\(k^{th}\\) vehicle in the fleet for year \\(j\\). Then, the total losses for the fleet in year \\(j\\) are \\(Y_{j1}+\\cdots+Y_{jm_j}\\) where we are adding up the losses for each of the \\(m_j\\) vehicles. In the Bühlmann-Straub model it is assumed that random variables \\(Y_{jk}\\) are iid across all vehicles and years for the policyholder. With this assumption the means E(\\(Y_{jk}|\\theta)=\\mu(\\theta)\\) and variances Var(\\(Y_{jk}|\\theta)=\\sigma^2(\\theta)\\) are the same for all vehicles and years. The quantity \\(\\mu(\\theta)\\) is the expected loss and \\(\\sigma^2(\\theta)\\) is the variance in the loss for one year for one vehicle for a policyholder with risk parameter \\(\\theta\\). If \\(X_j\\) is the average loss per unit of exposure in year \\(j\\), \\(X_j=(Y_{j1}+\\cdots+Y_{jm_j})/m_j\\), then E(\\(X_j|\\theta)=\\mu(\\theta)\\) and Var(\\(X_j|\\theta)=\\sigma^2(\\theta)/m_j\\) for policyholder with risk parameter \\(\\theta\\). Note that we used the fact that the \\(Y_{jk}\\) are iid for a given policyholder. The average loss per vehicle for the entire \\(n\\)-year period is \\[\\begin{equation*} \\bar{X}= \\frac{1}{m} \\sum_{j=1}^{n} m_j X_{j} \\quad , \\quad m=\\sum_{j=1}^{n} m_j. \\end{equation*}\\] It follows that E\\((\\bar{X}|\\theta)=\\mu(\\theta)\\) and Var\\((\\bar{X}|\\theta)=\\sigma^2(\\theta)/m\\) where \\(\\mu(\\theta)\\) and \\(\\sigma^2(\\theta)\\) are the mean and variance for a single vehicle for one year for the policyholder. Example 9.4.1. Prove that Var\\((\\bar{X}|\\theta)=\\sigma^2(\\theta)/m\\) for a risk with risk parameter \\(\\theta\\). Show Example Solution Solution \\[\\begin{eqnarray*} \\mathrm{Var}(\\bar{X}|\\theta)&amp;=&amp;\\mathrm{Var}\\left(\\frac{1}{m} \\sum_{j=1}^{n} m_j X_j|\\theta \\right)\\\\ &amp;=&amp;\\frac{1}{m^2}\\sum_{j=1}^{n} \\mathrm{Var}(m_j X_{j}|\\theta)=\\frac{1}{m^2}\\sum_{j=1}^{n} m_j^2 \\mathrm{Var}(X_j|\\theta)\\\\ &amp;=&amp;\\frac{1}{m^2}\\sum_{j=1}^{n} m_j^2 (\\sigma^2(\\theta)/m_j)=\\frac{\\sigma^2(\\theta)}{m^2}\\sum_{j=1}^{n} m_j=\\sigma^2(\\theta)/m.\\\\ \\end{eqnarray*}\\] The Buhlmann-Straub credibility estimate is: \\[\\begin{equation}\\hat{\\mu}(\\theta)=Z\\bar{X}+(1-Z)\\mu \\tag{9.9} \\end{equation}\\] with \\[\\begin{eqnarray*} \\theta&amp;=&amp;\\textrm{a risk parameter that identifies a policyholder&#39;s risk level}\\\\ \\hat{\\mu}(\\theta)&amp;=&amp;\\textrm{estimated expected loss for one exposure for the policyholder}\\\\ &amp; &amp; \\textrm{with loss experience } \\bar{X}\\\\ \\bar{X}&amp;=&amp; \\frac{1}{m} \\sum_{j=1}^{n} m_j X_j \\textrm{ is the average loss per exposure for $m$ exposures.}\\\\ &amp; &amp; \\textrm{$X_j$ is the average loss per exposure and $m_j$ is the number of exposures in year $j$.} \\\\ Z&amp;=&amp;\\textrm{credibility assigned to $m$ exposures } \\\\ \\mu&amp;=&amp;\\textrm{expected loss for one exposure for randomly chosen}\\\\ &amp; &amp; \\textrm{ policyholder from population.}\\\\ \\end{eqnarray*}\\] Note that \\(\\hat{\\mu}(\\theta)\\) is the estimator for the expected loss for one exposure. If the policyholder has \\(m_j\\) exposures then the expected loss is \\(m_j\\hat{\\mu}(\\theta)\\). In an example in the prior section it was shown that \\(Z\\)=Var(E(\\(\\bar{X}|\\theta\\)))/Var(\\(\\bar{X}\\)) where \\(\\bar{X}\\) is the average loss for \\(n\\) observations. In equation (9.9) the \\(\\bar{X}\\) is the average loss for \\(m\\) exposures and the same \\(Z\\) formula can be used: \\[ Z=\\frac{\\mathrm{Var}(\\mathrm{E}(\\bar{X}|\\theta))}{\\mathrm{Var}(\\bar{X})}= \\frac{\\mathrm{Var}(\\mathrm{E}(\\bar{X}|\\theta))}{\\mathrm{E}(\\mathrm{Var}(\\bar{X}|\\theta))+\\mathrm{Var}(\\mathrm{E}(\\bar{X}|\\theta))}. \\] The denominator was expanded using the law of total variance. As noted above \\(\\mathrm{E}(\\bar{X}|\\theta)=\\mu(\\theta)\\) so \\(\\mathrm{Var}(\\mathrm{E}(\\bar{X}|\\theta))=\\mathrm{Var}(\\mu(\\theta))=VHM\\). Because Var\\((\\bar{X}|\\theta)=\\sigma^2(\\theta)/m\\) it follows that E(Var(\\(\\bar{X}|\\theta\\)))=E(\\(\\sigma^2(\\theta))/m\\)=EPV/m. Making these substitutions and a little algebra gives \\[\\begin{equation} Z=\\frac{m}{m+K} \\quad , \\quad K =\\frac{EPV}{VHM}. \\tag{9.10} \\end{equation}\\] This is the same \\(Z\\) as for Bühlmann credibility except number of exposures \\(m\\) replaces number of years or observations \\(n\\). Example 9.4.2. A commercial automobile policyholder had the following exposures and claims over a three-year period: \\[\\begin{matrix} \\begin{array}{|c|c|c|} \\hline \\text{Year} &amp; \\text{Number of Vehicles} &amp; \\text{Number of Claims} \\\\ \\hline 1 &amp; 9 &amp; 5 \\\\ 2 &amp; 12 &amp; 4 \\\\ 3 &amp; 15 &amp; 4 \\\\ \\hline \\end{array} \\end{matrix}\\] The number of claims in a year for each vehicle in the policyholder’s fleet is Poisson distributed with the same mean (parameter) \\(\\lambda\\). Parameter \\(\\lambda\\) is distributed among the policyholders in the population with pdf \\(f(\\lambda)=6\\lambda(1-\\lambda)\\) with \\(0&lt;\\lambda&lt;1\\). The policyholder has 18 vehicles in its fleet in year 4. Use Bühlmann-Straub credibility to estimate the expected number of policyholder claims in year 4. Show Example Solution Solution The expected number of claims for one vehicle for a randomly chosen policyholder is \\(\\mu=\\mathrm{E}(\\lambda)=\\int_{0}^{1} \\lambda[6\\lambda(1-\\lambda)] d\\lambda=1/2\\). The average number of claims per vehicle for the policyholder is \\(\\bar{X}\\)=13/36. The Expected Value of the Process Variance for a single vehicle is EPV=E(\\(\\lambda)=1/2\\). The Variance of the Hypothetical Means across policyholders is VHM=Var(\\(\\lambda\\))=E(\\(\\lambda^2\\))-\\((\\mathrm{E}(\\lambda))^2=\\int_{0}^{1} \\lambda^2[6\\lambda(1-\\lambda)] d\\lambda-(1/2)^2=(3/10)-(1/4)=(6/20)-(5/20)=1/20\\). So, \\(K\\)=EPV/VHM=(1/2)/(1/20)=10. The number of exposures in the experience period is \\(m=9+12+15=36\\). The credibility is \\(Z=36/(36+10)=18/23\\). The credibility-weighted estimate for the number of claims for one vehicle is \\(\\hat{\\mu}(\\theta)=Z\\bar{X}+(1-Z)\\mu\\)=(18/23)(13/36)+(5/23)(1/2)=9/23. With 18 vehicles in the fleet in year 4 the expected number of claims is 18(9/23)=162/23=7.04 . 9.5 Bayesian Inference and Bühlmann Credibility In this section, you learn how to: Use Bayes Theorem to determine a formula for the expected loss of a risk given a likelihood and prior distribution. Determine the posterior distributions for the Gamma-Poisson and Beta-Binomial Bayesian models and compute expected values. Understand the connection between the Bühlmann and Bayesian estimates for the Gamma-Poisson and Beta-Binomial models. Section 4.4 reviews Bayesian inference and it is assumed that the reader is familiar with that material. The reader is also advised to read the Bühlmann credibility section in this chapter. This section will compare Bayesian inference with Bühlmann credibility and show connections between the two models. A risk with risk parameter \\(\\theta\\) has expected loss \\(\\mu(\\theta)=E(X|\\theta)\\) with random variable \\(X\\) representing pure premium, aggregate loss, number of claims, claim severity, or some other measure of loss during a period of time. If the risk has \\(n\\) losses \\(X_1,\\ldots, X_n\\) during n separate periods of time, then these losses are assumed to be \\(iid\\) for the policyholder and \\(\\mu(\\theta)=E(X_i|\\theta)\\) for \\(i=1,..,n\\). If the risk had \\(n\\) losses \\(x_1,\\ldots, x_n\\) then E(\\(\\mu(\\theta)|x_1,\\ldots, x_n)\\) is the conditional expectation of \\(\\mu(\\theta)\\). The Bühlmann credibility formula \\(\\hat{\\mu}(\\theta)=Z\\bar{X}+(1-Z)\\mu\\) is a linear function of \\(\\bar{X}=(x_1+\\cdots+x_n)/n\\) used to estimate \\(E(\\mu(\\theta)|x_1,\\ldots,x_n)\\). The expectation \\(E(\\mu(\\theta)|x_1,\\ldots,x_n)\\) can be calculated from the conditional density function \\(f(x|\\theta)\\) and the posterior distribution \\(\\pi(\\theta|x_1,\\ldots,x_n)\\): \\[\\begin{eqnarray*} \\mathrm{E}(\\mu(\\theta)|x_1,\\ldots,x_n)&amp;=&amp;\\int \\mu(\\theta) \\pi(\\theta|x_1,\\ldots,x_n) d\\theta \\\\ \\mu(\\theta)&amp;=&amp;\\mathrm{E}(X|\\theta)=\\int xf(x|\\theta) dx .\\\\ \\end{eqnarray*}\\] The posterior distribution comes from Bayes theorem \\[\\begin{equation*} \\pi(\\theta|x_1,\\ldots,x_n)=\\frac{\\prod_{j=1}^{n} f(x_j|\\theta)}{f(x_1,\\ldots,x_n)}\\pi({\\theta}). \\end{equation*}\\] The conditional density function \\(f(x|\\theta)\\) and the prior distribution \\(\\pi(\\theta)\\) must be specified. The numerator \\(\\prod_{j=1}^{n} f(x_j|\\theta)\\) on the right-hand side is called the likelihood. The denominator \\(f(x_1,\\ldots,x_n)\\) is the joint density function for \\(n\\) losses \\(x_1,\\ldots,x_n\\). 9.5.1 Gamma-Poisson Model In the Gamma-Poisson model the number of claims \\(X\\) has a Poisson distribution Pr(\\(X=x|\\lambda)=\\lambda^xe^{-\\lambda}/x!\\) for a risk with risk parameter \\(\\lambda\\). The prior distribution for \\(\\lambda\\) is gamma with \\(\\pi(\\lambda)=\\beta^\\alpha\\lambda^{\\alpha-1}e^{-\\beta\\lambda}/\\Gamma(\\alpha)\\). (Note that a rate parameter \\(\\beta\\) is being used in the gamma distribution rather than a scale parameter.) The mean of the gamma is E(\\(\\lambda)=\\alpha/\\beta\\) and the variance is Var(\\(\\lambda)=\\alpha/\\beta^2\\). In this section we will assume that \\(\\lambda\\) is the expected number of claims per year though we could have chosen another time interval. If a risk is selected at random from the population then the expected number of claims in a year is E(\\(N\\))=E(E(\\(N|\\lambda\\)))=E(\\(\\lambda\\))=\\(\\alpha/\\beta\\). If we had no observations for the selected risk then the expected number of claims for the risk is \\(\\alpha/\\beta\\). During \\(n\\) years the following number of claims by year was observed for the randomly selected risk: \\(x_1,\\ldots,x_n\\). From Bayes theorem the posterior distribution is \\[\\begin{equation*} \\pi(\\lambda|x_1,\\ldots,x_n)=\\frac{\\prod_{j=1}^{n} (\\lambda^{x_j}e^{-\\lambda}/x_j!)}{\\Pr(X_1=x_1,\\ldots,X_n=x_n)}\\beta^\\alpha\\lambda^{\\alpha-1}e^{-\\beta\\lambda}/\\Gamma(\\alpha). \\end{equation*}\\] Combining terms that have a \\(\\lambda\\) and putting all other terms into constant \\(C\\) gives \\[\\begin{equation*} \\pi(\\lambda|x_1,\\ldots,x_n)=C\\lambda^{(\\alpha+\\sum_{j=1}^{n}x_j)-1}e^{-(\\beta+n)\\lambda}. \\end{equation*}\\] This is a gamma distribution with parameters \\(\\alpha&#39;=\\alpha+\\sum_{j=1}^{n}x_j\\) and \\(\\beta&#39;=\\beta+n\\). The constant must be \\(C={\\beta&#39;}^{\\alpha&#39;}/\\Gamma(\\alpha&#39;)\\) so that \\(\\int_{0}^{\\infty}\\pi(\\lambda|x_1,\\ldots,x_n) d\\lambda=1\\) though we do not need to know \\(C\\). As explained in chapter four the gamma distribution is a conjugate prior for the Poisson distribution so the posterior distribution is also gamma. Because the posterior distribution is gamma the expected number of claims for the selected risk is \\[\\begin{equation*} \\mathrm{E}(\\lambda|x_1,\\ldots,x_n) = \\frac{\\alpha+\\sum_{j=1}^{n}x_j}{\\beta+n}=\\frac{\\alpha + \\textrm{number of claims}}{\\beta+\\textrm{number of years}}. \\end{equation*}\\] This formula is slightly different from chapter four because parameter \\(\\beta\\) is multiplied by \\(\\lambda\\) in the exponential of the gamma pdf whereas in chapter four \\(\\lambda\\) is divided by parameter \\(\\theta\\). We have chosen this form for the exponential to simplify the equation for the expected number of claims. Now we will compute the Bühlmann credibility estimate for the Gamma-Poisson model. The variance for a Poisson distribution with parameter \\(\\lambda\\) is \\(\\lambda\\) so EPV=E(Var(\\(X|\\lambda\\)))=E(\\(\\lambda\\))=\\(\\alpha/\\beta\\). The mean number of claims per year for the risk is \\(\\lambda\\) so VHM=Var(E(\\(X|\\lambda\\)))=Var(\\(\\lambda\\))=\\(\\alpha/\\beta^2\\). The credibility parameter is \\(K\\)=EPV/VHM=\\((\\alpha/\\beta)/(\\alpha/\\beta^2)=\\beta\\). The overall mean is E(E(\\(X|\\lambda\\)))=E(\\(\\lambda\\))=\\(\\alpha/\\beta\\). The sample mean is \\(\\bar{X}=(\\sum_{j=1}^{n}x_j)/n\\). The credibility-weighted estimate for the expected number of claims for the risk is \\[\\begin{equation*} \\hat{\\mu}=\\frac{n}{n+\\beta}\\frac{\\sum_{j=1}^{n}x_j}{n} +(1-\\frac{n}{n+\\beta})\\frac{\\alpha}{\\beta}=\\frac{\\alpha+\\sum_{j=1}^{n}x_j}{\\beta+n}. \\end{equation*}\\] For the Gamma-Poisson model the Bühlmann credibility estimate matches the Bayesian analysis result. 9.5.2 Beta-Binomial Model The Beta-Binomial model is useful for modeling the probability of an event. Assume that random variable \\(X\\) is the number of successes in \\(n\\) trials and that \\(X\\) has a binomial distribution Pr(\\(X=x|p)=\\binom{n}{x}p^x(1-p)^{n-x}\\). In the Beta-Binomial model the prior distribution for probability \\(p\\) is a beta distribution with pdf \\[\\begin{equation*} \\pi(p)=\\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)}p^{\\alpha-1}(1-p)^{\\beta-1} , \\quad 0&lt;p&lt;1, \\alpha&gt;0, \\beta&gt;0. \\end{equation*}\\] The posterior distribution for \\(p\\) given an outcome of \\(x\\) successes in \\(n\\) trials is \\[\\begin{equation*} \\pi(p|x)=\\frac{\\binom{n}{x}p^x(1-p)^{n-x}}{\\Pr(x)}\\frac{\\Gamma(\\alpha+\\beta)}{\\Gamma(\\alpha)\\Gamma(\\beta)}p^{\\alpha-1}(1-p)^{\\beta-1}. \\end{equation*}\\] Combining terms that have a \\(p\\) and putting everything else into the constant \\(C\\) yields \\[\\begin{equation*} \\pi(p| x)=Cp^{\\alpha+x-1}(1-p)^{\\beta+(n-x)-1}. \\end{equation*}\\] This is a beta distribution with new parameters \\(\\alpha^\\prime=\\alpha+x\\) and \\(\\beta^\\prime=\\beta+(n-x)\\). The constant must be \\[\\begin{equation*} C=\\frac{\\Gamma(\\alpha+\\beta+n)}{\\Gamma(\\alpha+x)\\Gamma(\\beta+n-x)}. \\end{equation*}\\] The mean for the beta distribution with parameters \\(\\alpha\\) and \\(\\beta\\) is E(\\(p)=\\alpha/(\\alpha+\\beta)\\). Given \\(x\\) successes in \\(n\\) trials in the Beta-Binomial model the mean of the posterior distribution is \\[\\begin{equation*} E(p|x)=\\frac{\\alpha+x}{\\alpha+\\beta+n}. \\end{equation*}\\] As the number of trials \\(n\\) and successes \\(x\\) increase, the expected value of \\(p\\) approaches \\(x/n\\). The Bühlmann credibility estimate for E(\\(p|x\\)) is exactly as the same as the Bayesian estimate as demonstrated in the following example. Example 9.5.1 The probability that a coin toss will yield heads is \\(p\\). The prior distribution for probability \\(p\\) is beta with parameters \\(\\alpha\\) and \\(\\beta\\). On \\(n\\) tosses of the coin there were exactly \\(x\\) heads. Use Bühlmann credibility to estimate the expected value of \\(p\\). Show Example Solution Solution Define random variables \\(Y_j\\) such that \\(Y_j=1\\) if the \\(j^{th}\\) coin toss is heads and \\(Y_j=0\\) if tails for \\(j=1,\\ldots, n\\). Random variables \\(Y_j\\) are iid conditional on \\(p\\) with Pr\\([Y=1|p]=p\\) and Pr\\([Y=0|p]=1-p\\) The number of heads in \\(n\\) tosses can be represented by the random variable \\(X=Y_1+\\cdots+Y_n\\). We want to estimate \\(p=E[Y_j]\\) using Bühlmann credibility: \\(\\hat{p} = Z\\bar{Y} +(1-Z)\\mu\\). The overall mean is \\(\\mu=E(E(Y_j|p))=E(p)=\\alpha/(\\alpha+\\beta)\\). The sample mean is \\(\\bar{y}=x/n\\). The credibility is \\(Z=n/(n+K)\\) and K=EPV/VHM. With Var\\((Y_j|p)=p(1-p)\\) it follows that EPV=E(Var\\((Y_j|p)\\))=E(\\(p(1-p)\\)). Because E\\((Y_j|p)=p\\) then VHM=Var\\((E(Y_j|p))\\)=Var(\\(p\\)). For the beta distribution \\[\\begin{equation*} \\mathrm{E}(p)=\\frac{\\alpha}{\\alpha+\\beta}, \\mathrm{E}(p^2)=\\frac{\\alpha(\\alpha+1)}{(\\alpha+\\beta)(\\alpha+\\beta+1)}, \\textrm{ and } \\mathrm{Var}(p)=\\frac{\\alpha\\beta}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)}. \\end{equation*}\\] Parameter \\(K\\)=EPV/VHM=[E(\\(p\\))-E(\\(p^2\\))]/Var(\\(p\\)). With some algebra this reduces to \\(K=\\alpha+\\beta\\). The Bühlmann credibility-weighted estimate is \\[\\begin{align*} \\hat{p} &amp;= \\frac{n}{n+\\alpha+\\beta}\\left(\\frac{x}{n}\\right)+\\left(1-\\frac{n}{n+\\alpha+\\beta}\\right)\\frac{\\alpha}{\\alpha+\\beta} \\\\ \\hat{p} &amp; =\\frac{\\alpha+x}{\\alpha+\\beta+n}\\\\ \\end{align*}\\] which is the same as the Bayesian posterior mean. 9.5.3 Exact Credibility As demonstrated in the prior section, the Bühlmann credibility estimates for the Gamma-Poisson and Beta-Binomial models exactly match the Bayesian analysis results. The term exact credibility is applied in these situations. Exact credibility may occur if the probability distribution for \\(X_j\\) is in the linear exponential family and the prior distribution is a conjugate prior. Besides these two models, examples of exact credibility also include Gamma-Exponential and Normal-Normal models. It is also noteworthy that if the conditional mean E\\((\\mu(\\theta)|X_1,...,X_n)\\) is linear in the past observations, then the Bühlmann credibility estimate will coincide with the Bayesian estimate. More information about exact credibility can be found in (Bühlmann and Gisler 2005), (Klugman, Panjer, and Willmot 2012), and (Tse 2009). 9.6 Estimating Credibility Parameters In this section, you learn how to: Perform nonparametric estimation with the Bühlmann and Bühlmann-Straub credibility models. Identify situations when semiparametric estimation is appropriate. Use data to approximate the EPV and VHM. Balance credibility-weighted estimates. The examples in this chapter have provided assumptions for calculating credibility parameters. In actual practice the actuary must use real world data and judgment to determine credibility parameters. 9.6.1 Full Credibility Standard for Limited Fluctuation Credibility Limited-fluctuation credibility requires a full credibility standard. The general formula for aggregate losses or pure premium, as obtained in formula (9.5), is \\[\\begin{equation*} n_S=\\left(\\frac{y_p}{k}\\right)^2\\left[\\left(\\frac{\\sigma_N^2}{\\mu_N}\\right)+\\left(\\frac{\\sigma_X}{\\mu_X}\\right)^2\\right] \\end{equation*}\\] with \\(N\\) representing number of claims and \\(X\\) the size of claims. If one assumes \\(\\sigma_X=0\\) then the full credibility standard for frequency results. If \\(\\sigma_N=0\\) then the full credibility formula for severity follows. Probability \\(p\\) and \\(k\\) value are often selected using judgment and experience. In practice it is often assumed that the number of claims is Poisson distributed so that \\(\\sigma_N^2/\\mu_N=1\\). In this case the formula can be simplified to \\[\\begin{equation*} n_S=\\left(\\frac{y_p}{k}\\right)^2\\left[\\frac{\\mathrm{E}(X^2)}{(\\mathrm{E}(X))^2}\\right]. \\end{equation*}\\] An empirical mean and second moment for the sizes of individual claim losses can be computed from past data, if available. 9.6.2 Nonparametric Estimation for Bühlmann and Bühlmann-Straub Models Bayesian analysis as described previously requires assumptions about a prior distribution and likelihood. It is possible to produce estimates without these assumptions and these methods are often referred to as empirical Bayes methods. Bühlmann and Bühlmann-Straub credibility with parameters estimated from the data are included in the category of empirical Bayes methods. Bühlmann Model First we will address the simpler Bühlmann model. Assume that there are \\(r\\) risks in a population. For risk \\(i\\) with risk parameter \\(\\theta_i\\) the losses for \\(n\\) periods are \\(X_{i1},\\ldots, X_{in}\\). The losses for a given risk are iid across periods as assumed in the Bühlmann model. For risk \\(i\\) the sample mean is \\(\\bar{X}_i=\\sum_{j=1}^{n}X_{ij}/n\\) and the unbiased sample process variance is \\(s_i^2=\\sum_{j=1}^{n}(X_{ij}-\\bar{X}_i)^2/(n-1)\\). An unbiased estimator for the EPV can be calculated by taking the average of \\(s_i^2\\) for the \\(r\\) risks in the population: \\[\\begin{equation} \\widehat{EPV}=\\frac{1}{r}\\sum_{i=1}^{r} s_i^2 = \\frac{1}{r(n-1)} \\sum_{i=1}^{r} \\sum_{j=1}^{n}(X_{ij}-\\bar{X}_i)^2 . \\tag{9.11} \\end{equation}\\] The individual risk means \\(\\bar{X}_i\\) for \\(i=1,\\ldots, r\\) can be used to estimate the VHM. An unbiased estimator of Var(\\(\\bar{X}_i\\)) is \\[\\begin{equation*} \\widehat{\\mathrm{Var}}(\\bar{X}_i)=\\frac{1}{r-1} \\sum_{i=1}^{r}(\\bar{X}_i-\\bar{X})^2 \\textrm{ and } \\bar{X}=\\frac{1}{r}\\sum_{i=1}^{r} \\bar{X}_i, \\end{equation*}\\] but Var(\\(\\bar{X}_i\\)) is not the VHM. The total variance formula or unconditional variance formula is \\[\\begin{equation*} \\mathrm{Var}(\\bar{X}_i)=\\textrm{E(Var}(\\bar{X}_i|\\Theta=\\theta_i))+\\textrm{Var(E}(\\bar{X}_i|\\Theta=\\theta_i)). \\end{equation*}\\] The VHM is the second term on the right because \\(\\mu(\\theta_i)=\\mathrm{E}(\\bar{X}_i|\\Theta=\\theta_i)\\) is the hypothetical mean for risk \\(i\\). So, \\[\\begin{equation*} VHM=\\textrm{Var(E}(\\mu(\\theta_i)) = \\mathrm{Var}(\\bar{X}_i) - \\textrm{E(Var}(\\bar{X}_i|\\Theta=\\theta_i)). \\end{equation*}\\] As discussed previously in Section 9.3.1, EPV/n = E(Var(\\(\\bar{X}_i|\\Theta=\\theta_i\\))) and using the above estimators gives an unbiased estimator for the VHM: \\[\\begin{equation} \\widehat{VHM} = \\frac{1}{r-1} \\sum_{i=1}^{r}(\\bar{X}_i-\\bar{X})^2 - \\frac{\\widehat{EPV}}{n} . \\tag{9.12} \\end{equation}\\] Although the expected loss for a risk with parameter \\(\\theta_i\\) is \\(\\mu(\\theta_i)\\)=E(\\(\\bar{X}_i|\\Theta=\\theta_i\\)), the variance of the sample mean \\(\\bar{X}_i\\) is greater than or equal to the variance of the hypothetical means: Var(\\(\\bar{X}_i)\\geq\\)Var(\\(\\mu(\\theta_i)\\)). The variance in the sample means Var(\\(\\bar{X}_i\\)) includes both the variance in the hypothetical means plus a process variance term. In some cases formula (9.12) can produce a negative value for \\(\\widehat{VHM}\\) because of the subtraction of \\(\\widehat{EPV}/n\\), but a variance cannot be negative. The process variance within risks is so large that it overwhelms the measurement of the variance in means between risks. In this case we cannot use this method to determine the values needed for Bühlmann credibility. Example 9.6.1. Two policyholders had claims over a three-year period as shown in the table below. Estimate the expected number of claims for each policyholder using Bühlmann credibility and calculating necessary parameters from the data. \\[\\begin{matrix} \\begin{array}{|c|c|c|} \\hline \\text{Year} &amp; \\text{Risk A} &amp; \\text{Risk B} \\\\ \\hline 1 &amp; 0 &amp; 2 \\\\ 2 &amp; 1 &amp; 1 \\\\ 3 &amp; 0 &amp; 2 \\\\ \\hline \\end{array} \\end{matrix}\\] Show Example Solution Solution \\(\\bar{x}_A=\\frac{1}{3}(0+1+0)=\\frac{1}{3}\\), \\(\\bar{x}_B=\\frac{1}{3}(2+1+2)=\\frac{5}{3}\\) \\(\\bar{x}=\\frac{1}{2}(\\frac{1}{3}+\\frac{5}{3})=1\\) \\(s_A^2=\\frac{1}{3-1}\\left[(0-\\frac{1}{3})^2+(1-\\frac{1}{3})^2+(0-\\frac{1}{3})^2\\right]=\\frac{1}{3}\\) \\(s_B^2=\\frac{1}{3-1}\\left[(2-\\frac{5}{3})^2+(1-\\frac{5}{3})^2+(2-\\frac{5}{3})^2\\right]=\\frac{1}{3}\\) \\(\\widehat{EPV}=\\frac{1}{2}\\left(\\frac{1}{3}+\\frac{1}{3}\\right)=\\frac{1}{3}\\) \\(\\widehat{VHM}=\\frac{1}{2-1}\\left[(\\frac{1}{3}-1)^2+(\\frac{5}{3}-1)^2\\right]-\\frac{1/3}{3}=\\frac{7}{9}\\) \\(K=\\frac{1/3}{7/9}=\\frac{3}{7}\\) \\(Z=\\frac{3}{3+(3/7))}=\\frac{7}{8}\\) \\(\\hat{\\mu}_A=\\frac{7}{8}\\left(\\frac{1}{3}\\right)+(1-\\frac{7}{8})1=\\frac{5}{12}\\) \\(\\hat{\\mu}_B=\\frac{7}{8}\\left(\\frac{5}{3}\\right)+(1-\\frac{7}{8})1=\\frac{19}{12}\\) Example 9.6.2. Two policyholders had claims over a three-year period as shown in the table below. Calculate the nonparametric estimate for the VHM. \\[\\begin{matrix} \\begin{array}{|c|c|c|} \\hline \\text{Year} &amp; \\text{Risk A} &amp; \\text{Risk B} \\\\ \\hline 1 &amp; 3 &amp; 3 \\\\ 2 &amp; 0 &amp; 0 \\\\ 3 &amp; 0 &amp; 3 \\\\ \\hline \\end{array} \\end{matrix}\\] Show Example Solution Solution \\(\\bar{x}_A=\\frac{1}{3}(3+0+0)=1\\), \\(\\bar{x}_B=\\frac{1}{3}(3+0+3)=2\\) \\(\\bar{x}=\\frac{1}{2}(1+2)=\\frac{3}{2}\\) \\(s_A^2=\\frac{1}{3-1}\\left[(3-1)^2+(0-1)^2+(0-1)^2\\right]=3\\) \\(s_B^2=\\frac{1}{3-1}\\left[(3-2)^2+(0-2)^2+(3-2)^2\\right]=3\\) \\(\\widehat{EPV}=\\frac{1}{2}(3+3)=3\\) \\(\\widehat{VHM}=\\frac{1}{2-1}\\left[(1-\\frac{3}{2})^2+(2-\\frac{3}{2})^2\\right]-\\frac{3}{3}=-\\frac{1}{2}.\\) The process variance is so large that it is not possible to estimate the VHM. Bühlmann-Straub Model Empirical formulas for EPV and VHM in the Bühlmann-Straub model are more complicated because a risk’s number of exposures can change from one period to another. Also, the number of experience periods does not have to be constant across the population. First some definitions: \\(X_{ij}\\) is the losses per exposure for risk \\(i\\) in period \\(j\\). Losses can refer to number of claims or amount of loss. There are \\(r\\) risks so \\(i=1,\\ldots,r\\). \\(n_i\\) is the number of observation periods for risk \\(i\\) \\(m_{ij}\\) is the number of exposures for risk \\(i\\) in period \\(j\\) for \\(j=1,\\ldots,n_i\\) Risk \\(i\\) with risk parameter \\(\\theta_i\\) has \\(m_{ij}\\) exposures in period \\(j\\) which means that the losses per exposure random variable can be written as \\(X_{ij}=(Y_{i1}+\\cdots+Y_{im_{ij}})/m_{ij}\\). Random variable \\(Y_{ik}\\) is the loss for one exposure. For risk \\(i\\) losses \\(Y_{ik}\\) are iid with mean E(\\(Y_{ik}\\))=\\(\\mu(\\theta_i)\\) and process variance Var(\\(Y_{ik}\\))=\\(\\sigma^2(\\theta_i)\\). It follows that Var(\\(X_{ij})\\)=\\(\\sigma^2(\\theta_i)/m_{ij}\\). Two more important definitions are: \\(\\bar{X}_i=\\frac{1}{m_i}\\sum_{j=1}^{n_i} m_{ij}X_{ij}\\) with \\(m_i = \\sum_{j=1}^{n_i} m_{ij}\\). \\(\\bar{X}_i\\) is the average loss per exposure for risk \\(i\\) for all observation periods combined. \\(\\bar{X}=\\frac{1}{m}\\sum_{i=1}^{r} m_i \\bar{X}_i\\) with \\(m=\\sum_{i=1}^r m_i\\). \\(\\bar{X}\\) is the average loss per exposure for all risks for all observation periods combined. An unbiased estimator for the process variance \\(\\sigma^2(\\theta_i)\\) of one exposure for risk \\(i\\) is \\[\\begin{equation*} {s_i}^2=\\frac{\\sum_{j=1}^{n_i} m_{ij}(X_{ij}-\\bar{X}_i)^2}{n_i-1}. \\end{equation*}\\] The weights \\(m_{ij}\\) are applied to the squared differences because the \\(X_{ij}\\) are the averages of \\(m_{ij}\\) exposures. The weighted average of the sample variances \\({s_i}^2\\) for each risk \\(i\\) in the population with weights proportional to the number of \\((n_i-1)\\) observation periods will produce the expected value of the process variance (EPV) estimate \\[\\begin{equation*} \\widehat{EPV}=\\frac{\\sum_{i=1}^r (n_i-1){s_i}^2}{\\sum_{i=1}^r (n_i-1)}=\\frac{\\sum_{i=1}^r \\sum_{j=1}^{n_i} m_{ij}(X_{ij}-\\bar{X}_i)^2}{\\sum_{i=1}^r (n_i-1)}. \\end{equation*}\\] The quantity \\(\\widehat{EPV}\\) is an unbiased estimator for the expected value of the process variance of one exposure for a risk chosen at random from the population. To calculate an estimator for the variance in the hypothetical means (VHM) the squared differences of the individual risk sample means \\(\\bar{X}_i\\) and population mean \\(\\bar{X}\\) are used. An unbiased estimator for the VHM is \\[\\begin{equation*} \\widehat{VHM}=\\frac{\\sum_{i=1}^r m_i(\\bar{X}_i-\\bar{X})^2 - (r-1)\\widehat{EPV}}{m-\\frac{1}{m}\\sum_{i=1}^r m_i^2}. \\end{equation*}\\] This complicated formula is necessary because of the varying number of exposures. Proofs that the EPV and VHM estimators shown above are unbiased can be found in several references mentioned at the end of this chapter including (Bühlmann and Gisler 2005), (Klugman, Panjer, and Willmot 2012), and (Tse 2009). Example 9.6.3. Two policyholders had claims shown in the table below. Estimate the expected number of claims per vehicle for each policyholder using Bühlmann-Straub credibility and calculating parameters from the data. \\[\\begin{matrix} \\begin{array}{|c|c|c|c|c|c|} \\hline \\text{Policyholder} &amp; &amp; \\text{Year 1} &amp; \\text{Year 2} &amp; \\text{Year 3} &amp; \\text{Year 4} \\\\ \\hline \\text{A} &amp; \\text{Number of claims} &amp; 0 &amp; 2 &amp; 2 &amp; 3 \\\\ \\hline \\text{A} &amp; \\text{Insured vehicles} &amp; 1 &amp; 2 &amp; 2 &amp; 2\\\\ \\hline &amp; &amp; &amp; &amp; &amp; \\\\ \\hline \\text{B} &amp; \\text{Number of claims} &amp; 0 &amp; 0 &amp; 1 &amp; 2\\\\ \\hline \\text{B} &amp; \\text{Insured vehicles} &amp; 0 &amp; 2 &amp; 3 &amp; 4\\\\ \\hline \\end{array} \\end{matrix}\\] Show Example Solution Solution \\(\\bar{x}_A=\\frac{0+2+2+3}{1+2+2+2}=1\\) \\(\\bar{x}_B=\\frac{0+1+2}{2+3+4}=\\frac{1}{3}\\) \\(\\bar{x}=\\frac{7(1)+9(1/3)}{7+9}=\\frac{5}{8}\\) \\(s_A^2=\\frac{1}{4-1}\\left[1(0-1)^2+2(1-1)^2+2(1-1)^2+2(\\frac{3}{2}-1)^2\\right]=\\frac{1}{2 }\\) \\(s_B^2=\\frac{1}{3-1}\\left[2(0-\\frac{1}{3})^2+3(\\frac{1}{3}-\\frac{1}{3})^2+4(\\frac{1}{2}-\\frac{1}{3})^2\\right]=\\frac{1}{6}\\) \\(\\widehat{EPV}=\\left[3\\left(\\frac{1}{2}\\right)+2\\left(\\frac{1}{6}\\right)\\right]/(3+2)=\\frac{11}{30}=0.3667\\) \\(\\widehat{VHM}=\\left[(7(1-\\frac{5}{8})^2+9(\\frac{1}{3}-\\frac{5}{8})^2-(2-1)\\frac{11}{30}\\right]/\\left[16-\\left(\\frac{1}{16}\\right)(7^2+9^2)\\right]=0.1757\\) \\(K=\\frac{0.3667}{0.1757}=2.0871\\) \\(m_A=7\\), \\(m_B=9\\) \\(Z_A=\\frac{7}{7+2.0871}=0.7703\\), \\(Z_B=\\frac{9}{9+2.0871}=0.8118\\) \\(\\hat{\\mu}_A=0.7703(1)+(1-0.7703)(5/8)=0.9139\\) \\(\\hat{\\mu}_B=0.8118(1/3)+(1-0.8118)(5/8)=0.3882\\) 9.6.3 Semiparametric Estimation for Bühlmann and Bühlmann-Straub Models In the prior section on nonparametric estimation, there were no assumptions about the distribution of the losses per exposure \\(X_{ij}\\). Assuming that the \\(X_{ij}\\) have a particular distribution and using properties of the distribution along with the data to determine credibility parameters is referred to as semiparametric estimation. An example of semiparametric estimation would be the assumption of a Poisson distribution when estimating claim frequencies. The Poisson distribution has the property that the mean and variance are identical and this property can simplify calculations. The following simple example comes from the prior section but now includes a Poisson assumption about claim frequencies. Example 9.6.4. Two policyholders had claims over a three-year period as shown in the table below. Assume that the number of claims for each risk has a Poisson distribution. Estimate the expected number of claims for each policyholder using Bühlmann credibility and calculating necessary parameters from the data. \\[\\begin{matrix} \\begin{array}{|c|c|c|} \\hline \\text{Year} &amp; \\text{Risk A} &amp; \\text{Risk B} \\\\ \\hline 1 &amp; 0 &amp; 2 \\\\ 2 &amp; 1 &amp; 1 \\\\ 3 &amp; 0 &amp; 2 \\\\ \\hline \\end{array} \\end{matrix}\\] Show Example Solution Solution \\(\\bar{x}_A=\\frac{1}{3}(0+1+0)=\\frac{1}{3}\\), \\(\\bar{x}_B=\\frac{1}{3}(2+1+2)=\\frac{5}{3}\\) \\(\\bar{x}=\\frac{1}{2}(\\frac{1}{3}+\\frac{5}{3})=1\\) With Poisson assumption the estimated variance for risk A is \\(\\hat\\sigma_A^2=\\bar{x}_A=\\frac{1}{3}\\) Similarly, \\(\\hat\\sigma_B^2=\\bar{x}_B=\\frac{5}{3}\\) \\(\\widehat{EPV}=\\frac{1}{2}(\\frac{1}{3})+\\frac{1}{2}(\\frac{5}{3})=1\\). This is also \\(\\bar{x}\\) because of Poisson assumption. \\(\\widehat{VHM}=\\frac{1}{2-1}\\left[(\\frac{1}{3}-1)^2+(\\frac{5}{3}-1)^2\\right]-\\frac{1}{3}=\\frac{5}{9}\\) \\(K=\\frac{1}{5/9}=\\frac{9}{5}\\) \\(Z_A=Z_B=\\frac{3}{3+(9/5)}=\\frac{5}{8}\\) \\(\\hat{\\mu}_A=\\frac{5}{8}\\left(\\frac{1}{3}\\right)+(1-\\frac{5}{8})1=\\frac{7}{12}\\) \\(\\hat{\\mu}_B=\\frac{5}{8}\\left(\\frac{5}{3}\\right)+(1-\\frac{5}{8})1=\\frac{17}{12}.\\) Although we assumed that the number of claims for each risk was Poisson distributed in the prior example, we did not need this additional assumption because there was enough information to use nonparametric estimation. In fact, the Poisson assumption might not be appropriate because for risk B the sample mean is not equal to the sample variance: \\(\\bar{x}_B=\\frac{5}{3}\\neq s_B^2=\\frac{1}{3}\\). The following example is commonly used to demonstrate a situation where semiparametric estimation is needed. There is insufficient information for nonparametric estimation but with the Poisson assumption, estimates can be calculated. Example 9.6.5. A portfolio of 2,000 policyholders generated the following claims profile during a five-year period: \\[\\begin{matrix} \\begin{array}{|c|c|} \\hline \\text{Number of Claims} &amp; \\\\ \\text{In 5 Years} &amp; \\text{Number of policies}\\\\ \\hline 0 &amp; 923 \\\\ 1 &amp; 682 \\\\ 2 &amp; 249 \\\\ 3 &amp; 70 \\\\ 4 &amp; 51 \\\\ 5 &amp; 25 \\\\ \\hline \\end{array} \\end{matrix}\\] In your model you assume that the number of claims for each policyholder has a Poisson distribution and that a policyholder’s expected number of claims is constant through time. Use Bühlmann credibility to estimate the annual expected number of claims for policyholders with 3 claims during the five-year period. Show Example Solution Solution Let \\(\\theta_i\\) be the risk parameter for the \\(i^{th}\\) risk in the portfolio with mean \\(\\mu(\\theta_i)\\) and variance \\(\\sigma^2(\\theta_i)\\). With the Poisson assumption \\(\\mu(\\theta_i)=\\sigma^2(\\theta_i)\\). The expected value of the process variance is EPV=E(\\(\\sigma^2(\\theta_i)\\)) where the expectation is taken across all risks in the population. Because of the Poisson assumption for all risks it follows that EPV=E(\\(\\sigma^2(\\theta_i)\\))=E(\\(\\mu(\\theta_i)\\)). An estimate for the annual expected number of claims is \\(\\hat{\\mu}(\\theta_i)\\)= (observed number of claims)/5. This can also serve as the estimate for the expected value of the process variance for a risk. Weighting the process variance estimates (or means) by the number of policies in each group gives the estimators \\[\\begin{equation*} \\widehat{EPV}=\\bar{x}=\\frac{923(0)+682(1)+249(2)+70(3)+51(4)+25(5)}{(5)(2000)}=0.1719. \\end{equation*}\\] Using the formula ((9.12)), the VHM estimator is \\[\\begin{eqnarray*} \\widehat{VHM}&amp;=&amp;\\frac{1}{2000-1}[923(0-0.1719)^2+682(0.20-0.1719)^2+249(0.40-0.1719)^2\\\\ &amp; &amp;+70(0.60-0.1719)^2+51(0.80-0.1719)^2+25(1-0.1719)^2]-\\frac{0.1719}{5}\\\\ &amp;=&amp; 0.0111\\\\ \\hat{K} &amp;=&amp; \\widehat{EPV}/\\widehat{VHM}=0.1719/0.0111=15.49\\\\ \\hat{Z} &amp;=&amp; \\frac{5}{5+15.49}=0.2440\\\\ \\hat{\\mu}_{3 \\textrm{ claims}}&amp; = &amp; 0.2440(3/5)+(1-0.2440)0.1719=0.2764 .\\\\ \\end{eqnarray*}\\] 9.6.4 Balancing Credibility Estimators The credibility weighted model \\(\\hat{\\mu}(\\theta_i)=Z_i\\bar{X}_i+(1-Z_i)\\bar{X}\\), where \\(\\bar{X}_i\\) is the loss per exposure for risk \\(i\\) and \\(\\bar{X}\\) is loss per exposure for the population, can be used to estimate the expected loss for risk \\(i\\). The overall mean is \\(\\bar{X}=\\sum_{i=1}^r(m_i/m) \\bar{X}_i\\) where \\(m_i\\) and \\(m\\) are number of exposures for risk \\(i\\) and population, respectively. For the credibility weighted estimators to be in balance we want \\[\\begin{equation*} \\bar{X}=\\sum_{i=1}^r(m_i/m) \\bar{X}_i=\\sum_{i=1}^r(m_i/m) \\hat{\\mu}(\\theta_i). \\end{equation*}\\] If this equation is satisfied then the estimated losses for each risk will add up to the population total, an important goal in ratemaking, but this may not happen if \\(\\bar{X}\\) is used for the complement of credibility. In order to find a complement of credibility that will bring the credibility-weighted estimators into balance we will set \\(\\hat{\\mu}\\) as the complement of credibility and analyze the following equation: \\[\\begin{equation*} \\sum_{i=1}^r(m_i/m) \\bar{X}_i=\\sum_{i=1}^r(m_i/m) (Z_i\\bar{X}_i+(1-Z_i)\\hat{\\mu}) . \\end{equation*}\\] A little algebra gives \\[\\begin{equation*} \\sum_{i=1}^r m_i \\bar{X}_i=\\sum_{i=1}^r m_i Z_i\\bar{X}_i + \\hat{\\mu}\\sum_{i=1}^r m_i(1-Z_i), \\end{equation*}\\] and \\[\\begin{equation*} \\hat{\\mu}=\\frac{\\sum_{i=1}^r m_i(1-Z_i)\\bar{X}_i}{\\sum_{i=1}^r m_i(1-Z_i)}. \\end{equation*}\\] Using this value for \\(\\hat{\\mu}\\) will bring the credibility weighted estimators into balance. If credibilities \\(Z_i\\) were computed using the Bühlmann-Straub model, then \\(Z_i=m_i/(m_i+K)\\). The prior formula can be simplified using the following relationship \\[\\begin{equation*} m_i(1-Z_i)=m_i\\left(1-\\frac{m_i}{m_i+K}\\right)=m_i\\left(\\frac{(m_i+K)-m_i}{m_i+K}\\right)=KZ_i . \\end{equation*}\\] Therefore, a complement of credibility that will bring the credibility-weighed estimators into balance with the overall mean loss per exposure is \\[\\begin{equation*} \\hat{\\mu}=\\frac{\\sum_{i=1}^r Z_i \\bar{X}_i}{\\sum_{i=1}^r Z_i}. \\end{equation*}\\] Example 9.6.6. An example from the nonparametric Bühlmann-Straub section had the following data for two risks. Find the complement of credibility \\(\\hat{\\mu}\\) that will produce credibility-weighted estimates that are in balance. \\[\\begin{matrix} \\begin{array}{|c|c|c|c|c|c|} \\hline \\text{Policyholder} &amp; &amp; \\text{Year 1} &amp; \\text{Year 2} &amp; \\text{Year 3} &amp; \\text{Year 4} \\\\ \\hline \\text{A} &amp; \\text{Number of claims} &amp; 0 &amp; 2 &amp; 2 &amp; 3 \\\\ \\hline \\text{A} &amp; \\text{Insured vehicles} &amp; 1 &amp; 2 &amp; 2 &amp; 2\\\\ \\hline &amp; &amp; &amp; &amp; &amp; \\\\ \\hline \\text{B} &amp; \\text{Number of claims} &amp; 0 &amp; 0 &amp; 1 &amp; 2\\\\ \\hline \\text{B} &amp; \\text{Insured vehicles} &amp; 0 &amp; 2 &amp; 3 &amp; 4\\\\ \\hline \\end{array} \\end{matrix}\\] Show Example Solution Solution The credibilities from the prior example are \\(Z_A=\\frac{7}{7+2.0871}=0.7703\\) and \\(Z_B=\\frac{9}{9+2.0871}=0.8118\\). The sample means are \\(\\bar{x}_A=1\\) and \\(\\bar{x}_B=1/3\\). The balanced complement of credibility is \\[\\begin{equation*} \\hat{\\mu}=\\frac{0.7703(1)+0.8118(1/3)}{0.7703+0.8118}=0.6579. \\end{equation*}\\] The updated credibility estimates are \\(\\hat{\\mu}_A=0.7703(1)+(1-0.7703)(.6579)=0.9214\\) versus the previous 0.9139 and \\(\\hat{\\mu}_B=0.8118(1/3)+(1-0.8118)(.6579)=0.3944\\) versus the previous 0.3882. Checking the balance on the new estimators: (7/16)(0.9214)+(9/16)(0.3944)=0.6250. This exactly matches \\(\\bar{X}=10/16=0.6250\\). Show Quiz Solution 9.7 Further Resources and Contributors Exercises Here are a set of exercises that guide the viewer through some of the theoretical foundations of Loss Data Analytics. Each tutorial is based on one or more questions from the professional actuarial examinations, typically the Society of Actuaries Exam C. Credibility Guided Tutorials Contributors Gary Dean, Ball State University is the author of the initial version of this chapter. Email: cgdean@bsu.edu for chapter comments and suggested improvements. Chapter reviewers include: Liang (Jason) Hong, Ambrose Lo, Ranee Thiagarajah, Hongjuan Zhou. Bibliography "],
["C-PortMgt.html", "Chapter 10 Gestión de Carteras de Seguros incluyendo Reaseguro 10.1 Introducción a las Carteras de Seguros 10.2 Colas de las Distribuciones 10.3 Medidas de Riesgo 10.4 Reaseguro 10.5 Recursos y Colaboradores adicionales", " Chapter 10 Gestión de Carteras de Seguros incluyendo Reaseguro Contenido. Una cartera de seguros es simplemente un conjunto de contratos de seguros. Para ayudar a gestionar la incertidumbre de la cartera, este capítulo cuantifica coberturas inusualmente extremas examinando las colas de la distribución, cuantifica el riesgo global introduciendo indicadores conocidos como medidas de riesgo, y analiza las opciones de repartir el riesgo de la cartera a través del reaseguro, la contratación de cobertura de seguro por la propia entidad aseguradora. 10.1 Introducción a las Carteras de Seguros La mayoría de nuestros análisis en los capítulos previos se han realizado a nivel de contrato, definido como un acuerdo entre el tomador y el asegurador. Los aseguradores tienen, y gestionan, carterasuna colección de contratos que son simplemente conjuntos de pólizas. Como en otras áreas financieras, existen elecciones sobre los procesos de gestión que se producen solo a nivel de cartera. Por ejemplo, las decisiones estratégicas no ocurren a nivel de contrato. Se producen en la sala de reuniones, donde los gestores revisan los datos disponibles y posiblemente pongan en marcha nuevas estrategias. Desde la perspectiva de la cartera, los aseguradores quieren planear su capacidad, establecer políticas de gestión, y equilibrar el mix de productos que se distribuyen para aumentar los ingresos mientras se controla la volatilidad. Conceptualmente, uno puede pensar en una compañía de seguros como nada más que un conjunto, o cartera, de contratos de seguros. En el Capítulo 5 se ha aprendido sobre la modelización de carteras de seguros como la suma de contratos individuales, teniendo en cuenta hipótesis de independencia entre los contratos. Teniendo en cuenta su importancia, este capítulo se centra directamente en las distribuciones de carteras. Las carteras de seguros representan las obligaciones de los aseguradores y, por ello, se está particularmente interesado en las probabilidades de grandes riesgos, dado que ellos representan grandes obligaciones o coberturas extraordinarias. Para formalizar este concepto se introduce el concepto de distribución de colas pesadas en la Sección 10.2. Las carteras de seguros representan las obligaciones de la compañía y por ello los aseguradores mantienen una cantidad equivalente de activos para cumplir con dichas obligaciones. Las Medidas de riesgo, introducidas en la Sección 10.3, resumen la distribución de la cartera de seguros y son usadas para cuantificar la cantidad de activos que un asegurador necesita tener para cumplir con sus obligaciones. En la Sección 3.4 se aprendieron mecanismos que los tomadores usan para repartir riesgos como franquicias y límites de cobertura. De la misma forma, los aseguradores usan mecanismos similares para repartir los riesgos de cartera. Compran protecciones del riesgo mediante el reaseguro, una compañía de seguros para los aseguradores. Este reparto del riesgo de cartera de seguros se describe en la Sección ??. 10.2 Colas de las Distribuciones En esta sección, se aprende como: Describir una distribución de cola pesada intuitivamente. Clasificar la pesadez de las colas de una distribución basada en los momentos. Comparar las colas de dos distribuciones. En 1998 cayó lluvia helada en el este de Ontario, al suroeste de Canadá, durante seis días. El suceso supuso el doble de precipitaciones experimentadas en la zona en cualquier tormenta de hielo anterior, y provocó una catástrofe que derivó en más de 840,000 reclamaciones de seguros. Esta cifra es un 20\\(\\%\\) superior a los siniestros causados por el Huracán Andrew – uno de los mayores desastres naturales en la historia de Norteamérica. La catástrofe supuso aproximadamente 1.44 miles de millones de dólares Canadienses en acuerdos de seguros lo que representa la mayor cantidad para pérdidas en la historia de Canadá. Este no es un ejemplo aislado – sucesos catastróficos similares que causaron pérdidas extremas para el seguro son los Huracanes Harvey y Sandy, el terremoto y tsunami japonès de 2011, y otros. En el contexto asegurador, las pérdidas muy grandes y poco frecuentes que afectan a las carteras convirtiéndose en siniestros representan habitualmente la mayor parte de las indemnizaciones pagadas por las compañías aseguradoras. Dichas pérdidas, también llamadas ‘extremas’, son modelizadas cuantitativamente mediante las colas de las distribuciones de probabilidad asociadas. Desde el punto de vista de la modelización cuantitativa, confiar en modelos probabilísticos que no recogen bien el comportamiento de las colas puede resultar desalentador. Por ejemplo, los periodos de crisis financera pueden aparecer con mayor frecuencia de loesperado, y las pérdidas en seguros pueden producirse con mayor severidad. Por tanto, el estudio del comportamiento probabilístico en las colas de los modelos actuariales es de suma importancia en el contexto moderno de la gestión cuantitativa del riesgo. Por esta razón, esta sección se dedica a la introduccción de unas pocas nociones matemáticas que caracterizan el peso de la cola de variables aleatorias (v.a.). La aplicación de esas nociones será útil en la construcción y selección de modelos apropiados con las propiedades matemáticas deseadas en las colas, que serán adecuadas para el alcance de determinados objetivos. Formalmente, se define \\(X\\) como las obligaciones (aleatorias) que pueden derivarse de un conjunto (cartera) de pólizas de seguros. Se está especialmente interesado en estudiar la cola derecha de la distribución de \\(X\\), que representa la ocurrencia de grandes pérdidas. Informalmente, una v.a. se define como de cola pesada si las probabilidades altas se asignan a los valores grandes. Destacar que esto no significa que las funciones de densidad/masa de probabilidad vayan creciendo cuando el valor de v.a. tienda a infinito. De hecho para una v.a. continua, la pdffunción de densidad de probabilidad/pmffunción de masa de probabilidad debe disminuir en el infinito para garantizar que la probabilidad total es igual a uno. En cambio, lo que preocupa es la tasa de decrecimiento de la función de probabilidad. Es más probable que se produzcan resultados no deseados en carteras de seguros descritas por una v.a. de pérdidas con cola (derecha) pesada. El peso de la cola puede ser un concepto absoluto o relativo. Específicamente, desde el primer punto de vista, se puede considerar que una v.a. es de cola pesada si se cumplen ciertas propiedades matemáticas de la distribución de probabilidad. Desde el segundo punto de vista, se puede decir que la cola de una distribución es más pesada que la otra si algunas medidas de cola son mayores/menores. Se han propuesto diferentes enfoques cuantitativos para clasificar y comparar el peso de las colas. Entre ellos, la función de supervivenciaUno menos la función de distribución. Proporciona la probabilidad de que la v.a. supere un determinado valor sirve como base de análisis. A continuación, se introducen dos métodos de clasificación de colas simples pero muy utilizados, basados en el comportamiento de la función de supervivencia de \\(X\\). 10.2.1 Clasificación Basada en los Momentos Una forma de clasificar el peso de la cola de una distribución es evaluando la existencia de momentos ordinarios o respecto al origen. Ya que nuestro mayor interés recae en las colas derechas de las distribuciones, de ahora en adelante se asume que la obligación o pérdida v.a. \\(X\\) es positiva. Al principio, el momento ordinario \\(k-\\)th de una v.a. \\(X\\) continua, introducido en la Sección 3.1, puede calcularse como \\[\\begin{eqnarray*} \\mu_k&#39; &amp;=&amp; k \\int_0^{\\infty} x^{k-1} S(x) dx, \\\\ \\end{eqnarray*}\\] donde \\(S(\\cdot)\\) es la función de supervivencia de \\(X\\). Esta expresión pone de manifiesto que la existencia de los momentos ordinarios depende del comportamiento asintótico de la función de supervivencia en el infinito. Dicho de otro modo, cuanto más rápido tiende a cero la función de supervivencia, mayor será el orden del momento finito (k) que la v.a. asociada posee. Se puede interpretar \\(k^{\\ast}\\) como el mayor valor de k para que el momento sea finito. Formalmente, se define \\(k^{\\ast}:=\\sup\\{k &gt; 0:\\mu_k&#39;&lt;\\infty \\}\\), donde \\(sup\\) representa el elemento supremo. Esta observación nos conduce al método de clasificación del peso de las colas basado en los momentos, que se define formalmente a continuación. Definición 10.1. Consideremos una variable aleatoria de pérdidas positiva \\(X\\). Si todos los momentos ordinarios positivos existen, llámemosle el máximo orden del momento finito \\(k^{\\ast}=\\infty\\), entonces \\(X\\) se denomina de cola ligera en base al método de los momentos. Si \\(k^{\\ast} &lt; \\infty\\), entonces \\(X\\) se denomina de cola pesada en base al método de los momentos. Además, para dos variables aleatorias de pérdidas positivas \\(X_1\\) y \\(X_2\\) con máximos órdenes del momento \\(k^{\\ast}_1\\) y \\(k^{\\ast}_2\\) respectivamente, se dice que \\(X_1\\) tiene una cola (derecha) más pesada que \\(X_2\\) si \\(k^{\\ast}_1\\leq k^{\\ast}_2\\). La primera parte de la Definición 10.1 es un concepto absoluto de peso de cola, mientras que la segunda parte es un concepto relativo de peso de cola que compara las colas (derechas) entre dos distribuciones. A continuación, se presentan unos cuantos ejemplos que ilustran las aplicaciones del método basado en los momentos para comparar el peso de las colas. Ejemplo 10.1.1. Naturaleza de la cola ligera de la distribución gamma. Sea \\(X\\sim gamma(\\alpha,\\theta)\\), con \\(\\alpha&gt;0\\) y \\(\\theta&gt;0\\), entonces para todo \\(k&gt;0\\), demuestra que \\(\\mu_k&#39; &lt; \\infty\\). Muestra solución del ejemplo Solución. \\[\\begin{eqnarray*} \\mu_k&#39; &amp;=&amp; \\int_0^{\\infty} x^k \\frac{x^{\\alpha-1} e^{-x/\\theta}}{\\Gamma(\\alpha) \\theta^{\\alpha}} dx \\\\ &amp;=&amp; \\int_0^{\\infty} (y\\theta)^k \\frac{(y\\theta)^{\\alpha-1} e^{-y}}{\\Gamma(\\alpha) \\theta^{\\alpha}} \\theta dy \\\\ &amp;=&amp; \\frac{\\theta^k}{\\Gamma(\\alpha)} \\Gamma(\\alpha+k) &lt; \\infty. \\end{eqnarray*}\\] Dado que todos los momentos positivos existen, por tanto, \\(k^{\\ast}=\\infty\\), de acuerdo con el método de clasificación basado en los momentos de la Definición 10.1, la distribución gamma es de cola ligera. Ejemplo 10.1.2. Naturaleza de la cola ligera de la distribución Weibull. Sea \\(X\\sim Weibull(\\theta,\\tau)\\), con \\(\\theta&gt;0\\) y \\(\\tau&gt;0\\), entonces para todo \\(k&gt;0\\), demuestra que \\(\\mu_k&#39; &lt; \\infty\\). Muestra solución del ejemplo Solución. \\[\\begin{eqnarray*} \\mu_k&#39; &amp;=&amp; \\int_0^{\\infty} x^k \\frac{\\tau x^{\\tau-1} }{\\theta^{\\tau}} e^{-(x/\\theta)^{\\tau}}dx \\\\ &amp;=&amp; \\int_0^{\\infty} \\frac{ y^{k/\\tau} }{\\theta^{\\tau}} e^{-y/\\theta^{\\tau}}dy \\\\ &amp;=&amp; \\theta^{k} \\Gamma(1+k/\\tau) &lt; \\infty. \\end{eqnarray*}\\] De nuevo, debido a la existencia de todos los momentos positivos, la distribution Weibull es de cola ligera. Las distribuciones gamma y Weibull se utilizan ampliamente en la práctica actuarial. Las aplicaciones de estas dos distribuciones son extensas e incluyen, entre otras, la modelización de la severidad de los siniestros de seguros, la evaluación de solvencia, reservas, la aproximación del riesgo agregado o conjunto, e ingeniería de fiabilidad y análisis de errores o fallos. Hasta ahora se han visto dos ejemplos de aplicación del método basado en los momentos para analizar distribuciones de cola ligera. A continuación se presenta un ejemplo de cola pesada. Ejemplo 10.1.3. Naturaleza de la cola pesada de la distribución de pareto. Sea \\(X\\sim Pareto(\\alpha,\\theta)\\), con \\(\\alpha&gt;0\\) y \\(\\theta&gt;0\\), entonces para \\(k&gt;0\\) \\[\\begin{eqnarray*} \\mu_k^{&#39;} &amp;=&amp; \\int_0^{\\infty} x^k \\frac{\\alpha \\theta^{\\alpha}}{(x+\\theta)^{\\alpha+1}} dx \\\\ &amp;=&amp; \\alpha \\theta^{\\alpha} \\int_{\\theta}^{\\infty} (y-\\theta)^k {y^{-(\\alpha+1)}} dy. \\end{eqnarray*}\\] Se considera una integración similar: \\[\\begin{eqnarray*} g_k:=\\int_{\\theta}^{\\infty} {y^{k-\\alpha-1}} dy=\\left\\{ \\begin{array}{ll} &lt;\\infty, &amp; \\hbox{for } k&lt;\\alpha;\\\\ =\\infty, &amp; \\hbox{for } k\\geq \\alpha. \\end{array} \\right. \\end{eqnarray*}\\] Mientras tanto, \\[\\lim_{y\\rightarrow \\infty} \\frac{(y-\\theta)^k {y^{-(\\alpha+1)}}}{y^{k-\\alpha-1}}=\\lim_{y\\rightarrow \\infty} (1-\\theta/y)^{k}=1.\\] La aplicación del teorema de comparación de límites para integrales impropias indica que \\(\\mu_k&#39;\\) es finita si y solo si \\(g_k\\) es finita. Por tanto se puede concluir que los momentos ordinarios de una rv Pareto existen solo hasta \\(k&lt;\\alpha\\), es decir, \\(k^{\\ast}=\\alpha\\), y de este modo la distribución es de cola pesada. Aún más, el máximo orden del momento finito depende solo del parámetro de forma \\(\\alpha\\) y es una función creciente de \\(\\alpha\\). En otras palabras, en base al método de los momentos, el peso de la cola de una v.a. Pareto cambia únicamente en función de \\(\\alpha\\) – cuanto más pequeño es el valor de \\(\\alpha\\), más fuerte es el peso de la cola. Dado que \\(k^{\\ast}&lt;\\infty\\), la cola de una distribución de Pareto es más pesada que la de las distribuciones gamma y Weibull. Se concluye esta sección con una discusión abierta sobre las limitaciones del método basado en los momentos. A pesar de su implementación sencilla y de su interpretación intuitiva, existen determinadas situaciones en las que la aplicación del método basado en los momentos no es factible. Primero, en el caso de los modelos probabilísticos más complejos, el \\(k\\)-th momento ordinario puede no ser simple de derivar, y de este modo, la identificación del máximo orden del momento finito puede convertirse en un desafío. Segundo, el método basado en los momentos no cumple bien con el cuerpo principal de la teoría de la cola pesada definido en la literatura. Específicamente, la existencia de las funciones generadoras de momentos es sin duda el método más popular para clasificar la cola pesada frente a la cola ligera dentro de la comunidad de los actuarios académicos. Sin embargo, para algunas v.a. como la v.a. lognormal, sus funciones generadoras de momentos no existen, incluso cuando todos los momentos positivos son finitos. En esos casos, las aplicaciones de los métodos basados en los momentos pueden conduir a diferentes evaluaciones del peso de la cola. Tercero, cuando se necesita comparar el peso de la cola entre dos distribuciones de cola ligera para las cuales existen todos los momentos positivos, el método basado en los momentos no es informativo (ver, por ejemplo, Ejemplos 10.1.1 y 10.1.2). 10.2.2 Comparación basada en el comportamiento de colas con límites Para resolver las dificultades anteriormente comentadas en relación al uso del método de clasificación basado en los momentos, una aproximación alternativa para comparar el peso de las colas es estudiar directamente los límites de las funciones de supervivencia. Definición 10.2. Para dos v.a. \\(X\\) e \\(Y\\), sea \\[ \\gamma:=\\lim_{t\\rightarrow \\infty}\\frac{S_X(t)}{S_Y(t)}. \\] Se dice que \\(X\\) tiene una cola derecha más pesada que \\(Y\\) si \\(\\gamma=\\infty\\); \\(X\\) e \\(Y\\) son proporcionalmente equivalentes en la cola derecha si \\(\\gamma =c\\in \\mathbf{R}_+\\); \\(X\\) tiene una cola derecha más ligera que \\(Y\\) si \\(\\gamma=0\\). Ejemplo 10.1.4. Comparación de las distribuciones Pareto y Weibull. Sea \\(X\\sim Pareto(\\alpha, \\theta)\\) e \\(Y\\sim Weibull(\\tau, \\theta)\\), para \\(\\alpha&gt;0\\), \\(\\tau&gt;0\\), y \\(\\theta&gt;0\\). Demostrar que la distribución Pareto tiene una cola derecha más pesada que la Weibull. Muestra solución del ejemplo Solución. \\[\\begin{eqnarray*} \\lim_{t\\rightarrow \\infty}\\frac{S_X(t)}{S_Y(t)} &amp;=&amp; \\lim_{t\\rightarrow \\infty}\\frac{(1+t/\\theta)^{-\\alpha}}{\\exp\\{-(t/\\theta)^{\\tau}\\}} \\\\ &amp;=&amp; \\lim_{t\\rightarrow \\infty}\\frac{\\exp\\{t/\\theta^{\\tau} \\}}{(1+t^{1/\\tau}/\\theta)^{\\alpha}} \\\\ &amp;=&amp; \\lim_{t\\rightarrow \\infty}\\frac{\\sum_{i=0}^{\\infty}\\left(\\frac{t}{\\theta^{\\tau}}\\right)^{i}/i!}{(1+t^{1/\\tau}/\\theta)^{\\alpha}}\\\\ &amp;=&amp; \\lim_{t\\rightarrow \\infty} \\sum_{i=0}^{\\infty} \\left(t^{-i/\\alpha}+\\frac{t^{(1/\\tau-i/\\alpha)}}{\\theta} \\right)^{-\\alpha}/\\theta^{\\tau i}i!\\\\ &amp;=&amp; \\infty. \\end{eqnarray*}\\] Por tanto, la distribución de Pareto tiene una cola más pesada que la distribución Weibull. Se puede observar que las exponenciales tienden a infinito más rápido que las polinómicas, por tanto, el límite antes mencionado debe ser infinito. Para algunas distribuciones para las que las funciones de supervivencia no admiten expresiones explícitas, se puede encontrar la siguiente fórmula alternativa: \\[\\begin{eqnarray*} \\lim_{t\\to \\infty} \\frac{S_X(t)}{S_Y(t)} &amp;=&amp; \\lim_{t \\to \\infty} \\frac{S_X^{&#39;}(t)}{S_Y^{&#39;}(t)} \\\\ &amp;=&amp; \\lim_{t \\to \\infty} \\frac{-f_X(t)}{-f_Y(t)}\\\\ &amp;=&amp; \\lim_{t\\to \\infty} \\frac{f_X(t)}{f_Y(t)}. \\end{eqnarray*}\\] dado que existen las funciones de densidad. Ejemplo 10.1.5. Comparación de las distribuciones Pareto y gamma. Sea \\(X\\sim Pareto(\\alpha, \\theta)\\) e \\(Y\\sim gamma(\\alpha, \\theta)\\), para \\(\\alpha&gt;0\\) y \\(\\theta&gt;0\\). Demostrar que la Pareto tiene una cola derecha más pesada que la gamma. Muestra solución del ejemplo Solución. \\[\\begin{eqnarray*} \\lim_{t\\to \\infty} \\frac{f_{X}(t)}{f_{Y}(t)} &amp;=&amp; \\lim_{t \\to \\infty} \\frac{\\alpha \\theta^{\\alpha} (t+ \\theta)^{-\\alpha-1}}{t^{\\tau-1} e^{-t/\\lambda} \\lambda^{-\\tau} \\Gamma(\\tau)^{-1}} \\\\ &amp;\\propto&amp; \\lim_{t\\to \\infty} \\frac{e^{t/\\lambda}}{(t+\\theta)^{\\alpha+1} t^{\\tau-1}} \\\\ &amp;=&amp; \\infty, \\end{eqnarray*}\\] Dado que las exponenciales tienden a infinito más rápido que las polinómicas. 10.3 Medidas de Riesgo En esta sección, se aprende como: Definir la idea de coherencia y determinar si una medida de riesgo es o no coherente. Definir el valor en riesgo y calcular este valor para una distribución dada. Definir la cola del valor en riesgo y calcular este valor para una distribución dada. En la sección previa, se estudian dos métodos para clasificar el peso de las colas de la distribución. Se puede afirmar que el riesgo asociado con una distribución es más peligroso que otros(asintóticamente)si la cola es más pesada. Sin embargo, saber que un riesgo es más peligroso (asintóticamente) que otros puede no ser suficiente a nivel informativo para una gestión de riesgos sofisticada, y adicionalmente, se puede estar interesado en cuantificar cuanto más lo es. De hecho, la magnitud del riesgo asociada con una distribución dada de pérdidas es un input fundamental para muchas aplicaciones de seguros, tales como la tarificación actuarial, el cálculo de reservas, el diseño de coberturas, la supervisión regulatoria de seguros, y otras. 10.3.1 Medidas de Riesgo Coherentes Para comparar la magnitud del riesgo de una forma conveniente, se busca una función que represente la v.a. pérdida en un valor numérico indicativo del nivel de riesgo, denominada medida de riesgouna medida que resume el riesgo, o incertidumbre, de una distribución. A nivel matemático, la medida de riesgo simplemente resume la función de distribución de una v.a. mediante un solo número. Dos medidas de riesgo sencillas son la media \\(\\mathrm{E}[X]\\) y la desviación estándar \\(\\mathrm{SD}(X)=\\sqrt{\\mathrm{Var}(X)}\\). Otros ejemplos clásicos de medidas de riesgo incluyen el principio de desviación estándar \\[\\begin{equation} H_{\\mathrm{SD}}(X):=\\mathrm{E}[X]+\\alpha \\mathrm{SD}(X),\\text{ para } \\alpha\\geq 0, \\tag{10.1} \\end{equation}\\] y el principio de varianza \\[ H_{\\mathrm{Var}}(X):=\\mathrm{E}[X]+\\alpha \\mathrm{Var}(X),\\text{ para } \\alpha\\geq 0. \\] Es sencillo comprobar que todas las funciones antes mencionadas son medidas de riesgo en las que se introduce la v.a. pérdida y las funciones generan un valor numérico. Sin embargo, la función \\(H^{\\ast}(X):=\\alpha X^{\\beta}\\) para cualquier valor real \\(\\alpha,\\beta\\neq 0\\), no es una medida de riesgo porque \\(H^{\\ast}\\) produce otra v.a. en lugar de un único valor numérico. Como las medidas de riesgo son medidas escalares que tienen como objetivo utilizar un único valor numérico para describir la naturaleza estocástica de la v.a. pérdidas, no debería sorprendernos que no haya ninguna medida de riesgo que pueda capturar toda la información de riesgo de las v.a. asociadas. Por tanto, al buscar medidas de riesgo útiles, es importante tener en cuenta que las medidas deben ser al menos fácilmente interpretables; convenientemente computables; y capaces de reflejar la información más crítica sobre el riesgo que sustenta la distribución de pérdidas. En la literatura se han desarrollado varias medidas de riesgo. Desafortunadamente, no hay una mejor medida de riesgo que pueda superar a las demás, y la selección de la medida de riesgo adecuada depende principalmente de lo que se esté analizando. En este sentido, es necesario subrayar que riesgo es un concepto subjetivo, y por tanto, incluso delante del mismo problema, existen enfoques alternativos para su evaluación. Sin embargo, en aplicaciones de gestión de riesgos, existe un amplio consenso en el hecho de que las medidas de riesgo utilizadas desde un punto de vista económico deben cumplir cuatro axiomas principales que se describen con detalle a continuación. Las medidas de riesgo que satisfacen estos axiomas se denominan medidas de riesgo coherentesuna medida de riesgo que es subaditiva, monótona, tiene homgeneidad positiva, y es invariante a desplazamientos . Consideramos a continuación una medida de riesgo \\(H(\\cdot)\\), de forma que \\(H\\) es una medida de riesgo coherente si se satisfacen los siguientes axiomas. Axioma 1. Subaditividad: \\(H(X+Y)\\leq H(X)+H(Y)\\). La implicación económica de este axioma es que existen beneficios de diversificación si se combinan diferentes riesgos. Axioma 2. Monotonicidad: si \\(\\Pr[X\\leq Y]=1\\), entonces \\(H(X)\\leq H(Y)\\). Destacar que \\(X\\) e \\(Y\\) son v.a. que representan pérdidas, la implicación económica subyacente es que las pérdidas más altas conducen esencialmente a un mayor nivel de riesgo. Axioma 3. Homogeneidad positiva: \\(H(cX)=cH(X)\\) para cualquier constante positiva \\(c\\). Una implicación económica posible de este axioma es que la medida de riesgo debe ser independiente de las unidades monetarias en las que se mide el riesgo. Por ejemplo, sea \\(c\\) el tipo de cambio entre los dólares estadounidenses y canadienses, entonces el riesgo de pérdidas aleatorias medidas en dólares estadounidenses (es decir, X) y dólares canadienses (es decir, cX) debe ser diferente solo en términos del tipo de cambio \\(c\\) (es decir, \\(cH(x)=H(cX)\\)). Axioma 4. Invarianza a los desplazamientos: \\(H(X+c)=H(X)+c\\) para cualquier constante positiva \\(c\\). Si la constante \\(c\\) se interpreta como un efectivo libre de riesgo, este axioma indica que no se crea riesgo adicional al añadir liquidez a una cartera de seguros, y añadir un capital libre de riesgo de cuantía \\(c\\) puede reducir solo el riesgo en la misma cantidad. Verificar las propiedades coherentes para algunas medidas de riesgo puede ser bastante sencillo, pero a veces puede complicarse. Por ejemplo, es sencillo comprobar que la media es una medida de riesgo coherente. Ejemplo. La Media es una Medida de Riesgo Coherente. Para cualquier par de v.a. \\(X\\) e \\(Y\\) con medias finitas y la constante \\(c&gt;0\\), validación de la subaditividad: \\(\\mathrm{E}[X+Y]=\\mathrm{E}[X]+\\mathrm{E}[Y]\\); validación de la monotonicidad: si \\(\\Pr[X\\leq Y]=1\\), entonces \\(\\mathrm{E}[X]\\leq \\mathrm{E}[Y]\\); validación de homogeneidad positiva: \\(\\mathrm{E}[cX]=c\\mathrm{E}[X]\\); validación de invarianza a los desplazamientos: \\(\\mathrm{E}[X+c]=\\mathrm{E}[X]+c\\) Con un poco más de esfuerzo, se puede determinar lo siguiente. Ejemplo. La Desviación Estándar no es una Medida de Riesgo Coherente. Mostrar verificación del ejemplo La desviación estándar no es una medida de riesgo coherente. De forma específica, se puede comprobar que la desviación estándar satisface validación de la subaditividad: \\[\\begin{eqnarray*} \\mathrm{SD}[X+Y]&amp;=&amp;\\sqrt{\\mathrm{Var}(X)+\\mathrm{Var}(Y)+2\\mathrm{Cov}(X,Y)}\\\\ &amp;\\leq&amp; \\sqrt{\\mathrm{SD}(X)^2+\\mathrm{SD}(Y)^2+2\\mathrm{SD}(X)\\mathrm{SD}(Y)}\\\\ &amp;=&amp; \\mathrm{SD}(X)+\\mathrm{SD}(Y); \\end{eqnarray*}\\] validación de la homogeneidad positiva: \\(\\mathrm{SD}[cX]=c~\\mathrm{SD}[X]\\). Sin embargo, la desviación estándar no cumple con la propiedad de la invarianza ante desplazamientos dado que para cualquier constante positiva \\(c\\), \\[ \\mathrm{SD}(X+c)=\\mathrm{SD}(X)&lt;\\mathrm{SD}(X)+c. \\] Además, la desviación estándar tampoco satisface la propiedad de monotonicidad. Para demostrarlo, se consideran las dos v.a. siguientes: \\[\\begin{eqnarray} X=\\left\\{ \\begin{array}{ll} 0, &amp; \\hbox{con probabilidad $0.25$;} \\\\ 4, &amp; \\hbox{con probabilidad $0.75$,} \\end{array} \\right. \\tag{10.2} \\end{eqnarray}\\] e \\(Y\\) es una v.a. tal que \\[\\begin{eqnarray} \\Pr[Y = 4] = 1. \\tag{10.3} \\end{eqnarray}\\] Es fácil comprobar que \\(\\Pr[X\\leq Y]=1\\), pero \\(\\mathrm{SD}(X)=\\sqrt{4^2\\cdot 0.25\\cdot 0.75}=\\sqrt{3}&gt;\\mathrm{SD}(Y)=0\\). Hasta ahora se ha comprobado que \\(\\mathrm{E}[\\cdot]\\) es una medida de riesgo coherente, pero no \\(\\mathrm{SD}(\\cdot)\\). Se procede ahora a estudiar la propiedad de coherencia para el principio de desviación estándar (10.1) que es una combinación linear de medidas de riesgo coherentes y no coherentes. Ejemplo. El Principio de Desviación Estándar (10.1) es una Medida de Riesgo Coherente. Mostrar verificación del ejemplo Con este fin, para una \\(\\alpha&gt;0\\) dada, comprobamos los cuatro axiomas para \\(H_{\\mathrm{SD}}(X+Y)\\) uno por uno: validación de subaditividad: \\[\\begin{eqnarray*} H_{\\mathrm{SD}}(X+Y) &amp;=&amp; \\mathrm{E}[X+Y]+\\alpha \\mathrm{SD}(X+Y) \\\\ &amp;\\leq&amp; \\mathrm{E}[X]+\\mathrm{E}[Y]+\\alpha [\\mathrm{SD}(X) +\\mathrm{SD}(Y)]\\\\ &amp;=&amp; H_{\\mathrm{SD}}(X)+ H_{\\mathrm{SD}}(Y); \\end{eqnarray*}\\] validación de homogeneidad positiva: \\[ H_{\\mathrm{SD}}(cX)=c\\mathrm{E}[X]+c\\alpha\\mathrm{SD}(X)=cH_{\\mathrm{SD}}(X); \\] validación de invarianza en los desplazamientos: \\[ H_{\\mathrm{SD}}(X+c)=\\mathrm{E}[X]+c+\\alpha\\mathrm{SD}(X)=H_{\\mathrm{SD}}(X)+c. \\] Solo queda por verificar la propiedad de monotonicidad, que puede cumplirse o no dependiendo del valor de \\(\\alpha\\). Para analizarlo, se considera de nuevo (10.2) y (10.3) donde \\(\\Pr[X\\leq Y]=1\\). Sea \\(\\alpha=0.1\\cdot \\sqrt{3}\\), entonces \\(H_{\\mathrm{SD}}(X)=3+0.3=3.3&lt; H_{\\mathrm{SD}}(Y)=4\\) y se cumple la condición de monotonicidad. Por otro lado, sea \\(\\alpha=\\sqrt{3}\\), entonces \\(H_{\\mathrm{SD}}(X)=3+3=6&gt; H_{\\mathrm{SD}}(Y)=4\\) y la condición de monotinicidad no se satisface. De forma más precisa, estableciendo \\[ H_{\\mathrm{SD}}(X) = 3+\\alpha\\sqrt{3} \\leq4= H_{\\mathrm{SD}}(Y), \\] Se observa que la condición de monotonicidad se satisface solo para \\(0\\leq\\alpha\\leq 1/\\sqrt{3}\\), y de este modo el principio de desviación estándar \\(H_{\\mathrm{SD}}\\) es coherente. Este resultado es muy intuitivo ya que el principio de desviación estándar \\(H_{\\mathrm{SD}}\\) es una combinación lineal de dos medidas de riesgo de las cuales una es coherente y la otra no lo es. Si \\(\\alpha\\leq 1/\\sqrt{3}\\), entonces la medida coherente domina a la no coherente, y de este modo la medida resultante \\(H_{\\mathrm{SD}}\\) es coherente y viceversa. Destacar que dicha conclusión no puede generalizarse a cualquier par de v.a. \\(X\\) e \\(Y\\). La literatura sobre medidas de riesgo ha crecido rápidamente en popularidad e importancia. En las dos secciones siguientes, se introducen dos índices que han ganado mucho interés recientemente entre teóricos, empíricos y reguladores. Son las medidas denominadas Valor en Riesgo (VaR) y Cola del Valor en Riesgo (TVaR). La racionalidad económica detrás de estas dos medidas de riesgo es similar a la de los métodos de clasificación de colas introducidos en la sección anterior, con las que se espera captar el riesgo de pérdidas extremas representadas por las colas de la distribución. 10.3.2 Valor en Riesgo En la Sección 4.1.1.3, se define el cuantil de una distribución. Se presenta ahora una caso especial de éste y se ofrece una definición formal del valor en riesgouna medida de riesgo basada en la función cuantílica, o VaR. Definición 10.3. Se considera la variable aleatoria pérdidas en seguros \\(X\\). La medida valor en riesgo de \\(X\\) con un nivel de confianza \\(q\\in (0,1)\\) se formula como \\[\\begin{eqnarray} VaR_q[X]:=\\inf\\{x:F_X(x)\\geq q\\}. \\tag{10.4} \\end{eqnarray}\\] Aquí, \\(inf\\) es el operador ínfimo de modo que la medida VaR proporciona el valor más pequeño de \\(X\\) tal que la cdffunción de distribución acumulada asociada supera o iguala a \\(q\\). Así es como debemos interpretar el VaR en el contexto de las aplicaciones actuariales. El VaR es una medida de la pérdida probable ‘máxima’ para un cartera/producto de seguros o una inversión con riesgo produciéndose \\(q\\times 100\\%\\) veces, a lo largo de un periodo de tiempo específico (típicamente, un año). Por ejemplo, sea \\(X\\) la v.a. pérdida anual para un producto de seguros, \\(VaR_{0,95}[X]=100\\) millones de dólares significa que hay un \\(5\\%\\) de probabilidad de que la pérdida supere 100 millones en un año dado. Debido a esta interpretación tan relevante, el VaR se ha convertido en una medida estándar en la medición de riesgos financieros y aseguradores desde 1990. Los conglomerados financieros, los reguladores, y los académicos usan a menudo el VaR para medir riesgos de capital, garantizar el cumplimiento de las reglas regulatorias, y divulgar las posiciones financieras. A continuación, se presentan unos cuantos ejemplos sobre el cálculo del VaR. Ejemplo 10.2.1. VaR para la distribución exponencial. Se considera una v.a. pérdidas en seguros \\(X\\sim Exp(\\theta)\\) para \\(\\theta&gt;0\\), entonces la cdf de \\(X\\) viene dada por \\[ F_X(x)=1-e^{-x/\\theta}, \\text{ para } x&gt;0. \\] Obtener una expresión cerrada para el VaR. Mostrar solución del ejemplo Solución. Dado que la distribución exponencial es una distribución continua, el valor más pequeño tal que la cdf excede o iguala a \\(q \\in (0,1)\\) debe ser el valor \\(x_q\\) que satisface \\[ q=F_X(x_q)=1-\\exp\\{-x_q/\\theta \\}. \\] De este modo \\[ VaR_q[X]=F_X^{-1}(q)=-\\theta[\\log(1-q)]. \\] El resultado presentado en el Ejemplo 10.2.1 puede generalizarse a cualquier v.a. continua con una cdf estrictamente creciente. Específicamente, el VaR de cualquier v.a continua es simplemente la inversa de la correspondiente cdf. Se considera otro ejemplo de una v.a. continua desde el infinito negativo hasta el infinito positivo. Ejemplo 10.2.2. VaR para la distribución normal. Se considera una v.a. pérdida en seguros \\(X\\sim Normal(\\mu,\\sigma^2)\\) con \\(\\sigma&gt;0\\). En este caso, se pueden interpretar los valores negativos de \\(X\\) como beneficio o ingreso. Obtener una expresión cerrada para el VaR. Mostrar solución al ejemplo Solución. Como la distribución normal es una distribución continua, el VaR de \\(X\\) debe satisfacer \\[\\begin{eqnarray*} q &amp;=&amp; F_X(VaR_q[X])\\\\ &amp;=&amp;\\Pr\\left[(X-\\mu)/\\sigma\\leq (VaR_q[X]-\\mu)/\\sigma\\right]\\\\ &amp;=&amp;\\Phi((VaR_q[X]-\\mu)/\\sigma). \\end{eqnarray*}\\] Por tanto, se tiene \\[ VaR_q[X]=\\Phi^{-1}(q)\\ \\sigma+\\mu. \\] En muchas aplicaciones de seguros se tiene que trabajar con transformaciones de v.a.. Por ejemplo, en el Ejemplo 10.2.2, la v.a. pérdida \\(X\\sim Normal(\\mu, \\sigma^2)\\) puede interpretarse como una transformación lineal de una normal estándar v.a. \\(Z\\sim Normal(0,1)\\), denominada \\(X=Z\\sigma+\\mu\\). Estableciendo \\(\\mu=0\\) y \\(\\sigma=1\\), es directo comprobar que \\(VaR_q[Z]=\\Phi^{-1}(q).\\) Un resultado relevante obtenido a partir del Ejemplo 10.2.2 es que el VaR de una transformación lineal de las v.a. normales es equivalente a la transformación lineal del VaR de las v.a. originales. Este resultado se puede generalizar a cualquier v.a. siempre y cuando las transformaciones sean estrictamente crecientes. Ejemplo 10.2.3. VaR para variables transformadas. Se considera una v.a. pérdida de seguros \\(Y\\sim lognormal(\\mu,\\sigma^2)\\), para \\(\\mu\\in \\mathbf{R}\\) y \\(\\sigma&gt;0\\). Obtener una expresión para el \\(VaR\\) de \\(Y\\) en función de la inversa normal estándar cdf. Mostrar solución al ejemplo Solución. Señalar que \\(\\log Y\\sim Normal(\\mu,\\sigma^2)\\), o de forma equivalente sea \\(X\\sim Normal(\\mu,\\sigma^2)\\), entonces \\(Y\\overset{d}{=}e^{X}\\) que es una transformación estrictamente creciente. Aquí, la notación `\\(\\overset{d}{=}\\)’ significa igualdad en la distribución. El VaR de \\(Y\\) viene dado de esta forma por la transformación exponencial del VaR de \\(X\\). Precisamente, para \\(q\\in (0,1)\\), \\[ VaR_{q}[Y]= e^{VaR_q[X]}=\\exp\\{\\Phi^{-1}(q)\\ \\sigma+\\mu\\}. \\] Hasta ahora se han visto una serie de ejemplos sobre el VaR para v.a. continuas. Se presenta ahora un ejemplo sobre el VaR de una v.a. discreta. Ejemplo 10.2.4. VaR para una variable aleatoria discreta. Se considera una v.a. pérdida en seguros con la siguiente distribución de probabilidad: \\[ {\\small \\Pr[X=x]=\\left\\{ \\begin{array}{ll} 1, &amp; \\hbox{con probabilidad $0,75$} \\\\ 3, &amp; \\hbox{con probabilidad $0,20$} \\\\ 4, &amp; \\hbox{con probabilidad $0,05$.} \\end{array} \\right. } \\] Determina el VaR para \\(q = 0,6, 0,9, 0,95, 0,95001\\). Mostrar solución al ejemplo Solución. La correspondiente cdf de \\(X\\) es \\[ F_X(x)=\\left\\{ \\begin{array}{ll} 0, &amp; \\hbox{ $x&lt;1$;} \\\\ 0,75, &amp; \\hbox{ $1\\leq x&lt;3$;} \\\\ 0,95, &amp; \\hbox{ $3\\leq x&lt;4$;} \\\\ 1, &amp; \\hbox{ $4\\leq x$.} \\end{array} \\right. \\] A partir de la definición del VaR, tenemos que \\(VaR_{0,6}[X]=1\\); \\(VaR_{0,9}[X]=3\\); \\(VaR_{0,95}[X]=3\\); \\(VaR_{0,950001}[X]=4\\). Se concluye esta subsección con una discusión abierta sobre la medida del VaR. Algunas ventajas de utilizar el VaR incluyen proporciona una interpretación práctica y sencilla; es relativamente sencillo de calcular para muchas funciones de distribución de forma cerrada; no se requieren supuestos adicionales para el cálculo del VaR. Por otro lado, las limitaciones del VaR pueden ser particularmente pronunciadas para algunas prácticas de gestión de riesgos. Algunas de ellas pueden ser: la selección del nivel de confianza \\(q\\in (0,1)\\) es muy subjetiva, mientras el VaR puede ser muy sensible a la elección de \\(q\\) (por ejemplo, en el Ejemplo 10.2.4, \\(VaR_{0,95}[X]=3\\) y \\(VaR_{0,950001}[X]=4\\)); los escenarios/información de pérdidas que están por encima del \\((1-p)\\times 100\\%\\) peor suceso, están completamente descuidados; el VaR no es una medida de riesgo coherente (específicamente, el VaR no satisface el axioma de subaditividad, lo que significa que los beneficios de la diversificación pueden no quedar suficientemente reflejados). 10.3.3 Cola del Valor en Riesgo Recalcar que el VaR representa \\((1-p)\\times100\\%\\) la máxima pérdida. Como se mencionó en la sección previa, uno de los mayores inconvenientes del VaR es que no refleja las pérdidas extremas que se producen más allá del \\((1-p)\\times100\\%\\) peor escenario. Con fines ilustrativos, se considera el siguiente ejemplo poco realista pero inspirador. Ejemplo 10.2.5. Se consideran dos v.a. de pérdidas \\(X\\sim Uniform [0,100]\\), e \\(Y\\sim Exp(31,71)\\). Se usa el VaR al \\(95\\%\\) de nivel de confianza para medir el riesgo de \\(X\\) e \\(Y\\). Mediante cálculos simples (ver, también, Ejemplo 10.2.1), \\[ VaR_{0,95}[X]=VaR_{0,95}[Y]=95, \\] y de ese modo estas dos distribuciones de pérdidas tienen el mismo nivel de riesgo según el \\(VaR_{0,95}\\). Sin embargo, está claro que \\(Y\\) tiene mayor riesgo que \\(X\\) si las pérdidas extremas son más preocupantes ya que \\(X\\) está limitada por arriba mientras que \\(Y\\) no lo está. La simple cuantificación del riesgo mediante el uso del VaR a un nivel de confianza específico podría ser engañosa y no reflejar la verdadera naturaleza del riesgo. Para remediarlo, fue propuesta la Cola del Valor en Riesgo (TVaR) para medir las pérdidas extremas que están por encima de un nivel dado del VaR como una media. Se presenta a continuación la definición del TVaR. Para simplificar, nos vamos a limitar a las v.a. positivas continuas, que se utilizan con más frecuencia en el contexto de la gestión de riesgos de seguros. Se remite al lector interesado a Hardy (2006) para una discusión más completa del TVaR para v.a. discretas y continuas. Definición 10.4. Dado \\(q\\in (0,1)\\), la cola del valor en riesgoel valor esperado de un riesgo dado que el riesgo excede el valor en riesgo de una v.a. (continua) \\(X\\) se define como \\[\\begin{eqnarray*} TVaR_q[X] &amp;:=&amp; \\mathrm{E}[X|X&gt;VaR_q[X]], \\end{eqnarray*}\\] dado que el valor esperado existe. Teniendo en cuenta la Definición 10.4, el cálculo del TVaR típicamente consta de dos partes - el VaR y la media de pérdidas que están por encima del VaR. El TVaR se puede calcular por medio de fórmulas. Se considera una v.a. \\(X\\) positiva continua, por conveniencia notacional, escrita de ahora en adelante \\(\\pi_q:=VaR_q[X]\\). Por definición, el TVaR puede calcularse vía \\[\\begin{eqnarray} TVaR_{q}[X]=\\frac{1}{(1-q)}\\int_{\\pi_q}^{\\infty}xf_X(x)dx. \\tag{10.5} \\end{eqnarray}\\] Ejemplo 10.2.6. TVaR para una distribución normal. Se considera una v.a. pérdida de seguros \\(X\\sim Normal (\\mu,\\sigma^2)\\) con \\(\\mu\\in \\mathbf{R}\\) y \\(\\sigma&gt;0\\). Obtener una expresión para el TVaR. Mostrar solución al ejemplo Solución. Sea \\(Z\\) la v.a. normal estándar. Para \\(q\\in(0,1)\\), el TVaR de \\(X\\) puede calcularse como \\[\\begin{eqnarray*} TVaR_q[X] &amp;=&amp; \\mathrm{E}[X|X&gt;VaR_q[X]]\\\\ &amp;=&amp;\\mathrm{E}[\\sigma Z+\\mu|\\sigma Z+\\mu&gt;VaR_q[X]]\\\\ &amp;=&amp; \\sigma\\mathrm{E}[Z|Z&gt;(VaR_q[X]-\\mu)/\\sigma]+\\mu\\\\ &amp;\\overset{(1)}{=}&amp; \\sigma\\mathrm{E}[Z|Z&gt;VaR_q[Z]]+\\mu, \\end{eqnarray*}\\] donde `\\(\\overset{(1)}{=}\\)’ debido a los resultados presentados en el Ejemplo 10.2.2. A continuación, se estudia \\(TVaR_q[Z]=\\mathrm{E}[Z|Z&gt;VaR_q[Z]]\\). Sea \\(\\omega(q)=(\\Phi^{-1}(q))^2/2\\), se tiene \\[\\begin{eqnarray*} (1-q)\\ TVaR_q[Z] &amp;=&amp; \\int_{\\Phi^{-1}(q)}^{\\infty} z \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2}dz\\\\ &amp;=&amp; \\int_{\\omega(q)}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} e^{-x}dx\\\\ &amp;=&amp; \\frac{1}{\\sqrt{2\\pi}} e^{-\\omega(q)}\\\\ &amp;=&amp; \\phi(\\Phi^{-1}(q)). \\end{eqnarray*}\\] De este modo, \\[ TVaR_q[X]=\\sigma\\frac{\\phi(\\Phi^{-1}(q))}{1-q}+\\mu. \\] Se mencionó anteriormente en la subsección previa que el VaR de una función estrictamente creciente de una v.a. es igual a la función VaR de la v.a. original. Como consecuencia de los resultados del Ejemplo 10.2.6, se puede demostrar que el TVaR de una v.a. transformación lineal estrictamente creciente es igual a la función VaR de la v.a. original. Esto es debido a la propiedad de linealidad de los valores esperados. Sin embargo, el resultado anterior no puede extenderse a funciones no lineales. El siguiente caso de v.a. lognormales sirve como ejemplo. Ejemplo 10.2.7. TVaR de una distribución lognormal. Se considera una v.a. de pérdidas de seguros \\(X\\sim lognormal (\\mu,\\sigma^2)\\), con \\(\\sigma&gt;0\\). Demuestra que \\[\\begin{eqnarray*} TVaR_q[X] &amp;=&amp; \\frac{e^{\\mu+\\sigma^2/2}}{(1-q)} \\Phi(\\Phi^{-1}(q)-\\sigma). \\end{eqnarray*}\\] Mostrar solución al ejemplo Solución. Recordar que la pdf de una distribución lognormal se formula como \\[ f_X(x)=\\frac{1}{\\sigma\\sqrt{2\\pi} x}\\exp\\{-(\\ln x-\\mu )^2/2\\sigma^2 \\}, \\text{ para } x&gt;0. \\] Dado que \\(q\\in(0,1)\\), entonces el TVaR de \\(X\\) se puede calcular como \\[\\begin{eqnarray} TVaR_q[X] &amp;=&amp; \\frac{1}{(1-q)} \\int_{\\pi_q}^{\\infty} x f_X(x)dx \\nonumber\\\\ &amp;=&amp;\\frac{1}{(1-q)} \\int_{\\pi_q}^{\\infty} \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\left\\{ -\\frac{(\\log x-\\mu)^2}{2\\sigma^2} \\right\\}dx\\nonumber\\\\ &amp;\\overset{(1)}{=}&amp;\\frac{1}{(1-q)} \\int_{\\omega(q)}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} e^{ -\\frac{1}{2}w^2+\\sigma w+\\mu}dw\\nonumber\\\\ &amp;=&amp;\\frac{e^{\\mu+\\sigma^2/2}}{(1-q)} \\int_{\\omega(q)}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} e^{ -\\frac{1}{2}(w-\\sigma)^2}dw\\nonumber\\\\ &amp;=&amp;\\frac{e^{\\mu+\\sigma^2/2}}{(1-q)} \\Phi(\\omega(q)-\\sigma), \\tag{10.6} \\end{eqnarray}\\] donde \\(\\overset{(1)}{=}\\) aplicando un cambio de variable \\(w=(\\log x-\\mu)/\\sigma\\), y \\(\\omega(q)=(\\log \\pi_q-\\mu)/\\sigma\\). Recordando la fórmula del VaR para la v.a. lognormal presentada en el Ejemplo 10.2.2, se puede simplificar la expresión (10.6) en \\[\\begin{eqnarray*} TVaR_q[X] &amp;=&amp; \\frac{e^{\\mu+\\sigma^2/2}}{(1-q)} \\Phi(\\Phi^{-1}(q)-\\sigma). \\end{eqnarray*}\\] De forma clara, el TVaR de una v.a. lognormal no es la exponencial del TVaR de una v.a. normal. Cuando las funciones de distribución son más fáciles de trabajar, se puede aplicar la integración por partes para reescribir la ecuación (10.5) como \\[\\begin{eqnarray*} TVaR_{q}[X]&amp;=&amp;\\left[-x S_X(x)\\big |_{\\pi_q}^{\\infty}+\\int_{\\pi_q}^{\\infty}S_X(x)dx\\right]\\frac{1}{(1-q)}\\\\ &amp;=&amp; \\pi_q +\\frac{1}{(1-q)}\\int_{\\pi_q}^{\\infty}S_X(x)dx. \\end{eqnarray*}\\] Ejemplo 10.2.8. TVaR de una distribución exponencial. Se considera una v.a. pérdida de seguros \\(X\\sim Exp(\\theta)\\) para \\(\\theta&gt;0\\). Obtener una expresión para el TVaR. Mostrar solución al ejemplo Solución. Se ha visto en la subsección previa que \\[ \\pi_q=-\\theta[\\log(1-q)]. \\] Consideremos ahora el TVaR: \\[\\begin{eqnarray*} TVaR_q[X] &amp;=&amp; \\pi_q+\\int_{\\pi_q}^{\\infty} e^{-x/\\theta}dx/(1-q)\\\\ &amp;=&amp; \\pi_q+\\theta e^{-\\pi_q/\\theta}/(1-q)\\\\ &amp;=&amp; \\pi_q+\\theta. \\end{eqnarray*}\\] Puede ser también provechoso expresar el TVaR en términos de valores esperados limitados. Específicamente tenemos \\[\\begin{eqnarray} TVaR_q[X] &amp;=&amp; \\int_{\\pi_q}^{\\infty} (x-\\pi_q+\\pi_q)f_X(x)dx/(1-q) \\nonumber\\\\ &amp;=&amp; \\pi_q+\\frac{1}{(1-q)}\\int_{\\pi_q}^{\\infty} (x-\\pi_q)f_X(x)dx\\nonumber\\\\ &amp;=&amp; \\pi_q+e_X(\\pi_q)\\nonumber\\\\ &amp;=&amp; \\pi_q +\\frac{\\left({\\mathrm{E}[X]-\\mathrm{E}[X\\wedge\\pi_q]}\\right)}{(1-q)}, \\tag{10.7} \\end{eqnarray}\\] donde \\(e_X(d):=\\mathrm{E}[X-d|X&gt;d]\\) para \\(d&gt;0\\) indica la función de exceso de pérdida media . Para muchas de las distribuciones paramétricas comúnmente usadas, las fórmulas para calcular \\(\\mathrm{E}[X]\\) y \\(\\mathrm{E}[X\\wedge\\pi_q]\\) pueden ser encontradas en una tabla de distribuciones. Ejemplo 10.2.9. TVaR de la distribución Pareto. Se considera una v.a. de pérdida \\(X\\sim Pareto(\\theta,\\alpha)\\) con \\(\\theta&gt;0\\) y \\(\\alpha&gt;0\\). La cdf de \\(X\\) viene dada por \\[ F_X(x)=1-\\left(\\frac{\\theta}{\\theta+x} \\right)^{\\alpha}, \\text{ para } x&gt;0 . \\] Estableciendo \\(q\\in (0,1)\\) y siendo \\(F_X(\\pi_q)=q\\), fácilmente se obtiene \\[\\begin{eqnarray} \\pi_q=\\theta\\left[(1-q)^{-1/\\alpha}-1 \\right]. \\tag{10.8} \\end{eqnarray}\\] De acuerdo a la tabla de distribuciones facilitada en la Sociedad de Actuarios, se sabe que \\[ \\mathrm{E}[X]=\\frac{\\theta}{\\alpha-1}, \\] y \\[ \\mathrm{E}[X\\wedge \\pi_q]=\\frac{\\theta}{\\alpha-1}\\left[ 1-\\left(\\frac{\\theta}{\\theta+\\pi_q}\\right)^{\\alpha-1} \\right]. \\] Recordando la ecuación (10.7) se tiene \\[\\begin{eqnarray*} TVaR_q[X] &amp;=&amp; \\pi_q+\\frac{\\theta}{\\alpha-1} \\frac{(\\theta/(\\theta+\\pi_q))^{\\alpha-1}} {(\\theta/(\\theta+\\pi_q))^{\\alpha}}\\\\ &amp;=&amp;\\pi_q +\\frac{\\theta}{\\alpha-1}\\left( \\frac{\\pi_q+\\theta}{\\theta} \\right)\\\\ &amp;=&amp; \\pi_q+\\frac{\\pi_q+\\theta}{\\alpha-1}, \\end{eqnarray*}\\] donde \\(\\pi_q\\) viene dada por (10.8). A partir de un cambio de variables, se puede también reescribir la ecuación (10.5) como \\[\\begin{eqnarray} TVaR_{q}[X] &amp;=&amp; \\frac{1}{(1-q)}\\int_{q}^{1} VaR_{\\alpha}[X]\\ d\\alpha. \\tag{10.9} \\end{eqnarray}\\] Lo que esta fórmula alternativa (10.9) indica es que el TVaR es de hecho la media del \\(VaR_{\\alpha}[X]\\) con un nivel de confianza variable \\(\\alpha\\in [q,1]\\). Por tanto, el TVaR resuelve efectivamente la mayoría de las limitaciones del VaR señaladas en la subsección previa. Primero, debido al efecto promedio, el TVaR puede ser menos sensible al cambio del nivel de confianza comparado con el VaR. Segundo, todas las pérdidas extremas que están por encima de \\((1-q)\\times 100\\%\\) representando los peores sucesos probables son tenidas en cuenta. En este sentido, es fácil ver que para cualquier \\(q\\in (0,1)\\) \\[ TVaR_q[X]\\geq VaR_q[X]. \\] Tercero y tal vez de forma más relevante, el TVaR es una medida de riesgo coherente y de este modo es capaz de capturar de modo más acertado los efectos de la diversificación de la cartera de seguros. En este caso, no se formula el objetivo de proporcionar la demostración de la característica coherente para el TVaR, que se considera técnicamente cambiante. 10.4 Reaseguro En esta sección, se aprende como: Definir tipos básicos de reaseguro incluyendo el proporcional, cuota- parte, no-proporcional, stop-loss, exceso de pérdida, y excedente. Interpretar la optimalidad de la cuota para los reaseguradores y calcular los acuerdos óptimos de repartos de cuotas. Interpretar la optimalidad del stop-loss para los aseguradores. Interpretar y calcular los límites óptimos de retención de exceso de pérdidas. Recordar que reaseguroseguro comprado por un asegurador es simplemente el seguro comprado por un asegurador. El seguro comprado por no-aseguradores se conoce algunas veces como seguro primarioseguro comprado por un no-asegurador para distinguirlo del reaseguro. El reaseguro difiere de un seguro personal comprado por los individuos, como el seguro de automóviles o el seguro del hogar, en la flexibilidad del contrato. Al igual que los seguros comprados por las grandes empresas, los programas de reaseguro suelen adaptarse mucho al comprador. Por el contrario, los compradores de seguros personales normalmente no pueden negociar los términos del contrato aunque pueden tener una variedad de diferentes opciones (contratos) para elegir. Los dos tipos más amplios de reaseguro son el proporcional y el no-proporcional. Un contrato de reaseguro proporcional un acuerdo entre un reasegurador y una compañía cedente (también conocida como reasegurada) en el cual el reasegurador asume un porcentaje dado de pérdidas y primas es un acuerdo entre un reasegurador y una compañía cedenteuna compañía que compra reaseguro (también conocida como reasegurada) (también conocida como la reasegurada) en el cual el reasegurador asume un porcentaje dado de pérdidas y primas. Un contrato de reaseguro se conoce también como un acuerdoun contrato de reaseguro. Los acuerdos no-proporcionales son simplemente todo lo demás. Como ejemplos de acuerdos no-proporcionales, este capítulo se centra en stop-lossbajo un acuerdo stop-loss, el asegurador establece un nivel de retención y paga siniestros hasta ese nivel con el reasegurador pagando el exceso y ,exceso de pérdida bajo un contrato de exceso de pérdida, el asegurador establece un nivel de retención para cada siniestro y paga indemnizaciones inferiores a dicho nivel mientras que el reasegurador paga el exceso contratado. Para todos los tipos de acuerdos, se divide el riesgo total \\(X\\) entre la porción que asume el reasegurador, \\(Y_{reasegurador}\\), y el retenido por el asegurador, \\(Y_{asegurador}\\), es decir, \\(X= Y_{asegurador}+Y_{reasegurador}\\). La estructura matemática de un contrato de reaseguro básico es la misma que la considerada en las modificacions de cobertura para seguros personales analizados en el Capítulo 3. Para un reaseguro proporcional, la transformación \\(Y_{asegurador} = c X\\) es idéntica a un ajuste de coaseguro en un seguro personal. Para un reaseguro stop-loss, la transformación \\(Y_{reasegurador} = \\max(0,X-M)\\) es la misma que el pago de un asegurador con una franquicia \\(M\\) e \\(Y_{asegurador} = \\min(X,M) = X \\wedge M\\) es equivalente a lo que un tomador paga con una franquicia \\(M\\). Para aplicaciones matemáticas prácticas, en los seguros personales el foco está generalmente en los valores esperados como el ingrediente principal usado en tarificación. Por el contrario, en reaseguro el foco está en la distribución completa del riesgo, dado que los valores extremos son la principal preocupación de la estabilidad financera del asegurador y del reasegurador. Esta sección describe los fundamentos y cuestiones más básicas de los acuerdos de reaseguro: Sección 10.4.1 para el reaseguro proporcional y Sección 10.4.2 para el reaseguro no-proporcional. La Sección 10.4.3 da una pincelada a los contratos más complejos. 10.4.1 Reaseguro Proporcional El ejemplo más sencillo de contratos proporcionales se denominacuota parteUn acuerdo proporcional donde el reasegurador recibe un porcentaje determinado de la prima por la cartera de negocio reasegurado y paga un porcentaje de las pérdidas, incluyendo los gastos asignados de ajuste de pérdidas. El reasegurador puede también pagar a la compañía cedente una comisión de cesión diseñada para reflejar las diferencias en los gastos incurridos en la suscripción.. En un contrato de cuota parte, el reasegurador recibe un porcentaje determinado, digamos el 50%, de la prima por la cartera de negocio reasegurado. A cambio, el reasegurador paga el 50% de las pérdidas, incluidos los gastos asignados de ajuste de pérdidas. El reasegurador también paga a la compañía cedente una comisión de cesión diseñada para reflejar las diferencias en los gastos de suscripción incurridos. Las cantidades pagadas por el asegurador de directo y el reasegurador se resumen como \\[ Y_{asegurador} = c X \\ \\ \\text{y} \\ \\ \\ Y_{reasegurador} = (1-c) X, \\] donde \\(c\\in (0,1)\\) representa la proporción retenida por el asegurador. Destacar que \\(Y_{asegurador}+Y_{reasegurador}=X\\). Ejemplo 10.3.1. Distribución de pérdidas bajo un contrato cuota parte. Para tener en cuenta una idea sobre el efecto de un contrato cuota parte en la distribución de pérdidas, se presenta a continuación una demostración breve en R usando simulación. Tener en cuenta las formas relativas de las distribuciones de las pérdidas totales, la parte retenida (del asegurador), y la parte del reasegurador. Mostrar el Código R set.seed(2018) theta = 1000 alpha = 3 nSim = 10000 library(actuar) X &lt;- rpareto(nSim, shape = alpha, scale = theta) par(mfrow=c(1,3)) plot(density(X), xlim=c(0,3*theta), ylim=c(0,0.008), main=&quot;Total Loss&quot;, xlab=&quot;Losses&quot;) plot(density(0.75*X), xlim=c(0,3*theta), ylim=c(0,0.008), main=&quot;Insurer (75%)&quot;, xlab=&quot;Losses&quot;) plot(density(0.25*X), xlim=c(0,3*theta), ylim=c(0,0.008), main=&quot;Reinsurer (25%)&quot;, xlab=&quot;Losses&quot;) 10.4.1.1 El Cuota Parte es deseable para los Reaseguradores El contrato cuota parte es particularmente deseable para el reasegurador. Para entenderlo, supongamos que un asegurador y un reasegurador desean firmar un contrato para repartir las pérdidas totales \\(X\\) tal que \\[Y_{asegurador}=g(X) \\ \\ \\ \\text{y} \\ \\ \\ \\ Y_{reasegurador}=X-g(X),\\] para alguna función genérica \\(g(\\cdot)\\) (conocida como la función retención). Supongamos además que el asegurador solo se preoucupa por la variabilidad de los siniestros retenidos y es indiferente a la elección de \\(g\\) siempre que \\(Var(Y_{asegurador})\\) sea la misma e igual, digamos, \\(Q\\). Entonces, el siguiente resultado demuestra que el contrato de reaseguro de cuota parte minimiza la incertidumbre del reasegurador medida por \\(Var(Y_{reasegurador})\\). Proposición. Se supone que \\(Var(Y_{asegurador})=Q.\\) Entonces, \\(Var ((1-c)X) \\le Var(g(X))\\) para todo \\(g(.)\\), donde \\(c=Q/Var(X)\\). Mostrar la Justificación de la Proposición Demostración de la Proposición. Donde \\(Y_{reasegurador} = X - Y_{asegurador}\\) y la ley de la variación total \\[ \\begin{array}{ll} Var (Y_{reasegurador}) &amp;= Var (X-Y_{asegurador}) \\\\ &amp;= Var (X) + Var (Y_{asegurador}) - 2 Cov (X,Y_{asegurador}) \\\\ &amp;=Var (X) + Q - 2 Corr (X,Y_{asegurador}) \\times \\sqrt{Q} \\sqrt{Var (X)} \\end{array} \\] En esta expresión, vemos que \\(Q\\) y \\(Var(X)\\) no cambian con la elección de \\(g\\). De este modo, se puede minimizar \\(Var (Y_{reasegurador})\\) maximizando la correlación \\(Corr (X,Y_{asegurador})\\). Si se usa un contrato de reaseguro cuota parte, entonces \\(Corr (X,Y_{asegurador})=Corr (X,(1-c)X)=1\\), la máxima correlación posible. Esto muestra la proposición. \\(\\Box\\)` La propuesta es intuitivamente atractiva – con un contrato de cuota parte, el reasegurador comparte la responsabilidad para siniestros muy grandes en la cola de la distribución. Esto contrasta con los acuerdos no proporcionales donde los reaseguradores se responsabilizan de las grandes reclamaciones. 10.4.1.2 Optimizando los Contratos Cuota Parte para Aseguradores Ahora se asumen \\(n\\) riesgos en la cartera, \\(X_1, \\ldots, X_n,\\) tal que la suma de la cartera es \\(X= X_1 + \\cdots + X_n\\). Por simplicidad, nos centramos en el caso de riesgos independientes. Se considera una variación del contrato básico de cuota parte donde la cantidad retenida por el asegurador puede variar con cada riesgo, digamos \\(c_i\\). De este modo, la parte que el asegurador asume del riesgo de la cartera es \\(Y_{asegurador} = \\sum_{i=1}^n c_i X_i\\). ¿Cuál es la mejor elección de las partes \\(c_i\\)? Para formalizar esta pregunta, tratamos de encontrar aquellos valores de \\(c_i\\) que minimizan \\(Var (Y_{asegurador})\\) teniendo en cuenta la restricción de que \\(E (Y_{asegurador}) = K.\\) El requisito de que \\(E (Y_{asegurador}) = K\\) sugiere que los aseguradores prefieren retener un ingreso como mínimo de la cantidad de la constante \\(K\\). Sujeto a esta restricción sobre el ingreso, el asegurador prefiere minimizar la incertidumbre de los riesgos retenidos medida por la varianza. Mostrar las Proporciones de Retención Óptimas Las Proporciones de Retención Óptimas La minimización de \\(Var(Y_{asegurador})\\) sujeta a \\(E(Y_{asegurador}) = K\\) es un problema de optimización restringida – se puede usar el método de los multiplicadores de Lagrange, una técnica de cálculo, para resolverlo. Para ello, se define el Lagrangiano \\[ \\begin{array}{ll} L &amp;= Var (Y_{asegurador}) - \\lambda (E (Y_{asegurador}) - K) \\\\ &amp;= \\sum_{i=1}^n c_i^2 ~Var(X_i) - \\lambda (\\sum_{i=1}^n c_i ~E(X_i) - K) \\end{array} \\] Calculando la derivada parcial respecto a \\(\\lambda\\) y fijándola igual a cero simplemente significa que se fuerza la restricción, \\(E(Y_{asegurador}) = K\\), y se tienen que elegir las proporciones \\(c_i\\) para satisfacer esta restricción. Además, obteniendo la derivada parcial respecto a cada proporción \\(c_i\\) se obtiene \\[ \\frac{\\partial}{\\partial c_i} L = 2 c_i ~Var(X_i) - \\lambda ~E(X_i) = 0 \\] Tal que \\[ c_i = \\frac{\\lambda}{2} \\frac{E(X_i)}{Var(X_i)} . \\] Con la restricción, se puede determinar \\(\\lambda\\) como la solución de \\[ \\begin{array}{ll} K &amp;= \\sum_{i=1}^3 c_i \\mathrm{E}(X_i) \\\\ &amp;= \\frac{\\lambda}{2} \\sum_{i=1}^3 \\frac{\\mathrm{E}(X_i)^2}{Var(X_i)} \\end{array} \\] Y usar este valor de \\(\\lambda\\) para determinar las proporciones. Desde el punto de vista matemático, se observa que la constante para el riesgo \\(i\\)th, \\(c_i\\) es proporcional a \\(\\frac{E(X_i)}{Var (X_i)}\\). Esto es intuitivamente interesante. Si el resto permanece igual, un mayor ingreso medido por \\(E (X_i)\\) significa un valor más alto de \\(c_i\\). De la misma forma, un mayor grado de incertidumbre medido por \\(Var(X_i)\\)significa un menor valor de \\(c_i\\). El factor de escala proporcional se determina por el requisito de ingreso \\(E(Y_{asegurador}) = K\\). El siguiente ejemplo ayuda a entender esta relación. Ejemplo 10.3.2. Tres riesgos Pareto. Se consideran tres riesgos que siguen una distribución de Pareto. Generar un gráfico, y el código necesario, que proporcionan valores de \\(c_1\\), \\(c_2\\), y \\(c_3\\) para un ingreso determinado \\(K\\). Observar si esos valores aumentan linealmente con \\(K\\). Mostrar un Ejemplo con Tres Riesgos Pareto theta1 = 1000; theta2 = 2000; theta3 = 3000; alpha1 = 3; alpha2 = 3; alpha3 = 4; library(actuar) propnfct &lt;- function(alpha,theta){ mu &lt;- mpareto(shape=alpha, scale=theta, order=1) var &lt;- mpareto(shape=alpha, scale=theta, order=2) - mu^2 mu/var } temp &lt;- propnfct(alpha1, theta1)*mpareto(shape=alpha1, scale=theta1, order=1)+ propnfct(alpha2, theta2)*mpareto(shape=alpha2, scale=theta2, order=1)+ propnfct(alpha3, theta3)*mpareto(shape=alpha3, scale=theta3, order=1) KVec &lt;- seq(100, 2500, length.out=20) Lambdavec &lt;- 2*KVec/temp c1 &lt;- propnfct(alpha1, theta1) c2 &lt;- propnfct(alpha2, theta2) c3 &lt;- propnfct(alpha3, theta3) c1Vec &lt;- c2Vec &lt;- c3Vec &lt;- 0*KVec for (j in 1:20) { c1Vec[j] &lt;- (Lambdavec[j]/2) * propnfct(alpha1, theta1) c2Vec[j] &lt;- (Lambdavec[j]/2) * propnfct(alpha2, theta2) c3Vec[j] &lt;- (Lambdavec[j]/2) * propnfct(alpha3, theta3) } plot(KVec, c1Vec, type=&quot;l&quot;, ylab=&quot;proportion&quot;, xlab=&quot;required revenue (K)&quot;, ylim=c(0,1)) lines(KVec, c2Vec) lines(KVec, c3Vec) text(1200,0.80, expression(c[1])) text(2000,0.75, expression(c[2])) text(1500,0.30, expression(c[3])) 10.4.2 Reaseguro No-Proporcional 10.4.2.1 La Optimalidad del Seguro Stop-Loss Bajo un contrato stop-loss, el asegurador establece un nivel de retención \\(M (&gt;0)\\) y paga en su totalidad los siniestros para los que \\(X \\le M\\). Además, para los siniestros con \\(X &gt; M\\), el asegurador de directo paga \\(M\\) y el reasegurador para la cantidad restante \\(X-M\\). De este modo, el asegurador retiene una cantidad \\(M\\) del riesgo. Resumiendo, las cantidades pagadas por el asegurador de directo y el reasegurador son \\[ Y_{asegurador} = \\begin{cases} X &amp; \\text{for } X \\le M\\\\ M &amp; \\text{for } X &gt;M \\\\ \\end{cases} \\ \\ \\ \\ = \\min(X,M) = X \\wedge M \\] y \\[ Y_{reasegurador} = \\begin{cases} 0 &amp; \\text{for } X \\le M\\\\ X- M &amp; \\text{for } X &gt;M \\\\ \\end{cases} \\ \\ \\ \\ = \\max(0,X-M) . \\] Como antes, notar que \\(Y_{asegurador}+Y_{reasegurador}=X\\). El tipo de contrato stop-loss es particularmente deseable para el asegurador. Similar a lo visto anteriormente, se supone que un asegurador y un reasegurador desean establecer un contrato tal que \\(Y_{asegurador}=g(X)\\) e \\(Y_{reasegurador}=X-g(X)\\) para alguna función de retención genérica \\(g(\\cdot)\\). Se supone además que el asegurador solo se encarga de la variabilidad de los siniestros retenidos y es indiferente respecto a la elección de \\(g\\) siempre que la \\(Var(Y_{asegurador})\\) pueda ser minimizada. De nuevo, se impone la restricción de que \\(E(Y_{asegurador}) = K\\); el asegurador tiene que retener un ingreso \\(K\\). Sujeto a esta restricción de ingreso, el asegurador desea minimizar la incertidumbre de los riesgos retenidos (medida por la varianza). Entonces, se obtiene el siguiente resultado que indica que el acuerdo de reaseguro stop-loss minimiza la incertidumbre del reasegurador medida por \\(Var(Y_{reasegurador})\\). Proposición. Se supone que \\(E(Y_{asegurador})=K.\\) Entonces, \\(Var (X \\wedge M) \\le Var(g(X))\\) para todo \\(g(.)\\), donde \\(M\\) es tal que \\(E(X \\wedge M)=K\\). Mostrar la Justificación de la Proposición Demostración de la Proposición. Añadir y restar una constante \\(M\\) y generar el cuadrado \\[ \\begin{array}{ll} Var(g(X)) &amp;= E (g(X) - K)^2 = E (g(X) -M +M- K)^2 \\\\ &amp;= E (g(X) -M)^2 + (M- K)^2 +2 E (g(X) -M)(M- K) \\\\ &amp;= E (g(X) -M)^2 - (M- K)^2 , \\end{array} \\] Porque \\(E(g(X))= K.\\) Ahora, para cualquier función de retención, se tiene \\(g(X) \\le X\\), es decir, los siniestros retenidos por el asegurador son menores o iguales que el total de los siniestros. Usando la notación \\(g_{SL}(X) = X \\wedge M\\) para los seguros stop-loss, se tiene \\[ \\begin{array}{ll} M- g_{SL}(X) &amp;= M-(X \\wedge M) \\\\ &amp;= (M-X) \\wedge 0 \\\\ &amp;\\le (M-g(X)) \\wedge 0 . \\end{array} \\] Elevando al cuadrado cada parte se tiene \\[(M- g_{SL}(X))^2 \\le (M-g(X))^2 \\wedge 0 \\le (M-g(X))^2.\\] Volviendo a la expresión de la varianza, \\[ \\begin{array}{ll} Var(g_{SL}(X)) &amp;= E (g_{SL}(X) -M)^2 - (M- K)^2 \\\\ &amp;\\le E (g(X) -M)^2 - (M- K)^2 = Var(g(X)) , \\end{array} \\] para cualquier función de retención \\(g\\). Esto demuestra la proposición. \\(\\Box\\)` La proposición es intuitivamente interesante – con el seguro stop-loss, el reasegurador es responsable de los siniestros muy grandes en la cola de la distribución, no el asegurador. 10.4.2.2 Exceso de Pérdida Una forma cerrada de reaseguro no-proporcional es la cobertura exceso de pérdida Bajo un acuerdo de exceso de pérdida, el asegurador establece un nivel de retención para cada siniestro y paga indemnizaciones inferiores a dicho nivel con el reasegurador pagando el exceso. Bajo este contrato, se asume que el riesgo total \\(X\\) puede entenderse como una composición de \\(n\\) riesgos separados \\(X_1, \\ldots, X_n\\) y que cada uno de esos riesgos están sujetos a un límite superior, digamos, \\(M_i\\). De este modo el asegurador retiene \\[ Y_{i,asegurador} = X_i \\wedge M_i \\ \\ \\ \\ Y_{asegurador} = \\sum_{i=1}^n Y_{i,asegurador} \\] y el reasegurador es responsable del exceso, \\(Y_{reasegurador}=X - Y_{asegurador}\\). Los límites de retención pueden variar según el riesgo o pueden ser los mismos para todos los riesgos, \\(M_i =M\\), para todo \\(i\\). 10.4.2.3 Elección Óptima de los Límites de Retención para Exceso de Pérdidas ¿Cuál es la mejor elección de los límites de retención del exceso de pérdidas \\(M_i\\)? Para formalizar esta pregunta, se propone encontrar aquellos valores de \\(M_i\\) que minimizan \\(Var(Y_{asegurador})\\) sujetos a la restricción de que \\(E(Y_{asegurador}) = K.\\) Sujeto a esta restricción de ingresos, el asegurador desea minimizar la incertidumbre de los riesgos retenidos (medidos por la varianza). Mostrar las Proporciones de Retención Óptimas Los Límites de Retención Óptimos Minimizar \\(Var(Y_{asegurador})\\) sujeto a \\(E(Y_{asegurador}) = K\\) es un problema de optimización restringida – se puede usar el método de los multiplicadores de Lagrange, una técnica de cálculo, para resolverlo. Como antes, se define el Lagrangiano \\[ \\begin{array}{ll} L &amp;= Var (Y_{asegurador}) - \\lambda (E(Y_{asegurador}) - K) \\\\ &amp;= \\sum_{i=1}^n ~Var (X_i \\wedge M_i) - \\lambda (\\sum_{i=1}^n ~E(X_i \\wedge M_i)- K). \\end{array} \\] En primer lugar se presentan las relaciones \\[ E(X \\wedge M) = \\int_0^M ~(1- F(x))dx \\] y \\[ E(X \\wedge M)^2 = 2\\int_0^M ~x(1- F(x))dx. \\] Calculando la derivada parcial respecto a \\(\\lambda\\) y fijándola igual a cero simplemente significa que se fuerza la restricción, \\(E(Y_{asegurador}) = K\\), y se han de elegir los límites \\(M_i\\) para satisfacer dicha restricción. Además, calculando la derivada parcial respecto a cada límite \\(M_i\\) se obtiene \\[ \\begin{array}{ll} \\frac{\\partial}{\\partial M_i} L &amp;= \\frac{\\partial}{\\partial M_i} ~Var(X_i \\wedge M_i) - \\lambda \\frac{\\partial}{\\partial M_i} ~E(X_i \\wedge M_i) \\\\ &amp;= \\frac{\\partial}{\\partial M_i} \\left(E(X_i \\wedge M_i)^2 -(E(X_i \\wedge M_i))^2\\right) - \\lambda (1-F_i(M_i)) \\\\ &amp;= 2 M_i (1-F_i(M_i)) - 2 E(X_i \\wedge M_i) (1-F_i(M_i))- \\lambda (1-F_i(M_i)). \\end{array} \\] Estableciendo \\(\\frac{\\partial}{\\partial M_i} L =0\\) y resolviendo para \\(\\lambda\\), se obtiene \\[ \\lambda = 2 (M_i - E(X_i \\wedge M_i)) . \\] Desde el punto de vista matemático se obtiene que el límite de retención menos los siniestros esperados por el asegurador, \\(M_i - E(X_i \\wedge M_i)\\), es el mismo para todos los riesgos. Esto es intuitivamente interesante. Ejemplo 10.3.3. Exceso de pérdidas para tres riesgos de Pareto . Se consideran tres riesgos que siguen una distribución de Pareto, cada uno definido por un set diferente de parámetros (de forma que son independientes pero no-idénticos). Demostrar numéricamente que los límites óptimos de retención \\(M_1\\), \\(M_2\\), y \\(M_3\\) calulados como los límites de retención menos los siniestros esperados por el asegurador, \\(M_i - E(X_i \\wedge M_i)\\), son los mismos para todos los riesgos, como se demuestra teóricamente. Además, comparar gráficamente la distribución de todos los riesgos con la de los retenidos por el asegurador y el reasegurador. Mostrar un Ejemplo con Tres Riesgos Pareto Primero se optimiza el Lagrangiano usando el paquete R alabama para Algoritmo de Minimización de la Barrera Adaptativa del Lagrangiano Aumentado. theta1 = 1000;theta2 = 2000;theta3 = 3000; alpha1 = 3; alpha2 = 3; alpha3 = 4; Pmin &lt;- 2000 library(actuar) VarFct &lt;- function(M){ M1=M[1];M2=M[2];M3=M[3] mu1 &lt;- levpareto(limit=M1,shape=alpha1, scale=theta1, order=1) var1 &lt;- levpareto(limit=M1,shape=alpha1, scale=theta1, order=2)-mu1^2 mu2 &lt;- levpareto(limit=M2,shape=alpha2, scale=theta2, order=1) var2 &lt;- levpareto(limit=M2,shape=alpha2, scale=theta2, order=2)-mu2^2 mu3 &lt;- levpareto(limit=M3,shape=alpha3, scale=theta3, order=1) var3 &lt;- levpareto(limit=M3,shape=alpha3, scale=theta3, order=2)-mu3^2 varFct &lt;- var1 +var2+var3 meanFct &lt;- mu1+mu2+mu3 c(meanFct,varFct) } f &lt;- function(M){VarFct(M)[2]} h &lt;- function(M){VarFct(M)[1] - Pmin} library(alabama) par0=rep(1000,3) op &lt;- auglag(par=par0,fn=f,hin=h,control.outer=list(trace=FALSE)) Los límites de retención óptimos \\(M_1\\), \\(M_2\\), y \\(M_3\\) calculados como los límites de retención menos los siniestros esperados del asegurador, \\(M_i - E(X_i \\wedge M_i)\\), son los mismos para todos los riesgos, como se ha derivado teóricamente. M1star = op$par[1];M2star = op$par[2];M3star = op$par[3] M1star -levpareto(M1star,shape=alpha1, scale=theta1,order=1) [1] 1344.135 M2star -levpareto(M2star,shape=alpha2, scale=theta2,order=1) [1] 1344.133 M3star -levpareto(M3star,shape=alpha3, scale=theta3,order=1) [1] 1344.133 Gráficamente se compara la distribución de los riesgos totales con los retenidos por el asegurador y el reasegurador. set.seed(2018) nSim = 10000 library(actuar) Y1 &lt;- rpareto(nSim, shape = alpha1, scale = theta1) Y2 &lt;- rpareto(nSim, shape = alpha2, scale = theta2) Y3 &lt;- rpareto(nSim, shape = alpha3, scale = theta3) YTotal &lt;- Y1 + Y2 + Y3 Yinsur &lt;- pmin(Y1,M1star)+pmin(Y2,M2star)+pmin(Y3,M3star) Yreinsur &lt;- YTotal - Yinsur par(mfrow=c(1,3)) plot(density(YTotal), xlim=c(0,10000), main=&quot;Total Loss&quot;, xlab=&quot;Losses&quot;) plot(density(Yinsur), xlim=c(0,10000), main=&quot;Insurer&quot;, xlab=&quot;Losses&quot;) plot(density(Yreinsur), xlim=c(0,10000), main=&quot;Reinsurer&quot;, xlab=&quot;Losses&quot;) 10.4.3 Acuerdos de Reaseguro Adicionales 10.4.3.1 Acuerdo Surplus Share Proportional Treaty Otro acuerdo proporcional es el denominado surplus shareUn acuerdo de reaseguro proporcional que es frecuente en seguros de daños comerciales. Un acuerdo surplus share permite al reasegurado limitar su exposición en un determinado riesgo a una cantidad dada (el pleno de retención). El reasegurador asume una parte del riesgo en proporción a la cantidad que el valor asegurado excede el pleno de retención, hasta un límite dado (expresado como un múltiplo del pleno de retención, o número de plenos).; este tipo de contratos es frecuente en seguros de daños comerciales. Un acuerdo surplus share permite al reasegurado limitar su exposición a un determinado riesgo a una cantidad dada (el pleno de retención). El reasegurador asume una parte del riesgo en proporción a la cantidad que el valor asegurado excede el pleno de retención, hasta un límite dado (expresado como un múltiplo del pleno de retención, o número de plenos). Por ejemplo, sea el pleno de retención $100,000 y el límite 4 veces el pleno ($400,000). Entonces, si \\(X\\) es la pérdida, la parte del reasegurador es \\(\\min(400000, (X-100000)_+)\\). 10.4.3.2 Layers de cobertura Se pueden extender los acuerdos de reaseguro no-proporcionales stop-loss introduiendo partes adicionales al contrato. Por ejemplo, en lugar de simplemente un asegurador y un reasegurador o un asegurador y un tomador, pensar en una situación con las tres partes, tomador, asegurador, y reasegurador, los cuales se ponen de acuerdo en como repartir el riesgo. De forma más general, se consideran \\(k\\) partes. Si \\(k=3\\), podria tratarse de un asegurador y dos reaseguradores diferentes. Ejemplo 10.3.4. Layers de cobertura para tres partes. Se supone que hay \\(k=3\\) partes. La primera parte es responsable de los siniestros hasta 100, la segunda es responsable de los siniestros entre 100 y 3000, y la tercera es responsable de los siniestros por encima de 3000. Si hay cuatro siniestros de cuantías 50, 600, 1800 y 4000, entonces estarían repartidos entre las partes de la forma: Layer Siniestro 1 Siniestro 2 Siniestro 3 Siniestro 4 Total (0, 100] 50 100 100 100 350 (100, 3000] 0 500 1700 2900 5100 (3000, $ ty$) 0 0 0 1000 1000 Total 50 600 1800 4000 6450 Para considerar la situación general con \\(k\\) grupos, se divide la línea de los reales positivos en \\(k\\) intervalos usando los puntos de corte \\[0 = M_0 &lt; M_1 &lt; \\cdots &lt; M_{k-1} &lt; M_k = \\infty.\\] Observar que el intervalo \\(j\\)th es \\((M_{j-1}, M_j]\\). Ahora sea \\(Y_j\\) la cuantía de riesgo compartida por la parte \\(j\\)th. Para ilustrarlo, si una pérdida \\(x\\) es tal que \\(M_{j-1} &lt;x \\le M_j\\), entonces \\[\\left(\\begin{array}{c} Y_1\\\\ Y_2 \\\\ \\vdots \\\\ Y_j \\\\Y_{j+1} \\\\ \\vdots \\\\Y_k \\end{array}\\right) =\\left(\\begin{array}{c} M_1-M_0 \\\\ M_2-M_1 \\\\ \\vdots \\\\ x-M_{j-1} \\\\ 0 \\\\ \\vdots \\\\0 \\end{array}\\right)\\] De forma más clara, podemos escribir \\[Y_j = \\min(X,M_j) - \\min(X,M_{j-1}) .\\] Con la expresión \\(Y_j = \\min(X,M_j) - \\min(X,M_{j-1})\\), se observa que la parte \\(j\\)th es responsable de los siniestros en el intervalo \\((M_{j-1}, M_j].\\) Con esto, es fàcil comprobar que \\(X = Y_1 + Y_2 + \\cdots + Y_k.\\) Como se destaca en el siguiente ejemplo, también se puede remarcar que las partes no necesitan ser diferentes. Ejemplo 10.3.5. - Suponer que un tomador es responsable de los primeros 500 y todos los siniestros en exceso de 100.000. El asegurador coge siniestros entre 100 y 100.000. - Entonces, se deberían usar \\(M_1 = 100\\), \\(M_2 =100000\\). - El tomador es responsable de \\(Y_1 =\\min(X,100)\\) y \\(Y_3 = X - \\min(X,100000) = \\max(0, X-100000)\\). Para saber más, consultar en Wisconsin Property Fund site un ejemplo de layers de reaseguro. 10.4.3.3 Ejemplo de Gestión de Cartera Pueden encontrarse muchas otras variaciones de los contratos originales. Para tener más ilustraciones, se considera lo siguiente. Ejemplo. 10.3.6. Gestión de carteras. Tú eres el jefe de riesgos de una empresa de telecomunicaciones. Tu empresa tiene varios riesgos de daños y responsabilidad. Se considera: \\(X_1\\) - edificios, modelizados por medio de una distribución gamma de media 200 y parámetro de escala 100. \\(X_2\\) - vehículos a motor, modelizados usando una distribución gamma con media 400 y parámetro de escala 200. \\(X_3\\) - responsabilidad de directores y ejecutivos, modelizada usando una distribución de Pareto con media 1000 y parámetro de escala 1000. \\(X_4\\) - ciberriesgos, modelizados usando una distribución de Pareto con media 1000 y parámetro de escala 2000. Se describe el riesgo total como \\[X = X_1 + X_2 + X_3 + X_4 .\\] Por simplicidad, se asume que esos riesgos son independientes. Para controlar el riesgo, se contrata algún tipo de cobertura aseguradora. Se puede preferir controlar internamente pequeñas cantidades relacionades con edificios y vehículos a motor, hasta \\(M_1\\) y \\(M_2\\), respectivamente. Se recurre al seguro para cubrir todos los demás riesgos. Específicamente, la parte del asegurador es \\[ Y_{asegurador} = (X_1 - M_1)_+ + (X_2 - M_2)_+ + X_3 + X_4 ,\\] De forma que tu riesgo retenido es \\(Y_{retenido}= X- Y_{asegurador} =\\) \\(\\min(X_1,M_1) + \\min(X_2,M_2)\\). Usando franquicias \\(M_1=\\) 100 y \\(M_2=\\) 200: Determinar de la cuantía esperada por siniestro (i)la retenida, (ii) la aceptada por el asegurador, y (iii) la cuantía total. Determinar los percentiles 80, 90, 95, y 99 para (i) la parte retenida, (ii) la parte aceptada por el asegurador, y (iii) la cuantía total. Comparar las distribuciones graficando las densidades para (i) la parte retenida, (ii) la aceptada por el asegurador, y (iii) la cuantía total. Mostrar Solución al Ejemplo con Código R En preparación, se adjunta el código necesario para establecer los parámetros. # Para la distribución gamma, usar alpha1 &lt;- 2; theta1 &lt;- 100 alpha2 &lt;- 2; theta2 &lt;- 200 # Para la distribución de Pareto, usar alpha3 &lt;- 2; theta3 &lt;- 1000 alpha4 &lt;- 3; theta4 &lt;- 2000 # Límites M1 &lt;- 100 M2 &lt;- 200 Con estos parámetros, se pueden simular acaecimientos de los riesgos de la cartera. # Simular los riesgos nSim &lt;- 10000 #número de simulaciones set.seed(2017) #establecer la seed para reproducir el trabajo X1 &lt;- rgamma(nSim,alpha1,scale = theta1) X2 &lt;- rgamma(nSim,alpha2,scale = theta2) # Para la Distribución de Pareto, usar library(actuar) X3 &lt;- rpareto(nSim,scale=theta3,shape=alpha3) X4 &lt;- rpareto(nSim,scale=theta4,shape=alpha4) # Riesgos de Cartera X &lt;- X1 + X2 + X3 + X4 Yretenido &lt;- pmin(X1,M1) + pmin(X2,M2) Yasegurador &lt;- X - Yretenido (a) Aquí está el código para las cantidades esperadas por siniestro. # Cantidades esperadas por siniestro ExpVec &lt;- t(as.matrix(c(mean(Yretenido),mean(Yasegurador),mean(X)))) colnames(ExpVec) &lt;- c(&quot;Retenido&quot;, &quot;Asegurador&quot;,&quot;Total&quot;) round(ExpVec,digits=2) Retenido Asegurador Total [1,] 269.05 5274.41 5543.46 (b) Aquí está el código para los cuantiles. # Cuantiles quantMat &lt;- rbind( quantile(Yretenido, probs=c(0.80, 0.90, 0.95, 0.99)), quantile(Yasegurador, probs=c(0.80, 0.90, 0.95, 0.99)), quantile(X , probs=c(0.80, 0.90, 0.95, 0.99))) rownames(quantMat) &lt;- c(&quot;Retenido&quot;, &quot;Asegurador&quot;,&quot;Total&quot;) round(quantMat,digits=2) 80% 90% 95% 99% Retenido 300.00 300.00 300.00 300.00 Asegurador 6075.67 7399.80 9172.69 14859.02 Total 6351.35 7675.04 9464.20 15159.02 (c) Aquí está el código para los gráficos de densidades del riesgo retenido, del asegurador y el total de riesgo de cartera. par(mfrow=c(1,3)) plot(density(Yretenido), xlim=c(0,500), main=&quot;Riesgo de Cartera Retenido&quot;, xlab=&quot;Pérdida (Tener en cuenta la escala horizontal diferente)&quot;, ylab = &quot;Densidad (Tener en cuenta la diferente escala vertical)&quot;) plot(density(Yasegurador), xlim=c(0,15000), main=&quot;Riesgo de Cartera del Asegurador&quot;, xlab=&quot;Pérdida&quot;) plot(density(X), xlim=c(0,15000), main=&quot;Riesgo Total de Cartera&quot;, xlab=&quot;Pérdida&quot;) 10.5 Recursos y Colaboradores adicionales Edward W. (Jed) Frees, University of Wisconsin-Madison, y Jianxi Su, Purdue University son los autores principales de la versión inicial de este capítulo. Email: jfrees@bus.wisc.edu y/o jianxi@purdue.edu para comentarios sobre el capítulo y mejoras sugeridas. Revisores del Capítulo: Fei Huang, Hirokazu (Iwahiro) Iwasawa, Peng Shi, Ping Wang, Chengguo Weng. Traducción al español: Mercedes Ayuso (Universitat de Barcelona) Algunos de los ejemplos de este capítulo se tomaron de Clark (1996), Klugman, Panjer, and Willmot (2012), y Bahnemann (2015). Estas referencias proporcionan excelentes Fuentes para discusiones adicionales y ejemplos. Bibliography "],
["C-BonusMalus.html", "Chapter 11 Experience Rating using Bonus-Malus 11.1 Introduction 11.2 NCD System in Several Countries 11.3 BMS and Markov Chain Model 11.4 BMS and Stationary Distribution 11.5 BMS and Premium Rating", " Chapter 11 Experience Rating using Bonus-Malus This chapter is being written and is not yet complete nor edited. It is here to give you a flavor of what will be in the final version. 11.1 Introduction Bonus-malus system, which is used interchangeably as “no-fault discount”, “merit rating”, “experience rating” or “no-claim discount” in different countries, is based on penalizing insureds who are responsible for one or more claims by a premium surcharge, and awarding insureds with a premium discount if they do not have any claims. Insurers use bonus-malus systems for two main purposes; to encourage drivers to drive more carefully in a year without any claims, and to ensure insureds to pay premiums proportional to their risks based on their claims experience. No Claim Discount (NCD) system is an experience rating system commonly used in motor insurance. It represents an attempt to categorize insureds into homogeneous groups who pay premiums based on their claims experience. Depending on the rules in the scheme, new policyholders may be required to pay full premium initially, and obtain discounts in the future years as a results of claim-free years. An NCD system rewards policyholders for not making any claims during a year, or in other words, it grants a bonus to a careful driver. This bonus principle may affect policy holders’ decisions whether to claim or not to claim, especially when involving accidents with slight damages, which is known as ‘hunger for bonus’ phenomenon. The option of ‘hunger for bonus’ under an NCD system may reduce insurers’ claim costs, and may be able to offset the expected decrease in premium income. 11.2 NCD System in Several Countries 11.2.1 NCD System in Malaysia Before the liberalization of Motor Tariff on 1st July 2017, the rating of motor insurance in Malaysia was governed by Motor Tariff. Under the tariff, the rate charged should not be lower than the rates specified under the classes of risks, to ensure that the price competition among insurers will not go below the country’s economic level. The basic rating factors considered were scope of insurance, cubic capacity of vehicle and estimated value of vehicle (or sum insured, whichever is lower). Under the Motor Tariff, the final premium to be paid is adjusted by the policyholder’s claim experience, or equivalently, his NCD entitlement. Effective on 1st July 2017, the premium rates for motor insurance are liberalized, or de-tariffed. The pricing of premium is now determined by individual insurers and takaful operators, and the consumers are able to enjoy a wider choice of motor insurance products at competitive prices. Since tariff liberalization encourages innovation and competition among insurers and takaful operators, the premiums are based on broader risk factors other than the two rating factors specified in the Motor Tariff, i.e. sum insured and cubic capacity of vehicle. Other rating factors may be defined in the risk profile of an insured, such as age of vehicle, age of driver, safety and security features of vehicle, geographical location of vehicle and traffic offences of driver. As different insurers and takaful operators have different ways of defining the risk profile of an insured, the price of a policy may differ from one insurer to another. However, the NCD structure from the Motor Tariff remains ‘unchanged’ and continue to exist, and is ‘transferable’ from one insurer, or from one takaful operator, to another. The discounts in the Malaysian NCD system are divided into six classes, starting from the initial class of 0% discount, followed by classes of 25%, 30%, 38.3%, 45% and 55% discounts. Table 1 provides the classes of NCD system in Malaysia. A claim-free year indicates that a policyholder is entitled to move one-step forward to the next discount class, such as from a 0% discount to a 25% discount in the renewal year. If a policyholder is already at the highest class, which is at a 55% discount, a claim-free year indicates that the policyholder remains in the same class. On the other hand, if one or more claims are made within the year, the NCD will be forfeited and the policyholder has to start at 0% discount in the renewal year. In other words, the policyholder has to pay a full premium for the next year’s renewal premium, regardless of his current class of NCD. For an illustration purpose, Figure 11.1 shows the transition diagram for the NCD classes under the Malaysian Motor Tariff. The transition starts at class 0, and increase one by one if an insured has a no-claim year. If an insured has one or more claims within the year, the current class automatically returns to class 0. \\[ \\begin{matrix} \\text{Table 1: Classes of NCD (Malaysia)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Classes (claim-free years)} &amp; \\text{Discounts}\\\\ \\hline\\\\ {0} &amp; {0}\\\\ {1} &amp; {25}\\\\ {2} &amp; {30}\\\\ {3} &amp; {38.33}\\\\ {4} &amp; {45}\\\\ {5\\text{ and above}} &amp; {55}\\\\\\\\ \\hline \\end{array} \\end{matrix} \\] Figure 11.1: Transition diagram for NCD classes (Malaysia) 11.2.2 NCD System in Other Countries The NCD system in Brazil are subdivided into seven classes, with the following premium levels (Lemaire 1998): 100, 90, 85, 80, 75, 70, and 65. These premium levels are also equivalent to the following discount classes: 0%, 10%, 15%, 20%, 25%, 30% and 45%. New policyholders have to start at 0% discount, or at level 100, and a claim-free year indicates that a policyholder can move forward at a one-class discount. If one or more claims incurred within the year, the policyholder has to move backward, also at a one-class discount. Table 2 and Figure 11.2 respectively show the classes and the transition diagram for the NCD system in Brazil. \\[ \\begin{matrix} \\text{Table 2: Classes of NCD (Brazil)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Classes (claim-free years)} &amp; \\text{Discounts}\\\\ \\hline\\\\ {0} &amp; {0}\\\\ {1} &amp; {10}\\\\ {2} &amp; {15}\\\\ {3} &amp; {20}\\\\ {4} &amp; {25}\\\\ {5} &amp; {30}\\\\ {6\\text{ and above}} &amp; {45}\\\\\\\\ \\hline \\end{array} \\end{matrix} \\] Figure 11.2: Transition diagram for NCD classes (Brazil) The NCD system in Switzerland, which is implemented in 1990, are subdivided into twenty-two classes, with the following premium levels: 270, 250, 230, 215, 200, 185, 170, 155, 140, 130, 120, 110, 100, 90, 80, 75, 70, 65, 60, 55, 50 and 45 (Lemaire and Zi 1994). These levels are also equivalent to the following loadings: 170%, 150%, 130%, 115%, 100%, 85%, 70%, 55%, 40%, 30%, 20%, and 10%, and the following discounts: 0%, 10%, 20%, 25%, 30%, 35%, 40%, 45%, 50% and 55%. New policyholders have to start at 170% loading, or at 270 premium level, and a claim-free year indicates that a policyholder can move one-class forward. If one or more claims incurred within the year, the policyholder has to move four-classes backwards. Table 3 and Figure 11.3 respectively show the classes and the transition diagram for the NCD system in Switzerland. \\[ \\begin{matrix} \\text{Table 3: Classes of NCD (Switzerland)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Classes} &amp; \\text{Loadings} &amp; \\text{Classes} &amp; \\text{Discounts}\\\\ \\text{(claim-free years)} &amp; &amp; \\text{(claim-free years)} &amp; \\\\ \\hline\\\\ {0} &amp; {170} &amp; {12} &amp; {0}\\\\ {1} &amp; {150} &amp; {13} &amp; {10}\\\\ {2} &amp; {130} &amp; {14} &amp; {20}\\\\ {3} &amp; {115} &amp; {15} &amp; {25}\\\\ {4} &amp; {100} &amp; {16} &amp; {30}\\\\ {5} &amp; {85} &amp; {17} &amp; {35}\\\\ {6} &amp; {70} &amp; {18} &amp; {40}\\\\ {7} &amp; {55} &amp; {19} &amp; {45}\\\\ {8} &amp; {40} &amp; {20} &amp; {50}\\\\ {9} &amp; {30} &amp; {21 \\text{ and above}} &amp; {55}\\\\ {10} &amp; {20} &amp;&amp; \\\\ {11} &amp; {10} &amp;&amp; \\\\\\\\ \\hline \\end{array} \\end{matrix} \\] Figure 11.3: Transition diagram for NCD classes (Switzerland) 11.3 BMS and Markov Chain Model A BMS, or an NCD system, can be represented by a discrete time parameter Markov chain. Under this model, the state space consists of classes of bonus-malus, and the state (or class) is assumed to shift randomly from year to year. Therefore, it is important to know a brief description on two elements; a stochastic process that has a Markov property, and a discrete time Markov chain. Definition: A stochastic process has a Markov property if the probability distribution of future states, conditional on both past and present states, depends only upon the present state and not on the sequence of events that preceded it. Definition: A discrete time Markov chain is a stochastic process that can be parameterized by empirically estimating the transition probabilities between discrete states. 11.3.1 Transition Probability The randomness of the transition of the NCD classes is governed by the transition probability in a given year. The definition of a transition probability is provided here to understand the use of the probability for representing the transition of the NCD classes. Definition: The transition probability from state \\(i\\) (at time \\(n\\)) to state \\(j\\) (at time \\(n + 1\\)) is called a one-step transition probability, and is denoted by \\(p_{ij} = Pr (X_{n + 1} = j|X_n = i)\\), \\(i = 1,2,...,k\\), \\(j = 1,2,...,k\\). The transition probabilities can be represented by a \\(k \\times k\\) matrix. Assuming a homogeneous Markov process, a k-state Markov chain can be represented by a matrix of transition probabilities \\({\\bf P}\\): \\[ {\\bf P} = \\left[ {\\begin{array}{*{20}c} p_{11} &amp; p_{12} &amp; \\ldots &amp; &amp; &amp; p_{1k} \\\\ p_{21} &amp; p_{22} &amp; \\ldots &amp; &amp; &amp; p_{2k} \\\\ \\vdots &amp; \\ddots &amp; &amp; &amp; &amp; \\vdots \\\\ &amp; &amp; &amp; &amp; &amp; \\\\ &amp; &amp; &amp; &amp; &amp; \\\\ p_{k1} &amp; p_{k2} &amp; \\cdots &amp; &amp; &amp; p_{kk} \\end{array} } \\right]. \\] Each row of the transition matrix represents the transition of flowing out of state, whereas each column represents the transition of flowing into the state. The cumulative transitions of flowing out of state must equal 1, or each row of the matrix must sum to 1, i.e. \\(\\sum\\limits_j p_{ij} = 1\\). All probabilities must also be non-negative (since they are probabilities), i.e. \\(p_{ij} \\ge 0\\). Consider the Malaysian NCD system. Under this system, let the random variable \\(X_t\\) denotes the class of NCD at time \\(t\\) and takes the values in a state space \\(\\bf{S}\\), where \\({\\bf S} = \\{0,1,...,5\\}\\). Therefore, the probability of a no-claim year is equal to the probability of transition from state \\(i\\) to state \\(j\\), which is \\(p_{ij}\\), \\(i = 0,1,2,...,5\\), \\(j = 0,1,2,...,5\\). If an insured has one or more claims within the year, the probability of transitioning back to state 0 is represented by \\(p_{i0}\\), which is also equivalent to \\(1 - {p_{ij}}.\\) Therefore, there are only two transition probabilities in each row; the probability of advancing to the next state, \\(p_{ij},\\) and the probability of returning back to state zero, \\(p_{i0} = 1 - p_{ij}\\). In terms of transition probabilities, the Malaysian NCD system can be represented by the following \\((6 \\times 6)\\) transition matrix: \\[ {\\bf P} = \\left[ {\\begin{array}{*{20}c} p_{00}&amp;p_{01}&amp;0&amp;0&amp;0&amp;0\\\\ p_{10}&amp;0&amp;p_{12}&amp;0&amp;0&amp;0\\\\ p_{20}&amp;0&amp;0&amp;p_{23}&amp;0&amp;0\\\\ p_{30}&amp;0&amp;0&amp;0&amp;p_{34}&amp;0\\\\ p_{40}&amp;0&amp;0&amp;0&amp;0&amp;p_{45}\\\\ p_{50}&amp;0&amp;0&amp;0&amp;0&amp;p_{55} \\end{array} }\\right] = \\left[ {\\begin{array}{*{20}c} {1 - p_{01}}&amp;p_{01}&amp;0&amp;0&amp;0&amp;0\\\\ {1 - p_{12}}&amp;0&amp;p_{12}&amp;0&amp;0&amp;0\\\\ {1 - p_{23}}&amp;0&amp;0&amp;p_{23}&amp;0&amp;0\\\\ {1 - p_{34}}&amp;0&amp;0&amp;0&amp;p_{34}&amp;0\\\\ {1 - p_{45}}&amp;0&amp;0&amp;0&amp;0&amp;p_{45}\\\\ {1 - p_{55}}&amp;0&amp;0&amp;0&amp;0&amp;p_{55} \\end{array} }\\right] \\] Example 1 Provide the transition matrix for the NCD system in Brazil. Solution Based on the NCD classes and the transition diagram shown respectively in Table 2 and Figure 11.2, the probability of a no-claim year is equal to the probability of moving one-class forward, whereas the probability of having one or more claims within the year is equal to the probability of moving one-class backward. Therefore, each row can contain two or more transition probabilities; one probability for advancing to the next state, and one or more probabilities for moving one-class backwards. The transition matrix is: \\[ {\\bf P} = \\left[ {\\begin{array}{*{20}{c}} {1 - p_{01}}&amp;p_{01}&amp;0&amp;0&amp;0&amp;0&amp;0\\\\ {1 - p_{12}}&amp;0&amp;p_{12}&amp;0&amp;0&amp;0&amp;0\\\\ {1 - \\sum\\limits_j p_{2j}}&amp;p_{21}&amp;0&amp;p_{23}&amp;0&amp;0&amp;0\\\\ {1 - \\sum\\limits_j p_{3j}}&amp;p_{31}&amp;p_{32}&amp;0&amp;p_{34}&amp;0&amp;0\\\\\\ {1 - \\sum\\limits_j p_{4j}}&amp;p_{41}&amp;p_{42}&amp;p_{43}&amp;0&amp;p_{45}&amp;0\\\\ {1 - \\sum\\limits_j p_{5j}}&amp;p_{51}&amp;p_{52}&amp;p_{53}&amp;p_{54}&amp;0&amp;p_{56}\\\\ {1 - \\sum\\limits_j p_{6j}}&amp;p_{61}&amp;p_{62}&amp;p_{63}&amp;p_{64}&amp;p_{65}&amp;p_{66} \\end{array} } \\right] \\] Example 2 Provide the transition matrix for the NCD system in Switzerland. Solution From Table 3 and Figure 11.3, the probability of a no-claim year is equal to the probability of moving one-class forward, whereas the probability of having one or more claims within the year is equal to the probability of moving four-classes backward. The transition matrix is: \\[ \\begin{matrix} \\left| {\\begin{array}{*{12}{c}} 1 - {p_{01}} &amp; p_{01} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\cdots\\\\ 1 - {p_{12}} &amp; 0 &amp; p_{12} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\cdots\\\\ 1 - {p_{23}} &amp; 0 &amp; 0 &amp; p_{23} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\cdots\\\\ 1 - {p_{34}} &amp; 0 &amp; 0 &amp; 0 &amp; p_{34} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\cdots\\\\ 1 - {p_{45}} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; p_{45} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\cdots\\\\ 1 - \\sum\\limits_j {p_{5j}} &amp; p_{51} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; p_{56} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\cdots\\\\ 1 - \\sum\\limits_j {p_{6j}} &amp; 0 &amp; p_{62} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; p_{67} &amp; 0 &amp; 0 &amp; 0 &amp; \\cdots\\\\ 1 - \\sum\\limits_j {p_{7j}} &amp; 0 &amp; 0 &amp; p_{73} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; p_{78} &amp; 0 &amp; 0 &amp; \\cdots\\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots\\\\ 1 - \\sum\\limits_j {p_{19,j}} &amp; 0 &amp; 0 &amp; p_{19,3} &amp; 0 &amp; 0 &amp; 0 &amp; p_{19,7} &amp; 0 &amp; 0 &amp; 0 &amp; \\cdots\\\\ 1 - \\sum\\limits_j {p_{20,j}} &amp; 0 &amp; 0 &amp; 0 &amp; p_{20,4} &amp; 0 &amp; 0 &amp; 0 &amp; p_{20,8} &amp; 0 &amp; 0 &amp; \\cdots\\\\ 1 - \\sum\\limits_j {p_{21,j}} &amp; p_{21,1} &amp; 0 &amp; 0 &amp; 0 &amp; p_{21,5} &amp; 0 &amp; 0 &amp; 0 &amp; p_{21,9} &amp; 0 &amp; \\cdots \\end{array}} \\right| \\end{matrix} \\] 11.4 BMS and Stationary Distribution 11.4.1 Stationary Distribution It is important to note that the transition matrix represents the transition probabilities of the NCD classes in one year. If we are interested in the distribution of the transition in the long run (which may take several years), the stationary probability can be used. Several definitions and properties are provided here to understand the use of a Markov chain model for representing the stationary distribution of the NCD transitions. However, students are encouraged to refer to textbooks on Markov Chain and stochastic processes available in the literature for a more comprehensive knowledge on the related subjects. Definition: A Markov chain is said to be irreducible if it is possible to move to any state from any other state. Definition: A state \\(i\\) has period \\(k\\) if any return to state \\(i\\) must occur in multiples of \\(k\\) time steps. If \\(k = 1\\), then the state is said to be aperiodic. Definition: A state \\(i\\) is said to be transient if, given that we start in state \\(i\\), there is a non-zero probability that we will never return to \\(i\\). State \\(i\\) is recurrent (or persistent) if it is not transient. A state \\(i\\) is positive recurrent if the mean recurrent time (or expected return time) is finite. Definition: A state \\(i\\) is said to be ergodic if it is aperiodic and positive recurrent. In other words, a state \\(i\\) is ergodic if it is recurrent, has a period of one (aperiodic), and has finite mean recurrence time. If all states in an irreducible Markov chain are ergodic, then the chain is said to be ergodic. Definition: Let \\(p_{ij}^{(n)} = \\Pr ({X_n} = j\\|{X_0} = i)\\) be the probability of transition from state \\(i\\) to state \\(j\\) in \\(n\\) time steps. The n-step transition probabilities for a stationary Markov chain satisfy the Chapman–Kolmogorov equation: \\[p_{ij}^{(n)} = \\sum\\limits_r {p_{ir}^{(k)}p_{rj}^{(n - k)}}\\] for any \\(k\\), where \\(0 &lt; k &lt; n\\). Definition: If a Markov chain is stationary, then the vector \\({\\bf{\\pi }}\\) is called a stationary distribution (or invariant measure) if it satisfies: \\[0 \\le {\\pi _j} \\le 1\\] \\[\\sum\\limits_j {{\\pi _j}} = 1,\\] \\[{\\pi_j} = \\sum\\limits_i {\\pi_i}p_{ij}\\]. In terms of vectors and matrices, a stationary distribution \\({\\bf{\\pi }}\\) is a row vector, whose entries are non-negative and sum to one, that is unchanged by the operation: \\({\\bf{\\pi P}} = {\\bf{\\pi }}\\). If a Markov chain is stationary, then the transition matrix \\({\\bf{P}}\\) is the same after each step, so that the \\(k\\)-step transition probability can be computed as the \\(k\\)-th power of the transition matrix, \\({{\\bf{P}}^k}.\\) From the definitions and properties above, a BMS forms a regular Markov chain if all of its states (NCD classes) are ergodic, and the chain is not cyclic (or irreversible). The row vector, \\({\\bf{\\pi }}\\), which is also the left eigenvector of the transition matrix, is a stationary distribution defined by \\(0 \\le {\\pi _j} \\le 1\\) and \\(\\sum\\limits_j {{\\pi_j}} = 1\\). Example 3 Find the stationary distribution for the NCD system in Malaysia assuming that the probability of a no-claim year for all NCD classes are \\({p_0}\\). Solution The transition matrix can be re-written as: The stationary distribution can be calculated using \\({\\pi _j} = \\sum\\limits_i {\\pi _i}p_{ij}\\). The solutions are: \\[ \\begin{array}{l} {\\pi _0} = \\sum\\limits_i {\\pi_i}p_{i0} = (1 - {p_0})\\sum\\limits_i {{\\pi _i}} = 1 - {p_0}\\\\\\\\ {\\pi _1} = \\sum\\limits_i {\\pi _i}p_{i1} = {\\pi_0}{p_{01}} = (1 - {p_0}){p_0}\\\\\\\\ {\\pi _2} = \\sum\\limits_i {\\pi _i}p_{i2} = {\\pi _1}{p_{12}} = (1 - {p_0}){p_0}^2\\\\\\\\ {\\pi _3} = \\sum\\limits_i {\\pi _i}p_{i3} = {\\pi _2}{p_{23}} = (1 - {p_0}){p_0}^3\\\\\\\\ {\\pi _4} = \\sum\\limits_i {\\pi _i}p_{i4} = {\\pi _3}{p_{34}} = (1 - {p_0}){p_0}^4\\\\\\\\ {\\pi _5} = \\sum\\limits_i {\\pi _i}p_{i5} = {\\pi _4}{p_{45}} + {\\pi _5}{p_{55}} = (1 - {p_0}){p_0}^5 + {\\pi _5}{p_0}\\\\\\\\ \\therefore {\\pi _5} = \\frac{(1 - {p_0}){p_0}^5}{{(1 - {p_0})}} = {p_0}^5 \\end{array} \\] The stationary distribution (or steady state condition) shown in Example 3 represents the asymptotic distribution of the NCD system, or the distribution in the long run. As an example, assuming that the probability of a no-claim year is \\(p_0 = 0.90,\\) the stationary probabilities are: \\[ \\begin{array}{l} {\\pi _0} = 1 - {p_0} = 0.1000\\\\\\\\ {\\pi _1} = (1 - {p_0}){p_0} = 0.0900\\\\\\\\ {\\pi _2} = (1 - {p_0}){p_0}^2 = 0.0810\\\\\\\\ {\\pi _3} = (1 - {p_0}){p_0}^3 = 0.0729\\\\\\\\ {\\pi _4} = (1 - {p_0}){p_0}^4 = 0.0656\\\\\\\\ {\\pi _5} = {p_0}^5 = 0.5905 \\end{array} \\] In other words, \\({\\pi_0} = 0.10\\) indicates that 10% of insureds will eventually belong to class 0 (or zero claim-free years), \\({\\pi _1} = 0.09\\) indicates that 9% of insureds will eventually belong to class 1 (or one claim-free year), and so forth, until \\({\\pi _5} = 0.59\\), which indicates that 59% of insureds will eventually belong to class 5 (or five successive claim-free years). 11.4.2 R Program for Stationary Distribution We can use the left eigenvector of a transition matrix to calculate the stationary distribution. The following R program can be used to calculate the left eigenvector: #create transition matrix entries=c(0.1,0.9,0,0,0,0, + 0.1,0,0.9,0,0,0, + 0.1,0,0,0.9,0,0, + 0.1,0,0,0,0.9,0, + 0.1,0,0,0,0,0.9, + 0.1,0,0,0,0,0.9) TP=matrix(entries,nrow=6,byrow=TRUE) TP ## [,1] [,2] [,3] [,4] [,5] [,6] ## [1,] 0.1 0.9 0.0 0.0 0.0 0.0 ## [2,] 0.1 0.0 0.9 0.0 0.0 0.0 ## [3,] 0.1 0.0 0.0 0.9 0.0 0.0 ## [4,] 0.1 0.0 0.0 0.0 0.9 0.0 ## [5,] 0.1 0.0 0.0 0.0 0.0 0.9 ## [6,] 0.1 0.0 0.0 0.0 0.0 0.9 #calculate left eigenvector #hint -- left eigenvector is the same as right eigenvector of transpose of transition matrix eigen(t(TP)) ## eigen() decomposition ## $values ## [1] 1.0000000000+0.0000000000i -0.0004880382+0.0003546725i ## [3] -0.0004880382-0.0003546725i 0.0001865015+0.0005736028i ## [5] 0.0001865015-0.0005736028i 0.0006030733+0.0000000000i ## ## $vectors ## [,1] [,2] ## [1,] 0.1615936+0i 0.00000000000011546+0.0000000000000838874i ## [2,] 0.1454342+0i -0.00000000006591101-0.0000000002025976972i ## [3,] 0.1308908+0i -0.00000009813867774+0.0000003022936262135i ## [4,] 0.1178017+0i 0.00038354290934278-0.0002787325538732070i ## [5,] 0.1060216+0i -0.70729837066103896+0.0000000000000000000i ## [6,] 0.9541940+0i 0.70691492595616912+0.0002784304627608034i ## [,3] ## [1,] 0.00000000000011546-0.0000000000000838874i ## [2,] -0.00000000006591101+0.0000000002025976972i ## [3,] -0.00000009813867774-0.0000003022936262135i ## [4,] 0.00038354290934278+0.0002787325538732070i ## [5,] -0.70729837066103896+0.0000000000000000000i ## [6,] 0.70691492595616912-0.0002784304627608034i ## [,4] ## [1,] -0.0000000000000440003+0.0000000000001357099i ## [2,] 0.0000000001723292683+0.0000000001248792837i ## [3,] 0.0000002567150759536-0.0000001869214542640i ## [4,] -0.0001468014877601952-0.0004505247500856750i ## [5,] -0.7070333538878578183+0.0004507115465249567i ## [6,] 0.7071798984882565753+0.0000000000000000000i ## [,5] [,6] ## [1,] -0.0000000000000440003-0.0000000000001357099i 0.0000000000001426323+0i ## [2,] 0.0000000001723292683-0.0000000001248792837i 0.0000000002126778891+0i ## [3,] 0.0000002567150759536+0.0000001869214542640i 0.0000003173909504803+0i ## [4,] -0.0001468014877601952+0.0004505247500856750i 0.0004736602551468477+0i ## [5,] -0.7070333538878578183-0.0004507115465249567i 0.7068696732221422252+0i ## [6,] 0.7071798984882565753+0.0000000000000000000i -0.7073436510810596767+0i #divide entry of first column by sum of elements, so that entries sum to 1 #provide answers in 4 decimal places round(eigen(t(TP))$vectors[,1]/sum(eigen(t(TP))$vectors[,1]),4) ## [1] 0.1000+0i 0.0900+0i 0.0810+0i 0.0729+0i 0.0656+0i 0.5905+0i Example 4 Find the stationary distribution for the NCD system in Brazil assuming that the number of successive years of claims is Poisson distributed with parameter \\(\\lambda = 0.10\\). Solution Under the Poisson distribution, the probability of \\(k\\) successive years of claims is \\(p_k = \\frac{e^{ - 0.1}{(0.1)}^k}{{k!}},{\\rm{ }}k = 0,1,2,.....\\) The transition matrix is: \\[ {\\small {\\bf{P}} = \\left[ {\\begin{array}{*{20}{c}} {1 - {p_0}}&amp;{{p_0}}&amp;0&amp;0&amp;0&amp;0&amp;0\\\\\\\\ {1 - {p_0}}&amp;0&amp;{{p_0}}&amp;0&amp;0&amp;0&amp;0\\\\\\\\ {1 -\\sum\\limits_i {{p_i}} }&amp;{{p_1}}&amp;0&amp;{{p_0}}&amp;0&amp;0&amp;0\\\\\\\\ {1 -\\sum\\limits_i {{p_i}} }&amp;{{p_2}}&amp;{{p_1}}&amp;0&amp;{{p_0}}&amp;0&amp;0\\\\\\\\ {1 - \\sum\\limits_i {{p_i}}}&amp;{{p_3}}&amp;{{p_2}}&amp;{{p_1}}&amp;0&amp;{{p_0}}&amp;0\\\\\\\\ {1 - \\sum\\limits_i{{p_i}} }&amp;{{p_4}}&amp;{{p_3}}&amp;{{p_2}}&amp;{{p_1}}&amp;0&amp;{{p_0}}\\\\\\\\ {1 - \\sum\\limits_i {{p_i}}}&amp;{{p_5}}&amp;{{p_4}}&amp;{{p_3}}&amp;{{p_2}}&amp;{{p_1}}&amp;{{p_0}} \\end{array}} \\right] = \\left[ {\\begin{array}{*{20}{c}} {0.0952}&amp;{0.9048}&amp;0&amp;0&amp;0&amp;0&amp;0\\\\\\\\ {0.0952}&amp;0&amp;{0.9048}&amp;0&amp;0&amp;0&amp;0\\\\\\\\ {0.0047}&amp;{0.0905}&amp;0&amp;{0.9048}&amp;0&amp;0&amp;0\\\\\\\\ {0.0002}&amp;{0.0045}&amp;{0.0905}&amp;0&amp;{0.9048}&amp;0&amp;0\\\\\\\\ {0.0000}&amp;{0.0002}&amp;{0.0045}&amp;{0.0905}&amp;0&amp;{0.9048}&amp;0\\\\\\\\ {0.0000}&amp;{0.0000}&amp;{0.0002}&amp;{0.0045}&amp;{0.0905}&amp;0&amp;{0.9048}\\\\\\\\ {0.0000}&amp;{0.0000}&amp;{0.0000}&amp;{0.0002}&amp;{0.0045}&amp;{0.0905}&amp;{0.9048} \\end{array}}\\right]} \\] Using R program, the stationary probabilities are: \\[ \\left[ {\\begin{array}{*{20}{c}} {{\\pi _0}}\\\\\\\\ {{\\pi_1}}\\\\\\\\ {{\\pi _2}}\\\\\\\\ {{\\pi _3}}\\\\\\\\ {{\\pi _4}}\\\\\\\\ {{\\pi_5}}\\\\\\\\ {{\\pi _6}} \\end{array}} \\right] = \\left[ {\\begin{array}{*{20}{c}} {0.0000}\\\\\\\\ {0.0000}\\\\\\\\ {0.0003}\\\\\\\\ {0.0022}\\\\\\\\ {0.0145}\\\\\\\\ {0.0936}\\\\\\\\ {0.8894} \\end{array}} \\right] \\] The probabilities indicate that 89% of insureds will eventually belong to class 6 (six successive claim-free years), 9% of insureds will eventually belong to class 5 (five successive claim-free years), and 1.5% of insureds will eventually belong to class 4 (four successive claim-free years). Other classes, after combined, have less than 1% of insureds. Example 5 Using the results from Example 4, find the final premium under the steady state condition assuming that the premium prior to implementing the NCD is \\(m.\\) Solution Using the stationary probabilities from Example 4, the stationary final premium is: \\[ \\begin{array}{l} = \\sum\\limits_j \\text{(premium)} \\times \\text{(proportion in class } j \\text{ in the long run)} \\times \\text{(1 - NCD in class } j)\\\\\\\\ = m[{\\pi _0}(1) + {\\pi _1}(1 - 0.9) + {\\pi _2}(1 - 0.15) + \\ldots + {\\pi _6}(1 - 0.35)]\\\\\\\\ = m[0 + 0 + (0.0003)(0.85) + \\ldots + (0.8894)(0.65)]\\\\\\\\ = 0.6565m \\end{array} \\] The results indicate that the final premium reduce from m to 0.6565m in the long run (under steady state condition or stationary condition) if the NCD is considered. 11.4.3 Premium Evolution Sometimes we are interested to observe the evolution of the mean premium after \\(n\\) years (or \\(n\\) steps). Under the NCD system, the n-step transition probability, \\(p_{ij}^{(n)}\\), can be used to observe the evolution of the mean premium. A definition on n-step transition probabaility \\(p_{ij}^{(n)}\\) is provided here to understand the use of the probability for observing the evolution of the mean premium. Definition: Let \\(p_{ij} = \\Pr ({X_{n + 1}} = j|{X_n} = i)\\) be a one-step transition probability from state \\(i\\) to state \\(j\\), and \\(p_{ij}^{(n)} = \\Pr ({X_n} = j|{X_0} = i)\\), \\(n = 1,2,...\\), be an n-step transition probability from state \\(i\\) to state \\(j\\). The probability \\(p_{ij}^{(n)}\\) can be obtained using the \\(n\\)th power of transition matrix \\({\\bf{P}}\\), which is \\({\\bf{P}^n}.\\) Example 6 Observe the premiums in 20 years under the NCD system in Malaysia, assuming that the probability of claims is Poisson distributed with parameter \\(\\lambda = 0.10\\) and the premium prior to implementing the NCD is \\(m = 100\\). Solution Under the Malaysian NCD, we use the Poisson probability, \\(p_k = \\frac{e^{ - 0.1}{(0.1)}^k}{k!}\\), only for \\(k = 0,1.\\) Therefore, the transition matrix in the first year is: \\[ {\\bf{P}^{(1)}} = \\left[{\\begin{array}{*{20}{c}} {0.0952}&amp;{0.9048}&amp;0&amp;0&amp;0&amp;0\\\\\\\\ {0.0952}&amp;0&amp;{0.9048}&amp;0&amp;0&amp;0\\\\\\\\ {0.0952}&amp;0&amp;0&amp;{0.9048}&amp;0&amp;0\\\\\\\\ {0.0952}&amp;0&amp;0&amp;0&amp;{0.9048}&amp;0\\\\\\\\ {0.0952}&amp;0&amp;0&amp;0&amp;0&amp;{0.9048}\\\\\\\\ {0.0952}&amp;0&amp;0&amp;0&amp;0&amp;{0.9048} \\end{array}} \\right] \\] The premium in the first year, after implementing the NCD, is: \\[ \\begin{aligned} &amp;= \\sum\\limits_j \\text{(premium)} \\times \\text{(average proportion in class } j) \\times \\text{(1 - NCD in class }j) \\\\ &amp;= m\\left[ \\frac{\\sum\\limits_i {p_{i0}}}{6}{(1)} + \\frac{\\sum\\limits_i {p_{i1}}}{6}{(1 - 0.25)} + \\ldots + \\frac{\\sum\\limits_i {p_{i5}}}{6}{(1 - 0.55)} \\right]\\\\ &amp;= 100[0.0952(1) + 0.1508(0.75) + \\cdots + 0.3016(0.45)]\\\\ &amp;= 62.55. \\end{aligned} \\] Using similar steps, the premium in the \\(n\\)-th year for \\(n = 1,2,...,20\\) can be observed. From R program, the premiums in 20 years are: 62.55, 59.87, 58.06, 57.06, 56.58, 56.58, 56.58, 56.58, 56.58, 56.58, 56.58, 56.58, 56.58, 56.58, 56.58, 56.58, 56.58, 56.58, 56.58, 56.58. 11.4.4 R Program for Premium Evolution The following R program can be used to find the premium in the n-th year and the premiums in 20 years under the NCD system in Malaysia (to find the solution in Example 6). #create transition matrix entries=c(0.0952,0.9048,0,0,0,0, + 0.0952,0,0.9048,0,0,0, + 0.0952,0,0,0.9048,0,0, + 0.0952,0,0,0,0.9048,0, + 0.0952,0,0,0,0,0.9048, + 0.0952,0,0,0,0,0.9048) TP=matrix(entries,nrow=6,byrow=TRUE) TP ## [,1] [,2] [,3] [,4] [,5] [,6] ## [1,] 0.0952 0.9048 0.0000 0.0000 0.0000 0.0000 ## [2,] 0.0952 0.0000 0.9048 0.0000 0.0000 0.0000 ## [3,] 0.0952 0.0000 0.0000 0.9048 0.0000 0.0000 ## [4,] 0.0952 0.0000 0.0000 0.0000 0.9048 0.0000 ## [5,] 0.0952 0.0000 0.0000 0.0000 0.0000 0.9048 ## [6,] 0.0952 0.0000 0.0000 0.0000 0.0000 0.9048 #create function for nth power of square matrix powA = function(n) { if (n==1) return (TP) if (n==2) return (TP%*%TP) if (n&gt;2) return ( TP%*%powA(n-1)) } #example for n=3 powA(3) ## [,1] [,2] [,3] [,4] [,5] [,6] ## [1,] 0.0952 0.08613696 0.07793672 0.7407263 0.0000000 0.0000000 ## [2,] 0.0952 0.08613696 0.07793672 0.0000000 0.7407263 0.0000000 ## [3,] 0.0952 0.08613696 0.07793672 0.0000000 0.0000000 0.7407263 ## [4,] 0.0952 0.08613696 0.07793672 0.0000000 0.0000000 0.7407263 ## [5,] 0.0952 0.08613696 0.07793672 0.0000000 0.0000000 0.7407263 ## [6,] 0.0952 0.08613696 0.07793672 0.0000000 0.0000000 0.7407263 #define NCD percentage NCD=c(1,.75,.7,.6167,.55,.45) #create function for premium in nth year p=numeric(0) prem=function(n){ for (j in 1:length(NCD)) p[j]=mean(powA(n)[,j]) + 100*sum(p*NCD)} #example for n=3 prem(3) ## [1] 58.06106 #provide premiums for 20 years premium=numeric(0) for (n in 1:20) premium[n]=prem(n) round(premium,2) ## [1] 62.55 59.87 58.06 57.06 56.58 56.58 56.58 56.58 56.58 56.58 56.58 56.58 ## [13] 56.58 56.58 56.58 56.58 56.58 56.58 56.58 56.58 Example 7 Observe the premiums in 20 years under the NCD system in Brazil, assuming that the probability of \\(k\\) successive years of claims is \\(p_k = \\frac{e^{ - 0.1}{(0.1)}^k}{{k!}},{\\rm{ }}k = 0,1,2,.....\\), and the premium prior to implementing the NCD is \\(m = 100\\). Solution The transition matrix for the NCD system in Brazil is: \\[ {\\bf P} = \\left[ {\\begin{array}{*{20}{c}} {0.0952}&amp;{0.9048}&amp;0&amp;0&amp;0&amp;0&amp;0\\\\\\\\ {0.0952}&amp;0&amp;{0.9048}&amp;0&amp;0&amp;0&amp;0\\\\\\\\ {0.0047}&amp;{0.0905}&amp;0&amp;{0.9048}&amp;0&amp;0&amp;0\\\\\\\\ {0.0002}&amp;{0.0045}&amp;{0.0905}&amp;0&amp;{0.9048}&amp;0&amp;0\\\\\\\\ {0.0000}&amp;{0.0002}&amp;{0.0045}&amp;{0.0905}&amp;0&amp;{0.9048}&amp;0\\\\\\\\ {0.0000}&amp;{0.0000}&amp;{0.0002}&amp;{0.0045}&amp;{0.0905}&amp;0&amp;{0.9048}\\\\\\\\ {0.0000}&amp;{0.0000}&amp;{0.0000}&amp;{0.0002}&amp;{0.0045}&amp;{0.0905}&amp;{0.9048} \\end{array}} \\right] \\] Using R program the premiums in 20 years are: 76.69, 73.76, 71.31, 69.38, 67.92, 66.93, 66.40, 66.05, 65.88, 65.78, 65.72, 65.69, 65.67, 65.66, 65.66, 65.66, 65.66, 65.65, 65.65, 65.65. The results in Examples 6-7 allow us to observe the evolution of premium for the NCD systems in Malaysia and Brazil assuming that the number of successive years of claims is Poisson distributed with parameter \\(\\lambda = 0.10\\), and the premium prior to implementing the NCD is \\(m = 100\\). The evolutions of premiums for both countries are provided in Table 4, and are shown graphically in Figure 11.4. \\[ \\begin{matrix} \\text{Table 4: Evolution of premium (Malaysia and Brazil)}\\\\ \\begin{array}{*{20}c} \\hline \\text{year} &amp; \\text{premium} &amp; \\text{premium} &amp; \\text{year} &amp; \\text{premium} &amp; \\text{premium} &amp; \\\\ &amp; \\text{Malaysia} &amp; \\text{Brazil} &amp; &amp; \\text{Malaysia} &amp; \\text{Brazil} \\\\ \\hline\\\\ 0 &amp; 100 &amp; 100 &amp; 11 &amp; 56.58 &amp; 65.72 \\\\ 1 &amp; 62.55 &amp; 76.69 &amp; 12 &amp; 56.58 &amp; 65.69 \\\\ 2 &amp; 59.87 &amp; 73.76 &amp; 13 &amp; 56.58 &amp; 65.67 \\\\ 3 &amp; 58.06 &amp; 71.31 &amp; 14 &amp; 56.58 &amp; 65.66 \\\\ 4 &amp; 57.06 &amp; 69.38 &amp; 15 &amp; 56.58 &amp; 65.66 \\\\ 5 &amp; 56.58 &amp; 67.92 &amp; 16 &amp; 56.58 &amp; 65.66 \\\\ 6 &amp; 56.58 &amp; 66.93 &amp; 17 &amp; 56.58 &amp; 65.66 \\\\ 7 &amp; 56.58 &amp; 66.40 &amp; 18 &amp; 56.58 &amp; 65.65 \\\\ 8 &amp; 56.58 &amp; 66.05 &amp; 19 &amp; 56.58 &amp; 65.65 \\\\ 9 &amp; 56.58 &amp; 65.88 &amp; 20 &amp; 56.58 &amp; 65.65 \\\\\\\\ \\hline \\end{array} \\end{matrix} \\] Figure 11.4: Evolution of premium (Malaysia and Brazil) 11.4.5 Convergence Rate Sometimes we are interested to know the variation between the probability in the n-th year, \\(p_{ij}^{(n)}\\), and the stationary probability, \\(\\pi _j\\). The variation between the probabilities can be measured using: \\[\\left| {average(p_{ij}^{(n)}) - {\\pi _j}} \\right|\\]. Therefore, the total variation can be measured by the sum of variation in all classes: \\[\\sum\\limits_j {\\left| {average(p_{ij}^{(n)}) - {\\pi _j}} \\right|}\\]. The total variation is also called the convergence rate because it measures the convergence rate after \\(n\\) years (or \\(n\\) transitions). Example 8 Provide the total variations (convergence rate) in 20 years under the NCD system in Malaysia, assuming that the probability of claims is Poisson distributed with parameter \\(\\lambda = 0.10\\). Solution Using R program, the stationary probabilities are: \\[ \\left[ {\\begin{array}{*{20}{c}} {{\\pi _0}}\\\\\\\\{{\\pi_1}}\\\\\\\\{{\\pi _2}}\\\\\\\\ {{\\pi _3}}\\\\\\\\{{\\pi _4}}\\\\\\\\{{\\pi_5}} \\end{array}} \\right] = \\left[ {\\begin{array}{*{20}{c}} {0.0952}\\\\\\\\{0.0861}\\\\\\\\{0.0779}\\\\\\\\ {0.0705}\\\\\\\\{0.0638}\\\\\\\\{0.6064} \\end{array}} \\right] \\] The transition matrix in the first year is: \\[ {\\bf{P}}^{(1)} = \\left[ {\\begin{array}{*{20}{c}} {0.0952}&amp;{0.9048}&amp;0&amp;0&amp;0&amp;0\\\\\\\\ {0.0952}&amp;0&amp;{0.9048}&amp;0&amp;0&amp;0\\\\\\\\ {0.0952}&amp;0&amp;0&amp;{0.9048}&amp;0&amp;0\\\\\\\\ {0.0952}&amp;0&amp;0&amp;0&amp;{0.9048}&amp;0\\\\\\\\ {0.0952}&amp;0&amp;0&amp;0&amp;0&amp;{0.9048}\\\\\\\\ {0.0952}&amp;0&amp;0&amp;0&amp;0&amp;{0.9048} \\end{array}} \\right] \\] The variation can be computed as: \\[ \\begin{array}{l} \\left| {\\sum\\limits_i {\\frac{p_{i0}^{}}{6}} - {\\pi _0}} \\right| = 0\\\\\\\\ \\left|{\\sum\\limits_i {\\frac{p_{i1}^{}}{6}} - {\\pi _1}} \\right| = 0.0647\\\\\\\\ \\vdots \\\\\\\\ \\left| {\\sum\\limits_i \\frac{p_{i5}}{6} - {\\pi _5}} \\right| = .3048 \\end{array} \\] Therefore, the total variation in the first year is \\(\\sum\\limits_j {\\left| {\\sum\\limits_i {\\frac{p_{ij}}{6} - {\\pi _j}} } \\right|} = 0.6096\\). Using R program, the total variations (or convergence rate) in 20 years are: 0.6096, 0.3941, 0.2252, 0.0958, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0. 11.4.6 R Program for Convergence Rate The following R program can be used to calculate the total variation in the \\(n\\)th year, and the total variations (convergence rates) in 20 years under the NCD system in Malaysia (the solution in Example 8). #transition matrix TP ## [,1] [,2] [,3] [,4] [,5] [,6] ## [1,] 0.0952 0.9048 0.0000 0.0000 0.0000 0.0000 ## [2,] 0.0952 0.0000 0.9048 0.0000 0.0000 0.0000 ## [3,] 0.0952 0.0000 0.0000 0.9048 0.0000 0.0000 ## [4,] 0.0952 0.0000 0.0000 0.0000 0.9048 0.0000 ## [5,] 0.0952 0.0000 0.0000 0.0000 0.0000 0.9048 ## [6,] 0.0952 0.0000 0.0000 0.0000 0.0000 0.9048 # stationary probability SP=eigen(t(TP))$vectors[,1]/sum(eigen(t(TP))$vectors[,1]) SP ## [1] 0.09520000+0i 0.08613696+0i 0.07793672+0i 0.07051715+0i 0.06380391+0i ## [6] 0.60640526+0i #create function for total variation in nth year TV=function(n) {dif=numeric(0) for (j in 1:length(SP)) dif[j]=abs(mean(powA(n)[,j])-SP[j]) + sum(dif)} #example for n=1 TV(1) ## [1] 0.6096105 #provide total variations (convergence rate) in 20 years tot.var=numeric(0) for (n in 1:20) tot.var[n]=TV(n) round(tot.var,4) ## [1] 0.6096 0.3941 0.2252 0.0958 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 ## [11] 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 0.0000 Example 9 Provide the total variations (or convergence rate) in 20 years under the NCD system in Brazil, assuming that the number of successive years of claims is distributed as Poisson with parameter \\(\\lambda = 0.10\\) Solution Using R program, the total variations (or convergence rates) in 20 years for the NCD system in Brazil are: 1.2617, 1.0536, 0.8465, 0.6412, 0.4362, 0.2316, 0.1531, 0.0747, 0.0480, 0.0232, 0.0145, 0.0071, 0.0043, 0.0021, 0.0013, 0.0006, 0.0004, 0.0002, 0.0001, 0.0001. Examples 8-9 provide the degree of convergence for two different BMS (two different countries). The Malaysian BMS reaches full stationary only after four years, while the BMS in Brazil takes a longer period. As mentioned in Lemaire (1998), a more sophisticated BMS would converge more slowly, and is considered as a drawback as it takes a longer period to stabilize. The main objective of a BMS is to separate the good drivers from the bad drivers, and thus, it is desirable to have a classification process that can be finalized (or stabilized) as soon as possible. 11.5 BMS and Premium Rating 11.5.1 Premium Rating Premium rating is the process of establishing premium rates in an insurance system, or other risk transfer mechanisms. The process involves a number of considerations such as statistical methods, marketing goals, competition and legal restrictions. Premium rating should fulfill four basic objectives generally agreed among the actuaries; producing ‘fair’ premium rates whereby high risks insureds pay higher premium and vice versa, providing sufficient funds for paying incurred losses and expenses, providing adequate margin for adverse deviation, and producing reasonable returns to insurers. Before we discuss the application of BMS in premium rating, a brief discussion of the Poisson and negative binomial regression models are provided here. The Poisson regression has been widely used for fitting count (or frequency) data in insurance area. The negative binomial regression model can be used for fitting count (or frequency) data with overdispersion, which is a situation when the variance is larger than the mean. However, students are encouraged to refer to textbooks on GLMs or regression models available in the literature for a more comprehensive knowledge on the related subjects. 11.5.2 Frequency Model – Poisson and Negative Binomial Regressions Let \\({({Y_1},{Y_2},...,{Y_n})^T}\\) be the vector of count random variables and \\(n\\) be the sample size. The probability mass function (p.m.f.) for Poisson regression model is, \\[\\Pr ({Y_i} = {y_i}) \\begin{array}{*{20}{c}} = \\frac{{{\\exp(- {\\mu _i})}{\\mu _i}^{y_i}}}{y_i{!}}&amp;{y_i = 0,1,...} \\end{array} \\] with mean and variance \\(E({Y_i}) = Var({Y_i}) = {\\mu _i}\\). To take into account non-negative values, the mean, or the fitted value, is assumed to follow a log link, \\(E({Y_i}) = {\\mu _i} = \\exp ({\\bf x}_{\\bf i}{\\bf &#39;\\beta })\\), where \\({\\bf{x}}_{\\bf i}\\) denotes the vector of explanatory variables and \\({\\bf \\beta}\\) is the vector of regression parameters. The maximum likelihood estimates can be obtained by maximizing the log likelihood. The p.m.f. for negative binomial regression model is, \\[ \\Pr ({Y_i} = {y_i}) = \\frac{{\\Gamma ({y_i} + v)}}{y_i{!}\\Gamma (v)} \\left( \\frac{v}{v + {\\mu _i}} \\right)^v \\left( \\frac{\\mu _i}{v + {\\mu _i}} \\right)^{y_i},{y_i} = 0,1,2,..., \\] where the mean is \\(E({Y_i}) = {\\mu _i}\\), the variance is \\(Var({Y_i}) = {\\mu _i}(1 + {v^{ - 1}}{\\mu _i}) = {\\mu _i}(1 + a{\\mu _i})\\), and \\({v^{ - 1}} = a\\) denotes the dispersion parameter. The NB regression model reduce to the Poisson regression model in the limit as \\(a \\to 0\\), and display overdispersion when \\(a &gt; 0\\). The mean can also be assumed to follow the log link, \\(E({Y_i}) = {\\mu _i} = \\exp ({{\\bf x}_{\\bf i}{\\bf{&#39;\\beta }}})\\), and the maximum likelihood estimates can be obtained by maximizing the log likelihood. 11.5.3 Premium Rating with Bonus-Malus Data Under this section, we will consider the statistical approach of obtaining premium rates using count data (frequency data) that provides bonus-malus information on the risk profiles of the insureds. Example 10 Consider the Canadian private automobile liability insurance data from Bailey and Simon (1960). The data provides information on the number of claims incurred and exposures (expressed in terms of number of earned car years). The data is classified into two rating factors; merit rating and class rating. Altogether, there are twenty \\((4 \\times 5)\\) cross-classified rating classes of claim frequencies (20 count data). Table 5 provides the description of the two rating factors. It can be seen that merit rating provides information on the number of accident-free years, and thus, the information can be used as bonus-malus information. Using the Canadian automobile insurance data: Fit the count data using Poisson regression model. Calculate the premium assuming that the claim severity is 1000 for all rating classes. Build a simple premium table, and suggest the percentage of discounts (or loadings) for the premiums if the BMS is to be considered. \\[ \\begin{matrix} \\text{Table 5: Rating factors (Canadian data)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Merit} &amp; \\text{Class}\\\\ \\hline\\\\ \\text{A = licensed, accident-free ≥ 3 years } &amp; \\text{1 = pleasure, no male operator &lt; 25 } \\\\ \\text{X = licensed, accident-free 2 years } &amp; \\text{2 = pleasure, non-principal male operator &lt; 25 } \\\\ \\text{Y = licensed, accident-free 1 year } &amp; \\text{3 = business use } \\\\ \\text{B = others} &amp; \\text{4 = unmarried owner / principal operator &lt; 25} \\\\ &amp; \\text{5 = married owner / principal operator &lt; 25 } \\\\\\\\ \\hline \\end{array} \\end{matrix} \\] Solution Table 6 provides the parameter estimates (and standard errors) for the Poisson regression model which is fitted to the count data. The premiums are calculated by multiplying the fitted frequencies with the claim severities. The fitted frequency is obtained by dividing the fitted count with the exposure. The fitted count, \\(E({Y_i}) = {\\mu _i} = {\\hat y_i}\\), is the fitted value obtained from the Poisson regression model. The premiums for all rating classes, are shown in Table 7. Let the premium classified under merit B be the base premium. The premium relativities and the percentage of discounts for each rating class can be calculated, and the values are shown in Table 8. A simple premium table, which provides the percentage of discounts based on the number of accident-free years, can be constructed and is shown in Table 9. The discounts can be suggested for implementing the BMS. \\[ \\begin{matrix} \\text{Table 6: Poisson regression model (Canadian data)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Regression parameter} &amp; \\text{est.} &amp; \\text{std. error} &amp; p\\text{ -value} \\\\ \\hline\\\\ \\text{Intercept} &amp; {-2.53} &amp; {0.00} &amp; {0.00} \\\\ \\text{Class 2} &amp; {0.30} &amp; {0.01} &amp; {0.00} \\\\ \\text{Class 3} &amp; {0.47} &amp; {0.01} &amp; {0.00} \\\\ \\text{Class 4} &amp; {0.53} &amp; {0.01} &amp; {0.00} \\\\ \\text{Class 5} &amp; {0.22} &amp; {0.01} &amp; {0.00} \\\\ \\text{Merit X} &amp; {0.27} &amp; {0.01} &amp; {0.00} \\\\ \\text{Merit Y} &amp; {0.36} &amp; {0.01} &amp; {0.00} \\\\ \\text{Merit B} &amp; {0.49} &amp; {0.00} &amp; {0.00} \\\\ &amp; &amp; &amp; \\\\ \\text{Log }L &amp; {-394.96} &amp; &amp; \\\\\\\\ \\hline \\end{array} \\end{matrix} \\] \\[ \\begin{matrix} \\text{Table 7: Fitted count, fitted frequency and premium (Canadian data)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Class} &amp; \\text{Merit} &amp; &amp; &amp; \\text{Fitted frequency} &amp; \\text{Premium} \\\\ \\text{rating} &amp; \\text{rating} &amp; \\text{Fitted count} &amp; \\text{Exposure} &amp; \\text{(count/exposure)} &amp; \\text{(frequency x 1000)}\\\\ \\hline\\\\ 1 &amp; \\text{A} &amp; 219950 &amp; 2757520 &amp; 0.08 &amp; 80 \\\\ 1 &amp; \\text{X} &amp; 13688 &amp; 130706 &amp; 0.1 &amp; 105 \\\\ 1 &amp; \\text{Y} &amp; 18608 &amp; 163544 &amp; 0.11 &amp; 114 \\\\ 1 &amp; \\text{B} &amp; 35773 &amp; 273944 &amp; 0.13 &amp; 131 \\\\ 2 &amp; \\text{A} &amp; 14052 &amp; 130535 &amp; 0.11 &amp; 108 \\\\ 2 &amp; \\text{X} &amp; 1022 &amp; 7233 &amp; 0.14 &amp; 141 \\\\ 2 &amp; \\text{Y} &amp; 1494 &amp; 9726 &amp; 0.15 &amp; 154 \\\\ 2 &amp; \\text{B} &amp; 3790 &amp; 21504 &amp; 0.18 &amp; 176 \\\\ 3 &amp; \\text{A} &amp; 31547 &amp; 247424 &amp; 0.13 &amp; 128 \\\\ 3 &amp; \\text{X} &amp; 2656 &amp; 15868 &amp; 0.17 &amp; 167 \\\\ 3 &amp; \\text{Y} &amp; 3705 &amp; 20369 &amp; 0.18 &amp; 182 \\\\ 3 &amp; \\text{B} &amp; 7862 &amp; 37666 &amp; 0.21 &amp; 209 \\\\ 4 &amp; \\text{A} &amp; 21170 &amp; 156871 &amp; 0.13 &amp; 135 \\\\ 4 &amp; \\text{X} &amp; 3137 &amp; 17707 &amp; 0.18 &amp; 177 \\\\ 4 &amp; \\text{Y} &amp; 4060 &amp; 21089 &amp; 0.19 &amp; 193 \\\\ 4 &amp; \\text{B} &amp; 12534 &amp; 56730 &amp; 0.22 &amp; 221 \\\\ 5 &amp; \\text{A} &amp; 6346 &amp; 64130 &amp; 0.1 &amp; 99 \\\\ 5 &amp; \\text{X} &amp; 525 &amp; 4039 &amp; 0.13 &amp; 130 \\\\ 5 &amp; \\text{Y} &amp; 687 &amp; 4869 &amp; 0.14 &amp; 141 \\\\ 5 &amp; \\text{B} &amp; 1393 &amp; 8601 &amp; 0.16 &amp; 162 \\\\\\\\ \\hline \\end{array} \\end{matrix} \\] \\[ \\begin{matrix} \\text{Table 8: Premium relativities (Canadian data)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Class} &amp; \\text{Merit} &amp; \\text{Premium} &amp; \\text{Premium relativity} &amp; \\text{Discount} \\\\ \\hline\\\\ 1 &amp; \\text{A} &amp; 80 &amp; 0.61 &amp; 39 \\\\ &amp; \\text{X} &amp; 105 &amp; 0.80 &amp; 20 \\\\ &amp; \\text{Y} &amp; 114 &amp; 0.87 &amp; 13 \\\\ &amp; \\text{B} &amp; 131 &amp; 1.00 &amp; 0 \\\\ 2 &amp; \\text{A} &amp; 108 &amp; 0.61 &amp; 39 \\\\ &amp; \\text{X} &amp; 141 &amp; 0.80 &amp; 20 \\\\ &amp; \\text{Y} &amp; 154 &amp; 0.88 &amp; 13 \\\\ &amp; \\text{B} &amp; 176 &amp; 1.00 &amp; 0 \\\\ 3 &amp; \\text{A} &amp; 128 &amp; 0.61 &amp; 39 \\\\ &amp; \\text{X} &amp; 167 &amp; 0.80 &amp; 20 \\\\ &amp; \\text{Y} &amp; 182 &amp; 0.87 &amp; 13 \\\\ &amp; \\text{B} &amp; 209 &amp; 1.00 &amp; 0 \\\\ 4 &amp; \\text{A} &amp; 135 &amp; 0.61 &amp; 39 \\\\ &amp; \\text{X} &amp; 177 &amp; 0.80 &amp; 20 \\\\ &amp; \\text{Y} &amp; 193 &amp; 0.87 &amp; 13 \\\\ &amp; \\text{B} &amp; 221 &amp; 1.00 &amp; 0 \\\\ 5 &amp; \\text{A} &amp; 99 &amp; 0.61 &amp; 39 \\\\ &amp; \\text{X} &amp; 130 &amp; 0.80 &amp; 20 \\\\ &amp; \\text{Y} &amp; 141 &amp; 0.87 &amp; 13 \\\\ &amp; \\text{B} &amp; 162 &amp; 1.00 &amp; 0 \\\\\\\\ \\hline \\end{array} \\end{matrix}\\] \\[ \\begin{matrix} \\text{Table 9: Premium rates and BMS (Canadian data)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Class} &amp; \\text{Premium} &amp; \\text{Years of} &amp; \\text{Discount for} \\\\ &amp; &amp; \\text{accident-free} &amp; \\text{bonus-malus }\\\\ \\hline\\\\ 1 &amp; 131 &amp; {3+} &amp; 39 \\\\ &amp; &amp; 2 &amp; 20 \\\\ &amp; &amp; 1 &amp; 13 \\\\ &amp; &amp; 0 &amp; 0 \\\\ 2 &amp; 176 &amp; {3+} &amp; 39 \\\\ &amp; &amp; 2 &amp; 20 \\\\ &amp; &amp; 1 &amp; 13 \\\\ &amp; &amp; 0 &amp; 0 \\\\ 3 &amp; 209 &amp; {3+} &amp; 39 \\\\ &amp; &amp; 2 &amp; 20 \\\\ &amp; &amp; 1 &amp; 13 \\\\ &amp; &amp; 0 &amp; 0 \\\\ 4 &amp; 221 &amp; {3+} &amp; 39 \\\\ &amp; &amp; 2 &amp; 20 \\\\ &amp; &amp; 1 &amp; 13 \\\\ &amp; &amp; 0 &amp; 0 \\\\ 5 &amp; 162 &amp; {3+} &amp; 39 \\\\ &amp; &amp; 2 &amp; 20 \\\\ &amp; &amp; 1 &amp; 13 \\\\ &amp; &amp; 0 &amp; 0 \\\\\\\\ \\hline \\end{array} \\end{matrix}\\] 11.5.4 Premium Rating without Bonus-Malus Data Under this section, we will consider the statistical approach of obtaining premium rates using count data that does not provide bonus-malus information on the risk profiles of the insureds. Example 11 The dataset for private car Own Damage (OD) claim count in Malaysia (Zamani and Ismail 2012, Ismail and Zamani 2013) is considered here. The data is based on 1.01 million private car policies for a three-year period of 2001-2003. The exposures are expressed in car-year units. Table 10 shows the rating factors for the claim count data. Altogether, there are \\(5 \\times 5 \\times 5 \\times 5 = 625\\) cross-classified rating classes of claim frequencies (625 count data). However, the number of rating classes (sample size) reduces to 547 after excluding count data with zero exposure. It can be seen from the description in Table 10 that the data does not provide information on the number of claim-free years (bonus-malus information). Using the Malaysian private car insurance data: Fit the count data using Poisson and negative binomial regression models. Compare both models and suggest a preferred model for the data. Calculate the premium assuming that the claim severity is MYR 1000 (Ringgit Malaysia) for all rating classes. Build a premium table, assuming that the NCD is to be implemented. \\[ \\begin{matrix} \\text{Table 10: Rating factors (Malaysian data)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Rating factors} &amp; \\text{Description} \\\\ \\hline\\\\ \\text{Vehicle age} &amp; \\text{0-1 year } \\\\ &amp; \\text{2-3 years} \\\\ &amp; \\text{4-5 years} \\\\ &amp; \\text{6-7 years} \\\\ &amp; \\text{8+ years} \\\\ \\text{Vehicle c.c.} &amp; \\text{0-1000} \\\\ &amp; \\text{1001-1300} \\\\ &amp; \\text{1301-1500} \\\\ &amp; \\text{1501-1800} \\\\ &amp; \\text{1801+} \\\\ \\text{Vehicle make} &amp; \\text{Local type 1} \\\\ &amp; \\text{Local type 2} \\\\ &amp; \\text{Foreign type 1} \\\\ &amp; \\text{Foreign type 2} \\\\ &amp; \\text{Foreign type 3} \\\\ \\text{Location} &amp; \\text{North} \\\\ &amp; \\text{East} \\\\ &amp; \\text{Central} \\\\ &amp; \\text{South} \\\\ &amp; \\text{East Malaysia} \\\\\\\\ \\hline \\end{array} \\end{matrix} \\] Solution Table 11 shows the parameter estimates (and standard errors) for the fitted Poisson and negative binomial regression models. The results indicate that the regression parameters of all models have similar estimates. The likelihood ratio for testing overdispersion between the Poisson and the NB models is 2844.14, indicating that the data is overdispersed and the NB is a better model. The AIC and BIC also indicate that the NB is a better model. Table 12 shows the parameter estimates (and standard errors) for the fitted negative binomial regression model with significant covariates (covariates with \\(p\\)-values larger than 0.10 are excluded). The NB model in Table 12 is suggested as the preferred model for the data. The premiums are calculated by multiplying the fitted frequencies with the claim severities. The premiums for the first 25 rating classes (vehicle age: 0-1 year and vehicle make: local-type 1) are shown in Table 13. The Malaysian NCD system have six discount classes (0%, 25%, 30%, 38.3%, 45% and 55%) for 0, 1, 2, 3, 4 and 5+ claim-free years. The final premium rates should be ‘inflated’ accordingly to take into account the NCD (discount entitlement) of each insured. We can use the stationary distribution to approximate the proportion of insureds in each NCD class (in the long run). Assume that the probability of a no-claim year for all NCD classes is 0.90. The stationary probabilities are (from Example 3): \\[ {\\pi_0} = 0.1000,\\rm{ }{\\pi _1} = 0.0900,\\rm{ }{\\pi _2} = 0.0810,\\rm{ }{\\pi _3} = 0.0729,\\rm{ }{\\pi _4} = 0.0656,\\rm{ }{\\pi _5} = 0.5905 \\] which indicates that 10% of insureds eventually belong to class 0 (zero claim-free years), 9% of insureds eventually belong to class 1 (one claim-free year), and so forth, until 59% of insureds eventually belong to class 5 (or five successive claim-free years). After implementing the NCD, the premium (in the long run) will be reduced (on average) by the following factor: \\[ \\begin{array}{l} = \\sum\\limits_j \\text{(proportion of insureds in class }j)\\text{(1 - NCD in class }j) \\\\\\\\ = (0.1000)(1) + (0.0900)(1 - 0.25) + ... + (0.5905)(1 - 0.55)\\\\\\\\ = {0}{.570962} \\end{array} \\] Therefore, the final premiums (after adjusting for the NCD) should be inflated by \\(1 \\div 0.57 = 1.75\\). A premium table can be constructed based on the factor (1.75). The final premiums for the first 5 rating classes are shown in Table 14, and can be suggested for implementing the NCD. \\[ \\begin{matrix} \\text{Table 11: Poisson and negative binomial regression models (Malaysian data)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Parameters} &amp; \\text{Poisson} &amp; \\text{Poisson} &amp; \\text{NB} &amp; \\text{NB} \\\\ &amp; \\text{Est.} &amp; {p}\\text{ -value} &amp; \\text{Est.} &amp; {p}\\text{ -value} \\\\ \\hline\\\\ \\text{Intercept} &amp; {-3.04} &amp; {0.00} &amp; -3.17 &amp; 0.00 \\\\ \\text{2-3 year} &amp; {0.51} &amp; {0.00} &amp; 0.57 &amp; 0.00 \\\\ \\text{4-5 year} &amp; {0.52} &amp; {0.00} &amp; 0.52 &amp; 0.00 \\\\ \\text{6-7 year} &amp; {0.43} &amp; {0.00} &amp; 0.40 &amp; 0.00 \\\\ \\text{8+ year} &amp; {0.24} &amp; {0.00} &amp; 0.28 &amp; 0.00 \\\\ \\text{1001-1300 cc} &amp; {-0.31} &amp; {0.00} &amp; -0.14 &amp; 0.00 \\\\ \\text{1301-1500 cc} &amp; {-0.16} &amp; {0.00} &amp; 0.08 &amp; 0.16 \\\\ \\text{1501-1800 cc} &amp; {0.14} &amp; {0.00} &amp; 0.25 &amp; 0.00 \\\\ \\text{1801+ cc} &amp; {0.12} &amp; {0.00} &amp; 0.34 &amp; 0.00 \\\\ \\text{Local type 2} &amp; {-0.46} &amp; {0.00} &amp; -0.30 &amp; 0.00 \\\\ \\text{Foreign type 1} &amp; {-0.21} &amp; {0.00} &amp; -0.31 &amp; 0.00 \\\\ \\text{Foreign type 2} &amp; {0.18} &amp; {0.00} &amp; 0.31 &amp; 0.00 \\\\ \\text{Foreign type 3} &amp; {-0.02} &amp; {0.43} &amp; -0.16 &amp; 0.04 \\\\ \\text{East} &amp; {0.35} &amp; {0.00} &amp; 0.30 &amp; 0.00 \\\\ \\text{Central} &amp; {0.32} &amp; {0.00} &amp; 0.31 &amp; 0.00 \\\\ \\text{South} &amp; {0.26} &amp; {0.00} &amp; 0.36 &amp; 0.00 \\\\ \\text{East Malaysia} &amp; {0.13} &amp; {0.00} &amp; 0.11 &amp; 0.08 \\\\ {a} &amp; {-} &amp; {-} &amp; 0.13 &amp; 0.00 \\\\ &amp; &amp; &amp; &amp; \\\\ \\text{Log likelihood} &amp; &amp; {-3,613.39} &amp; &amp; -2191.32 \\\\ \\text{AIC} &amp; &amp; {7,260.79} &amp; &amp; 4418.65 \\\\ \\text{BIC} &amp; &amp; {7,333.96} &amp; &amp; 4496.13 \\\\\\\\ \\hline \\end{array} \\end{matrix} \\] \\[ \\begin{matrix} \\text{Table 12: Negative binomial regression model with significant covariates (Malaysian data)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Parameters} &amp; \\text{Est.} &amp; p\\text{ -value}\\\\ \\hline \\\\ \\text{Intercept} &amp; {-3.14} &amp; {0.00}\\\\ \\text{2-3 year} &amp; {0.58} &amp; {0.00}\\\\ \\text{4-5 year} &amp; {0.53} &amp; {0.00}\\\\ \\text{6-7 year} &amp; {0.41} &amp; {0.00}\\\\ \\text{8+ year} &amp; {0.29} &amp; {0.00}\\\\ \\text{1001-1300 cc} &amp; {-0.17} &amp; {0.00}\\\\ \\text{1501-1800 cc} &amp; {0.23} &amp; {0.00}\\\\ \\text{1801+ cc} &amp; {0.32} &amp; {0.00}\\\\ \\text{Local type 2} &amp; {-0.32} &amp; {0.00}\\\\ \\text{Foreign type 1} &amp; {-0.31} &amp; {0.00}\\\\ \\text{Foreign type 2} &amp; {0.31} &amp; {0.00}\\\\ \\text{Foreign type 3} &amp; {-0.18} &amp; {0.02}\\\\ \\text{East} &amp; {0.30} &amp; {0.00}\\\\ \\text{Central} &amp; {0.31} &amp; {0.00}\\\\ \\text{South} &amp; {0.36} &amp; {0.00}\\\\ \\text{East Malaysia} &amp; {0.11} &amp; {0.08}\\\\ \\alpha\\,\\text{(dispersion)} &amp; {0.13} &amp; {0.00}\\\\\\\\ \\text{Log likelihood} &amp; &amp; {-2192.34}\\\\ \\text{AIC} &amp; &amp; {4418.68}\\\\ \\text{BIC} &amp; &amp; {4491.85}\\\\\\\\ \\hline \\end{array} \\end{matrix} \\] \\[ \\begin{matrix} \\text{Table 13: Premium rates (Malaysian data)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Vehicle} &amp; \\text{Vehicle} &amp; \\text{Vehicle} &amp; \\text{location} &amp; \\text{exposure} &amp; \\text{Fitted} &amp; \\text{Premium}\\\\ \\text{year} &amp; \\text{cc} &amp; \\text{make} &amp; &amp; &amp; \\text{count} &amp; \\left(\\frac{fitted\\,count}{exposure} \\times 1000 \\right)\\\\ \\hline\\\\ 0-1\\,\\text{year} &amp; {0-1000} &amp; \\text{local-1} &amp; \\text{north} &amp; {34} &amp; {1} &amp; {29}\\\\ &amp; &amp; &amp; \\text{east} &amp; {11} &amp; {1} &amp; {91}\\\\ &amp; &amp; &amp; \\text{central} &amp; {184} &amp; {11} &amp; {60}\\\\ &amp; &amp; &amp; \\text{south} &amp; {14} &amp; {1} &amp; {71}\\\\ &amp; &amp; &amp; \\text{east Msia} &amp; {22} &amp; {1} &amp; {45}\\\\ &amp; &amp; \\text{local-2} &amp; \\text{north} &amp; {17881} &amp; {562} &amp; {31}\\\\ &amp; &amp; &amp; \\text{east} &amp; {7581} &amp; {322} &amp; {42}\\\\ &amp; &amp; &amp; \\text{central} &amp; {19699} &amp; {844} &amp; {43}\\\\ &amp; &amp; &amp; \\text{south} &amp; {8268} &amp; {371} &amp; {45}\\\\ &amp; &amp; &amp; \\text{east Msia} &amp; {12229} &amp; {429} &amp; {35}\\\\ &amp; &amp; \\text{foreign-1} &amp; \\text{north} &amp; {241} &amp; {8} &amp; {33}\\\\ &amp; &amp; &amp; \\text{east} &amp; {44} &amp; {2} &amp; {45}\\\\ &amp; &amp; &amp; \\text{central} &amp; {254} &amp; {11} &amp; {43}\\\\ &amp; &amp; &amp; \\text{south} &amp; {35} &amp; {2} &amp; {57}\\\\ &amp; &amp; &amp; \\text{east Msia} &amp; {113} &amp; {4} &amp; {35}\\\\ &amp; &amp; \\text{foreign-2} &amp; \\text{north} &amp; {64} &amp; {4} &amp; {63}\\\\ &amp; &amp; &amp; \\text{east} &amp; {7} &amp; {1} &amp; {143}\\\\ &amp; &amp; &amp; \\text{central} &amp; {164} &amp; {13} &amp; {79}\\\\ &amp; &amp; &amp; \\text{south} &amp; {23} &amp; {2} &amp; {87}\\\\ &amp; &amp; &amp; \\text{east Msia} &amp; {45} &amp; {1} &amp; {67}\\\\ &amp; &amp; \\text{foreign-3} &amp; \\text{north} &amp; {7512} &amp; {274} &amp; {36}\\\\ &amp; &amp; &amp; \\text{east} &amp; {2747} &amp; {135} &amp; {49}\\\\ &amp; &amp; &amp; \\text{central} &amp; {15551} &amp; {774} &amp; {50}\\\\ &amp; &amp; &amp; \\text{south} &amp; {7408} &amp; {387} &amp; {52}\\\\ &amp; &amp; &amp; \\text{east Msia} &amp; {6740} &amp; {274} &amp; {41}\\\\\\\\ \\hline \\end{array} \\end{matrix} \\] \\[ \\begin{matrix} \\text{Table 14: Premium, final premium and NCD (Malaysian data)}\\\\ \\begin{array}{*{20}c} \\hline \\text{Vehicle} &amp; \\text{Vehicle} &amp; \\text{Vehicle} &amp; \\text{location} &amp; \\text{Premium} &amp; \\text{Final} &amp; \\text{Years of} &amp; \\text{NCD}\\\\ \\text{year} &amp; \\text{cc} &amp; \\text{make} &amp; &amp; &amp; \\text{Premium} &amp; \\text{claim-free} &amp; \\left( \\% \\right)\\\\ &amp; &amp; &amp; &amp; &amp; \\left( \\text{premium} \\times \\text{1.75}\\right) &amp; &amp; \\\\ \\hline\\\\ 0-1\\,\\text{year} &amp; {0-1000} &amp; \\text{local-1} &amp; \\text{north} &amp; {29} &amp; {51} &amp; {5+} &amp; {55}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {4} &amp; {45}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {3} &amp; {38.33}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {2} &amp; {30}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {1} &amp; {25}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {0} &amp; {0}\\\\ &amp; &amp; &amp; \\text{east} &amp; {91} &amp; {159} &amp; {0} &amp; {55}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {1} &amp; {45}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {2} &amp; {38.33}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {3} &amp; {30}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {4} &amp; {25}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {5+} &amp; {0}\\\\ &amp; &amp; &amp; \\text{central} &amp; {60} &amp; {105} &amp; {0} &amp; {55}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {1} &amp; {45}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {2} &amp; {38.33}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {3} &amp; {30}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {4} &amp; {25}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {5+} &amp; {0}\\\\ &amp; &amp; &amp; \\text{south} &amp; {71} &amp; {125} &amp; {0} &amp; {55}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {1} &amp; {45}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {2} &amp; {38.33}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {3} &amp; {30}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {4} &amp; {25}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {5+} &amp; {0}\\\\ &amp; &amp; &amp; \\text{east Msia} &amp; {45} &amp; {80} &amp; {0} &amp; {55}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {1} &amp; {45}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {2} &amp; {38.33}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {3} &amp; {30}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {4} &amp; {25}\\\\ &amp; &amp; &amp; &amp; &amp; &amp; {5+} &amp; {0}\\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; &amp; \\vdots &amp; \\vdots &amp; \\vdots\\\\\\\\ \\hline \\end{array} \\end{matrix} \\] FURTHER READING AND REFERENCES: Aitkin, M., Anderson, D., Francis, B., Hinde, J. 1990. Statistical Modelling in GLIM. New York: Oxford University Press. Ajne, B. 1975. A note on the multiplicative ratemaking model. ASTIN Bulletin 8(2): 144-153. Anderson, D., Feldblum, S., Modlin, C., Schirmacher, D., Schirmacher, E., Thandi, N. 2004. A practitioner's guide to Generalized Linear Models. Casualty Actuarial Society Discussion Paper Program 1-115. Bailey, R.A. 1963. Insurance rates with minimum bias. Proceedings of the Casualty Actuarial Society 50(93): 4-14. Bailey, R.A., Simon, L.J. 1960. Two studies in automobile insurance ratemaking. ASTIN Bulletin 49(1): 192-217. Bichsel, F. 1964. Erfahrungs-Tarifierung in der Motorfahrzeug-halfplichtversicherung. Milleilungen der Vereinigung Schweizerischer Versicherungsmathematiker 119-129. Boucher, J.P., Denuit, M., Guillen, M. 2007. Risk classification for claim count: a comparative analysis of various zero-inflated mixed Poisson and hurdle models. North American Actuarial Journal 11(4): 110-131. Brockmann, M.J., Wright, T.S. 1992. Statistical motor rating: making effective use of your data. Journal of the Institute of Actuaries 119(3): 457-543. Brown, R.L. 1988. Minimum bias with generalized linear models. Proceedings of the Casualty Actuarial Society 75(143): 187-217. Bühlmann, H. 1964. Optimale Prämienstufen systeme. Milleilungen der Vereinigung Schweizerischer Versicherungsmathematiker 193-213. Cameron, A.C., Trivedi, P.K. 1986. Econometric models based on count data: comparisons and applications of some estimators and tests. Journal of Applied Econometrics 1: 29-53. Cameron, A.C., Trivedi, P.K. 1998. Regression Analysis of Count Data. New York: Cambridge University Press. Chamberlain, C. 1980. Relativity pricing through analysis of variance. Casualty Actuarial Society Discussion Paper Program 4-24. Corlier, F., Lemaire, J., &amp; Muhokolo, D. (1979). Simulation of an automobile portfolio. The Geneva Papers on Risk and Insurance Theory 4:40-46. Coutts, S.M. 1984. Motor insurance rating, an actuarial approach. Journal of the Institute of Actuaries 111: 87-148. Delaporte, P. 1965. Tarification du risque individuel d’accidents par la prime modelil ée sur le risqué. ASTIN Bulletin 3: 251-271. Denuit, M., Marechal, X., Pitrebois, S., Walhin, J.F. 2007. Actuarial Modeling of Claim Counts: Risk Classification, Credibility and Bonus-Malus Systems. John Wiley and Sons: England. Dionne, G., &amp; Vanasse, C. (1989). A generalization of automobile insurance rating models: the negative binomial distribution with a regression component. ASTIN Bullettin 19(2): 199-212. Frangos, N. E., Vrontos, S. D. 2001. Design of optimal bonus-malus systems with a frequency and severity component on an individual basis in automobile insurance. ASTIN Bulletin 31(1): 1-22. Harrington, S.E. 1986. Estimation and testing for functional form in pure premium regression models. ASTIN Bulletin 16: 31-43. Hastings, N.A.J. 1976. Optimal claiming on vehicle insurance. Operational Research Quarterly 27: 805-813. Hilbe, J. 2007. Negative Binomial Regression. Cambridge, UK: Cambridge University Press. Ismail, N., Jemain, A.A. 2005. Bridging minimum bias and maximum likelihood methods through weighted equation. Casualty Actuarial Society Forum Spring: 367-394. Ismail, N., Jemain, A.A. 2007. Handling overdispersion with negative binomial and generalized Poisson regression models. Casualty Actuarial Society Forum Winter: 103-158. Ismail, N., Zamani, H. 2013. Estimation of claim count data using negative binomial, generalized Poisson, zero-inflated negative binomial and zero-inflated generalized Poisson regression models. Casualty Actuarial Society E-Forum Spring: 1-29. Jung, J. 1968. On automobile insurance ratemaking. ASTIN Bulletin 5(1): 41-48. Kolderman, J., Volgenant, A. 1985. Optimal claiming in an automobile insurance system with bonus-malus structure. Journal of the Operational Research Society 36: 239-247. Lawless, J.F. 1987. Negative binomial and mixed Poisson regression. Canadian Journal of Statistics 15(3): 209-225. Lemaire, J. 1976. Driver versus company, optimal behaviour of the policy holder. Scandinavian Actuarial Journal 59: 209-219. Lemaire, J. 1977. La soif du bonus. ASTIN Bulletin 9: 181-190. Lemaire, J. 1979. How to define a Bonus-Malus system with an exponential utility function. ASTIN Bulletin 10: 274-282. Lemaire, J., Zi, H.M. 1994. A comparative analysis of 30 Bonus-Malus systems. ASTIN Bulletin 24: 287-309. Lemaire, J. 1998. Bonus-Malus systems: The European and Asian approach to merit-rating. North American Actuarial Journal 2(1): 26-38. Loimaranta, K. 1972. Some asymptotic properties of bonus systems. ASTIN Bulletin 6: 233-245. McCullagh, P., Nelder, J.A. 1989. Generalized Linear Models (2nd Edition). Chapman and Hall: London. Morillo, I., Bermúdez, L. 2003. Bonus–malus system using an exponential loss function with an inverse Gaussian distribution. Insurance: Mathematics and Economics 33: 49-57. Pitrebois, S., Denuit, M., Walhin, J.F. 2003. Fitting the Belgian Bonus-Malus system. Belgian Actuarial Bulletin 3(1): 58-62. Renshaw, A.E., 1994. Modelling the claims process in the presence of covariates. ASTIN Bulletin 24(2): 265-285. Tremblay, L. 1992. Using the Poisson inverse Gaussian in Bonus-Malus systems. ASTIN Bulletin 22(1): 97-106. Vepsäläinen, S. 1972. Applications to a theory of bonus systems. ASTIN Bulletin 6: 212-221. Walhin, J. F., Paris, J. 1999. Using mixed Poisson processes in connection with Bonus-Malus systems. ASTIN Bulletin 29(1): 81-99. Winkelmann, R. 2008. Econometric Analysis of Count Data. Heidelberg: Springer Verlag. Zamani, H., Ismail, N. 2012. Functional form for the generalized Poisson regression model. Communications in Statistics (Theory and Methods) 41(20): 3666–3675. "],
["C-DataSystems.html", "Chapter 12 Data and Systems 12.1 Data 12.2 Data Analysis Preliminaries 12.3 Data Analysis Techniques 12.4 Some R Functions 12.5 Summary 12.6 Further Resources and Contributors", " Chapter 12 Data and Systems Chapter Preview. This chapter covers the learning areas on data and systems outlined in the IAA (International Actuarial Association) Education Syllabus published in September 2015. This chapter is organized into three major parts: data, data analysis, and data analysis techniques. The first part introduces data basics such as data types, data structures, data storages, and data sources. The second part discusses the process and various aspects of data analysis. The third part presents some commonly used techniques for data analysis. 12.1 Data 12.1.1 Data Types and Sources In terms of how data are collected, data can be divided into two types (Hox and Boeije 2005): primary data and secondary data. Primary data are original data that are collected for a specific research problem. Secondary data are data originally collected for a different purpose and reused for another research problem. A major advantage of using primary data is that the theoretical constructs, the research design, and the data collection strategy can be tailored to the underlying research question to ensure that the data collected indeed help to solve the problem. A disadvantage of using primary data is that data collection can be costly and time-consuming. Using secondary data has the advantage of lower cost and faster access to relevant information. However, using secondary data may not be optimal for the research question under consideration. In terms of the degree of organization of the data, data can be also divided into two types (Inmon and Linstedt 2014; O’Leary 2013; Hashem et al. 2015; Abdullah and Ahmad 2013; Pries and Dunnigan 2015): structured data and unstructured data. Structured data have a predictable and regularly occurring format. In contrast, unstructured data are unpredictable and have no structure that is recognizable to a computer. Structured data consist of records, attributes, keys, and indices and are typically managed by a database management system (DBMS) such as IBM DB2, Oracle, MySQL, and Microsoft SQL Server. As a result, most units of structured data can be located quickly and easily. Unstructured data have many different forms and variations. One common form of unstructured data is text. Accessing unstructured data is clumsy. To find a given unit of data in a long text, for example, sequentially search is usually performed. In terms of how the data are measured, data can be classified as qualitative or quantitative. Qualitative data are data about qualities, which cannot be actually measured. As a result, qualitative data are extremely varied in nature and include interviews, documents, and artifacts (Miles, Hberman, and Sdana 2014). Quantitative data are data about quantities, which can be measured numerically with numbers. In terms of the level of measurement, quantitative data can be further classified as nominal, ordinal, interval, or ratio (Gan 2011). Nominal data, also called categorical data, are discrete data without a natural ordering. Ordinal data are discrete data with a natural order. Interval data are continuous data with a specific order and equal intervals. Ratio data are interval data with a natural zero. There exist a number of data sources. First, data can be obtained from university-based researchers who collect primary data. Second, data can be obtained from organizations that are set up for the purpose of releasing secondary data for general research community. Third, data can be obtained from national and regional statistical institutes that collect data. Finally, companies have corporate data that can be obtained for research purpose. While it might be difficult to obtain data to address a specific research problem or answer a business question, it is relatively easy to obtain data to test a model or an algorithm for data analysis. In the modern era, readers can obtain datasets from the Internet easily. The following is a list of some websites to obtain real-world data: UCI Machine Learning Repository This website (url: http://archive.ics.uci.edu/ml/index.php) maintains more than 400 datasets that can be used to test machine learning algorithms. Kaggle The Kaggle website (url: https://www.kaggle.com/) include real-world datasets used for data science competition. Readers can download data from Kaggle by registering an account. DrivenData DrivenData aims at bringing cutting-edge practices in data science to solve some of the world’s biggest social challenges. In its website (url: https://www.drivendata.org/), readers can participate data science competitions and download datasets. Analytics Vidhya This website (url: https://datahack.analyticsvidhya.com/contest/all/) allows you to participate and download datasets from practice problems and hackathon problems. KDD Cup KDD Cup is the annual Data Mining and Knowledge Discovery competition organized by ACM Special Interest Group on Knowledge Discovery and Data Mining. This website (url: http://www.kdd.org/kdd-cup) contains the datasets used in past KDD Cup competitions since 1997. U.S. Government’s open data This website (url: https://www.data.gov/) contains about 200,000 datasets covering a wide range of areas including climate, education, energy, and finance. AWS Public Datasets In this website (url: https://aws.amazon.com/datasets/), Amazon provides a centralized repository of public datasets, including some huge datasets. 12.1.2 Data Structures and Storage As mentioned in the previous subsection, there are structured data as well as unstructured data. Structured data are highly organized data and usually have the following tabular format: \\[ \\begin{matrix} \\begin{array}{lllll} \\hline &amp; V_1 &amp; V_2 &amp; \\cdots &amp; V_d \\ \\\\\\hline \\textbf{x}_1 &amp; x_{11} &amp; x_{12} &amp; \\cdots &amp; x_{1d} \\\\ \\textbf{x}_2 &amp; x_{21} &amp; x_{22} &amp; \\cdots &amp; x_{2d} \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\cdots &amp; \\vdots \\\\ \\textbf{x}_n &amp; x_{n1} &amp; x_{n2} &amp; \\cdots &amp; x_{nd} \\\\ \\hline \\end{array} \\end{matrix} \\] In other words, structured data can be organized into a table consists of rows and columns. Typically, each row represents a record and each column represents an attribute. A table can be decomposed into several tables that can be stored in a relational database such as the Microsoft SQL Server. The SQL (Structured Query Language) can be used to access and modify the data easily and efficiently. Unstructured data do not follow a regular format (Abdullah and Ahmad 2013). Examples of unstructured data include documents, videos, and audio files. Most of the data we encounter are unstructured data. In fact, the term ``big data’’ was coined to reflect this fact. Traditional relational databases cannot meet the challenges on the varieties and scales brought by massive unstructured data nowadays. NoSQL databases have been used to store massive unstructured data. There are three main NoSQL databases (Chen et al. 2014): key-value databases, column-oriented databases, and document-oriented databases. Key-value databases use a simple data model and store data according to key-values. Modern key-value databases have higher expandability and smaller query response time than relational databases. Examples of key-value databases include Dynamo used by Amazon and Voldemort used by LinkedIn. Column-oriented databases store and process data according to columns rather than rows. The columns and rows are segmented in multiple nodes to achieve expandability. Examples of column-oriented databases include BigTable developed by Google and Cassandra developed by FaceBook. Document databases are designed to support more complex data forms than those stored in key-value databases. Examples of document databases include MongoDB, SimpleDB, and CouchDB. MongoDB is an open-source document-oriented database that stores documents as binary objects. SimpleDB is a distributed NoSQL database used by Amazon. CouchDB is another open-source document-oriented database. 12.1.3 Data Quality Accurate data are essential to useful data analysis. The lack of accurate data may lead to significant costs to organizations in areas such as correction activities, lost customers, missed opportunities, and incorrect decisions (Olson 2003). Data has quality if it satisfies its intended use, that is, the data is accurate, timely, relevant, complete, understood, and trusted (Olson 2003). As a result, we first need to know the specification of the intended uses and then judge the suitability for those uses in order to assess the quality of the data. Unintended uses of data can arise from a variety of reasons and lead to serious problems. Accuracy is the single most important component of high-quality data. Accurate data have the following properties (Olson 2003): The data elements are not missing and have valid values. The values of the data elements are in the right ranges and have the right representations. Inaccurate data arise from different sources. In particular, the following areas are common areas where inaccurate data occur: Initial data entry. Mistakes (including deliberate errors) and system errors can occur during the initial data entry. Flawed data entry processes can result in inaccurate data. Data decay. Data decay, also known as data degradation, refers to the gradual corruption of computer data due to an accumulation of non-critical failures in a storage device. Data moving and restructuring. Inaccurate data can also arise from data extracting, cleaning, transforming, loading, or integrating. Data using. Faulty reporting and lack of understanding can lead to inaccurate data. Reverification and analysis are two approaches to find inaccurate data elements. The first approach is done by people, who manually check every data element by going back to the original source of the data. The second approach is done by software with the skills of an analyst to search through data to find possible inaccurate data elements. To ensure that the data elements are 100% accurate, we must use reverification. However, reverification can be time-consuming and may not be possible for some data. Analytical techniques can also be used to identify inaccurate data elements. There are five types of analysis that can be used to identify inaccurate data (Olson 2003): data element analysis, structural analysis, value correlation, aggregation correlation, and value inspection Companies can create a data quality assurance program to create high-quality databases. For more information about management of data quality issues and data profiling techniques, readers are referred to Olson (2003). 12.1.4 Data Cleaning Raw data usually need to be cleaned before useful analysis can be conducted. In particular, the following areas need attention when preparing data for analysis (Janert 2010): Missing values It is common to have missing values in raw data. Depending on the situations, we can discard the record, discard the variable, or impute the missing values. Outliers Raw data may contain unusual data points such as outliers. We need to handle outliers carefully. We cannot just remove outliers without knowing the reason for their existence. Sometimes the outliers are caused by clerical errors. Sometimes outliers are the effect we are looking for. Junk Raw data may contain junks such as nonprintable characters. Junks are typically rare and not easy to get noticed. However, junks can cause serious problems in downstream applications. Format Raw data may be formatted in a way that is inconvenient for subsequent analysis. For example, components of a record may be split into multiple lines in a text file. In such cases, lines corresponding to a single record should be merged before loading to a data analysis software such as R. Duplicate records Raw data may contain duplicate records. Duplicate records should be recognized and removed. This task may not be trivial depending on what you consider ``duplicate.’’ Merging datasets Raw data may come from different sources. In such cases, we need to merge the data from different sources to ensure compatibility. For more information about how to handle data in R, readers are referred to Forte (2015) and Buttrey and Whitaker (2017). Show Quiz Solution 12.2 Data Analysis Preliminaries Data analysis involves inspecting, cleansing, transforming, and modeling data to discover useful information to suggest conclusions and make decisions. Data analysis has a long history. In 1962, statistician John Tukey defined data analysis as: procedures for analyzing data, techniques for interpreting the results of such procedures, ways of planning the gathering of data to make its analysis easier, more precise or more accurate, and all the machinery and results of (mathematical) statistics which apply to analyzing data. — (Tukey 1962) Recently, Judd and coauthors defined data analysis as the following equation(Judd, McClelland, and Ryan 2017): \\[ \\hbox{Data} = \\hbox{Model} + \\hbox{Error}, \\] where Data represents a set of basic scores or observations to be analyzed, Model is a compact representation of the data, and Error is simply the amount the model fails to represent accurately. Using the above equation for data analysis, an analyst must resolve the following two conflicting goals: to add more parameters to the model so that the model represents the data better. to remove parameters from the model so that the model is simple and parsimonious. In this section, we give a high-level introduction to data analysis, including different types of methods. 12.2.1 Data Analysis Process Data analysis is part of an overall study. For example, Figure 12.1 shows the process of a typical study in behavioral and social sciences as described in Albers (2017). The data analysis part consists of the following steps: Exploratory analysis The purpose of this step is to get a feel of the relationships with the data and figure out what type of analysis for the data makes sense. Statistical analysis This step performs statistical analysis such as determining statistical significance and effect size. Make sense of the results This step interprets the statistical results in the context of the overall study. Determine implications This step interprets the data by connecting it to the study goals and the larger field of this study. The goal of the data analysis as described above focuses on explaining some phenomenon (See Section 12.2.5). Figure 12.1: The process of a typical study in behavioral and social sciences. Shmueli (2010) described a general process for statistical modeling, which is shown in Figure 12.2. Depending on the goal of the analysis, the steps differ in terms of the choice of methods, criteria, data, and information. Figure 12.2: The process of statistical modeling. 12.2.2 Exploratory versus Confirmatory There are two phases of data analysis (Good 1983): exploratory data analysis (EDA) and confirmatory data analysis (CDA). Table 13.1 summarizes some differences between EDA and CDA. EDA is usually applied to observational data with the goal of looking for patterns and formulating hypotheses. In contrast, CDA is often applied to experimental data (i.e., data obtained by means of a formal design of experiments) with the goal of quantifying the extent to which discrepancies between the model and the data could be expected to occur by chance (Gelman 2004). \\[ \\begin{matrix} \\begin{array}{lll} \\hline &amp; \\textbf{EDA} &amp; \\textbf{CDA} \\\\\\hline \\text{Data} &amp; \\text{Observational data} &amp; \\text{Experimental data}\\\\[3mm] \\text{Goal} &amp; \\text{Pattern recognition,} &amp; \\text{Hypothesis testing,} \\\\ &amp; \\text{formulate hypotheses} &amp; \\text{estimation, prediction} \\\\[3mm] \\text{Techniques} &amp; \\text{Descriptive statistics,} &amp; \\text{Traditional statistical tools of} \\\\ &amp; \\text{visualization, clustering} &amp; \\text{inference, significance, and}\\\\ &amp; &amp; \\text{confidence} \\\\ \\hline \\end{array} \\end{matrix} \\] Table 13.1: Comparison of exploratory data analysis and confirmatory data analysis. Techniques for EDA include descriptive statistics (e.g., mean, median, standard deviation, quantiles), distributions, histograms, correlation analysis, dimension reduction, and cluster analysis. Techniques for CDA include the traditional statistical tools of inference, significance, and confidence. 12.2.3 Supervised versus Unsupervised Methods for data analysis can be divided into two types (Abbott 2014; Igual and Segu 2017): supervised learning methods and unsupervised learning methods. Supervised learning methods work with labeled data, which include a target variable. Mathematically, supervised learning methods try to approximate the following function: \\[ Y = f(X_1, X_2, \\ldots, X_p), \\] where \\(Y\\) is a target variable and \\(X_1\\), \\(X_2\\), \\(\\ldots\\), \\(X_p\\) are explanatory variables. Other terms are also used to mean a target variable. Table 13.2 gives a list of common names for different types of variables (Edward W. Frees 2009b). When the target variable is a categorical variable, supervised learning methods are called classification methods. When the target variable is continuous, supervised learning methods are called regression methods. \\[ \\begin{matrix} \\begin{array}{ll} \\hline \\textbf{Target Variable} &amp; \\textbf{Explanatory Variable}\\\\\\hline \\text{Dependent variable} &amp; \\text{Independent variable}\\\\ \\text{Response} &amp; \\text{Treatment} \\\\ \\text{Output} &amp; \\text{Input} \\\\ \\text{Endogenous variable} &amp; \\text{Exogenous variable} \\\\ \\text{Predicted variable} &amp; \\text{Predictor variable} \\\\ \\text{Regressand} &amp; \\text{Regressor} \\\\ \\hline \\end{array} \\end{matrix} \\] Table 13.2: Common names of different variables. Unsupervised learning methods work with unlabeled data, which include explanatory variables only. In other words, unsupervised learning methods do not use target variables. As a result, unsupervised learning methods are also called descriptive modeling methods. 12.2.4 Parametric versus Nonparametric Methods for data analysis can be parametric or nonparametric (Abbott 2014). Parametric methods assume that the data follow a certain distribution. Nonparametric methods do not assume distributions for the data and therefore are called distribution-free methods. Parametric methods have the advantage that if the distribution of the data is known, properties of the data and properties of the method (e.g., errors, convergence, coefficients) can be derived. A disadvantage of parametric methods is that analysts need to spend considerable time on figuring out the distribution. For example, analysts may try different transformation methods to transform the data so that it follows a certain distribution. Since nonparametric methods make fewer assumptions, nonparametric methods have the advantage that they are more flexible, more robust, and applicable to non-quantitative data. However, a drawback of nonparametric methods is that the conclusions drawn from nonparametric methods are not as powerful as those drawn from parametric methods. 12.2.5 Explanation versus Prediction There are two goals in data analysis (Breiman 2001; Shmueli 2010): explanation and prediction. In some scientific areas such as economics, psychology, and environmental science, the focus of data analysis is to explain the causal relationships between the input variables and the response variable. In other scientific areas such as natural language processing and bioinformatics, the focus of data analysis is to predict what the responses are going to be given the input variables. Shmueli (2010) discussed in detail the distinction between explanatory modeling and predictive modeling, which reflect the process of using data and methods for explaining or predicting, respectively. Explanatory modeling is commonly used for theory building and testing. However, predictive modeling is rarely used in many scientific fields as a tool for developing theory. Explanatory modeling is typically done as follows: State the prevailing theory. State causal hypotheses, which are given in terms of theoretical constructs rather than measurable variables. A causal diagram is usually included to illustrate the hypothesized causal relationship between the theoretical constructs. Operationalize constructs. In this step, previous literature and theoretical justification are used to build a bridge between theoretical constructs and observable measurements. Collect data and build models alongside the statistical hypotheses, which are operationalized from the research hypotheses. Reach research conclusions and recommend policy. The statistical conclusions are converted into research conclusions. Policy recommendations are often accompanied. Shmueli (2010) defined predictive modeling as the process of applying a statistical model or data mining algorithm to data for the purpose of predicting new or future observations. Predictions include point predictions, interval predictions, regions, distributions, and rankings of new observations. Predictive model can be any method that produces predictions. 12.2.6 Data Modeling versus Algorithmic Modeling Breiman (2001) discussed two cultures in the use of statistical modeling to reach conclusions from data: the data modeling culture and the algorithmic modeling culture. In the data modeling culture, the data are assumed to be generated by a given stochastic data model. In the algorithmic modeling culture, the data mechanism is treated as unknown and algorithmic models are used. Data modeling gives the statistics field many successes in analyzing data and getting information about the data mechanisms. However, Breiman (2001) argued that the focus on data models in the statistical community has led to some side effects such as Produced irrelevant theory and questionable scientific conclusions. Kept statisticians from using algorithmic models that might be more suitable. Restricted the ability of statisticians to deal with a wide range of problems. Algorithmic modeling was used by industrial statisticians long time ago. However, the development of algorithmic methods was taken up by a community outside statistics (Breiman 2001). The goal of algorithmic modeling is predictive accuracy. For some complex prediction problems, data models are not suitable. These prediction problems include speech recognition, image recognition, handwriting recognition, nonlinear time series prediction, and financial market prediction. The theory in algorithmic modeling focuses on the properties of algorithms, such as convergence and predictive accuracy. 12.2.7 Big Data Analysis Unlike traditional data analysis, big data analysis employs additional methods and tools that can extract information rapidly from massive data. In particular, big data analysis uses the following processing methods (Chen et al. 2014): Bloom filter A bloom filter is a space-efficient probabilistic data structure that is used to determine whether an element belongs to a set. It has the advantages of high space efficiency and high query speed. A drawback of using bloom filter is that there is a certain misrecognition rate. Hashing Hashing is a method that transforms data into fixed-length numerical values through a hash function. It has the advantages of rapid reading and writing. However, sound hash functions are difficult to find. Indexing Indexing refers to a process of partitioning data in order to speed up reading. Hashing is a special case of indexing. Tries A trie, also called digital tree, is a method to improve query efficiency by using common prefixes of character strings to reduce comparison on character strings to the greatest extent. Parallel computing Parallel computing uses multiple computing resources to complete a computation task. Parallel computing tools include MPI (Message Passing Interface), MapReduce, and Dryad. Big data analysis can be conducted in the following levels (Chen et al. 2014): memory-level, business intelligence (BI) level, and massive level. Memory-level analysis is conducted when the data can be loaded to the memory of a cluster of computers. Current hardware can handle hundreds of gigabytes (GB) of data in memory. BI level analysis can be conducted when the data surpass the memory level. It is common for BI level analysis products to support data over terabytes (TB). Massive level analysis is conducted when the data surpass the capabilities of products for BI level analysis. Usually Hadoop and MapReduce are used in massive level analysis. 12.2.8 Reproducible Analysis As mentioned in Section 12.2.1, a typical data analysis workflow includes collecting data, analyzing data, and reporting results. The data collected are saved in a database or files. The data are then analyzed by one or more scripts, which may save some intermediate results or always work on the raw data. Finally a report is produced to describe the results, which include relevant plots, tables, and summaries of the data. The workflow may subject to the following potential issues (Mailund 2017, Chapter 2): The data are separated from the analysis scripts. The documentation of the analysis is separated from the analysis itself. If the analysis is done on the raw data with a single script, then the first issue is not a major problem. If the analysis consists of multiple scripts and a script saves intermediate results that are read by the next script, then the scripts describe a workflow of data analysis. To reproduce an analysis, the scripts have to be executed in the right order. The workflow may cause major problems if the order of the scripts is not documented or the documentation is not updated or lost. One way to address the first issue is to write the scripts so that any part of the workflow can be run completely automatically at any time. If the documentation of the analysis is synchronized with the analysis, then the second issue is not a major problem. However, the documentation may become completely useless if the scripts are changed but the documentation is not updated. Literate programming is an approach to address the two issues mentioned above. In literate programming, the documentation of a program and the code of the program are written together. To do literate programming in R, one way is to use the R Markdown and the \\(\\texttt{knitr}\\) package. 12.2.9 Ethical Issues Analysts may face ethical issues and dilemmas during the data analysis process. In some fields, for example, ethical issues and dilemmas include participant consent, benefits, risk, confidentiality, and data ownership (Miles, Hberman, and Sdana 2014). For data analysis in actuarial science and insurance in particular, we face the following ethical matters and issues (Miles, Hberman, and Sdana 2014): Worthiness of the project Is the project worth doing? Will the project contribute in some significant way to a domain broader than my career? If a project is only opportunistic and does not have a larger significance, then it might be pursued with less care. The result may be looked good but not right. Competence Do I or the whole team have the expertise to carry out the project? Incompetence may lead to weakness in the analytics such as collecting large amounts of data poorly and drawing superficial conclusions. Benefits, costs, and reciprocity Will each stakeholder gain from the project? Are the benefit and the cost equitable? A project will likely to fail if the benefit and the cost for a stakeholder do not match. Privacy and confidentiality How do we make sure that the information is kept confidentially? Where raw data and analysis results are stored and how will have access to them should be documented in explicit confidentiality agreements. Show Quiz Solution 12.3 Data Analysis Techniques Techniques for data analysis are drawn from different but overlapping fields such as statistics, machine learning, pattern recognition, and data mining. Statistics is a field that addresses reliable ways of gathering data and making inferences based on them (Bandyopadhyay and Forster 2011; Bluman 2012). The term machine learning was coined by Samuel in 1959 (Samuel 1959). Originally, machine learning refers to the field of study where computers have the ability to learn without being explicitly programmed. Nowadays, machine learning has evolved to the broad field of study where computational methods use experience (i.e., the past information available for analysis) to improve performance or to make accurate predictions (Bishop 2007; Clarke, Fokoue, and Zhang 2009; Mohri, Rostamizadeh, and Talwalkar 2012; Kubat 2017). There are four types of machine learning algorithms (See Table 13.3 depending on the type of the data and the type of the learning tasks. \\[ \\begin{matrix} \\begin{array}{rll} \\hline &amp; \\textbf{Supervised} &amp; \\textbf{Unsupervised} \\\\\\hline \\textbf{Discrete Label} &amp; \\text{Classification} &amp; \\text{Clustering} \\\\ \\textbf{Continuous Label} &amp; \\text{Regression} &amp; \\text{Dimension reduction} \\\\ \\hline \\end{array} \\end{matrix} \\] Table 13.3: Types of machine learning algorithms. Originating in engineering, pattern recognition is a field that is closely related to machine learning, which grew out of computer science. In fact, pattern recognition and machine learning can be considered to be two facets of the same field (Bishop 2007). Data mining is a field that concerns collecting, cleaning, processing, analyzing, and gaining useful insights from data (Aggarwal 2015). 12.3.1 Exploratory Techniques Exploratory data analysis techniques include descriptive statistics as well as many unsupervised learning techniques such as data clustering and principal component analysis. 12.3.1.1 Descriptive Statistics In the mass noun sense, descriptive statistics is an area of statistics that concerns the collection, organization, summarization, and presentation of data (Bluman 2012). In the count noun sense, descriptive statistics are summary statistics that quantitatively describe or summarize data. \\[ \\begin{matrix} \\begin{array}{ll} \\hline &amp; \\textbf{Descriptive Statistics} \\\\\\hline \\text{Measures of central tendency} &amp; \\text{Mean, median, mode, midrange}\\\\ \\text{Measures of variation} &amp; \\text{Range, variance, standard deviation} \\\\ \\text{Measures of position} &amp; \\text{Quantile} \\\\ \\hline \\end{array} \\end{matrix} \\] Table 13.4: Some commonly used descriptive statistics. Table 13.4 lists some commonly used descriptive statistics. In R, we can use the function \\(\\texttt{summary}\\) to calculate some of the descriptive statistics. For numeric data, we can visualize the descriptive statistics using a boxplot. In addition to these quantitative descriptive statistics, we can also qualitatively describe shapes of the distributions (Bluman 2012). For example, we can say that a distribution is positively skewed, symmetric, or negatively skewed. To visualize the distribution of a variable, we can draw a histogram. 12.3.1.2 Principal Component Analysis Principal component analysis (PCA) is a statistical procedure that transforms a dataset described by possibly correlated variables into a dataset described by linearly uncorrelated variables, which are called principal components and are ordered according to their variances. PCA is a technique for dimension reduction. If the original variables are highly correlated, then the first few principal components can account for most of the variation of the original data. The principal components of the variables are related to the eigenvectors and eigenvectors of the covariance matrix of the variables. For \\(i=1,2,\\ldots,d\\), let \\((\\lambda_i, \\textbf{e}_i)\\) be the \\(i\\)th eigenvalue-eigenvector pair of the covariance matrix \\({\\Sigma}\\) of \\(d\\) variables \\(X_1,X_2,\\ldots,X_d\\) such that \\(\\lambda_1\\ge \\lambda_2\\ge \\ldots\\ge \\lambda_d\\ge 0\\) and the eigenvectors are normalized. Then the \\(i\\)th principal component is given by \\[ Z_{i} = \\textbf{e}_i&#39; \\textbf{X} =\\sum_{j=1}^d e_{ij} X_j, \\] where \\(\\textbf{X}=(X_1,X_2,\\ldots,X_d)&#39;\\). It can be shown that \\(\\mathrm{Var~}{(Z_i)} = \\lambda_i\\). As a result, the proportion of variance explained by the \\(i\\)th principal component is calculated as \\[ \\dfrac{\\mathrm{Var~}{(Z_i)}}{ \\sum_{j=1}^{d} \\mathrm{Var~}{(Z_j)}} = \\dfrac{\\lambda_i}{\\lambda_1+\\lambda_2+\\cdots+\\lambda_d}. \\] For more information about PCA, readers are referred to Mirkin (2011). 12.3.1.3 Cluster Analysis Cluster analysis (aka data clustering) refers to the process of dividing a dataset into homogeneous groups or clusters such that points in the same cluster are similar and points from different clusters are quite distinct (Gan, Ma, and Wu 2007; Gan 2011). Data clustering is one of the most popular tools for exploratory data analysis and has found applications in many scientific areas. During the past several decades, many clustering algorithms have been proposed. Among these clustering algorithms, the \\(k\\)-means algorithm is perhaps the most well-known algorithm due to its simplicity. To describe the k-means algorithm, let \\(X=\\{\\textbf{x}_1,\\textbf{x}_2,\\ldots,\\textbf{x}_n\\}\\) be a dataset containing \\(n\\) points, each of which is described by \\(d\\) numerical features. Given a desired number of clusters \\(k\\), the \\(k\\)-means algorithm aims at minimizing the following objective function: \\[ P(U,Z) = \\sum_{l=1}^k\\sum_{i=1}^n u_{il} \\Vert \\textbf{x}_i-\\textbf{z}_l\\Vert^2, \\] where \\(U=(u_{il})_{n\\times k}\\) is an \\(n\\times k\\) partition matrix, \\(Z=\\{\\textbf{z}_1,\\textbf{z}_2,\\ldots,\\textbf{z}_k\\}\\) is a set of cluster centers, and \\(\\Vert\\cdot\\Vert\\) is the \\(L^2\\) norm or Euclidean distance. The partition matrix \\(U\\) satisfies the following conditions: \\[ u_{il}\\in \\{0,1\\},\\quad i=1,2,\\ldots,n,\\:l=1,2,\\ldots,k, \\] \\[ \\sum_{l=1}^k u_{il}=1,\\quad i=1,2,\\ldots,n. \\] The \\(k\\)-means algorithm employs an iterative procedure to minimize the objective function. It repeatedly updates the partition matrix \\(U\\) and the cluster centers \\(Z\\) alternately until some stop criterion is met. For more information about \\(k\\)-means, readers are referred to Gan, Ma, and Wu (2007) and Mirkin (2011). 12.3.2 Confirmatory Techniques Confirmatory data analysis techniques include the traditional statistical tools of inference, significance, and confidence. 12.3.2.1 Linear Models Linear models, also called linear regression models, aim at using a linear function to approximate the relationship between the dependent variable and independent variables. A linear regression model is called a simple linear regression model if there is only one independent variable. When more than one independent variables are involved, a linear regression model is called a multiple linear regression model. Let \\(X\\) and \\(Y\\) denote the independent and the dependent variables, respectively. For \\(i=1,2,\\ldots,n\\), let \\((x_i, y_i)\\) be the observed values of \\((X,Y)\\) in the \\(i\\)th case. Then the simple linear regression model is specified as follows (Edward W. Frees 2009b): \\[ y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i,\\quad i=1,2,\\ldots,n, \\] where \\(\\beta_0\\) and \\(\\beta_1\\) are parameters and \\(\\epsilon_i\\) is a random variable representing the error for the \\(i\\)th case. When there are multiple independent variables, the following multiple linear regression model is used: \\[ y_i = \\beta_0 + \\beta_1 x_{i1} + \\cdots + \\beta_k x_{ik} + \\epsilon_i, \\] where \\(\\beta_0\\), \\(\\beta_1\\), \\(\\ldots\\), \\(\\beta_k\\) are unknown parameters to be estimated. Linear regression models usually make the following assumptions: \\(x_{i1},x_{i2},\\ldots,x_{ik}\\) are nonstochastic variables. \\(\\mathrm{Var~}(y_i)=\\sigma^2\\), where \\(\\mathrm{Var~}(y_i)\\) denotes the variance of \\(y_i\\). \\(y_1,y_2,\\ldots,y_n\\) are independent random variables. For the purpose of obtaining tests and confidence statements with small samples, the following strong normality assumption is also made: \\(\\epsilon_1,\\epsilon_2,\\ldots,\\epsilon_n\\) are normally distributed. 12.3.2.2 Generalized Linear Models The generalized linear model (GLM) is a wide family of regression models that include linear regression models as special cases. In a GLM, the mean of the response (i.e., the dependent variable) is assumed to be a function of linear combinations of the explanatory variables, i.e., \\[ \\mu_i = E[y_i], \\] \\[ \\eta_i = \\textbf{x}_i&#39;\\boldsymbol{\\beta} = g(\\mu_i), \\] where \\(\\textbf{x}_i=(1,x_{i1}, x_{i2}, \\ldots, x_{ik})&#39;\\) is a vector of regressor values, \\(\\mu_i\\) is the mean response for the \\(i\\)th case, and \\(\\eta_i\\) is a systematic component of the GLM. The function \\(g(\\cdot)\\) is known and is called the link function. The mean response can vary by observations by allowing some parameters to change. However, the regression parameters \\(\\boldsymbol{\\beta}\\) are assumed to be the same among different observations. GLMs make the following assumptions: \\(x_{i1},x_{i2},\\ldots,x_{in}\\) are nonstochastic variables. \\(y_1,y_2,\\ldots,y_n\\) are independent. The dependent variable is assumed to follow a distribution from the linear exponential family. The variance of the dependent variable is not assumed to be constant but is a function of the mean, i.e., \\[ \\mathrm{Var~}{(y_i)} = \\phi \\nu(\\mu_i), \\] where \\(\\phi\\) denotes the dispersion parameter and \\(\\nu(\\cdot)\\) is a function. As we can see from the above specification, the GLM provides a unifying framework to handle different types of dependent variables, including discrete and continuous variables. For more information about GLMs, readers are referred to Jong and Heller (2008) and Edward W. Frees (2009b). 12.3.2.3 Tree-based Models Decision trees, also known as tree-based models, involve dividing the predictor space (i.e., the space formed by independent variables) into a number of simple regions and using the mean or the mode of the region for prediction (Breiman et al. 1984). There are two types of tree-based models: classification trees and regression trees. When the dependent variable is categorical, the resulting tree models are called classification trees. When the dependent variable is continuous, the resulting tree models are called regression trees. The process of building classification trees is similar to that of building regression trees. Here we only briefly describe how to build a regression tree. To do that, the predictor space is divided into non-overlapping regions such that the following objective function \\[ f(R_1,R_2,\\ldots,R_J) = \\sum_{j=1}^J \\sum_{i=1}^n I_{R_j}(\\textbf{x}_i)(y_i - \\mu_j)^2 \\] is minimized, where \\(I\\) is an indicator function, \\(R_j\\) denotes the set of indices of the observations that belong to the \\(j\\)th box, \\(\\mu_j\\) is the mean response of the observations in the \\(j\\)th box, \\(\\textbf{x}_i\\) is the vector of predictor values for the \\(i\\)th observation, and \\(y_i\\) is the response value for the \\(i\\)th observation. In terms of predictive accuracy, decision trees generally do not perform to the level of other regression and classification models. However, tree-based models may outperform linear models when the relationship between the response and the predictors is nonlinear. For more information about decision trees, readers are referred to Breiman et al. (1984) and Mitchell (1997). Show Quiz Solution 12.4 Some R Functions R is an open-source software for statistical computing and graphics. The R software can be downloaded from the R project website at . In this section, we give some R function for data analysis, especially the data analysis tasks mentioned in previous sections. \\[ \\begin{matrix} \\begin{array}{lll} \\hline \\text{Data Analysis Task} &amp; \\text{R package} &amp; \\text{R Function} \\\\\\hline \\text{Descriptive Statistics} &amp; \\texttt{base} &amp; \\texttt{summary}\\\\ \\text{Principal Component Analysis} &amp; \\texttt{stats} &amp; \\texttt{prcomp} \\\\ \\text{Data Clustering} &amp; \\texttt{stats} &amp; \\texttt{kmeans}, \\texttt{hclust} \\\\ \\text{Fitting Distributions} &amp; \\texttt{MASS} &amp; \\texttt{fitdistr} \\\\ \\text{Linear Regression Models} &amp; \\texttt{stats} &amp; \\texttt{lm} \\\\ \\text{Generalized Linear Models} &amp; \\texttt{stats} &amp; \\texttt{glm} \\\\ \\text{Regression Trees} &amp; \\texttt{rpart} &amp; \\texttt{rpart} \\\\ \\text{Survival Analysis} &amp; \\texttt{survival} &amp; \\texttt{survfit} \\\\ \\hline \\end{array} \\end{matrix} \\] Table 13.5: Some R functions for data analysis. Table 13.5 lists a few R functions for different data analysis tasks. Readers can read the R documentation for examples of using these functions. There are also other R functions from other packages to do similar things. However, the functions listed in this table provide good start points for readers to conduct data analysis in R. For analyzing large datasets in R in an efficient way, readers are referred to Daroczi (2015). 12.5 Summary In this chapter, we gave a high-level overview of data analysis by introducing data types, data structures, data storages, data sources, data analysis processes, and data analysis techniques. In particular, we presented various aspects of data analysis. In addition, we provided several websites where readers can obtain real-world datasets to horn their data analysis skills. We also listed some R packages and functions that can be used to perform various data analysis tasks. 12.6 Further Resources and Contributors Contributor Guojun Gan, University of Connecticut, is the principal author of the initial version of this chapter. Email: guojun.gan@uconn.edu for chapter comments and suggested improvements. Chapter reviewers include: Min Ji, Toby White. Bibliography "],
["C-DependenceModel.html", "Chapter 13 Dependence Modeling 13.1 Variable Types 13.2 Classic Measures of Scalar Associations 13.3 Introduction to Copulas 13.4 Application Using Copulas 13.5 Types of Copulas 13.6 Why is Dependence Modeling Important? 13.7 Further Resources and Contributors", " Chapter 13 Dependence Modeling Chapter Preview. In practice, there are many types of variables that one encounter and the first step in dependence modeling is identifying the type of variable you are dealing with to help direct you to the appropriate technique. This chapter introduces readers to variable types and techniques for modeling dependence or association of multivariate distributions. Section 13.1 provides an overview of the types of variables. Section 13.2 then elaborates basic measures for modeling the dependence between variables. Section 13.3 introduces a novel approach to modeling dependence using Copulas which is reinforced with practical illustrations in Section 13.4. The types of Copula families and basic properties of Copula functions is explained Section 13.5. The chapter concludes by explaining why the study of dependence modeling is important in Section 13.6. 13.1 Variable Types In this section, you learn how to: Classify variables as qualitative or quantitative. Describe multivariate variables. People, firms, and other entities that we want to understand are described in a dataset by numerical characteristics. As these characteristics vary by entity, they are commonly known as variables. To manage insurance systems, it will be critical to understand the distribution of each variable and how they are associated with one another. It is common for data sets to have many variables (high dimensional) and so it useful to begin by classifying them into different types. As will be seen, these classifications are not strict; there is overlap among the groups. Nonetheless, the grouping summarized in Table 14.1 and explained in the remainder of this section provides a solid first step in framing a data set. \\[ {\\small \\begin{matrix} \\begin{array}{l|l} \\hline \\textbf{Variable Type} &amp; \\textbf{Example} \\\\\\hline Qualitative &amp; \\\\ \\text{Binary} &amp; \\text{Sex} \\\\ \\text{Categorical (Unordered, Nominal)} &amp; \\text{Territory (e.g., state/province) in which an insured resides} \\\\ \\text{Ordered Category (Ordinal)} &amp; \\text{Claimant satisfaction (five point scale ranging from 1=dissatisfied} \\\\ &amp; ~~~ \\text{to 5 =satisfied)} \\\\\\hline Quantitative &amp; \\\\ \\text{Continuous} &amp; \\text{Policyholder&#39;s age, weight, income} \\\\ \\text{Discrete} &amp; \\text{Amount of deductible (0, 250, 500, and 1000)} \\\\ \\text{Count} &amp; \\text{Number of insurance claims} \\\\ \\text{Combinations of} &amp; \\text{Policy losses, mixture of 0&#39;s (for no loss)} \\\\ ~~~ \\text{Discrete and Continuous} &amp; ~~~\\text{and positive claim amount} \\\\ \\text{Interval Variable} &amp; \\text{Driver Age: 16-24 (young), 25-54 (intermediate),} \\\\ &amp; ~~~\\text{55 and over (senior)} \\\\ \\text{Circular Data} &amp; \\text{Time of day measures of customer arrival} \\\\ \\hline Multivariate ~ Variable &amp; \\\\ \\text{High Dimensional Data} &amp; \\text{Characteristics of a firm purchasing worker&#39;s compensation} \\\\ &amp; ~~~\\text{insurance (location of plants, industry, number of employees,} \\\\ &amp;~~~\\text{and so on)} \\\\ \\text{Spatial Data} &amp; \\text{Longitude/latitude of the location an insurance hailstorm claim} \\\\ \\text{Missing Data} &amp; \\text{Policyholder&#39;s age (continuous/interval) and &quot;-99&quot; for} \\\\ &amp;~~~ \\text{&quot;not reported,&quot; that is, missing} \\\\ \\text{Censored and Truncated Data} &amp; \\text{Amount of insurance claims in excess of a deductible} \\\\ \\text{Aggregate Claims} &amp; \\text{Losses recorded for each claim in a motor vehicle policy.} \\\\ \\text{Stochastic Process Realizations} &amp; \\text{The time and amount of each occurrence of an insured loss} \\\\ \\hline \\end{array} \\end{matrix}} \\] Table 14.1 : Variable types In data analysis, it is important to understand what type of variable you are working with. For example, Consider a pair of random variables (Coverage,Claim) from the LGPIF data introduced in chapter 1 as displayed in Figure 13.1 below. We would like to know whether the distribution of Coverage depends on the distribution of Claim or whether they are statistically independent. We would also want to know how the Claim distribution depends on the EntityType variable. Because the EntityType variable belongs to a different class of variables, modeling the dependence between Claim and Coverage may require a different technique from that of Claim and EntityType. Figure 13.1: Scatter plot of (Coverage,Claim) from LGPIF data 13.1.1 Qualitative Variables In this sub-section, you learn how to: Classify qualitative variables as nominal or ordinal Describe binary variable A qualitative, or categorical variable is one for which the measurement denotes membership in a set of groups, or categories. For example, if you were coding which area of the country an insured resides, you might use a 1 for the northern part, 2 for southern, and 3 for everything else. This location variable is an example of a nominal variable, one for which the levels have no natural ordering. Any analysis of nominal variables should not depend on the labeling of the categories. For example, instead of using a 1,2,3 for north, south, other, I should arrive at the same set of summary statistics if I used a 2,1,3 coding instead, interchanging north and south. In contrast, an ordinal variable is a type of categorical variable for which an ordering does exist. For example, with a survey to see how satisfied customers are with our claims servicing department, we might use a five point scale that ranges from 1 meaning dissatisfied to a 5 meaning satisfied. Ordinal variables provide a clear ordering of levels of a variable but the amount of separation between levels is unknown. A binary variable is a special type of categorical variable where there are only two categories commonly taken to be a 0 and a 1. For example, we might code a variable in a dataset to be a 1 if an insured is female and a 0 if male. 13.1.2 Quantitative Variables In this sub-section, you learn how to: Differentiate between continuous and discrete variable Use a combination of continuous and discrete variable Describe circular data Unlike a qualitative variable, a quantitative variable is one in which numerical level is a realization from some scale so that the distance between any two levels of the scale takes on meaning. A continuous variable is one that can take on any value within a finite interval. For example, it is common to represent a policyholder’s age, weight, or income, as a continuous variable. In contrast, a discrete variable is one that takes on only a finite number of values in any finite interval. For example, when examining a policyholder’s choice of deductibles, it may be that values of 0, 250, 500, and 1000 are the only possible outcomes. Like an ordinal variable, these represent distinct categories that are ordered. Unlike an ordinal variable, the numerical difference between levels takes on economic meaning. A special type of discrete variable is a count variable, one with values on the nonnegative integers. For example, we will be particularly interested in the number of claims arising from a policy during a given period. Some variables are inherently a combination of discrete and continuous components. For example, when we analyze the insured loss of a policyholder, we will encounter a discrete outcome at zero, representing no insured loss, and a continuous amount for positive outcomes, representing the amount of the insured loss. Another interesting variation is an interval variable,one that gives a range of possible outcomes. Circular data represent an interesting category typically not analyzed by insurers. As an example of circular data, suppose that you monitor calls to your customer service center and would like to know when is the peak time of the day for calls to arrive. In this context, one can think about the time of the day as a variable with realizations on a circle, e.g., imagine an analog picture of a clock. For circular data, the distance between observations at 00:15 and 00:45 are just as close as observations 23:45 and 00:15 (here, we use the convention HH:MM means hours and minutes). 13.1.3 Multivariate Variables In this sub-section, you learn how to: Differentiate between univariate and multivariate data Handle missing variables Insurance data typically are multivariate in the sense that we can take many measurements on a single entity. For example, when studying losses associated with a firm’s worker’s compensation plan, we might want to know the location of its manufacturing plants, the industry in which it operates, the number of employees, and so forth. The usual strategy for analyzing multivariate data is to begin by examining each variable in isolation of the others. This is known as a univariate approach. In contrast, for some variables, it makes little sense to only look at one dimensional aspects. For example, insurers typically organize spatial data by longitude and latitude to analyze the location of weather related insurance claims due hailstorms. Having only a single number, either longitude or latitude, provides little information in understanding geographical location. Another special case of a multivariate variable, less obvious, involves coding for missing data. Historically, some statistical packages used a -99 to report when a variable, such as policyholder’s age, was not available or not reported. This led to many unsuspecting analysts providing strange statistics when summarizing a set of data. When data are missing, it is better to think about the variable as two dimensions, one to indicate whether or not the variable is reported and the second providing the age (if reported). In the same way, insurance data are commonly censored and truncated. We refer you to Chapter 4 for more on censored and truncated data. Aggregate claims can also be coded as another special type of multivariate variable. We refer you to Chapter 5 for more Aggregate claims. Perhaps the most complicated type of multivariate variable is a realization of a stochastic process. You will recall that a stochastic process is little more than a collection of random variables. For example, in insurance, we might think about the times that claims arrive to an insurance company in a one year time horizon. This is a high dimensional variable that theoretically is infinite dimensional. Special techniques are required to understand realizations of stochastic processes that will not be addressed here. Show Quiz Solution 13.2 Classic Measures of Scalar Associations In this section, you learn how to: Estimate correlation using Pearson method Use rank based measures like Spearman, Kendall to estimate correlation Measure dependence using odds ratio, Pearson chi-square and likelihood ratio test statistic Use normal-based correlations to quantify associations involving ordinal variables 13.2.1 Association Measures for Quantitative Variables For this section, consider a pair of random variables \\((X,Y)\\) having joint distribution function \\(F(\\cdot)\\) and a random sample \\((X_i,Y_i), i=1, \\ldots, n\\). For the continuous case, suppose that \\(F(\\cdot)\\) is absolutely continuous with absolutely continuous marginals. 13.2.1.1 Pearson Correlation Define the sample covariance function \\(\\widehat{Cov}(X,Y) = \\frac{1}{n} \\sum_{i=1}^n (X_i - \\bar{X})(Y_i - \\bar{Y})\\), where \\(\\bar{X}\\) and \\(\\bar{Y}\\) are the sample means of \\(X\\) and \\(Y\\), respectively. Then, the product-moment (Pearson) correlation can be written as \\[\\begin{equation*} r = \\frac{\\widehat{Cov}(X,Y)}{\\sqrt{\\widehat{Cov}(X,X)\\widehat{Cov}(Y,Y)}}. \\end{equation*}\\] The correlation statistic \\(r\\) is widely used to capture linear association between random variables. It is a (nonparametric) estimator of the correlation parameter \\(\\rho\\), defined to be the covariance divided by the product of standard deviations. In this sense, it captures association for any pair of random variables. This statistic has several important features. Unlike regression estimators, it is symmetric between random variables, so the correlation between \\(X\\) and \\(Y\\) equals the correlation between \\(Y\\) and \\(X\\). It is unchanged by linear transformations of random variables (up to sign changes) so that we can multiply random variables or add constants as is helpful for interpretation. The range of the statistic is \\([-1,1]\\) which does not depend on the distribution of either \\(X\\) or \\(Y\\). Further, in the case of independence, the correlation coefficient \\(r\\) is 0. However, it is well known that zero correlation does not imply independence, except for normally distributed random variables. The correlation statistic \\(r\\) is also a (maximum likelihood) estimator of the association parameter for bivariate normal distribution. So, for normally distributed data, the correlation statistic \\(r\\) can be used to assess independence. For additional interpretations of this well-known statistic, readers will enjoy (Lee Rodgers and Nicewander 1998). You can obtain the Pearson correlation statistic \\(r\\) using the cor() function in R and selecting the pearson method. This is demonstrated below by using the Coverage rating variable in millions of dollars and Claim amount variable in dollars from the LGPIF data introduced in chapter 1. R Code for Pearson Correlation Statistic ### Pearson correlation between Claim and Coverage r&lt;-cor(Claim,Coverage, method = c(&quot;pearson&quot;)) round(r,2) Output: [1] 0.31 ### Pearson correlation between Claim and log(Coverage) r&lt;-cor(Claim,log(Coverage), method = c(&quot;pearson&quot;)) round(r,2) Output: [1] 0.1 From R output above, \\(r=0.31\\) , which indicates a positive association between Claim and Coverage. This means that as the coverage amount of a policy increases we expect claim to increase. 13.2.2 Rank Based Measures 13.2.2.1 Spearman’s Rho The Pearson correlation coefficient does have the drawback that it is not invariant to nonlinear transforms of the data. For example, the correlation between \\(X\\) and \\(\\ln Y\\) can be quite different from the correlation between \\(X\\) and \\(Y\\). As we see from the R code for Pearson correlation statistic above, the correlation statistic \\(r\\) between Coverage rating variable in logarithmic millions of dollars and Claim amounts variable in dollars is \\(0.1\\) as compared to \\(0.31\\) when we calculate the correlation between Coverage rating variable in millions of dollars and Claim amounts variable in dollars. This limitation is one reason for considering alternative statistics. Alternative measures of correlation are based on ranks of the data. Let \\(R(X_j)\\) denote the rank of \\(X_j\\) from the sample \\(X_1, \\ldots, X_n\\) and similarly for \\(R(Y_j)\\). Let \\(R(X) = \\left(R(X_1), \\ldots, R(X_n)\\right)&#39;\\) denote the vector of ranks, and similarly for \\(R(Y)\\). For example, if \\(n=3\\) and \\(X=(24, 13, 109)\\), then \\(R(X)=(2,1,3)\\). A comprehensive introduction of rank statistics can be found in, for example, (Hettmansperger 1984). Also, ranks can be used to obtain the empirical distribution function, refer to section 4.1.1 for more on the empirical distribution function. With this, the correlation measure of (Spearman 1904) is simply the product-moment correlation computed on the ranks: \\[\\begin{equation*} r_S = \\frac{\\widehat{Cov}(R(X),R(Y))}{\\sqrt{\\widehat{Cov}(R(X),R(X))\\widehat{Cov}(R(Y),R(Y))}} = \\frac{\\widehat{Cov}(R(X),R(Y))}{(n^2-1)/12} . \\end{equation*}\\] You can obtain the Spearman correlation statistic \\(r_S\\) using the cor() function in R and selecting the spearman method. From below, the Spearman correlation between the Coverage rating variable in millions of dollars and Claim amount variable in dollars is \\(0.41\\). R Code for Spearman Correlation Statistic ### Spearman correlation between Claim and Coverage ### rs&lt;-cor(Claim,Coverage, method = c(&quot;spearman&quot;)) round(rs,2) Output: [1] 0.41 ### Spearman correlation between Claim and log(Coverage) ### rs&lt;-cor(Claim,log(Coverage), method = c(&quot;spearman&quot;)) round(rs,2) Output: [1] 0.41 We can show that the Spearman correlation statistic is invariant under strictly increasing transformations. From the R Code for Spearman correlation statistic above, \\(r_S=0.41\\) between the Coverage rating variable in logarithmic millions of dollars and Claim amount variable in dollars. 13.2.2.2 Kendall’s Tau An alternative measure that uses ranks is based on the concept of concordance. An observation pair \\((X,Y)\\) is said to be concordant (discordant) if the observation with a larger value of \\(X\\) has also the larger (smaller) value of \\(Y\\). Then \\(\\Pr(concordance) = \\Pr[ (X_1-X_2)(Y_1-Y_2) &gt;0 ]\\) , \\(\\Pr(discordance) = \\Pr[ (X_1-X_2)(Y_1-Y_2) &lt;0 ]\\), \\(\\Pr(tie) = \\Pr[ (X_1-X_2)(Y_1-Y_2) =0 ]\\) and \\[\\begin{eqnarray*} \\tau(X,Y)= \\Pr(concordance) - \\Pr(discordance) = 2\\Pr(concordance) - 1 + \\Pr(tie). \\end{eqnarray*}\\] To estimate this, the pairs \\((X_i,Y_i)\\) and \\((X_j,Y_j)\\) are said to be concordant if the product \\(sgn(X_j-X_i)sgn(Y_j-Y_i)\\) equals 1 and discordant if the product equals -1. Here, \\(sgn(x)=1,0,-1\\) as \\(x&gt;0\\), \\(x=0\\), \\(x&lt;0\\), respectively. With this, we can express the association measure of (Kendall 1938), known as Kendall’s tau, as \\[\\begin{equation*} \\begin{array}{rl} \\tau &amp;= \\frac{2}{n(n-1)} \\sum_{i&lt;j}sgn(X_j-X_i)sgn(Y_j-Y_i)\\\\ &amp;= \\frac{2}{n(n-1)} \\sum_{i&lt;j}sgn(R(X_j)-R(X_i))sgn(R(Y_j)-R(Y_i)) \\end{array}. \\end{equation*}\\] Interestingly, (Hougaard 2000), page 137, attributes the original discovery of this statistic to (Fechner 1897), noting that Kendall’s discovery was independent and more complete than the original work. You can obtain the Kendall’s tau, using the cor() function in R and selecting the kendall method. From below, \\(\\tau=0.32\\) between the Coverage rating variable in millions of dollars and Claim amount variable in dollars. When there are ties in the data, the cor() function computes Kendall’s tau_b, as proposed by (Kendall 1945). R Code for Kendall’s Tau ### Kendall&#39;s tau correlation between Claim and Coverage ### tau&lt;-cor(Claim,Coverage, method = c(&quot;kendall&quot;)) round(tau,2) Output: [1] 0.32 ### Kendall&#39;s tau correlation between Claim and log(Coverage) ### tau&lt;-cor(Claim,log(Coverage), method = c(&quot;kendall&quot;)) round(tau,2) Output: [1] 0.32 Also,to show that the Kendall’s tau is invariate under strictly increasing transformations , \\(\\tau=0.32\\) between the Coverage rating variable in logarithmic millions of dollars and Claim amount variable in dollars. 13.2.3 Nominal Variables 13.2.3.1 Bernoulli Variables To see why dependence measures for continuous variables may not be the best for discrete variables, let us focus on the case of Bernoulli variables that take on simple binary outcomes, 0 and 1. For notation, let \\(\\pi_{jk} = \\Pr(X=j, Y=k)\\) for \\(j,k=0,1\\) and let \\(\\pi_X=\\Pr(X=1)\\) and similarly for \\(\\pi_Y\\). Then, the population version of the product-moment (Pearson) correlation can be easily seen to be \\[\\begin{eqnarray*} \\rho = \\frac{\\pi_{11} - \\pi_X \\pi_Y}{\\sqrt{\\pi_X(1-\\pi_X)\\pi_Y(1-\\pi_Y)}} . \\end{eqnarray*}\\] Unlike the case for continuous data, it is not possible for this measure to achieve the limiting boundaries of the interval \\([-1,1]\\). To see this, students of probability may recall the Fr\\(\\acute{e}\\)chet-H\\(\\ddot{o}\\)effding bounds for a joint distribution that turn out to be \\(\\max\\{0, \\pi_X+\\pi_Y-1\\} \\le \\pi_{11} \\le \\min\\{\\pi_X,\\pi_Y\\}\\) for this joint probability. This limit on the joint probability imposes an additional restriction on the Pearson correlation. As an illustration, assume equal probabilities \\(\\pi_X =\\pi_Y = \\pi &gt; 1/2\\). Then, the lower bound is \\[\\begin{eqnarray*} \\frac{2\\pi - 1 - \\pi^2}{\\pi(1-\\pi)} = -\\frac{1-\\pi}{\\pi} . \\end{eqnarray*}\\] For example, if \\(\\pi=0.8\\), then the smallest that the Pearson correlation could be is -0.25. More generally, there are bounds on \\(\\rho\\) that depend on \\(\\pi_X\\) and \\(\\pi_Y\\) that make it difficult to interpret this measure. As noted by (Bishop, Fienberg, and Holland 1975) (page 382), squaring this correlation coefficient yields the Pearson chi-square statistic (introduced in chapter 2) . Despite the boundary problems described above, this feature makes the Pearson correlation coefficient a good choice for describing dependence with binary data. The other is the odds ratio, described as follows. As an alternative measure for Bernoulli variables, the odds ratio is given by \\[\\begin{eqnarray*} OR(\\pi_{11}) = \\frac{\\pi_{11} \\pi_{00}}{\\pi_{01} \\pi_{10}} = \\frac{\\pi_{11} \\left( 1+\\pi_{11}-\\pi_X -\\pi_Y\\right)}{(\\pi_X-\\pi_{11})(\\pi_Y- \\pi_{11})} . \\end{eqnarray*}\\] Pleasant calculations show that \\(OR(z)\\) is \\(0\\) at the lower Fr\\(\\acute{e}\\)chet-H\\(\\ddot{o}\\)effding bound \\(z= \\max\\{0, \\pi_X+\\pi_Y-1\\}\\) and is \\(\\infty\\) at the upper bound \\(z=\\min\\{\\pi_X,\\pi_Y\\}\\). Thus, the bounds on this measure do not depend on the marginal probabilities \\(\\pi_X\\) and \\(\\pi_Y\\), making it easier to interpret this measure. As noted by (Yule 1900), odds ratios are invariant to the labeling of 0 and 1. Further, they are invariant to the marginals in the sense that one can rescale \\(\\pi_X\\) and \\(\\pi_Y\\) by positive constants and the odds ratio remains unchanged. Specifically, suppose that \\(a_i\\), \\(b_j\\) are sets of positive constants and that \\[\\begin{eqnarray*} \\pi_{ij}^{new} &amp;=&amp; a_i b_j \\pi_{ij} \\end{eqnarray*}\\] and \\(\\sum_{ij} \\pi_{ij}^{new}=1.\\) Then, \\[\\begin{eqnarray*} OR^{new} = \\frac{(a_1 b_1 \\pi_{11})( a_0 b_0 \\pi_{00})}{(a_0 b_1 \\pi_{01})( a_1 b_0\\pi_{10})} = \\frac{\\pi_{11} \\pi_{00}}{\\pi_{01} \\pi_{10}} =OR^{old} . \\end{eqnarray*}\\] For additional help with interpretation, Yule proposed two transforms for the odds ratio, the first in (Yule 1900), \\[\\begin{eqnarray*} \\frac{OR-1}{OR+1}, \\end{eqnarray*}\\] and the second in (Yule 1912), \\[\\begin{eqnarray*} \\frac{\\sqrt{OR}-1}{\\sqrt{OR}+1}. \\end{eqnarray*}\\] Although these statistics provide the same information as is the original odds ration \\(OR\\), they have the advantage of taking values in the interval \\([-1,1]\\), making them easier to interpret. In a later section, we will also see that the marginal distributions have no effect on the Fr\\(\\acute{e}\\)chet-H\\(\\ddot{o}\\)effding of the tetrachoric correlation, another measure of association, see also, (Joe 2014), page 48. \\[ {\\small \\begin{matrix} \\begin{array}{l|rr|r} \\hline &amp; \\text{Fire5} &amp; &amp; \\\\ \\text{NoClaimCredit} &amp; 0 &amp; 1 &amp; \\text{Total} \\\\ \\hline 0 &amp; 1611 &amp; 2175 &amp; 3786 \\\\ 1 &amp; 897 &amp; 956 &amp; 1853 \\\\ \\hline \\text{Total} &amp; 2508 &amp; 3131 &amp; 5639 \\\\ \\hline \\end{array} \\end{matrix}} \\] Table 14.2 : 2 \\(\\times\\) 2 table of counts for Fire5 and NoClaimCredit variables from LGPIF data. From Table 14.2, \\(OR(\\pi_{11})=\\frac{1611(956)}{897(2175)}=0.79\\). You can obtain the \\(OR(\\pi_{11})\\), using the oddsratio() function from the epitools library in R. From the output below, \\(OR(\\pi_{11})=0.79\\) for the binary variables NoClaimCredit and Fier5 from the LGPIF data. R Code for Odds Ratios library(epitools) oddsratio(NoClaimCredit, Fire5,method = c(&quot;wald&quot;))$measure Output: [1] 0.79 13.2.3.2 Categorical Variables More generally, let \\((X,Y)\\) be a bivariate pair having \\(ncat_X\\) and \\(ncat_Y\\) numbers of categories, respectively. For a two-way table of counts, let \\(n_{jk}\\) be the number in the \\(j\\)th row, \\(k\\) column. Let \\(n_{j\\centerdot}\\) be the row margin total, \\(n_{\\centerdot k}\\) be the column margin total and \\(n=\\sum_{j,k} n_{j,k}\\). Define Pearson chi-square statistic as \\[\\begin{eqnarray*} \\chi^2 = \\sum_{jk} \\frac{(n_{jk}- n_{j\\centerdot}n_{\\centerdot k}/n)^2}{n_{j\\centerdot}n_{\\centerdot k}/n} . \\end{eqnarray*}\\] The likelihood ratio test statistic is \\[\\begin{eqnarray*} G^2 = 2 \\sum_{jk} n_{jk} \\ln\\frac{n_{jk}}{n_{j\\centerdot}n_{\\centerdot k}/n} . \\end{eqnarray*}\\] Under the assumption of independence, both \\(\\chi^2\\) and \\(G^2\\) have an asymptotic chi-square distribution with \\((ncat_X-1)(ncat_Y-1)\\) degrees of freedom. To help see what these statistics are estimating, let \\(\\pi_{jk} = \\Pr(X=j, Y=k)\\) and let \\(\\pi_{X,j}=\\Pr(X=j)\\) and similarly for \\(\\pi_{Y,k}\\). Assuming that \\(n_{jk}/n \\approx \\pi_{jk}\\) for large \\(n\\) and similarly for the marginal probabilities, we have \\[\\begin{eqnarray*} \\frac{\\chi^2}{n} \\approx \\sum_{jk} \\frac{(\\pi_{jk}- \\pi_{X,j}\\pi_{Y,k})^2}{\\pi_{X,j}\\pi_{Y,k}} \\end{eqnarray*}\\] and \\[\\begin{eqnarray*} \\frac{G^2}{n} \\approx 2 \\sum_{jk} \\pi_{jk} \\ln\\frac{\\pi_{jk}}{\\pi_{X,j}\\pi_{Y,k}} . \\end{eqnarray*}\\] Under the null hypothesis of independence, we have \\(\\pi_{jk} =\\pi_{X,j}\\pi_{Y,k}\\) and it is clear from these approximations that we anticipate that these statistics will be small under this hypothesis. Classical approaches, as described in (Bishop, Fienberg, and Holland 1975) (page 374), distinguish between tests of independence and measures of associations. The former are designed to detect whether a relationship exists whereas the latter are meant to assess the type and extent of a relationship. We acknowledge these differing purposes but also less concerned with this distinction for actuarial applications. \\[ {\\small \\begin{matrix} \\begin{array}{l|rr} \\hline &amp; \\text{NoClaimCredit} &amp; \\\\ \\text{EntityType} &amp; 0 &amp; 1 \\\\ \\hline \\text{City} &amp; 644 &amp; 149 \\\\ \\text{County} &amp; 310 &amp; 18 \\\\ \\text{Misc} &amp; 336 &amp; 273 \\\\ \\text{School} &amp; 1103 &amp; 494 \\\\ \\text{Town} &amp; 492 &amp; 479 \\\\ \\text{Village} &amp; 901 &amp; 440 \\\\ \\hline \\end{array} \\end{matrix}} \\] Table 14.3 : Two-way table of counts for EntityType and NoClaimCredit variables from LGPIF data. You can obtain the Pearson chi-square statistic, using the chisq.test() function from the MASS library in R. Here, we test whether the EntityType variable is independent of NoClaimCredit variable using Table 14.3. R Code for Pearson Chi-square Statistic library(MASS) table = table(EntityType, NoClaimCredit) chisq.test(table) Output: ------------------------------------ Test statistic df P value ---------------- ---- -------------- 344.2 5 3.15e-72 * * * ------------------------------------ Table: Pearson&#39;s Chi-squared test As the p-value is less than the .05 significance level, we reject the null hypothesis that the EntityType is independent of NoClaimCredit. Furthermore, you can obtain the likelihood ratio test statistic , using the likelihood.test() function from the Deducer library in R. From below, we test whether the EntityType variable is independent of NoClaimCredit variable from the LGPIF data. Same conclusion is drawn as the Pearson chi-square test. R Code for Likelihood Ratio Test Statistic library(Deducer) likelihood.test(EntityType, NoClaimCredit) Output: ----------------------------------------- Test statistic X-squared df P value ---------------- -------------- --------- 378.7 5 0 * * * ----------------------------------------- Table: Log likelihood ratio (G-test) test of independence without correction 13.2.4 Ordinal Variables As the analyst moves from the continuous to the nominal scale, there are two main sources of loss of information (Bishop, Fienberg, and Holland 1975) (page 343). The first is breaking the precise continuous measurements into groups. The second is losing the ordering of the groups. So, it is sensible to describe what we can do with variables that in discrete groups but where the ordering is known. As described in Section 13.1.1, ordinal variables provide a clear ordering of levels of a variable but distances between levels are unknown. Associations have traditionally been quantified parametrically using normal-based correlations and nonparametrically using Spearman correlations with tied ranks. 13.2.4.1 Parametric Approach Using Normal Based Correlations Refer to page 60, Section 2.12.7 of (Joe 2014). Let \\((y_1,y_2)\\) be a bivariate pair with discrete values on \\(m_1, \\ldots, m_2\\). For a two-way table of ordinal counts, let \\(n_{st}\\) be the number in the \\(s\\)th row, \\(t\\) column. Let \\((n_{m_1\\centerdot}, \\ldots, n_{m_2\\centerdot})\\) be the row margin total, \\((n_{\\centerdot m_1}, \\ldots, n_{\\centerdot m_2})\\) be the column margin total and \\(n=\\sum_{s,t} n_{s,t}\\). Let \\(\\hat{\\xi}_{1s} = \\Phi^{-1}((n_{m_1}+\\cdots+n_{s\\centerdot})/n)\\) for \\(s=m_1, \\ldots, m_2\\) be a cutpoint and similarly for \\(\\hat{\\xi}_{2t}\\). The polychoric correlation, based on a two-step estimation procedure, is \\[\\begin{eqnarray*} \\begin{array}{cr} \\hat{\\rho_N} &amp;=\\text{argmax}_{\\rho} \\sum_{s=m_1}^{m_2} \\sum_{t=m_1}^{m_2} n_{st} \\log\\left\\{ \\Phi_2(\\hat{\\xi}_{1s}, \\hat{\\xi}_{2t};\\rho) -\\Phi_2(\\hat{\\xi}_{1,s-1}, \\hat{\\xi}_{2t};\\rho) \\right.\\\\ &amp; \\left. -\\Phi_2(\\hat{\\xi}_{1s}, \\hat{\\xi}_{2,t-1};\\rho) +\\Phi_2(\\hat{\\xi}_{1,s-1}, \\hat{\\xi}_{2,t-1};\\rho) \\right\\} \\end{array} \\end{eqnarray*}\\] It is called a tetrachoric correlation for binary variables. \\[ {\\small \\begin{matrix} \\begin{array}{l|rr} \\hline &amp; \\text{NoClaimCredit} &amp; \\\\ \\text{AlarmCredit} &amp; 0 &amp; 1 \\\\ \\hline 1 &amp; 1669 &amp; 942 \\\\ 2 &amp; 121 &amp; 118 \\\\ 3 &amp; 195 &amp; 132 \\\\ 4 &amp; 1801 &amp; 661 \\\\ \\hline \\end{array} \\end{matrix}} \\] Table 14.4 : Two-way table of counts for AlarmCredit and NoClaimCredit variables from LGPIF data. You can obtain the polychoric or tetrachoric correlation using the polychoric() or tetrachoric() function from the psych library in R. The polychoric correlation is illustrated using Table 14.4. \\(\\hat{\\rho}_N=-0.14\\), which means that there is a negative relationship between AlarmCredit and NoClaimCredit. R Code for Polychoric Correlation library(psych) AlarmCredit&lt;-as.numeric(ifelse(Insample$AC00==1,&quot;1&quot;, ifelse(Insample$AC05==1,&quot;2&quot;, ifelse(Insample$AC10==1,&quot;3&quot;, ifelse(Insample$AC15==1,&quot;4&quot;,0))))) x &lt;- table(AlarmCredit,NoClaimCredit) rhoN&lt;-polychoric(x,correct=FALSE)$rho round(rhoN,2) Output: [1] -0.14 13.2.5 Interval Variables As described in Section 13.1.2, interval variables provide a clear ordering of levels of a variable and the numerical distance between any two levels of the scale can be readily interpretable. For example, drivers age group variable is an interval variable. For measuring association, both the continuous variable and ordinal variable approaches make sense. The former takes advantage of knowledge of the ordering although assumes continuity. The latter does not rely on the continuity but also does not make use of the information given by the distance between scales. 13.2.6 Discrete and Continuous Variables The polyserial correlation is defined similarly, when one variable (\\(y_1\\)) is continuous and the other (\\(y_2\\)) ordinal. Define \\(z\\) to be the normal score of \\(y_1\\). The polyserial correlation is \\[\\begin{eqnarray*} \\hat{\\rho_N} = \\text{argmax}_{\\rho} \\sum_{i=1}^n \\log\\left\\{ \\phi(z_{i1})\\left[ \\Phi(\\frac{\\hat{\\xi}_{2,y_{i2}} - \\rho z_{i1}} {(1-\\rho^2)^{1/2}}) -\\Phi(\\frac{\\hat{\\xi}_{2,y_{i2-1}} - \\rho z_{i1}} {(1-\\rho^2)^{1/2}}) \\right] \\right\\} \\end{eqnarray*}\\] The biserial correlation is defined similarly, when one variable is continuous and the other binary. \\[ {\\small \\begin{matrix} \\begin{array}{l|r|r} \\hline \\text{NoClaimCredit} &amp; \\text{Mean} &amp;\\text{Total} \\\\ &amp; \\text{Claim} &amp;\\text{Claim} \\\\ \\hline 0 &amp; 22,505 &amp; 85,200,483 \\\\ 1 &amp; 6,629 &amp; 12,282,618 \\\\ \\hline \\end{array} \\end{matrix}} \\] Table 14.5 : Summary of Claim by NoClaimCredit variable from LGPIF data. You can obtain the polyserial or biserial correlation using the polyserial() or biserial() function from the psych library in R. Table 14.5 gives the summary of Claim by NoClaimCredit and the biserial correlation is illustrated using R code below. The \\(\\hat{\\rho}_N=-0.04\\) which means that there is a negative correlation between Claim and NoClaimCredit. R Code for Biserial Correlation library(psych) rhoN&lt;-biserial(Claim,NoClaimCredit) round(rhoN,2) Output: [1] -0.04 Show Quiz Solution 13.3 Introduction to Copulas Copula functions are widely used in statistics and actuarial science literature for dependency modeling. In this section, you learn how to: Describe a multivariate distribution function in terms of a copula function. A copula is a multivariate distribution function with uniform marginals. Specifically, let \\(U_1, \\ldots, U_p\\) be \\(p\\) uniform random variables on \\((0,1)\\). Their distribution function \\[{C}(u_1, \\ldots, u_p) = \\Pr(U_1 \\leq u_1, \\ldots, U_p \\leq u_p),\\] is a copula. We seek to use copulas in applications that are based on more than just uniformly distributed data. Thus, consider arbitrary marginal distribution functions \\({F}_1(y_1)\\),…,\\({F}_p(y_p)\\). Then, we can define a multivariate distribution function using the copula such that \\[{F}(y_1, \\ldots, y_p)= {C}({F}_1(y_1), \\ldots, {F}_p(y_p)).\\] Here, \\(F\\) is a multivariate distribution function in this equation. Sklar (1959) showed that \\(any\\) multivariate distribution function \\(F\\), can be written in the form of this equation, that is, using a copula representation. Sklar also showed that, if the marginal distributions are continuous, then there is a unique copula representation. In this chapter we focus on copula modeling with continuous variables. For discrete case, readers can see (Joe 2014) and (Genest and Nešlohva 2007). For bivariate case, \\(p=2\\) , the distribution function of two random variables can be written by the bivariate copula function: \\[{C}(u_1, \\, u_2) = \\Pr(U_1 \\leq u_1, \\, U_2 \\leq u_2),\\] \\[{F}(y_1, \\, y_2)= {C}({F}_1(y_1), \\, {F}_p(y_2)).\\] To give an example for bivariate copula, we can look at Frank’s (1979) copula. The equation is \\[{C}(u_1,u_2) = \\frac{1}{\\theta} \\ln \\left( 1+ \\frac{ (\\exp(\\theta u_1) -1)(\\exp(\\theta u_2) -1)} {\\exp(\\theta) -1} \\right).\\] This is a bivariate distribution function with its domain on the unit square \\([0,1]^2.\\) Here \\(\\theta\\) is dependence parameter and the range of dependence is controlled by the parameter \\(\\theta\\). Positive association increases as \\(\\theta\\) increases and this positive association can be summarized with Spearman’s rho (\\(\\rho\\)) and Kendall’s tau (\\(\\tau\\)). Frank’s copula is one of the commonly used copula functions in the copula literature. We will see other copula functions in Section 13.5. Show Quiz Solution 13.4 Application Using Copulas In this section, you learn how to: Discover dependence structure between random variables Model the dependence with a copula function This section analyzes the insurance losses and expenses data with the statistical programming R. This data set was introduced in (Frees and Valdez 1998) and is now readily available in the copula package. The model fitting process is started by marginal modeling of two variables (\\(loss\\) and \\(expense\\)). Then we model the joint distribution of these marginal outcomes. 13.4.1 Data Description We start with getting a sample (\\(n = 1500\\)) from the whole data. We consider first two variables of the data; losses and expenses. losses : general liability claims from Insurance Services Office, Inc. (ISO) expenses : ALAE, specifically attributable to the settlement of individual claims (e.g. lawyer’s fees, claims investigation expenses) To visualize the relationship between losses and expenses (ALAE), scatterplots in figure ?? are created on the real dollar scale and on the log scale. R Code for Scatterplots library(copula) data(loss) # loss data Lossdata &lt;- loss attach(Lossdata) loss &lt;- Lossdata$loss par(mfrow=c(1, 2)) plot(loss,alae, cex=.5) # real dollar scale plot(log(loss),log(alae),cex=.5) # log scale par(mfrow=c(1, 2)) 13.4.2 Marginal Models We first examine the marginal distributions of losses and expenses before going through the joint modeling. The histograms show that both losses and expenses are right-skewed and fat-tailed. For marginal distributions of losses and expenses, we consider a Pareto-type distribution, namely a Pareto type II with distribution function \\[ F(y)=1- \\left( 1 + \\frac{y}{\\theta} \\right) ^{-\\alpha},\\] where \\(\\theta\\) is the scale parameter and \\(\\alpha\\) is the shape parameter. The marginal distributions of losses and expenses are fitted with maximum likelihood. Specifically, we use the \\(vglm\\) function from the R VGAM package. Firstly, we fit the marginal distribution of expenses . R Code for Pareto Fitting library(VGAM) fit = vglm(alae ~ 1, paretoII(location=0, lscale=&quot;loge&quot;, lshape=&quot;loge&quot;)) # fit the model by vlgm function coef(fit, matrix=TRUE) # extract fitted model coefficients, matrix=TRUE gives logarithm of estimated parameters instead of default normal scale estimates Coef(fit) Output: loge(scale) loge(shape) (Intercept) 9.624673 0.7988753 scale shape (Intercept) 15133.603598 2.223039 We repeat this procedure to fit the marginal distribution of the loss variable. Because the loss data also seems right-skewed and heavy-tail data, we also model the marginal distribution with Pareto II distribution. R Code for Pareto Fitting fitloss = vglm(loss ~ 1, paretoII, trace=TRUE) Coef(fit) summary(fit) Output: scale shape 15133.603598 2.223039 To visualize the fitted distribution of expenses and loss variables, we use the estimated parameters and plot the corresponding distribution function and density function. For more details on marginal model selection, see Chapter 4. 13.4.3 Probability Integral Transformation The probability integral transformation shows that any continuous variable can be mapped to a \\(U(0,1)\\) random variable via its distribution function. Given the fitted Pareto II distribution, the variable expenses is transformed to the variable \\(u_1\\), which follows a uniform distribution on \\([0,1]\\): \\[u_1 = 1 - \\left( 1 + \\frac{ALAE}{\\hat{\\theta}} \\right)^{-\\hat{\\alpha}}.\\] After applying the probability integral transformation to expenses variable, we plot the histogram of Transformed Alae in Figure 13.2. Figure 13.2: Histogram of Transformed Alae After fitting process,the variable loss is also transformed to the variable \\(u_2\\), which follows a uniform distribution on \\([0,1]\\). We plot the histogram of Transformed Loss . As an alternative, the variable loss is transformed to \\(normal\\) \\(scores\\) with the quantile function of standard normal distribution. As we see in Figure 13.3, normal scores of the variable loss are approximately marginally standard normal. Figure 13.3: Histogram of Transformed Loss. The left-hand panel shows the distribution of probability integral transformed losses. The right-hand panel shows the distribution for the corresponding normal scores. R Code for Histograms of Transformed Variables u1 &lt;- 1 - (1 + (alae/b))^(-s) # or u1 &lt;- pparetoII(alae, location=0, scale=b, shape=s) hist(u1, main = &quot;&quot;, xlab = &quot;Histogram of Transformed alae&quot;) scaleloss &lt;- Coef(fitloss)[1] shapeloss &lt;- Coef(fitloss)[2] u2 &lt;- 1 - (1 + (loss/scaleloss))^(-shapeloss) par(mfrow = c(1, 2)) hist(u2, main = &quot;&quot;, xlab = &quot;Histogram of Transformed Loss&quot;) hist(qnorm(u2), main = &quot;&quot;, xlab = &quot;Histogram of qnorm(Loss)&quot;) 13.4.4 Joint Modeling with Copula Function Before jointly modeling losses and expenses, we draw the scatterplot of transformed variables \\((u_1, u_2)\\) and the scatterplot of normal scores in Figure 13.4. Then we calculate the Spearman’s rho between these two uniform random variables. Figure 13.4: Left: Scatter plot for transformed variables. Right:Scatter plot for normal scores R Code for Scatter Plots and Correlation par(mfrow = c(1, 2)) plot(u1, u2, cex = 0.5, xlim = c(-0.1,1.1), ylim = c(-0.1,1.1), xlab = &quot;Transformed Alae&quot;, ylab = &quot;Transformed Loss&quot;) plot(qnorm(u1), qnorm(u2)) cor(u1, u2, method = &quot;spearman&quot;) Output: [1] 0.451872 Scatter plots and Spearman’s rho correlation value (0.451) shows us there is a positive dependency between these two uniform random variables. It is more clear to see the relationship with normal scores in the second graph. To learn more details about normal scores and their applications in copula modeling, see (Joe 2014). \\((U_1, U_2)\\), (\\(U_1 = F_1(ALAE)\\) and \\(U_2=F_2(LOSS)\\)), is fit to Frank’s copula with maximum likelihood method. R Code for Modeling with Frank Copula uu = cbind(u1,u2) frank.cop &lt;- archmCopula(&quot;frank&quot;, param= c(5), dim = 2) fit.ml &lt;- fitCopula(frank.cop, uu, method=&quot;ml&quot;, start=c(0.4)) summary(fit.ml) Output: Call: fitCopula(copula, data = data, method = &quot;ml&quot;, start = ..2) Fit based on &quot;maximum likelihood&quot; and 1500 2-dimensional observations. Copula: frankCopula param 3.114 The maximized loglikelihood is 172.6 Convergence problems: code is 52 see ?optim. Call: fitCopula(copula, data = data, method = &quot;ml&quot;, start = ..2) Fit based on &quot;maximum likelihood&quot; and 1500 2-dimensional observations. Frank copula, dim. d = 2 Estimate Std. Error param 3.114 NA The maximized loglikelihood is 172.6 Convergence problems: code is 52 see ?optim. Number of loglikelihood evaluations: function gradient 45 45 The fitted model implies that losses and expenses are positively dependent and their dependence is significant. We use the fitted parameter to update the Frank’s copula. The Spearman’s correlation corresponding to the fitted copula parameter(3.114) is calculated with the rho function. In this case, the Spearman’s correlation coefficient is 0.462, which is very close to the sample Spearman’s correlation coefficient; 0.452. R Code for Spearman’s Correlation Using Frank’s Copula (param = fit.ml@estimate) frank.cop &lt;- archmCopula(&quot;frank&quot;, param= param, dim = 2) rho(frank.cop) Output : [1] 0.4622722 To visualize the fitted Frank’s copula, the distribution function and density function perspective plots are drawn in Figure 13.5. Figure 13.5: Left: Plot for distribution function for Franks Copula. Right:Plot for density function for Franks Copula R Code for Frank’s Copula Plots par(mar=c(3.2,3,.2,.2),mfrow=c(1,2)) persp(frank.cop, pCopula, theta=50, zlab=&quot;C(u,v)&quot;, xlab =&quot;u&quot;, ylab=&quot;v&quot;, cex.lab=1.3) persp(frank.cop, dCopula, theta=0, zlab=&quot;c(u,v)&quot;, xlab =&quot;u&quot;, ylab=&quot;v&quot;, cex.lab=1.3) Frank’s copula models positive dependence for this data set, with \\(\\theta=3.114\\). For Frank’s copula, the dependence is related to values of \\(\\theta\\). That is: \\(\\theta=0\\): independent copula \\(\\theta&gt;0\\): positive dependence \\(\\theta&lt;0\\): negative dependence 13.5 Types of Copulas In this section, you learn how to: Define the basic families of the copula functions Calculate the association coefficients by the help of copula functions There are several families of copulas have been described in the literature. Two main families of the copula families are the Archimedian and Elliptical copulas. 13.5.1 Elliptical Copulas Elliptical copulas are constructed from elliptical distributions. This copula decompose (multivariate) elliptical distributions into their univariate elliptical marginal distributions by Sklar’s theorem (Hofert et al. 2018). Properties of elliptical copulas are typically obtained from the properties of corresponding elliptical distributions (Hofert et al. 2018). For example, the normal distribution is a special type of elliptical distribution. To introduce the elliptical class of copulas, we start with the familiar multivariate normal distribution with probability density function \\[\\phi_N (\\mathbf{z})= \\frac{1}{(2 \\pi)^{p/2}\\sqrt{\\det \\boldsymbol \\Sigma}} \\exp\\left( -\\frac{1}{2} \\mathbf{z}^{\\prime} \\boldsymbol \\Sigma^{-1}\\mathbf{z}\\right).\\] Here, \\(\\boldsymbol \\Sigma\\) is a correlation matrix, with ones on the diagonal. Let \\(\\Phi\\) and \\(\\phi\\) denote the standard normal distribution and density functions. We define the Gaussian (normal) copula density function as \\[{c}_N(u_1, \\ldots, u_p) = \\phi_N \\left(\\Phi^{-1}(u_1), \\ldots, \\Phi^{-1}(u_p) \\right) \\prod_{j=1}^p \\frac{1}{\\phi(\\Phi^{-1}(u_j))}.\\] As with other copulas, the domain is the unit cube \\([0,1]^p\\). Specifically, a \\(p\\)-dimensional vector \\({z}\\) has an \\({elliptical}\\) \\({distribution}\\) if the density can be written as \\[h_E (\\mathbf{z})= \\frac{k_p}{\\sqrt{\\det \\boldsymbol \\Sigma}} g_p \\left( \\frac{1}{2} (\\mathbf{z}- \\boldsymbol \\mu)^{\\prime} \\boldsymbol \\Sigma^{-1}(\\mathbf{z}- \\boldsymbol \\mu) \\right).\\] We will use elliptical distributions to generate copulas. Because copulas are concerned primarily with relationships, we may restrict our considerations to the case where \\(\\mu = \\mathbf{0}\\) and \\(\\boldsymbol \\Sigma\\) is a correlation matrix. With these restrictions, the marginal distributions of the multivariate elliptical copula are identical; we use \\(H\\) to refer to this marginal distribution function and \\(h\\) is the corresponding density. This marginal density is \\(h(z) = k_1 g_1(z^2/2).\\) We are now ready to define the \\(elliptical\\) \\(copula\\), a function defined on the unit cube \\([0,1]^p\\) as \\[{c}_E(u_1, \\ldots, u_p) = h_E \\left(H^{-1}(u_1), \\ldots, H^{-1}(u_p) \\right) \\prod_{j=1}^p \\frac{1}{h(H^{-1}(u_j))}.\\] In the elliptical copula family, the function \\(g_p\\) is known as a generator in that it can be used to generate alternative distributions. \\[ \\small\\begin{array}{lc} \\hline &amp; Generator \\\\ Distribution &amp; \\mathrm{g}_p(x) \\\\ \\hline \\text{Normal distribution} &amp; e^{-x}\\\\ \\text{t-distribution with r degrees of freedom} &amp; (1+2x/r)^{-(p+r)/2}\\\\ \\text{Cauchy} &amp; (1+2x)^{-(p+1)/2}\\\\ \\text{Logistic} &amp; e^{-x}/(1+e^{-x})^2\\\\ \\text{Exponential power} &amp; \\exp(-rx^s)\\\\ \\hline \\end{array} \\] Table 14.6 : Distribution and Generator Functions (\\(\\mathrm{g}_p(x)\\)) for Selected Elliptical Copulas Most empirical work focuses on the normal copula and \\(t\\)-copula. That is, \\(t\\)-copulas are useful for modeling the dependency in the tails of bivariate distributions, especially in financial risk analysis applications. The \\(t\\)-copulas with same association parameter in varying the degrees of freedom parameter show us different tail dependency structures. For more information on about \\(t\\)-copulas readers can see (Joe 2014), (Hofert et al. 2018). 13.5.2 Archimedian Copulas This class of copulas are constructed from a \\(generator\\) function,which is \\(\\mathrm{g}(\\cdot)\\) is a convex, decreasing function with domain [0,1] and range \\([0, \\infty)\\) such that \\(\\mathrm{g}(0)=0\\). Use \\(\\mathrm{g}^{-1}\\) for the inverse function of \\(\\mathrm{g}\\). Then the function \\[\\mathrm{C}_{\\mathrm{g}}(u_1, \\ldots, u_p) = \\mathrm{g}^{-1} \\left(\\mathrm{g}(u_1)+ \\cdots + \\mathrm{g}(u_p) \\right)\\] is said to be an Archimedean copula. The function \\(\\mathrm{g}\\) is known as the generator of the copula \\(\\mathrm{C}_{\\mathrm{g}}\\). For bivariate case; \\(p=2\\) , Archimedean copula function can be written by the function \\[\\mathrm{C}_{\\mathrm{g}}(u_1, \\, u_2) = \\mathrm{g}^{-1} \\left(\\mathrm{g}(u_1) + \\mathrm{g}(u_2) \\right).\\] Some important special cases of Archimedean copulas are Frank copula, Clayton/Cook-Johnson copula, Gumbel/Hougaard copula. This copula classes are derived from different generator functions. We can remember that we mentioned about Frank’s copula with details in Section 13.3 and in Section 13.4. Here we will continue to express the equations for Clayton copula and Gumbel/Hougaard copula. 13.5.2.1 Clayton Copula For \\(p=2\\), the Clayton copula is parameterized by \\(\\theta \\in [-1,\\infty)\\) is defined by \\[C_{\\theta}^C(u)=\\max\\{u_1^{-\\theta}+u_2^{-\\theta}-1,0\\}^{1/\\theta}, \\quad u\\in[0,1]^2.\\] This is a bivariate distribution function of Clayton copula defined in unit square \\([0,1]^2.\\) The range of dependence is controlled by the parameter \\(\\theta\\) as the same as Frank copula. 13.5.2.2 Gumbel-Hougaard copula The Gumbel-Hougaarg copula is parametrized by \\(\\theta \\in [1,\\infty)\\) and defined by \\[C_{\\theta}^{GH}(u)=\\exp\\left(-\\left(\\sum_{i=1}^2 (-\\log u_i)^{\\theta}\\right)^{1/\\theta}\\right), \\quad u\\in[0,1]^2.\\] Readers seeking deeper background on Archimedean copulas can see Joe (2014), Frees and Valdez (1998), and Genest and Mackay (1986). 13.5.3 Properties of Copulas 13.5.3.1 Bounds on Association Like all multivariate distribution functions, copulas are bounded. The Fr\\(&#39;{e}\\)chet-Hoeffding bounds are \\[\\max( u_1 +\\cdots+ u_p + p -1, 0) \\leq \\mathrm{C}(u_1, \\ldots, u_p) \\leq \\min (u_1, \\ldots,u_p).\\] To see the right-hand side of the equation, note that \\[\\mathrm{C}(u_1,\\ldots, u_p) = \\Pr(U_1 \\leq u_1, \\ldots, U_p \\leq u_p) \\leq \\Pr(U_j \\leq u_j)\\], for \\(j=1,\\ldots,p\\). The bound is achieved when \\(U_1 = \\cdots = U_p\\). To see the left-hand side when \\(p=2\\), consider \\(U_2=1-U_1\\). In this case, if \\(1-u_2 &lt; u_1\\) then \\(\\Pr(U_1 \\leq u_1, U_2 \\leq u_2) = \\Pr ( 1-u_2 \\leq U_1 &lt; u_1) =u_1+u_2-1.\\) (Nelson 1997) The product copula is \\(\\mathrm{C}(u_1,u_2)=u_1u_2\\) is the result of assuming independence between random variables. The lower bound is achieved when the two random variables are perfectly negatively related (\\(U_2=1-U_1\\)) and the upper bound is achieved when they are perfectly positively related (\\(U_2=U_1\\)). We can see The Frechet-Hoeffding bounds for two random variables in the Figure 13.6. Figure 13.6: Perfect Positive and Perfect negative dependence plots R Code for Frechet-Hoeffding Bounds for Two Random Variables library(copula) n&lt;-100 set.seed(1980) U&lt;-runif(n) par(mfrow=c(1, 2)) plot(cbind(U,1-U), xlab=quote(U[1]), ylab=quote(U[2]),main=&quot;Perfect Negative Dependency&quot;) # W for p=2 plot (cbind(U,U), xlab=quote(U[1]),ylab=quote(U[2]),main=&quot;Perfect Positive Dependency&quot;) #M for p=2 13.5.3.2 Measures of Association Schweizer and Wolff (1981) established that the copula accounts for all the dependence between two random variables, \\(Y_1\\) and \\(Y_2\\), in the following sense. Consider m\\(_1\\) and m\\(_2\\), strictly increasing functions. Thus, the manner in which \\(Y_1\\) and \\(Y_2\\) “move together” is captured by the copula, regardless of the scale in which each variable is measured. Schweizer and Wolff also showed the two standard nonparametric measures of association could be expressed solely in terms of the copula function. Spearman’s correlation coefficient is given by \\[= 12 \\int \\int \\left\\{\\mathrm{C}(u,v) - uv \\right\\} du dv.\\] Kendall’s tau is given by \\[= 4 \\int \\int \\mathrm{C}(u,v)d\\mathrm{C}(u,v) - 1 .\\] For these expressions, we assume that \\(Y_1\\) and \\(Y_2\\) have a jointly continuous distribution function. Further, the definition of Kendall’s tau uses an independent copy of (\\(Y_1\\), \\(Y_2\\)), labeled (\\(Y_1^{\\ast}\\), \\(Y_2^{\\ast}\\)), to define the measure of “concordance.” the widely used Pearson correlation depends on the margins as well as the copula. Because it is affected by non-linear changes of scale. 13.5.3.3 Tail Dependency There are some applications in which it is useful to distinguish by the part of the distribution in which the association is strongest. For example, in insurance it is helpful to understand association among the largest losses, that is, association in the right tails of the data. To capture this type of dependency, we use the right-tail concentration function. The function is \\[R(z) = \\frac{\\Pr(U_1 &gt;z, U_2 &gt; z)}{1-z} =\\Pr(U_1 &gt; z | U_2 &gt; z) =\\frac{1 - 2z + \\mathrm{C}(z,z)}{1-z} .\\] From this equation , \\(R(z)\\) will equal to \\(z\\) under independence. Joe (1997) uses the term “upper tail dependence parameter” for \\(R = \\lim_{z \\rightarrow 1} R(z)\\). Similarly, the left-tail concentration function is \\[L(z) = \\frac{\\Pr(U_1 \\leq z, U_2 \\leq z)}{z}=\\Pr(U_1 \\leq z | U_2 \\leq z) =\\frac{ \\mathrm{C}(z,z)}{1-z}.\\] Tail dependency concentration function captures the probability of two random variables both catching up extreme values. We calculate the left and right tail concentration functions for four different types of copulas; Normal, Frank,Gumbel and t copula. After getting tail concentration functions for each copula, we show concentration function’s values for these four copulas in Table 14.7. As in Venter (2002), we show \\(L(z)\\) for \\(z\\leq 0.5\\) and \\(R(z)\\) for \\(z&gt;0.5\\) in the tail dependence plot in Figure 13.7. We interpret the tail dependence plot, to mean that both the Frank and Normal copula exhibit no tail dependence whereas the \\(t\\) and the Gumbel may do so. The \\(t\\) copula is symmetric in its treatment of upper and lower tails. \\[ {\\small \\begin{matrix} \\begin{array}{l|rr} \\hline \\text{Copula} &amp; \\text{Lower} &amp; \\text{Upper} \\\\ \\hline \\text{Frank} &amp; 0 &amp; 0 \\\\ \\text{Gumbel} &amp; 0 &amp; 0.74 \\\\ \\text{Normal} &amp; 0 &amp; 0 \\\\ \\text{t} &amp; 0.10 &amp; 0.10 \\\\ \\hline \\end{array} \\end{matrix}} \\] Table 14.7 : Tail concentration function values for different copulas R Code for Tail Copula Functions for Different Copulas library(copula) U1 = seq(0,0.5, by=0.002) U2 = seq(0.5,1, by=0.002) U = rbind(U1, U2) TailFunction &lt;- function(Tailcop) { lowertail &lt;- pCopula(cbind(U1,U1), Tailcop)/U1 uppertail &lt;- (1-2*U2 +pCopula(cbind(U2,U2), Tailcop))/(1-U2) jointtail &lt;- rbind(lowertail,uppertail) } Tailcop1 &lt;- archmCopula(family = &quot;frank&quot;, param= c(0.05), dim = 2) Tailcop2 &lt;- archmCopula(family = &quot;gumbel&quot;,param = 3) Tailcop3 &lt;- ellipCopula(&quot;normal&quot;, param = c(0.25),dim = 2, dispstr = &quot;un&quot;) Tailcop4 &lt;- ellipCopula(&quot;t&quot;, param = c(0.25),dim = 2, dispstr = &quot;un&quot;, df=5) jointtail1 &lt;- TailFunction(Tailcop1) jointtail2 &lt;- TailFunction(Tailcop2) jointtail3 &lt;- TailFunction(Tailcop3) jointtail4 &lt;- TailFunction(Tailcop4) tailIndex(Tailcop1) tailIndex(Tailcop2) tailIndex(Tailcop3) tailIndex(Tailcop4) Figure 13.7: Tail dependence plots R Code for Tail Dependence Plots for Different Copulas plot(U,jointtail1, cex=.2, xlim=c(0,1),ylab=&quot;Tail Dependence&quot;, ylim=c(0,1)) lines(U,jointtail2, type=&quot;p&quot;,lty=1, cex=.2) lines(U,jointtail3, type=&quot;p&quot;,lty=1, cex=.2) lines(U,jointtail4, type=&quot;p&quot;,lty=1, cex=.2) text(0.75, 0.1, &quot;Frank&quot;, cex=1.3) #1 text(0.1, 0.8, &quot;Gumbel&quot;, cex=1.3) #2 text(0.25, 0.1, &quot;normal&quot;, cex=1.3) #3 arrows(.17, 0.1, .07, 0.12,code=2, angle=20, length=0.1) text(0.9, 0.4, &quot;t with 5 df&quot;, cex=1.3) #4 Show Quiz Solution 13.6 Why is Dependence Modeling Important? Dependence Modeling is important because it enables us to understand the dependence structure by defining the relationship between variables in a dataset. In insurance, ignoring dependence modeling may not impact pricing but could lead to misestimation of required capital to cover losses. For instance, from Section 13.4 , it is seen that there was a positive relationship between Loss and Expense. This means that, if there is a large loss then we expect expenses to be large as well and ignoring this relationship could lead to misestimation of reserves. To illustrate the importance of dependence modeling, we refer you back to Portfolio Management example in Chapter 6 that assumed that the property and liability risks are independent. Here, we incorporate dependence by allowing the 4 lines of business to depend on one another through a Gaussian copula. In Table 14.8, we show that dependence affects the portfolio quantiles (\\(VaR_q\\)), although not the expect value. For instance , the \\(VaR_{0.99}\\) for total risk which is the amount of capital required to ensure, with a \\(99\\%\\) degree of certainty that the firm does not become technically insolvent is higher when we incorporate dependence. This leads to less capital being allocated when dependence is ignored and can cause unexpected solvency problems. \\[ {\\small \\begin{matrix} \\begin{array}{l|rrrr} \\hline \\text{Independent} &amp;\\text{Expected} &amp; VaR_{0.9} &amp; VaR_{0.95} &amp; VaR_{0.99} \\\\ &amp;\\text{Value} &amp; &amp; &amp; \\\\ \\hline \\text{Retained} &amp; 269 &amp; 300 &amp; 300 &amp; 300 \\\\ \\text{Insurer} &amp; 2,274 &amp; 4,400 &amp; 6,173 &amp; 11,859 \\\\ \\text{Total} &amp; 2,543 &amp; 4,675 &amp; 6,464 &amp; 12,159 \\\\ \\hline \\text{Gaussian Copula}&amp;\\text{Expected}&amp; VaR_{0.9} &amp; VaR_{0.95} &amp; VaR_{0.99} \\\\ &amp;\\text{Value} &amp; &amp; &amp; \\\\ \\hline \\text{Retained} &amp; 269 &amp; 300 &amp; 300 &amp; 300 \\\\ \\text{Insurer} &amp; 2,340 &amp; 4,988 &amp; 7,339 &amp; 14,905 \\\\ \\text{Total} &amp; 2,609 &amp; 5,288 &amp; 7,639 &amp; 15,205 \\\\ \\hline \\end{array} \\end{matrix}} \\] Table 14.8 : Results for portfolio expected value and quantiles (\\(VaR_q\\)) R Code for Simulation Using Gaussian Copula # For the gamma distributions, use alpha1 &lt;- 2; theta1 &lt;- 100 alpha2 &lt;- 2; theta2 &lt;- 200 # For the Pareto distributions, use alpha3 &lt;- 2; theta3 &lt;- 1000 alpha4 &lt;- 3; theta4 &lt;- 2000 # Deductibles d1 &lt;- 100 d2 &lt;- 200 # Simulate the risks nSim &lt;- 10000 #number of simulations set.seed(2017) #set seed to reproduce work X1 &lt;- rgamma(nSim,alpha1,scale = theta1) X2 &lt;- rgamma(nSim,alpha2,scale = theta2) # For the Pareto Distribution, use library(VGAM) X3 &lt;- rparetoII(nSim,scale=theta3,shape=alpha3) X4 &lt;- rparetoII(nSim,scale=theta4,shape=alpha4) # Portfolio Risks S &lt;- X1 + X2 + X3 + X4 Sretained &lt;- pmin(X1,d1) + pmin(X2,d2) Sinsurer &lt;- S - Sretained # Expected Claim Amounts ExpVec &lt;- t(as.matrix(c(mean(Sretained),mean(Sinsurer),mean(S)))) colnames(ExpVec) &lt;- c(&quot;Retained&quot;, &quot;Insurer&quot;,&quot;Total&quot;) round(ExpVec,digits=2) # Quantiles quantMat &lt;- rbind( quantile(Sretained, probs=c(0.80, 0.90, 0.95, 0.99)), quantile(Sinsurer, probs=c(0.80, 0.90, 0.95, 0.99)), quantile(S , probs=c(0.80, 0.90, 0.95, 0.99))) rownames(quantMat) &lt;- c(&quot;Retained&quot;, &quot;Insurer&quot;,&quot;Total&quot;) round(quantMat,digits=2) plot(density(S), main=&quot;Density of Total Portfolio Risk S&quot;, xlab=&quot;S&quot;) ### Normal Copula ## library(VGAM) library(copula) library(GB2) library(statmod) library(numDeriv) set.seed(2017) parm&lt;-c(0.5,0.5,0.5,0.5,0.5,0.5) nc &lt;- normalCopula(parm, dim = 4, dispstr = &quot;un&quot;) mcc &lt;- mvdc(nc, margins = c(&quot;gamma&quot;, &quot;gamma&quot;,&quot;paretoII&quot;,&quot;paretoII&quot;), paramMargins = list(list(scale = theta1, shape=alpha1), list(scale = theta2, shape=alpha2), list(scale = theta3, shape=alpha3), list(scale = theta4, shape=alpha4))) X &lt;- rMvdc(nSim, mvdc = mcc) X1&lt;-X[,1] X2&lt;-X[,2] X3&lt;-X[,3] X4&lt;-X[,4] # Portfolio Risks S &lt;- X1 + X2 + X3 + X4 Sretained &lt;- pmin(X1,d1) + pmin(X2,d2) Sinsurer &lt;- S - Sretained # Expected Claim Amounts ExpVec &lt;- t(as.matrix(c(mean(Sretained),mean(Sinsurer),mean(S)))) colnames(ExpVec) &lt;- c(&quot;Retained&quot;, &quot;Insurer&quot;,&quot;Total&quot;) round(ExpVec,digits=2) # Quantiles quantMat &lt;- rbind( quantile(Sretained, probs=c(0.80, 0.90, 0.95, 0.99)), quantile(Sinsurer, probs=c(0.80, 0.90, 0.95, 0.99)), quantile(S , probs=c(0.80, 0.90, 0.95, 0.99))) rownames(quantMat) &lt;- c(&quot;Retained&quot;, &quot;Insurer&quot;,&quot;Total&quot;) round(quantMat,digits=2) plot(density(S), main=&quot;Density of Total Portfolio Risk S&quot;, xlab=&quot;S&quot;) Show Quiz Solution 13.7 Further Resources and Contributors Contributors Edward W. (Jed) Frees and Nii-Armah Okine, University of Wisconsin-Madison, and Emine Selin Sarıdaş, Mimar Sinan University, are the principal authors of the initial version of this chapter. Email: jfrees@bus.wisc.edu for chapter comments and suggested improvements. TS 14.A. Other Classic Measures of Scalar Associations TS 14.A.1. Blomqvist’s Beta Blomqvist (1950) developed a measure of dependence now known as Blomqvist’s beta, also called the median concordance coefficient and the medial correlation coefficient. Using distribution functions, this parameter can be expressed as \\[\\begin{equation*} \\beta = 4F\\left(F^{-1}_X(1/2),F^{-1}_Y(1/2) \\right) - 1. \\end{equation*}\\] That is, first evaluate each marginal at its median (\\(F^{-1}_X(1/2)\\) and \\(F^{-1}_Y(1/2)\\), respectively). Then, evaluate the bivariate distribution function at the two medians. After rescaling (multiplying by 4 and subtracting 1), the coefficient turns out to have a range of \\([-1,1]\\), where 0 occurs under independence. Like Spearman’s rho and Kendall’s tau, an estimator based on ranks is easy to provide. First write \\(\\beta = 4C(1/2,1/2)-1 = 2\\Pr((U_1-1/2)(U_2-1/2))-1\\) where \\(U_1, U_2\\) are uniform random variables. Then, define \\[\\begin{equation*} \\hat{\\beta} = \\frac{2}{n} \\sum_{i=1}^n I\\left( (R(X_{i})-\\frac{n+1}{2})(R(Y_{i})-\\frac{n+1}{2}) \\ge 0 \\right)-1 . \\end{equation*}\\] See, for example, (Joe 2014), page 57 or (Hougaard 2000), page 135, for more details. Because Blomqvist’s parameter is based on the center of the distribution, it is particularly useful when data are censored; in this case, information in extreme parts of the distribution are not always reliable. How does this affect a choice of association measures? First, recall that association measures are based on a bivariate distribution function. So, if one has knowledge of a good approximation of the distribution function, then calculation of an association measure is straightforward in principle. Second, for censored data, bivariate extensions of the univariate Kaplan-Meier distribution function estimator are available. For example, the version introduced in (Dabrowska 1988) is appealing. However, because of instances when large masses of data appear at the upper range of the data, this and other estimators of the bivariate distribution function are unreliable. This means that, summary measures of the estimated distribution function based on Spearman’s rho or Kendall’s tau can be unreliable. For this situation, Blomqvist’s beta appears to be a better choice as it focuses on the center of the distribution. (Hougaard 2000), Chapter 14, provides additional discussion. You can obtain the Blomqvist’s beta, using the betan() function from the copula library in R. From below, \\(\\beta=0.3\\) between the Coverage rating variable in millions of dollars and Claim amount variable in dollars. R Code for Blomqvist’s Beta ### Blomqvist&#39;s beta correlation between Claim and Coverage ### library(copula) n&lt;-length(Claim) U&lt;-cbind(((n+1)/n*pobs(Claim)),((n+1)/n*pobs(Coverage))) beta&lt;-betan(U, scaling=FALSE) round(beta,2) Output: [1] 0.3 ### Blomqvist&#39;s beta correlation between Claim and log(Coverage) ### n&lt;-length(Claim) Fx&lt;-cbind(((n+1)/n*pobs(Claim)),((n+1)/n*pobs(log(Coverage)))) beta&lt;-betan(Fx, scaling=FALSE) round(beta,2) Output: [1] 0.3 In addition,to show that the Blomqvist’s beta is invariate under strictly increasing transformations , \\(\\beta=0.3\\) between the Coverage rating variable in logarithmic millions of dollars and Claim amount variable in dollars. TS 14.A.2. Nonparametric Approach Using Spearman Correlation with Tied Ranks For the first variable, the average rank of observations in the \\(s\\)th row is \\[\\begin{equation*} r_{1s} = n_{m_1\\centerdot}+ \\cdots+ n_{s-1,\\centerdot}+ \\frac{1}{2} \\left(1+ n_{s\\centerdot}\\right) \\end{equation*}\\] and similarly \\(r_{2t} = \\frac{1}{2} \\left[(n_{\\centerdot m_1}+ \\cdots+ n_{\\centerdot,s-1}+1)+ (n_{\\centerdot m_1}+ \\cdots+ n_{\\centerdot s})\\right]\\). With this, we have Spearman’s rho with tied rank is \\[\\begin{equation*} \\hat{\\rho}_S = \\frac{\\sum_{s=m_1}^{m_2} \\sum_{t=m_1}^{m_2} n_{st}(r_{1s} - \\bar{r})(r_{2t} - \\bar{r})} {\\left[\\sum_{s=m_1}^{m_2}n_{s \\centerdot}(r_{1s} - \\bar{r})^2 \\sum_{t=m_1}^{m_2} n_{\\centerdot t}(r_{2t} - \\bar{r})^2 \\right]^2} \\end{equation*}\\] where the average rank is \\(\\bar{r} = (n+1)/2\\). Click to Show Proof for Special Case: Binary Data. Special Case: Binary Data. Here, \\(m_1=0\\) and \\(m_2=1\\). For the first variable ranks, we have \\(r_{10} = (1+n_{0\\centerdot})/2\\) and \\(r_{11} = (n_{0\\centerdot}+1+n)/2\\). Thus, \\(r_{10} -\\bar{r}= (n_{0\\centerdot}-n)/2\\) and \\(r_{11}-\\bar{r} = n_{0\\centerdot}/2\\). This means that we have \\(\\sum_{s=0}^{1}n_{s\\centerdot}(r_{1s} - \\bar{r})^2 = n (n-n_{0\\centerdot})n_{0\\centerdot}/4\\) and similarly for the second variable. For the numerator, we have \\[\\begin{eqnarray*} \\sum_{s=0}^{1} \\sum_{t=0}^{1} &amp;&amp; n_{st}(r_{1s} - \\bar{r})(r_{2t} - \\bar{r})\\\\ &amp;=&amp; n_{00} \\frac{n_{0\\centerdot}-n}{2} \\frac{n_{\\centerdot 0}-n}{2} +n_{01} \\frac{n_{0\\centerdot}-n}{2} \\frac{n_{\\centerdot 0}}{2} +n_{10} \\frac{n_{0\\centerdot}}{2} \\frac{n_{\\centerdot 0}-n}{2} +n_{11} \\frac{n_{0\\centerdot}}{2} \\frac{n_{\\centerdot 0}}{2} \\\\ &amp;=&amp; \\frac{1}{4}(n_{00} (n_{0\\centerdot}-n) (n_{\\centerdot 0}-n) +(n_{0\\centerdot}-n_{00}) (n_{0\\centerdot}-n)n_{\\centerdot 0} \\\\ &amp;&amp; ~ ~ ~ +(n_{\\centerdot 0}-n_{00}) n_{0\\centerdot}(n_{\\centerdot 0}-n) +(n-n_{\\centerdot 0}-n_{0\\centerdot}+n_{00}) n_{0\\centerdot}n_{\\centerdot 0} ) \\\\ &amp;=&amp; \\frac{1}{4}(n_{00} n^2 - n_{0\\centerdot} (n_{0\\centerdot}-n)n_{\\centerdot 0} \\\\ &amp;&amp; ~ ~ ~ +n_{\\centerdot 0} n_{0\\centerdot}(n_{\\centerdot 0}-n) +(n-n_{\\centerdot 0}-n_{0\\centerdot}) n_{0\\centerdot}n_{\\centerdot 0} ) \\\\ &amp;=&amp; \\frac{1}{4}(n_{00} n^2 - n_{0\\centerdot}n_{\\centerdot 0} (n_{0\\centerdot}-n +n_{\\centerdot 0}-n +n-n_{\\centerdot 0}-n_{0\\centerdot}) \\\\ &amp;=&amp; \\frac{n}{4}(n n_{00} - n_{0\\centerdot}n_{\\centerdot 0}) . \\end{eqnarray*}\\] This yields \\[\\begin{eqnarray*} \\hat{\\rho}_S &amp;=&amp; \\frac{n(n n_{00} - n_{0\\centerdot}n_{\\centerdot 0})} {4\\sqrt{(n (n-n_{0\\centerdot})n_{0\\centerdot}/4)(n (n-n_{\\centerdot 0})n_{\\centerdot 0}/4)}} \\\\ &amp;=&amp; \\frac{n n_{00} - n_{0\\centerdot}n_{\\centerdot 0}} {\\sqrt{ n_{0\\centerdot} n_{\\centerdot 0}(n-n_{0\\centerdot}) (n-n_{\\centerdot 0})}} \\\\ &amp;=&amp; \\frac{n_{00} - n (1-\\hat{\\pi}_X)(1- \\hat{\\pi}_Y)} {\\sqrt{\\hat{\\pi}_X(1-\\hat{\\pi}_X)\\hat{\\pi}_Y(1-\\hat{\\pi}_Y) }} \\end{eqnarray*}\\] where \\(\\hat{\\pi}_X = (n-n_{0\\centerdot})/n\\) and similarly for \\(\\hat{\\pi}_Y\\). Note that this is same form as the Pearson measure. From this, we see that the joint count \\(n_{00}\\) drives this association measure. You can obtain the ties-corrected Spearman correlation statistic \\(r_S\\) using the cor() function in R and selecting the spearman method. From below \\(\\hat{\\rho}_S=-0.09\\). R Code for Ties-corrected Spearman Correlation rs_ties&lt;-cor(AlarmCredit,NoClaimCredit, method = c(&quot;spearman&quot;)) round(rs_ties,2) Output: [1] -0.09 Bibliography "],
["C-AppA.html", "Chapter 14 Appendix A: Review of Statistical Inference 14.1 Basic Concepts 14.2 Point Estimation and Properties 14.3 Interval Estimation 14.4 Hypothesis Testing", " Chapter 14 Appendix A: Review of Statistical Inference Chapter preview. The appendix gives an overview of concepts and methods related to statistical inference on the population of interest, using a random sample of observations from the population. In the appendix, Section 14.1 introduces the basic concepts related to the population and the sample used for making the inference. Section 14.2 presents the commonly used methods for point estimation of population characteristics. Section 14.3 demonstrates interval estimation that takes into consideration the uncertainty in the estimation, due to use of a random sample from the population. Section 14.4 introduces the concept of hypothesis testing for the purpose of variable and model selection. 14.1 Basic Concepts In this section, you learn the following concepts related to statistical inference. Random sampling from a population that can be summarized using a list of items or individuals within the population Sampling distributions that characterize the distributions of possible outcomes for a statistic calculated from a random sample The central limit theorem that guides the distribution of the mean of a random sample from the population Statistical inference is the process of making conclusions on the characteristics of a large set of items/individuals (i.e., the population), using a representative set of data (e.g., a random sample) from a list of items or individuals from the population that can be sampled. While the process has a broad spectrum of applications in various areas including science, engineering, health, social, and economic fields, statistical inference is important to insurance companies that use data from their existing policy holders in order to make inference on the characteristics (e.g., risk profiles) of a specific segment of target customers (i.e., the population) whom the insurance companies do not directly observe. Show An Empirical Example Using the Wisconsin Property Fund Example – Wisconsin Property Fund. Assume there are 1,377 individual claims from the 2010 experience. Minimum First Quartile Median Mean Third Quartile Maximum Standard Deviation Claims 1 788 2,250 26,620 6,171 12,920,000 368,030 Logarithmic Claims 0 6.670 7.719 7.804 8.728 16.370 1.683 ClaimLev &lt;- read.csv(&quot;Data/CLAIMLEVEL.csv&quot;, header=TRUE) ClaimLevBC10&lt;-subset(ClaimLev,Year==2010); cat(&quot;Sample size: &quot;, nrow(ClaimLevBC10), &quot;\\n&quot;) par(mfrow=c(1, 2)) hist(ClaimLevBC10$Claim, main=&quot;&quot;, xlab=&quot;Claims&quot;) hist(log(ClaimLevBC10$Claim), main=&quot;&quot;, xlab=&quot;Logarithmic Claims&quot;) Figure 14.1: Distribution of Claims ## Sample size: 1377 Using the 2010 claim experience (the sample), the Wisconsin Property Fund may be interested in assessing the severity of all claims that could potentially occur, such as 2010, 2011, and so forth (the population). This process is important in the contexts of ratemaking or claim predictive modeling. In order for such inference to be valid, we need to assume that the set of 2010 claims is a random sample that is representative of the population, the sampling distribution of the average claim amount can be estimated, so that we can quantify the bias and uncertainty in the esitmation due to use of a finite sample. 14.1.1 Random Sampling In statistics, a sampling error occurs when the sampling frame, the list from which the sample is drawn, is not an adequate approximation of the population of interest. A sample must be a representative subset of a population, or universe, of interest. If the sample is not representative, taking a larger sample does not eliminate bias, as the same mistake is repeated over again and again. Thus, we introduce the concept for random sampling that gives rise to a simple random sample that is representative of the population. We assume that the random variable \\(X\\) represents a draw from a population with a distribution function \\(F(\\cdot)\\) with mean \\(\\mathrm{E}[X]=\\mu\\) and variance \\(\\mathrm{Var}[X]=\\mathrm{E}[(X-\\mu)^2]\\), where \\(E(\\cdot)\\) denotes the expectation of a random variable. In random sampling, we make a total of \\(n\\) such draws represented by \\(X_1, \\ldots, X_n\\), each unrelated to one another (i.e., statistically independent). We refer to \\(X_1, \\ldots, X_n\\) as a random sample (with replacement) from \\(F(\\cdot)\\), taking either a parametric or nonparametric form. Alternatively, we may say that \\(X_1, \\ldots, X_n\\) are identically and independently distributed (iid) with distribution function \\(F(\\cdot)\\). 14.1.2 Sampling Distribution Using the random sample \\(X_1, \\ldots, X_n\\), we are interested in making a conclusion on a specific attribute of the population distribution \\(F(\\cdot)\\). For example, we may be interested in making an inference on the population mean, denoted \\(\\mu\\). It is natural to think of the sample mean, \\(\\bar{X}=\\sum_{i=1}^nX_i\\), as an estimate of the population mean \\(\\mu\\). We call the sample mean as a statistic calculated from the random sample \\(X_1, \\ldots, X_n\\). Other commonly used summary statistics include sample standard deviation and sample quantiles. When using a statistic (e.g., the sample mean \\(\\bar{X}\\)) to make statistical inference on the population attribute (e.g., population mean \\(\\mu\\)), the quality of inference is determined by the bias and uncertainty in the estimation, owing to the use of a sample in place of the population. Hence, it is important to study the distribution of a statistic that quantifies the bias and variability of the statistic. In particular, the distribution of the sample mean, \\(\\bar{X}\\) (or any other statistic), is called the sampling distribution. The sampling distribution depends on the sampling process, the statistic, the sample size \\(n\\) and the population distribution \\(F(\\cdot)\\). The central limit theorem gives the large-sample (sampling) distribution of the sample mean under certain conditions. 14.1.3 Central Limit Theorem In statistics, there are variations of the central limit theorem (CLT) ensuring that, under certain conditions, the sample mean will approach the population mean with its sampling distribution approaching the normal distribution as the sample size goes to infinity. We give the Lindeberg–Levy CLT that establishes the asymptotic sampling distribution of the sample mean \\(\\bar{X}\\) calculated using a random sample from a universe population having a distribution \\(F(\\cdot)\\). Lindeberg–Levy CLT. Let \\(X_1, \\ldots, X_n\\) be a random sample from a population distribution \\(F(\\cdot)\\) with mean \\(\\mu\\) and variance \\(\\sigma^2&lt;\\infty\\). The difference between the sample mean \\(\\bar{X}\\) and \\(\\mu\\), when multiplied by \\(\\sqrt{n}\\), converges in distribution to a normal distribution as the sample size goes to infinity. That is, \\[\\sqrt{n}(\\bar{X}-\\mu)\\xrightarrow[]{d}N(0,\\sigma).\\] Note that the CLT does not require a parametric form for \\(F(\\cdot)\\). Based on the CLT, we may perform statistical inference on the population mean (we infer, not deduce). The types of inference we may perform include estimation of the population, hypothesis testing on whether a null statement is true, and prediction of future samples from the population. 14.2 Point Estimation and Properties In this section, you learn how to estimate population parameters using method of moments estimation estimate population parameters based on maximum likelihood estimation The population distribution function \\(F(\\cdot)\\) can usually be characterized by a limited (finite) number of terms called parameters, in which case we refer to the distribution as a parametric distribution. In contrast, in nonparametric analysis, the attributes of the sampling distribution are not limited to a small number of parameters. For obtaining the population characteristics, there are different attributes related to the population distribution \\(F(\\cdot)\\). Such measures include the mean, median, percentiles (i.e., 95th percentile), and standard deviation. Because these summary measures do not depend on a specific parametric reference, they are nonparametric summary measures. In parametric analysis, on the other hand, we may assume specific families of distributions with specific parameters. For example, people usually think of logarithm of claim amounts to be normally distributed with mean \\(\\mu\\) and standard deviation \\(\\sigma\\). That is, we assume that the claims have a lognormal distribution with parameters \\(\\mu\\) and \\(\\sigma\\). Alternatively, insurance companies commonly assume that claim severity follows a gamma distribution with a shape parameter \\(\\alpha\\) and a scale parameter \\(\\theta\\). Here, the normal, lognormal, and gamma distributions are examples of parametric distributions. In the above examples, the quantities of \\(\\mu\\), \\(\\sigma\\), \\(\\alpha\\), and \\(\\theta\\) are known as parameters. For a given parametric distribution family, the distribution is uniquely determined by the values of the parameters. One often uses \\(\\theta\\) to denote a summary attribute of the population. In parametric models, \\(\\theta\\) can be a parameter or a function of parameters from a distribution such as the normal mean and variance parameters. In nonparametric analysis, it can take a form of a nonparametric summary such as the population mean or standard deviation. Let \\(\\hat{\\theta} =\\hat{\\theta}(X_1, \\ldots, X_n)\\) be a function of the sample that provides a proxy, or an estimate, of \\(\\theta\\). It is referred to as a statistic, a function of the sample \\(X_1, \\ldots, X_n\\). Show Wisconsin Property Fund Example - Continued Example – Wisconsin Property Fund. The sample mean 7.804 and the sample standard deviation 1.683 can be either deemed as nonparametric estimates of the population mean and standard deviation, or as parametric estimates of \\(\\mu\\) and \\(\\sigma\\) of the normal distribution concerning the logarithmic claims. Using results from the lognormal distribution, we may estimate the expected claim, the lognormal mean, as 10,106.8 ( \\(=\\exp(7.804+1.683^2/2)\\) ). For the Wisconsin Property Fund data, we may denote \\(\\hat{\\mu} =7.804\\) and \\(\\hat{\\sigma} = 1.683\\), with the hat notation denoting an estimate of the parameter based on the sample. In particular, such an estimate is referred to as a point estimate, a single approximation of the corresponding parameter. For point estimation, we introduce the two commonly used methods called the method of moments estimation and maximum likelihood estimation. 14.2.1 Method of Moments Estimation Before defining the method of moments estimation, we define the the concept of moments. Moments are population attributes that characterize the distribution function \\(F(\\cdot)\\). Given a random draw \\(X\\) from \\(F(\\cdot)\\), the expectation \\(\\mu_k=\\mathrm{E}[X^k]\\) is called the \\(k\\)th moment of \\(X\\), \\(k=1,2,3,\\ldots\\) For example, the population mean \\(\\mu\\) is the first moment. Furthermore, the expectation \\(\\mathrm{E}[(X-\\mu)^k]\\) is called a \\(k\\)th central moment. Thus, the variance is the second central moment. Using the random sample \\(X_1, \\ldots, X_n\\), we may construct the corresponding sample moment, \\(\\hat{\\mu}_k=(1/n)\\sum_{i=1}^n X_i^k\\), for estimating the population attribute \\(\\mu_k\\). For example, we have used the sample mean \\(\\bar{X}\\) as an estimator for the population mean \\(\\mu\\). Similarly, the second central moment can be estimated as \\((1/n)\\sum_{i=1}^n(X_i-\\bar{X})^2\\). Without assuming a parametric form for \\(F(\\cdot)\\), the sample moments constitute nonparametric estimates of the corresponding population attributes. Such an estimator based on matching of the corresponding sample and population moments is called a method of moments estimator (MME). While the MME works naturally in a nonparametric model, it can be used to estimate parameters when a specific parametric family of distribution is assumed for \\(F(\\cdot)\\). Denote by \\(\\boldsymbol{\\theta}=(\\theta_1,\\cdots,\\theta_m)\\) the vector of parameters corresponding to a parametric distribution \\(F(\\cdot)\\). Given a distribution family, we commonly know the relationships between the parameters and the moments. In particular, we know the specific forms of the functions \\(h_1(\\cdot),h_2(\\cdot),\\cdots,h_m(\\cdot)\\) such that \\(\\mu_1=h_1(\\boldsymbol{\\theta}),\\,\\mu_2=h_2(\\boldsymbol{\\theta}),\\,\\cdots,\\,\\mu_m=h_m(\\boldsymbol{\\theta})\\). Given the MME \\(\\hat{\\mu}_1, \\ldots, \\hat{\\mu}_m\\) from the random sample, the MME of the parameters \\(\\hat{\\theta}_1,\\cdots,\\hat{\\theta}_m\\) can be obtained by solving the equations of \\[\\hat{\\mu}_1=h_1(\\hat{\\theta}_1,\\cdots,\\hat{\\theta}_m);\\] \\[\\hat{\\mu}_2=h_2(\\hat{\\theta}_1,\\cdots,\\hat{\\theta}_m);\\] \\[\\cdots\\] \\[\\hat{\\mu}_m=h_m(\\hat{\\theta}_1,\\cdots,\\hat{\\theta}_m).\\] Show Wisconsin Property Fund Example - Continued Example – Wisconsin Property Fund. Assume that the claims follow a lognormal distribution, so that logarithmic claims follow a normal distribution. Specifically, assume \\(\\ln(X)\\) has a normal distribution with mean \\(\\mu\\) and variance \\(\\sigma^2\\), denoted as \\(\\ln(X) \\sim N(\\mu, \\sigma^2)\\). It is straightforward that the MME \\(\\hat{\\mu}=\\bar{X}\\) and \\(\\hat{\\sigma}=\\sqrt{(1/n)\\sum_{i=1}^n(X_i-\\bar{X})^2}\\). For the Wisconsin Property Fund example, the method of moments estimates are \\(\\hat{\\mu} =7.804\\) and \\(\\hat{\\sigma} = 1.683\\). 14.2.2 Maximum Likelihood Estimation When \\(F(\\cdot)\\) takes a parametric form, the maximum likelihood method is widely used for estimating the population parameters \\(\\boldsymbol{\\theta}\\). Maximum likelihood estimation is based on the likelihood function, a function of the parameters given the observed sample. Denote by \\(f(x_i|\\boldsymbol{\\theta})\\) the probability function of \\(X_i\\) evaluated at \\(X_i=x_i\\) \\((i=1,2,\\cdots,n)\\); it is the probability mass function in the case of a discrete \\(X\\) and the probability density function in the case of a continuous \\(X\\). Assuming independence, the likelihood function of \\(\\boldsymbol{\\theta}\\) associated with the observation \\((X_1,X_2,\\cdots,X_n)=(x_1,x_2,\\cdots,x_n)=\\mathbf{x}\\) can be written as \\[L(\\boldsymbol{\\theta}|\\mathbf{x})=\\prod_{i=1}^nf(x_i|\\boldsymbol{\\theta}),\\] with the corresponding log-likelihood function given by \\[l(\\boldsymbol{\\theta}|\\mathbf{x})=\\ln(L(\\boldsymbol{\\theta}|\\mathbf{x}))=\\sum_{i=1}^n\\ln f(x_i|\\boldsymbol{\\theta}).\\] The maximum likelihood estimator (MLE) of \\(\\boldsymbol{\\theta}\\) is the set of values of \\(\\boldsymbol{\\theta}\\) that maximize the likelihood function (log-likelihood function), given the observed sample. That is, the MLE \\(\\hat{\\boldsymbol{\\theta}}\\) can be written as \\[\\hat{\\boldsymbol{\\theta}}={\\mbox{argmax}}_{\\boldsymbol{\\theta}\\in\\Theta}l(\\boldsymbol{\\theta}|\\mathbf{x}),\\] where \\(\\Theta\\) is the parameter space of \\(\\boldsymbol{\\theta}\\), and \\({\\mbox{argmax}}_{\\boldsymbol{\\theta}\\in\\Theta}l(\\boldsymbol{\\theta}|\\mathbf{x})\\) is defined as the value of \\(\\boldsymbol{\\theta}\\) at which the function \\(l(\\boldsymbol{\\theta}|\\mathbf{x})\\) reachs its maximum. Given the analytical form of the likelihood function, the MLE can be obtained by taking the first derivative of the log-likelihood function with respect to \\(\\boldsymbol{\\theta}\\), and setting the values of the partial derivatives to zero. That is, the MLE are the solutions of the equations of \\[\\frac{\\partial l(\\hat{\\boldsymbol{\\theta}}|\\mathbf{x})}{\\partial\\hat{\\theta}_1}=0;\\] \\[\\frac{\\partial l(\\hat{\\boldsymbol{\\theta}}|\\mathbf{x})}{\\partial\\hat{\\theta}_2}=0;\\] \\[\\cdots\\] \\[\\frac{\\partial l(\\hat{\\boldsymbol{\\theta}}|\\mathbf{x})}{\\partial\\hat{\\theta}_m}=0,\\] provided that the second partial derivatives are negative. For parametric models, the MLE of the parameters can be obtained either analytically (e.g., in the case of normal distributions and linear estimators), or numerically through iterative algorithms such as the Newton-Raphson method and its adaptive versions (e.g., in the case of generalized linear models with a non-normal response variable). Normal distribution. Assume \\((X_1,X_2,\\cdots,X_n)\\) to be a random sample from the normal distribution \\(N(\\mu, \\sigma^2)\\). With an observed sample \\((X_1,X_2,\\cdots,X_n)=(x_1,x_2,\\cdots,x_n)\\), we can write the likelihood function of \\(\\mu,\\sigma^2\\) as \\[L(\\mu,\\sigma^2)=\\prod_{i=1}^n\\left[\\frac{1}{\\sqrt{2\\pi\\sigma^2}}e^{-\\frac{\\left(x_i-\\mu\\right)^2}{2\\sigma^2}}\\right],\\] with the corresponding log-likelihood function given by \\[l(\\mu,\\sigma^2)=-\\frac{n}{2}[\\ln(2\\pi)+\\ln(\\sigma^2)]-\\frac{1}{2\\sigma^2}\\sum_{i=1}^n\\left(x_i-\\mu\\right)^2.\\] By solving \\[\\frac{\\partial l(\\hat{\\mu},\\sigma^2)}{\\partial \\hat{\\mu}}=0,\\] we obtain \\(\\hat{\\mu}=\\bar{x}=(1/n)\\sum_{i=1}^nx_i\\). It is straightforward to verify that \\(\\frac{\\partial l^2(\\hat{\\mu},\\sigma^2)}{\\partial \\hat{\\mu}^2}\\left|_{\\hat{\\mu}=\\bar{x}}\\right.&lt;0\\). Since this works for arbitrary \\(x\\), \\(\\hat{\\mu}=\\bar{X}\\) is the MLE of \\(\\mu\\). Similarly, by solving \\[\\frac{\\partial l(\\mu,\\hat{\\sigma}^2)}{\\partial \\hat{\\sigma}^2}=0,\\] we obtain \\(\\hat{\\sigma}^2=(1/n)\\sum_{i=1}^n(x_i-\\mu)^2\\). Further replacing \\(\\mu\\) by \\(\\hat{\\mu}\\), we derive the MLE of \\(\\sigma^2\\) as \\(\\hat{\\sigma}^2=(1/n)\\sum_{i=1}^n(X_i-\\bar{X})^2\\). Hence, the sample mean \\(\\bar{X}\\) and \\(\\hat{\\sigma}^2\\) are both the MME and MLE for the mean \\(\\mu\\) and variance \\(\\sigma^2\\), under a normal population distribution \\(F(\\cdot)\\). More details regarding the properties of the likelihood function, and the derivation of MLE under parametric distributions other than the normal distribution are given in Appendix Chapter 15. 14.3 Interval Estimation In this section, you learn how to derive the exact sampling distribution of the MLE of the normal mean obtain the large-sample approximation of the sampling distribution using the large sample properties of the MLE construct a confidence interval of a parameter based on the large sample properties of the MLE Now that we have introduced the MME and MLE, we may perform the first type of statistical inference, interval estimation that quantifies the uncertainty resulting from the use of a finite sample. By deriving the sampling distribution of MLE, we can estimate an interval (a confidence interval) for the parameter. Under the frequentist approach (e.g., that based on maximum likelihood estimation), the confidence intervals generated from the same random sampling frame will cover the true value the majority of times (e.g., 95% of the times), if we repeat the sampling process and re-calculate the interval over and over again. Such a process requires the derivation of the sampling distribution for the MLE. 14.3.1 Exact Distribution for Normal Sample Mean Due to the additivity property of the normal distribution (i.e., a sum of normal random variables that follows a multivariate normal distribution still follows a normal distribution) and that the normal distribution belongs to the location–scale family (i.e., a location and/or scale transformation of a normal random variable has a normal distribution), the sample mean \\(\\bar{X}\\) of a random sample from a normal \\(F(\\cdot)\\) has a normal sampling distribution for any finite \\(n\\). Given \\(X_i\\sim^{iid} N(\\mu,\\sigma^2)\\), \\(i=1,\\dots,n\\), the MLE of \\(\\mu\\) has an exact distribution \\[\\bar{X}\\sim N\\left(\\mu,\\frac{\\sigma^2}{n}\\right).\\] Hence, the sample mean is an unbiased estimator of \\(\\mu\\). In addition, the uncertainty in the estimation can be quantified by its variance \\(\\sigma^2/n\\), that decreases with the sample size \\(n\\). When the sample size goes to infinity, the sample mean will approach a single mass at the true value. 14.3.2 Large-sample Properties of MLE For the MLE of the mean parameter and any other parameters of other parametric distribution families, however, we usually cannot derive an exact sampling distribution for finite samples. Fortunately, when the sample size is sufficiently large, MLEs can be approximated by a normal distribution. Due to the general maximum likelihood theory, the MLE has some nice large-sample properties. The MLE \\(\\hat{\\theta}\\) of a parameter \\(\\theta\\), is a consistent estimator. That is, \\(\\hat{\\theta}\\) converges in probability to the true value \\(\\theta\\), as the sample size \\(n\\) goes to infinity. The MLE has the asymptotic normality property, meaning that the estimator will converge in distribution to a normal distribution centered around the true value, when the sample size goes to infinity. Namely, \\[\\sqrt{n}(\\hat{\\theta}-\\theta)\\rightarrow_d N\\left(0,\\,V\\right),\\quad \\mbox{as}\\quad n\\rightarrow \\infty,\\] where \\(V\\) is the inverse of the Fisher Information. Hence, the MLE \\(\\hat{\\theta}\\) approximately follows a normal distribution with mean \\(\\theta\\) and variance \\(V/n\\), when the sample size is large. The MLE is efficient, meaning that it has the smallest asymptotic variance \\(V\\), commonly referred to as the Cramer–Rao lower bound. In particular, the Cramer–Rao lower bound is the inverse of the Fisher information defined as \\(\\mathcal{I}(\\theta)=-\\mathrm{E}(\\partial^2\\ln f(X;\\theta)/\\partial \\theta^2)\\). Hence, \\(\\mathrm{Var}(\\hat{\\theta})\\) can be estimated based on the observed Fisher information that can be written as \\(-\\sum_{i=1}^n \\partial^2\\ln f(X_i;\\theta)/\\partial \\theta^2\\). For many parametric distributions, the Fisher information may be derived analytically for the MLE of parameters. For more sophisticated parametric models, the Fisher information can be evaluated numerically using numerical integration for continuous distributions, or numerical summation for discrete distributions. 14.3.3 Confidence Interval Given that the MLE \\(\\hat{\\theta}\\) has either an exact or an approximate normal distribution with mean \\(\\theta\\) and variance \\(\\mathrm{Var}(\\hat{\\theta})\\), we may take the square root of the variance and plug-in the estimate to define \\(se(\\hat{\\theta}) = \\sqrt{\\mathrm{Var}(\\hat{\\theta})}\\). A standard error is an estimated standard deviation that quantifies the uncertainty in the estimation resulting from the use of a finite sample. Under some regularity conditions governing the population distribution, we may establish that the statistic \\[\\frac{\\hat{\\theta}-\\theta}{se(\\hat{\\theta})}\\] converges in distribution to a Student-\\(t\\) distribution with degrees of freedom (a parameter of the distribution) \\({n-p}\\), where \\(p\\) is the number of parameters in the model other than the variance. For example, for the normal distribution case, we have \\(p=1\\) for the parameter \\(\\mu\\); for a linear regression model with an independent variable, we have \\(p=2\\) for the parameters of the intercept and the independent variable. Denote by \\(t_{n-p}(1-\\alpha/2)\\) the \\(100\\times(1-\\alpha/2)\\)-th percentile of the Student-\\(t\\) distribution that satisfies \\(\\Pr\\left[t&lt; t_{n-p}\\left(1-{\\alpha}/{2}\\right) \\right]= 1-{\\alpha}/{2}\\). We have, \\[\\Pr\\left[-t_{n-p}\\left(1-\\frac{\\alpha}{2}\\right)&lt;\\frac{\\hat{\\theta}-\\theta}{se(\\hat{\\theta})}&lt; t_{n-p}\\left(1-\\frac{\\alpha}{2}\\right) \\right]= 1-{\\alpha},\\] from which we can derive a confidence interval for \\(\\theta\\). From the above equation we can derive a pair of statistics, \\(\\hat{\\theta}_1\\) and \\(\\hat{\\theta}_2\\), that provide an interval of the form \\([\\hat{\\theta}_1, \\hat{\\theta}_2]\\). This interval is a \\(1-\\alpha\\) confidence interval for \\(\\theta\\) such that \\(\\Pr\\left(\\hat{\\theta}_1 \\le \\theta \\le \\hat{\\theta}_2\\right) = 1-\\alpha,\\) where the probability \\(1-\\alpha\\) is referred to as the confidence level. Note that the above confidence interval is not valid for small samples, except for the case of the normal mean. Normal distribution. For the normal population mean \\(\\mu\\), the MLE has an exact sampling distribution \\(\\bar{X}\\sim N(\\mu,\\sigma/\\sqrt{n})\\), in which we can estimate \\(se(\\hat{\\theta})\\) by \\(\\hat{\\sigma}/\\sqrt{n}\\). Based on the Cochran’s theorem, the resulting statistic has an exact Student-\\(t\\) distribution with degrees of freedom \\(n-1\\). Hence, we can derive the lower and upper bounds of the confidence interval as \\[\\hat{\\mu}_1 = \\hat{\\mu} - t_{n-1}\\left(1-\\frac{\\alpha}{2}\\right)\\frac{ \\hat{\\sigma}}{\\sqrt{n}}\\] and \\[\\hat{\\mu}_2 = \\hat{\\mu} + t_{n-1}\\left(1-\\frac{\\alpha}{2}\\right)\\frac{ \\hat{\\sigma}}{\\sqrt{n}}.\\] When \\(\\alpha = 0.05\\), \\(t_{n-1}(1-\\alpha/2) \\approx 1.96\\) for large values of \\(n\\). Based on the Cochran’s theorem, the confidence interval is valid regardless of the sample size. Show Wisconsin Property Fund Example - Continued Example – Wisconsin Property Fund. For the lognormal claim model, (7.715235, 7.893208) is a 95% confidence interval for \\(\\mu\\). More details regarding interval estimation based the MLE of other parameters and distribution families are given in Appendix Chapter 16. 14.4 Hypothesis Testing In this section, you learn how to understand the basic concepts in hypothesis testing including the level of significance and the power of a test perform hypothesis testing such as a Student-\\(t\\) test based on the properties of the MLE construct a likelihood ratio test for a single parameter or multiple parameters from the same statistical model use information criteria such as the Akaike’s information criterion or the Bayesian information criterion to perform model selection For the parameter(s) \\(\\boldsymbol{\\theta}\\) from a parametric distribution, an alternative type of statistical inference is called hypothesis tesing that verifies whether a hypothesis regarding the parameter(s) is true, under a given probability called the level of significance \\(\\alpha\\) (e.g., 5%). In hypothesis testing, we reject the null hypothesis, a restrictive statement concerning the parameter(s), if the probability of observing a random sample as extremal as the observed one is smaller than \\(\\alpha\\), if the null hypothesis were true. 14.4.1 Basic Concepts In a statistical test, we are usually interested in testing whether a statement regarding some parameter(s), a null hypothesis (denoted \\(H_0\\)), is true given the observed data. The null hypothesis can take a general form \\(H_0:\\theta\\in\\Theta_0\\), where \\(\\Theta_0\\) is a subset of the parameter space \\(\\Theta\\) of \\(\\theta\\) that may contain multiple parameters. For the case with a single parameter \\(\\theta\\), the null hypothesis usually takes either the form \\(H_0:\\theta=\\theta_0\\) or \\(H_0:\\theta\\leq\\theta_0\\). The opposite of the null hypothesis is called the alternative hypothesis that can be written as \\(H_a:\\theta\\neq\\theta_0\\) or \\(H_a:\\theta&gt;\\theta_0\\). The statistical test on \\(H_0:\\theta=\\theta_0\\) is called a two-sided as the alternative hypothesis contains two ineqalities of \\(H_a:\\theta&lt;\\theta_0\\) or \\(\\theta&gt;\\theta_0\\). In contrast, the statistical test on either \\(H_0:\\theta\\leq\\theta_0\\) or \\(H_0:\\theta\\geq\\theta_0\\) is called a one-sided test. A statistical test is usually constructed based on a statistic \\(T\\) and its exact or large-sample distribution. The test typically rejects a two-sided test when either \\(T &gt; c_1\\) or \\(T &lt; c_2\\), where the two constants \\(c_1\\) and \\(c_2\\) are obtained based on the sampling distribution of \\(T\\) at a probability level \\(\\alpha\\) called the level of significance. In particular, the level of significance \\(\\alpha\\) satisfies \\[\\alpha=\\Pr(\\mbox{reject }H_0|H_0\\mbox{ is true}),\\] meaning that if the null hypothesis were true, we would reject the null hypothesis only 5% of the times, if we repeat the sampling process and perform the test over and over again. Thus, the level of significance is the probability of making a type I error (error of the first kind), the error of incorrectly rejecting a true null hypothesis. For this reason, the level of significance \\(\\alpha\\) is also referred to as the type I error rate. Another type of error we may make in hypothesis testing is the type II error (error of the second kind), the error of incorrectly accepting a false null hypothesis. Similarly, we can define the type II error rate as the probability of not rejecting (accepting) a null hypothesis given that it is not true. That is, the type II error rate is given by \\[\\Pr(\\mbox{accept }H_0|H_0\\mbox{ is false}).\\] Another important quantity concerning the quality of the statistical test is called the power of the test \\(\\beta\\), defined as the probability of rejecting a false null hypothesis. The mathematical definition of the power is \\[\\beta=\\Pr(\\mbox{reject }H_0|H_0\\mbox{ is false}).\\] Note that the power of the test is typically calculated based on a specific alternative value of \\(\\theta=\\theta_a\\), given a specific sampling distribution and a given sample size. In real experimental studies, people usually calculate the required sample size in order to choose a sample size that will ensure a large chance of obtaining a statistically significant test (i.e., with a prespecified statistical power such as 85%). 14.4.2 Student-\\(t\\) test based on MLE Based on the results from Section 14.3.1, we can define a Student \\(t\\) test for testing \\(H_0:\\theta=\\theta_0\\). In particular, we define the test statistic as \\[t\\text{-stat}=\\frac{\\hat{\\theta}-\\theta_0}{se(\\hat{\\theta})},\\] which has a large-sample distribution of a Student-\\(t\\) distribution with degrees of freedom \\({n-p}\\), when the null hypothesis is true (i.e., when \\(\\theta=\\theta_0\\)). For a given level of significance \\(\\alpha\\), say 5%, we reject the null hypothesis if the event \\(t\\text{-stat}&lt;-t_{n-p}\\left(1-{\\alpha}/{2}\\right)\\) or \\(t\\text{-stat}&gt; t_{n-p}\\left(1-{\\alpha}/{2}\\right)\\) occurs (the rejection region). Under the null hypothesis \\(H_0\\), we have \\[\\Pr\\left[t\\text{-stat}&lt;-t_{n-p}\\left(1-\\frac{\\alpha}{2}\\right)\\right]=\\Pr\\left[t\\text{-stat}&gt; t_{n-p}\\left(1-\\frac{\\alpha}{2}\\right) \\right]= \\frac{\\alpha}{2}.\\] In addition to the concept of rejection region, we may reject the test based on the \\(p\\)-value defined as \\(2\\Pr(T&gt;|t\\text{-stat}|)\\) for the aforementioned two-sided test, where the random variable \\(T\\sim T_{n-p}\\). We reject the null hypothesis if \\(p\\)-value is smaller than and equal to \\(\\alpha\\). For a given sample, a \\(p\\)-value is defined to be the smallest significance level for which the null hypothesis would be rejected. Similarly, we can construct a one-sided test for the null hypothesis \\(H_0:\\theta\\leq\\theta_0\\) (or \\(H_0:\\theta\\geq\\theta_0\\)). Using the same test statistic, we reject the null hypothesis when \\(t\\text{-stat}&gt; t_{n-p}\\left(1-{\\alpha}\\right)\\) (or \\(t\\text{-stat}&lt;- t_{n-p}\\left(1-{\\alpha}\\right)\\) for the test on \\(H_0:\\theta\\geq\\theta_0\\)). The corresponding \\(p\\)-value is defined as \\(\\Pr(T&gt;|t\\text{-stat}|)\\) (or \\(\\Pr(T&lt;|t\\text{-stat}|)\\) for the test on \\(H_0:\\theta\\geq\\theta_0\\)). Note that the test is not valid for small samples, except for the case of the test on the normal mean. One-sample \\(t\\) Test for Normal Mean. For the test on the normal mean of the form \\(H_0:\\mu=\\mu_0\\), \\(H_0:\\mu\\leq\\mu_0\\) or \\(H_0:\\mu\\geq\\mu_0\\), we can define the test statistic as \\[t\\text{-stat}=\\frac{\\bar{X}-\\mu_0}{{\\hat{\\sigma}}/{\\sqrt{n}}},\\] for which we have an exact sampling distribution \\(t\\text{-stat}\\sim T_{n-1}\\) from the Cochran’s theorem, with \\(T_{n-1}\\) denoting a Student-\\(t\\) distribution with degrees of freedom \\(n-1\\). According to the Cochran’s theorem, the test is valid for both small and large samples. Show Wisconsin Property Fund Example - Continued Example – Wisconsin Property Fund. Assume that mean logarithmic claims have historically been approximately by \\(\\mu_0 = \\ln(5000)= 8.517\\). We might want to use the 2010 data to assess whether the mean of the distribution has changed (a two-sided test), or whether it has increased (a one-sided test). Given the actual 2010 average \\(\\hat{\\mu} =7.804\\), we may use the one-sample \\(t\\) test to assess whether this is a significant departure from \\(\\mu_0 = 8.517\\) (i.e., in testing \\(H_0:\\mu=8.517\\)). The test statistic \\(t\\text{-stat}=(8.517-7.804)/(1.683/\\sqrt{1377}) = 15.72&gt;t_{1376}\\left(0.975\\right)\\). Hence, we reject the two-sided test at \\(\\alpha=5\\%\\). Similarly, we will reject the one-sided test at \\(\\alpha=5\\%\\). Show Wisconsin Property Fund Example - Continued Example – Wisconsin Property Fund. For numerical stability and extensions to regression applications, statistical packages often work with transformed versions of parameters. The following estimates are from the R package VGAM (the function). More details on the MLE of other distribution families are given in Appendix Chapter 16. Distribution Parameter Standard \\(t\\)-stat Estimate Error Gamma 10.190 0.050 203.831 -1.236 0.030 -41.180 Lognormal 7.804 0.045 172.089 0.520 0.019 27.303 Pareto 7.733 0.093 82.853 -0.001 0.054 -0.016 GB2 2.831 1.000 2.832 1.203 0.292 4.120 6.329 0.390 16.220 1.295 0.219 5.910 14.4.3 Likelihood Ratio Test In the previous subsection, we have introduced the Student-\\(t\\) test on a single parameter, based on the properties of the MLE. In this section, we define an alternative test called the likelihood ratio test (LRT). The LRT may be used to test multiple parameters from the same statistical model. Given the likelihood function \\(L(\\theta|\\mathbf{x})\\) and \\(\\Theta_0 \\subset \\Theta\\), the likelihood ratio test statistic for testing \\(H_0:\\theta\\in\\Theta_0\\) against \\(H_a:\\theta\\notin\\Theta_0\\) is given by \\[L=\\frac{\\sup_{\\theta\\in\\Theta_0}L(\\theta|\\mathbf{x})}{\\sup_{\\theta\\in\\Theta}L(\\theta|\\mathbf{x})},\\] and that for testing \\(H_0:\\theta=\\theta_0\\) versis \\(H_a:\\theta\\neq\\theta_0\\) is \\[L=\\frac{L(\\theta_0|\\mathbf{x})}{\\sup_{\\theta\\in\\Theta}L(\\theta|\\mathbf{x})}.\\] The LRT rejects the null hypothesis when \\(L &lt; c\\), with the threshold depending on the level of significance \\(\\alpha\\), the sample size \\(n\\), and the number of parameters in \\(\\theta\\). Based on the Neyman–Pearson Lemma, the LRT is the uniformly most powerful (UMP) test for testing \\(H_0:\\theta=\\theta_0\\) versis \\(H_a:\\theta=\\theta_a\\). That is, it provides the largest power \\(\\beta\\) for a given \\(\\alpha\\) and a given alternative value \\(\\theta_a\\). Based on the Wilks’s Theorem, the likelihood ratio test statistic \\(-2\\ln(L)\\) converges in distribution to a Chi-square distribution with the degree of freedom being the difference between the dimensionality of the parameter spaces \\(\\Theta\\) and \\(\\Theta_0\\), when the sample size goes to infinity and when the null model is nested within the alternative model. That is, when the null model is a special case of the alternative model containing a restricted sample space, we may approximate \\(c\\) by \\(\\chi^2_{p_1 - p_2}(1-\\alpha)\\), the \\(100\\times(1-\\alpha)\\) th percentile of the Chi-square distribution, with \\(p_1-p_2\\) being the degrees of freedom, and \\(p_1\\) and \\(p_2\\) being the numbers of parameters in the alternative and null models, respectively. Note that the LRT is also a large-sample test that will not be valid for small samples. 14.4.4 Information Criteria In real-life applications, the LRT has been commonly used for comparing two nested models. The LRT approach as a model selection tool, however, has two major drawbacks: 1) It typically requires the null model to be nested within the alternative model; 2) models selected from the LRT tends to provide in-sample over-fitting, leading to poor out-of-sample prediction. In order to overcome these issues, model selection based on information criteria, applicable to non-nested models while taking into consideration the model complexity, is more widely used for model selection. Here, we introduce the two most widely used criteria, the Akaike’s information criterion and the Bayesian information criterion. In particular, the Akaike’s information criterion (\\(AIC\\)) is defined as \\[AIC = -2\\ln L(\\hat{\\boldsymbol \\theta}) + 2p,\\] where \\(\\hat{\\boldsymbol \\theta}\\) denotes the MLE of \\({\\boldsymbol \\theta}\\), and \\(p\\) is the number of parameters in the model. The additional term \\(2 p\\) represents a penalty for the complexity of the model. That is, with the same maximized likelihood function, the \\(AIC\\) favors model with less parameters. We note that the \\(AIC\\) does not consider the impact from the sample size \\(n\\). Alternatively, people use the Bayesian information criterion (\\(BIC\\)) that takes into consideration the sample size. The \\(BIC\\) is defined as \\[BIC = -2\\ln L(\\hat{\\boldsymbol \\theta}) + p\\,\\ln(n).\\] We observe that the \\(BIC\\) generally puts a higher weight on the number of parameters. With the same maximized likelihood function, the \\(BIC\\) will suggest a more parsimonious model than the \\(AIC\\). Show Wisconsin Property Fund Example - Continued Example – Wisconsin Property Fund. Both the \\(AIC\\) and \\(BIC\\) statistics suggest that the GB2 is the best fitting model whereas gamma is the worst. Distribution AIC BIC Gamma 28,305.2 28,315.6 Lognormal 26,837.7 26,848.2 Pareto 26,813.3 26,823.7 GB2 26,768.1 26,789.0 In this graph, black represents actual (smoothed) logarithmic claims Best approximated by green which is fitted GB2 Pareto (purple) and Lognormal (lightblue) are also pretty good Worst are the exponential (in red) and gamma (in dark blue) Figure 14.2: Fitted Claims Distribution ## Sample size: 6258 Show R Code R Code for Fitted Claims Distributions # R Code to fit several claims distributions ClaimLev &lt;- read.csv(&quot;Data/CLAIMLEVEL.csv&quot;, header=TRUE); nrow(ClaimLev) ClaimData&lt;-subset(ClaimLev,Year==2010); #Use &quot;VGAM&quot; library for estimation of parameters library(VGAM) fit.LN &lt;- vglm(Claim ~ 1, family=lognormal, data = ClaimData) fit.gamma &lt;- vglm(Claim ~ 1, family=gamma2, data = ClaimData) theta.gamma&lt;-exp(coef(fit.gamma)[1])/exp(coef(fit.gamma)[2]) alpha.gamma&lt;-exp(coef(fit.gamma)[2]) fit.exp &lt;- vglm(Claim ~ 1, exponential, data = ClaimData) fit.pareto &lt;- vglm(Claim ~ 1, paretoII, loc=0, data = ClaimData) ################################################### # Inference assuming a GB2 Distribution - this is more complicated # The likelihood functon of GB2 distribution (negative for optimization) likgb2 &lt;- function(param) { a1 &lt;- param[1] a2 &lt;- param[2] mu &lt;- param[3] sigma &lt;- param[4] yt &lt;- (log(ClaimData$Claim)-mu)/sigma logexpyt&lt;-ifelse(yt&gt;23,yt,log(1+exp(yt))) logdens &lt;- a1*yt - log(sigma) - log(beta(a1,a2)) - (a1+a2)*logexpyt -log(ClaimData$Claim) return(-sum(logdens)) } # &quot;optim&quot; is a general purpose minimization function gb2bop &lt;- optim(c(1,1,0,1),likgb2,method=c(&quot;L-BFGS-B&quot;), lower=c(0.01,0.01,-500,0.01),upper=c(500,500,500,500),hessian=TRUE) ################################################### # Plotting the fit using densities (on a logarithmic scale) plot(density(log(ClaimData$Claim)), ylim=c(0,0.36),main=&quot;&quot;, xlab=&quot;Log Expenditures&quot;) x &lt;- seq(0,15,by=0.01) fexp_ex = dgamma(exp(x), scale = exp(-coef(fit.exp)), shape = 1)*exp(x) lines(x,fexp_ex, col=&quot;red&quot;) fgamma_ex = dgamma(exp(x), shape = alpha.gamma, scale=theta.gamma)*exp(x) lines(x,fgamma_ex,col=&quot;blue&quot;) fpareto_ex = dparetoII(exp(x),loc=0,shape = exp(coef(fit.pareto)[2]), scale = exp(coef(fit.pareto)[1]))*exp(x) lines(x,fpareto_ex,col=&quot;purple&quot;) flnorm_ex = dlnorm(exp(x), mean = coef(fit.LN)[1], sd = exp(coef(fit.LN)[2]))*exp(x) lines(x,flnorm_ex, col=&quot;lightblue&quot;) # density for GB II gb2density &lt;- function(x){ a1 &lt;- gb2bop$par[1] a2 &lt;- gb2bop$par[2] mu &lt;- gb2bop$par[3] sigma &lt;- gb2bop$par[4] xt &lt;- (log(x)-mu)/sigma logexpxt&lt;-ifelse(xt&gt;23,yt,log(1+exp(xt))) logdens &lt;- a1*xt - log(sigma) - log(beta(a1,a2)) - (a1+a2)*logexpxt -log(x) exp(logdens) } fGB2_ex = gb2density(exp(x))*exp(x) lines(x,fGB2_ex, col=&quot;green&quot;) Contributors Lei (Larry) Hua, Northern Illinois University, and Edward W. (Jed) Frees, University of Wisconsin-Madison, are the principal authors of the initial version of this chapter. Email: lhua@niu.edu or jfrees@bus.wisc.edu for chapter comments and suggested improvements. "],
["C-AppB.html", "Chapter 15 Appendix B: Iterated Expectations 15.1 Conditional Distribution and Conditional Expectation 15.2 Iterated Expectations and Total Variance 15.3 Conjugate Distributions", " Chapter 15 Appendix B: Iterated Expectations This appendix introduces the laws related to iterated expectations. In particular, Section 15.1 introduces the concepts of conditional distribution and conditional expectation. Section 15.2 introduces the Law of Iterated Expectations and the Law of Total Variance. In some situations, we only observe a single outcome but can conceptualize an outcome as resulting from a two (or more) stage process. Such types of statistical models are called two-stage, or hierarchical models. Some special cases of hierarchical models include: models where the parameters of the distribution are random variables; mixture distribution, where Stage 1 represents the draw of a sub-population and Stage 2 represents a random variable from a distribution that is determined by the sub-population drew in Stage 1; an aggregate distribution, where Stage 1 represents the draw of the number of events and Stage two represents the loss amount occurred per event. In these situations, the process gives rise to a conditional distribution of a random variable (the Stage 2 outcome) given the other (the Stage 1 outcome). The Law of Iterated Expectations can be useful for obtaining the unconditional expectation or variance of a random variable in such cases. 15.1 Conditional Distribution and Conditional Expectation In this section, you learn the concepts related to the conditional distribution of a random variable given another how to define the conditional expectation and variance based on the conditional distribution function The iterated expectations are the laws regarding calculation of the expectation and variance of a random variable using a conditional distribution of the variable given another variable. Hence, we first introduce the concepts related to the conditional distribution, and the calculation of the conditional expectation and variable based on a given conditional distribution. 15.1.1 Conditional Distribution Here we introduce the concept of conditional distribution respectively for discrete and continuous random variables. 15.1.1.1 Discrete Case Suppose that \\(X\\) and \\(Y\\) are both discrete random variables, meaning that they can take a finite or countable number of possible values with a positive probability. The joint probability (mass) function of (\\(X\\), \\(Y\\)) is defined as \\[p(x,y) = \\Pr[X=x, Y=y]\\]. When \\(X\\) and \\(Y\\) are independent (the value of \\(X\\) does not depend on that of \\(Y\\)), we have \\[p(x,y)=p(x)p(y),\\] with \\(p(x)=\\Pr[X=x]\\) and \\(p(y)=\\Pr[Y=y]\\) being the marginal probability function of \\(X\\) and \\(Y\\), respectively. Given the joint probability function, we may obtain the marginal probability functions of \\(Y\\) as \\[p(y)=\\sum_x p(x,y),\\] where the summation is over all possible values of \\(x\\), and the marginal probability function of \\(X\\) can be obtained in a similar manner. The conditional probability (mass) function of \\((Y|X)\\) is defined as \\[p(y|x) =\\Pr[Y=y|X=x]= \\frac{p(x,y)}{\\Pr[X=x]},\\] where we may obtain the conditional probability function of \\((X|Y)\\) in a similar manner. In particular, the above conditional probability represents the probability of the event \\(Y=y\\) given the event \\(X=x\\). Hence, even in cases where \\(\\Pr[X=x]=0\\), the function may be given as a particular form, in real applications. 15.1.1.2 Continuous Case For continuous random variables \\(X\\) and \\(Y\\), we may define their joint probability (density) function based on the joint cumulative distribution function. The joint cumulative distribution function of (\\(X\\), \\(Y\\)) is defined as \\[F(x,y) = \\Pr[X\\leq x, Y\\leq y].\\] When \\(X\\) and \\(Y\\) are independent, we have \\[F(x,y)=F(x)F(y),\\] with \\(F(x)=\\Pr[X\\leq x]\\) and \\(F(y)=\\Pr[Y\\leq y]\\) being the cumulative distribution function (cdf) of \\(X\\) and \\(Y\\), respectively. The random variable \\(X\\) is referred to as a continuous random variable if its cdf is continuous on \\(x\\). When the cdf \\(F(x)\\) is continuous on \\(x\\), then we define \\(f(x)=\\partial F(x)/\\partial x\\) as the (marginal) probability density function (pdf) of \\(X\\). Similarly, if the joint cdf \\(F(x,y)\\) is continuous on both \\(x\\) and \\(y\\), we define \\[f(x,y)=\\frac{\\partial^2 F(x,y)}{\\partial x\\partial y}\\] as the joint probability density function of (\\(X\\), \\(Y\\)), in which case we refer to the random variables as jointly continuous. When \\(X\\) and \\(Y\\) are independent, we have \\[f(x,y)=f(x)f(y).\\] Given the joint density function, we may obtain the marginal density function of \\(Y\\) as \\[f(y)=\\int_x f(x,y)\\,dx,\\] where the integral is over all possible values of \\(x\\), and the marginal probability function of \\(X\\) can be obtained in a similar manner. Based on the joint pdf and the marginal pdf, we define the conditional probability density function of \\((Y|X)\\) as \\[f(y|x) = \\frac{f(x,y)}{f(x)},\\] where we may obtain the conditional probability function of \\((X|Y)\\) in a similar manner. Here, the conditional density function is the density function of \\(y\\) given \\(X=x\\). Hence, even in cases where \\(\\Pr[X=x]=0\\) or when \\(f(x)\\) is not defined, the function may be given in a particular form in real applications. 15.1.2 Conditional Expectation and Conditional Variance Now we define the conditional expectation and variance based on the conditional distribution defined in the previous subsection. 15.1.2.1 Discrete Case For a discrete random variable \\(Y\\), its expectation is defined as \\(\\mathrm{E}[Y]=\\sum_y y\\,p(y)\\) if its value is finite, and its variance is defined as \\(\\mathrm{Var}[Y]=\\mathrm{E}\\{(Y-\\mathrm{E}[Y])^2\\}=\\sum_y y^2\\,p(y)-\\{\\mathrm{E}[Y]\\}^2\\) if its value is finite. For a discrete random variable \\(Y\\), the conditional expectation of the random variable \\(Y\\) given the event \\(X=x\\) is defined as \\[\\mathrm{E}[Y|X=x]=\\sum_y y\\,p(y|x),\\] where \\(X\\) does not have to be a discrete variable, as far as the conditional probability function \\(p(y|x)\\) is given. Note that the conditional expectation \\(\\mathrm{E}[Y|X=x]\\) is a fixed number. When we replace \\(x\\) with \\(X\\) on the right hand side of the above equation, we can define the expectation of \\(Y\\) given the random variable \\(X\\) as \\[\\mathrm{E}[Y|X]=\\sum_y y\\,p(y|X),\\] which is still a random variable, and the randomness comes from \\(X\\). In a similar manner, we can define the conditional variance of the random variable \\(Y\\) given the event \\(X=x\\) as \\[\\mathrm{Var}[Y|X=x]=\\mathrm{E}[Y^2|X=x]-\\{\\mathrm{E}[Y|X=x]\\}^2=\\sum_y y^2\\,p(y|x)-\\{\\mathrm{E}[Y|X=x]\\}^2.\\] The variance of \\(Y\\) given \\(X\\), \\(\\mathrm{Var}[Y|X]\\) can be defined by replacing \\(x\\) by \\(X\\) in the above equation, and \\(\\mathrm{Var}[Y|X]\\) is still a random variable and the randomness comes from \\(X\\). 15.1.2.2 Continuous Case For a continuous random variable \\(Y\\), its expectation is defined as \\(\\mathrm{E}[Y]=\\int_y y\\,f(y)dy\\) if the integral exists, and its variance is defined as \\(\\mathrm{Var}[Y]=\\mathrm{E}\\{(X-\\mathrm{E}[Y])^2\\}=\\int_y y^2\\,f(y)dy-\\{\\mathrm{E}[Y]\\}^2\\) if its value is finite. For jointly continuous random variables \\(X\\) and \\(Y\\), the conditional expectation of the random variable \\(Y\\) given \\(X=x\\) is defined as \\[\\mathrm{E}[Y|X=x]=\\int_y y\\,f(y|x)dy.\\] where \\(X\\) does not have to be a continuous variable, as far as the conditional probability function \\(f(y|x)\\) is given. Similarly, the conditional expectation \\(\\mathrm{E}[Y|X=x]\\) is a fixed number. When we replace \\(x\\) with \\(X\\) on the right-hand side of the above equation, we can define the expectation of \\(Y\\) given the random variable \\(X\\) as \\[\\mathrm{E}[Y|X]=\\int_y y\\,p(y|X)\\,dy,\\] which is still a random variable, and the randomness comes from \\(X\\). In a similar manner, we can define the conditional variance of the random variable \\(Y\\) given the event \\(X=x\\) as \\[\\mathrm{Var}[Y|X=x]=\\mathrm{E}[Y^2|X=x]-\\{\\mathrm{E}[Y|X=x]\\}^2=\\int_y y^2\\,f(y|x)\\,dy-\\{\\mathrm{E}[Y|X=x]\\}^2.\\] The variance of \\(Y\\) given \\(X\\), \\(\\mathrm{Var}[Y|X]\\) can then be defined by replacing \\(x\\) by \\(X\\) in the above equation, and similarly \\(\\mathrm{Var}[Y|X]\\) is also a random variable and the randomness comes from \\(X\\). 15.2 Iterated Expectations and Total Variance In this section, you learn the Law of Iterated Expectations for calculating the expectation of a random variable based on its conditional distribution given another random variable the Law of Total Variance for calculating the variance of a random variable based on its conditional distribution given another random variable how to calculate the expectation and variance based on an example of a two-stage model 15.2.1 Law of Iterated Expectations Consider two random variables \\(X\\) and \\(Y\\), and \\(h(X,Y)\\), a random variable depending on the function \\(h\\), \\(X\\) and \\(Y\\). Assuming all the expectations exist and are finite, the Law of Iterated Expectations states that \\[\\mathrm{E}[h(X,Y)]= \\mathrm{E} \\left\\{ \\mathrm{E} \\left[ h(X,Y) | X \\right] \\right \\},\\] where the first (inside) expectation is taken with respect to the random variable \\(Y\\) and the second (outside) expectation is taken with respect to \\(X\\). For the Law of Iterated Expectations, the random variables may be discrete, continuous, or a hybrid combination of the two. We use the example of discrete variables of \\(X\\) and \\(Y\\) to illustrate the calculation of the unconditional expectation using the Law of Iterated Expectations. For continuous random variables, we only need to replace the summation with the integral, as illustrated earlier in the appendix. Given \\(p(y|x)\\) the joint pmf of \\(X\\) and \\(Y\\), the conditional expectation of \\(h(X,Y)\\) given the event \\(X=x\\) is defined as \\[\\mathrm{E} \\left[ h(X,Y) | X=x \\right] = \\sum_y h(x,y) p(y|x),\\] and the conditional expectation of \\(h(X,Y)\\) given \\(X\\) being a random variable can be written as \\[\\mathrm{E} \\left[ h(X,Y) | X \\right] = \\sum_y h(X,y) p(y|X).\\] The unconditional expectation of \\(h(X,Y)\\) can then be obtained by taking the expectation of \\(\\mathrm{E} \\left[ h(X,Y) | X \\right]\\) with respect to the random variable \\(X\\). That is, we can obtain \\(\\mathrm{E}[ h(X,Y)]\\) as \\[\\begin{aligned} \\mathrm{E} \\left\\{ \\mathrm{E} \\left[ h(X,Y) | X \\right] \\right \\} &amp;= \\sum_x \\left\\{\\sum_y h(x,y) p(y|x) \\right \\} p(x) \\\\ &amp;= \\sum_x \\sum_y h(x,y) p(y|x)p(x) \\\\ &amp;= \\sum_x \\sum_y h(x,y) p(x,y) = \\mathrm{E}[h(X,Y)] \\end{aligned}.\\] The Law of Iterated Expectations for the continuous and hybrid cases can be proved in a similar manner, by replacing the corresponding summation(s) by integral(s). 15.2.2 Law of Total Variance Assuming that all the variances exist and are finite, the Law of Total Variance states that \\[\\mathrm{Var}[h(X,Y)]= \\mathrm{E} \\left\\{ \\mathrm{Var} \\left[h(X,Y) | X \\right] \\right \\} +\\mathrm{Var} \\left\\{ \\mathrm{E} \\left[ h(X,Y) | X \\right] \\right \\},\\] where the first (inside) expectation/variance is taken with respect to the random variable \\(Y\\) and the second (outside) expectation/variance is taken with respect to \\(X\\). Thus, the unconditional variance equals to the expectation of the conditional variance plus the variance of the conditional expectation. Show Technical Detail In order to verify this rule, first note that we can calculate a conditional variance as \\[\\mathrm{Var} \\left[ h(X,Y) | X \\right] = \\mathrm{E} [ h(X,Y)^2 | X ] -\\left\\{\\mathrm{E} \\left[ h(X,Y) | X \\right] \\right\\}^2.\\] From this, the expectation of the conditional variance is \\[\\begin{align} \\mathrm{E}\\{\\mathrm{Var} \\left[ h(X,Y) | X \\right] \\} &amp;= \\mathrm{E}\\left\\{\\mathrm{E} \\left[ h(X,Y)^2 | X \\right] \\right\\} - \\mathrm{E}\\left(\\left\\{\\mathrm{E} \\left[ h(X,Y) | X \\right] \\right\\}^2\\right) \\notag \\\\ &amp;=\\mathrm{E} \\left[ h(X,Y)^2\\right] - \\mathrm{E}\\left(\\left\\{\\mathrm{E} \\left[ h(X,Y) | X \\right] \\right\\}^2\\right).\\tag{15.1} \\end{align}\\] Further, note that the conditional expectation, \\(\\mathrm{E} \\left[ h(X,Y) | X \\right]\\), is a function of \\(X\\), denoted \\(g(X)\\). Thus, \\(g(X)\\) is a random variable with mean \\(\\mathrm{E}[h(X,Y)]\\) and variance \\[\\begin{align} \\mathrm{Var} \\left\\{ \\mathrm{E} \\left[ h(X,Y) | X \\right] \\right \\} &amp;=\\mathrm{Var}[g(X)] \\notag \\\\ &amp;= \\mathrm{E}[g(X)^2]\\ - \\left\\{\\mathrm{E}[g(X)]\\right\\}^2 \\nonumber\\\\ &amp;= \\mathrm{E}\\left(\\left\\{\\mathrm{E} \\left[ h(X,Y) | X \\right] \\right\\}^2\\right) - \\left\\{\\mathrm{E}[h(X,Y)]\\right\\}^2.\\tag{15.2} \\end{align}\\] Thus, adding Equations (15.1) and (15.2) leads to the unconditional variance \\(\\mathrm{Var} \\left[ h(X,Y) \\right]\\). 15.2.3 Application To apply the Law of Iterated Expectations and the Law of Total Variance, we generally adopt the following procedure. Identify the random variable that is being conditioned upon, typically a stage 1 outcome (that is not observed). Conditional on the stage 1 outcome, calculate summary measures such as a mean, variance, and the like. There are several results of the step 2, one for each stage 1 outcome. Then, combine these results using the iterated expectations or total variance rules. Mixtures of Finite Populations. Suppose that the random variable \\(N_1\\) represents a realization of the number of claims in a policy year from the population of good drivers and \\(N_2\\) represents that from the population of bad drivers. For a specific driver, there is a probability \\(\\alpha\\) that (s)he is a good driver. For a specific draw \\(N\\), we have \\[N = \\begin{cases} N_1, &amp; \\text{if (s)he is a good driver;}\\\\ N_2, &amp; \\text{otherwise}.\\\\ \\end{cases}\\] Let \\(T\\) be the indicator whether (s)he is a good driver, with \\(T=1\\) representing that the driver is a good driver with \\(\\Pr[T=1]=\\alpha\\) and \\(T=2\\) representing that the driver is a bad driver with \\(\\Pr[T=2]=1-\\alpha\\). From the Law of Iterated Expectations, we can obtain the expected number of claims as \\[ \\mathrm{E}[N]= \\mathrm{E} \\left\\{ \\mathrm{E} \\left[ N | T \\right] \\right \\}= \\mathrm{E}[N_1] \\times \\alpha + \\mathrm{E}[N_2] \\times (1-\\alpha).\\] From the Law of Total Variance, we can obtain the variance of \\(N\\) as \\[\\mathrm{Var}[N]= \\mathrm{E} \\left\\{ \\mathrm{Var} \\left[ N | T \\right] \\right \\} +\\mathrm{Var} \\left\\{ \\mathrm{E} \\left[ N | T \\right] \\right \\}.\\] To be more concrete, suppose that \\(N_j\\) follows a Poisson distribution with the mean \\(\\lambda_j\\), \\(j=1,2\\). Then we have \\[\\mathrm{Var}[N|T=j]= \\mathrm{E}[N|T=j] = \\lambda_j, \\quad j = 1,2.\\] Thus, we can derive the expectation of the conditional variance as \\[\\mathrm{E} \\left\\{ \\mathrm{Var} \\left[ N | T \\right] \\right \\} = \\alpha \\lambda_1+ (1-\\alpha) \\lambda_2\\] and the variance of the conditional expectation as \\[\\mathrm{Var} \\left\\{ \\mathrm{E} \\left[ N | T \\right] \\right \\} = (\\lambda_1-\\lambda_2)^2 \\alpha (1-\\alpha).\\] Note that the later is the variance for a Bernoulli with outcomes \\(\\lambda_1\\) and \\(\\lambda_2\\), and the binomial probability \\(\\alpha\\). Based on the Law of Total Variance, the unconditional variance of \\(N\\) is given by \\[\\mathrm{Var}[N]= \\alpha \\lambda_1+ (1-\\alpha) \\lambda_2 + (\\lambda_1-\\lambda_2)^2 \\alpha (1-\\alpha).\\] 15.3 Conjugate Distributions As described in Section 4.4.1, for conjugate distributions the posterior and the prior come from the same family of distributions. In insurance applications, this broadly occurs in a “family of distribution familes” known as the linear exponential family which we introduce first. 15.3.1 Linear Exponential Family Definition. The distribution of the linear exponential family is \\[\\begin{equation} f( x; \\gamma ,\\theta ) = \\exp \\left( \\frac{x\\gamma -b(\\gamma )}{\\theta} +S\\left( x,\\theta \\right) \\right). \\end{equation}\\] Here, \\(x\\) is a dependent variable and \\(\\gamma\\) is the parameter of interest. The quantity \\(\\theta\\) is a scale parameter. The term \\(b(\\gamma)\\) depends only on the parameter \\(\\gamma\\), not the dependent variable. The statistic \\(S\\left(x,\\theta \\right)\\) is a function of the dependent variable and the scale parameter, not the parameter \\(\\gamma\\). The dependent variable \\(x\\) may be discrete, continuous or a hybrid combination of the two. Thus, \\(f\\left( .\\right)\\) may be interpreted to be a density or mass function, depending on the application. The following table provides several examples, including the normal, binomial and Poisson distributions. \\[ {\\small \\begin{matrix} \\text{Selected Distributions of the Linear Exponential Family}\\\\ \\begin{array}{l|ccccc} \\hline &amp; &amp; \\text{Density or} &amp; &amp; &amp; \\\\ \\text{Distribution} &amp; \\text{Parameters} &amp; \\text{Mass Function} &amp; \\text{Components} \\\\ \\hline \\text{General} &amp; \\gamma,~ \\theta &amp; \\exp \\left( \\frac{x\\gamma -b(\\gamma )}{\\theta} +S\\left( x,\\theta \\right) \\right) &amp; \\gamma,~ \\theta, b(\\gamma), S(x, \\theta)\\\\ \\text{Normal} &amp; \\mu, \\sigma^2 &amp; \\frac{1}{\\sigma \\sqrt{2\\pi }}\\exp \\left(-\\frac{(x-\\mu )^{2}}{2\\sigma ^{2}}\\right) &amp; \\mu, \\sigma^2, \\frac{\\gamma^2}{2}, - \\left(\\frac{x^2}{2\\theta} + \\frac{\\ln(2 \\pi \\theta)}{2} \\right) \\\\ \\text{Binomal} &amp; \\pi &amp; {n \\choose x} \\pi ^x (1-\\pi)^{n-x} &amp; \\ln \\left(\\frac{\\pi}{1-\\pi} \\right), 1, n \\ln(1+e^{\\gamma} ), \\\\ &amp; &amp; &amp; \\ln {n \\choose x} \\\\ \\text{Poisson} &amp; \\lambda &amp; \\frac{\\lambda^x}{x!} \\exp(-\\lambda) &amp; \\ln \\lambda, 1, e^{\\gamma}, - \\ln (x!) \\\\ \\text{Negative } &amp; r,p &amp; \\frac{\\Gamma(x+r)}{x!\\Gamma(r)} p^r ( 1-p)^x &amp; \\ln(1-p), 1, -r \\ln(1-e^{\\gamma}), \\\\ ~~~\\text{Binomial}^{\\ast} &amp; &amp; &amp; ~~~\\ln \\left[ \\frac{\\Gamma(x+r)}{x! \\Gamma(r)} \\right] \\\\ \\text{Gamma} &amp; \\alpha, \\theta &amp; \\frac{1}{\\Gamma (\\alpha)\\theta ^ \\alpha} x^{\\alpha -1 }\\exp(-x/ \\theta) &amp; - \\frac{1}{\\alpha \\gamma}, \\frac{1}{\\alpha}, - \\ln ( - \\gamma), -\\theta^{-1} \\ln \\theta \\\\ &amp; &amp; &amp; - \\ln \\left( \\Gamma(\\theta ^{-1}) \\right) + (\\theta^{-1} - 1) \\ln x &amp; &amp; \\\\ \\hline \\end{array}\\\\ ^{\\ast} \\text{This assumes that the parameter r is fixed but need not be an integer.}\\\\ \\end{matrix} } \\] The Tweedie (see Section ??) and inverse Gaussian distributions are also members of the linear exponential family. The linear exponential family of distribution families is extensively used as the basis of generalized linear models as described in, for example, Edward W. Frees (2009a). 15.3.2 Conjugate Distributions Now assume that the parameter \\(\\gamma\\) is random with distribution \\(\\pi(\\gamma, \\tau)\\), where \\(\\tau\\) is a vector of parameters that describe the distribution of \\(\\gamma\\). In Bayesian models, the distribution \\(\\pi\\) is known as the prior and reflects our belief or information about \\(\\gamma\\). The likelihood \\(f(x|\\gamma)\\) is a probability conditional on \\(\\gamma\\). The distribution of \\(\\gamma\\) with knowledge of the random variables, \\(\\pi(\\gamma,\\tau| x)\\), is called the posterior distribution. For a given likelihood distribution, priors and posteriors that come from the same parametric family are known as conjugate families of distributions. For a linear exponential likelihood, there exists a natural conjugate family. Specifically, consider a likelihood of the form \\(f(x|\\gamma) = \\exp \\left\\{(x\\gamma -b(\\gamma))/\\theta\\right\\} \\exp \\left\\{S\\left( x,\\theta \\right) \\right\\}\\). For this likelihood, define the prior distribution \\[ \\pi(\\gamma,\\tau) = C \\exp\\left\\{ \\gamma a_1(\\tau) - b(\\gamma)a_2(\\tau))\\right\\}, \\] where \\(C\\) is a normalizing constant. Here, \\(a_1(\\tau)=a_1\\) and \\(a_2(\\tau)=a_2\\) are functions of the parameters \\(\\tau\\) although we simplify the notation by dropping explicit dependence on \\(\\tau\\). The joint distribution of \\(x\\) and \\(\\gamma\\) is given by \\(f(x,\\gamma) = f(x|\\gamma) \\pi(\\gamma,\\tau)\\). Using Bayes Theorem, the posterior distribution is \\[ \\pi(\\gamma,\\tau|x) = C_1 \\exp\\left\\{ \\gamma \\left( a_1+\\frac{x}{\\theta}\\right) - b(\\gamma)\\left( a_2+\\frac{1}{\\theta}\\right)\\right\\}, \\] where \\(C_1\\) is a normalizing constant. Thus, we see that \\(\\pi(\\gamma,\\tau|x)\\) has the same form as \\(\\pi(\\gamma,\\tau)\\). Special case. Poisson-Gamma Model. Consider a Poisson likelihood so that \\(b(\\gamma) = e^{\\gamma}\\) and scale parameter (\\(\\theta\\)) equals one. Thus, we have \\[ \\pi(\\gamma,\\tau) = C \\exp\\left\\{ \\gamma a_1 - a_2 e^{\\gamma} \\right\\}= C ~ \\left( e^{\\gamma}\\right)^{a_1} \\exp\\left(-a_2e^{\\gamma} \\right). \\] From the table of exponential family distributions, we recognize this to be a gamma distribution. That is, we have that the prior distribution of \\(\\lambda = e^{\\gamma}\\) is a gamma distribution with parameters \\(\\alpha_{prior} = a_1+1\\) and \\(\\theta_{prior}^{-1}=a_2\\). The posterior distribution is a gamma distribution with parameters \\(\\alpha_{post} =a_1+x+1=\\alpha_{prior}+x\\) and \\(\\theta_{post}^{-1}=a_2+1 = \\theta_{prior}^{-1}+1\\). This is consistent with our Section ?? result. Special case. Normal-Normal Model. Consider a normal likelihood so that \\(b(\\gamma) = \\gamma^2/2\\) and the scale parameter is \\(\\sigma^2\\). Thus, we have \\[ \\pi(\\gamma,\\tau) = C \\exp\\left\\{ \\gamma a_1 - \\frac{\\gamma^2}{2}a_2\\right\\}= C_1(\\tau)\\exp\\left\\{ - \\frac{a_2}{2}\\left(\\gamma -\\frac{a_1}{a_2}\\right)^2\\right\\}, \\] The prior distribution of \\(\\gamma\\) is normal with mean \\(a_1/a_2\\) and variance \\(a_2^{-1}\\). The posterior distribution of \\(\\gamma\\) given \\(x\\) is normal with mean \\((a_1+x/\\sigma^2)/(a_2+\\sigma^{-2})\\) and variance \\((a_2+\\sigma^{-2})^{-1}\\). Special case. Beta-Binomial Model. Consider a binomial likelihood so that \\(b(\\gamma) = n \\ln(1+e^{\\gamma})\\) and scale parameter equals one. Thus, we have \\[ \\pi(\\gamma,\\tau) = C \\exp\\left\\{ \\gamma a_1 - n a_2 \\ln(1+e^{\\gamma}) \\right\\}= C ~ \\left( \\frac{e^{\\gamma}}{1+e^{\\gamma}}\\right)^{a_1} \\left(1-\\frac{e^{\\gamma}}{1+e^{\\gamma}}\\right)^{-na_2+a_1}. \\] This is a beta distribution. As in the other cases, prior parameters \\(a_1\\) and \\(a_2\\) are updated to become posterior parameters \\(a_1+x\\) and \\(a_2+1\\). Contributors Lei (Larry) Hua, Northern Illinois University, and Edward W. (Jed) Frees, University of Wisconsin-Madison, are the principal authors of the initial version of this chapter. Email: lhua@niu.edu or jfrees@bus.wisc.edu for chapter comments and suggested improvements. Bibliography "],
["C-AppC.html", "Chapter 16 Appendix C: Maximum Likelihood Theory 16.1 Likelihood Function 16.2 Maximum Likelihood Estimators 16.3 Statistical Inference Based on Maximum Likelhood Estimation", " Chapter 16 Appendix C: Maximum Likelihood Theory Chapter preview. Appendix Chapter 14 introduced the maximum likelihood theory regarding estimation of parameters from a parametric family. This appendix gives more specific examples and expands some of the concepts. Section 16.1 reviews the definition of the likelihood function, and introduces its properties. Section 16.2 reviews the maximum likelihood estimators, and extends their large-sample properties to the case where there are multiple parameters in the model. Section 16.3 reviews statistical inference based on maximum likelihood estimators, with specific examples on cases with multiple parameters. 16.1 Likelihood Function In this section, you learn the definitions of the likelihood function and the log-likelihood function the properties of the likelihood function. From Appendix 14, the likelihood function is a function of parameters given the observed data. Here, we review the concepts of the likelihood function, and introduces its properties that are bases for maximum likelihood inference. 16.1.1 Likelihood and Log-likelihood Functions Here, we give a brief review of the likelihood function and the log-likelihood function from Appendix 14. Let \\(f(\\cdot|\\boldsymbol\\theta)\\) be the probability function of \\(X\\), the probability mass function (pmf) if \\(X\\) is discrete or the probability density function (pdf) if it is continuous. The likelihood is a function of the parameters (\\(\\boldsymbol \\theta\\)) given the data (\\(\\mathbf{x}\\)). Hence, it is a function of the parameters with the data being fixed, rather than a function of the data with the parameters being fixed. The vector of data \\(\\mathbf{x}\\) is usually a realization of a random sample as defined in Appendix 14. Given a realized of a random sample \\(\\mathbf{x}=(x_1,x_2,\\cdots,x_n)\\) of size \\(n\\), the likelihood function is defined as \\[L(\\boldsymbol{\\theta}|\\mathbf{x})=f(\\mathbf{x}|\\boldsymbol{\\theta})=\\prod_{i=1}^nf(x_i|\\boldsymbol{\\theta}),\\] with the corresponding log-likelihood function given by \\[l(\\boldsymbol{\\theta}|\\mathbf{x})=\\ln L(\\boldsymbol{\\theta}|\\mathbf{x})=\\sum_{i=1}^n\\ln f(x_i|\\boldsymbol{\\theta}),\\] where \\(f(\\mathbf{x}|\\boldsymbol{\\theta})\\) denotes the joint probability function of \\(\\mathbf{x}\\). The log-likelihood function leads to an additive structure that is easy to work with. In Appendix 14, we have used the normal distribution to illustrate concepts of the likelihood function and the log-likelihood function. Here, we derive the likelihood and corresponding log-likelihood functions when the population distribution is from the Pareto distribution family. Show Example Example – Pareto Distribution. Suppose that \\(X_1, \\ldots, X_n\\) represents a random sample from a single-parameter Pareto distribution with the cumulative distribution function given by \\[F(x) = \\Pr(X_i\\leq x)=1- \\left(\\frac{500}{x}\\right)^{\\alpha}, ~~~~ x&gt;500,\\] where the parameter \\(\\theta = \\alpha\\). The corresponding probability density function is \\(f(x) = 500^{\\alpha} \\alpha x^{-\\alpha-1}\\) and the log-likelihood function can be derived as \\[l(\\boldsymbol \\alpha|\\mathbf{x}) = \\sum_{i=1}^n \\ln f(x_i;\\alpha) = n \\alpha \\ln 500 +n \\ln \\alpha -(\\alpha+1) \\sum_{i=1}^n \\ln x_i .\\] 16.1.2 Properties of Likelihood Functions In mathematical statistics, the first derivative of the log-likelihood function with respect to the parameters, \\(u(\\boldsymbol\\theta)=\\partial l(\\boldsymbol \\theta|\\mathbf{x})/\\partial \\boldsymbol \\theta\\), is referred to as the score function, or the score vector when there are multiple parameters in \\(\\boldsymbol\\theta\\). The score function or score vector can be written as \\[u(\\boldsymbol\\theta)=\\frac{ \\partial}{\\partial \\boldsymbol \\theta} l(\\boldsymbol \\theta|\\mathbf{x}) =\\frac{ \\partial}{\\partial \\boldsymbol \\theta} \\ln \\prod_{i=1}^n f(x_i;\\boldsymbol \\theta ) =\\sum_{i=1}^n \\frac{ \\partial}{\\partial \\boldsymbol \\theta} \\ln f(x_i;\\boldsymbol \\theta ),\\] where \\(u(\\boldsymbol\\theta)=(u_1(\\boldsymbol\\theta),u_2(\\boldsymbol\\theta),\\cdots,u_p(\\boldsymbol\\theta))\\) when \\(\\boldsymbol\\theta=(\\theta_1,\\cdots,\\theta_p)\\) contains \\(p&gt;2\\) parameters, with the element \\(u_k(\\boldsymbol\\theta)=\\partial l(\\boldsymbol \\theta|\\mathbf{x})/\\partial \\theta_k\\) being the partial derivative with respect to \\(\\theta_k\\) (\\(k=1,2,\\cdots,p\\)). The likelihood function has the following properties: One basic property of the likelihood function is that the expectation of the score function with respect to \\(\\mathbf{x}\\) is 0. That is, \\[\\mathrm{E}[u(\\boldsymbol\\theta)]=\\mathrm{E} \\left[ \\frac{ \\partial}{\\partial \\boldsymbol \\theta} l(\\boldsymbol \\theta|\\mathbf{x}) \\right] = \\mathbf 0\\] To illustrate this, we have \\[\\begin{aligned} \\mathrm{E} \\left[ \\frac{ \\partial}{\\partial \\boldsymbol \\theta} l(\\boldsymbol \\theta|\\mathbf{x}) \\right] &amp;= \\mathrm{E} \\left[ \\frac{\\frac{\\partial}{\\partial \\boldsymbol \\theta}f(\\mathbf{x};\\boldsymbol \\theta)}{f(\\mathbf{x};\\boldsymbol \\theta )} \\right] = \\int\\frac{\\partial}{\\partial \\boldsymbol \\theta} f(\\mathbf{y};\\boldsymbol \\theta ) d \\mathbf y \\\\ &amp;= \\frac{\\partial}{\\partial \\boldsymbol \\theta} \\int f(\\mathbf{y};\\boldsymbol \\theta ) d \\mathbf y = \\frac{\\partial}{\\partial \\boldsymbol \\theta} 1 = \\mathbf 0.\\end{aligned}\\] Denote by \\({ \\partial^2 l(\\boldsymbol \\theta|\\mathbf{x}) }/{\\partial \\boldsymbol \\theta\\partial \\boldsymbol \\theta^{\\prime}}={ \\partial^2 l(\\boldsymbol \\theta|\\mathbf{x}) }/{\\partial \\boldsymbol \\theta^{2}}\\) the second derivative of the log-likelihood function when \\(\\boldsymbol\\theta\\) is a single parameter, or by \\({ \\partial^2 l(\\boldsymbol \\theta|\\mathbf{x}) }/{\\partial \\boldsymbol \\theta\\partial \\boldsymbol \\theta^{\\prime}}=(h_{jk})=({ \\partial^2 l(\\boldsymbol \\theta|\\mathbf{x}) }/\\partial x_j\\partial x_k)\\) the hessian matrix of the log-likelihood function when it contains multiple parameters. Denote \\([{ \\partial l(\\boldsymbol \\theta|\\mathbf{x})}{\\partial\\boldsymbol \\theta}][{ \\partial l(\\boldsymbol \\theta|\\mathbf{x})}{\\partial\\boldsymbol \\theta&#39;}]=u^2(\\boldsymbol \\theta)\\) when \\(\\boldsymbol\\theta\\) is a single parameter, or let \\([{ \\partial l(\\boldsymbol \\theta|\\mathbf{x})}{\\partial\\boldsymbol \\theta}][{ \\partial l(\\boldsymbol \\theta|\\mathbf{x})}{\\partial\\boldsymbol \\theta&#39;}]=(uu_{jk})\\) be a \\(p\\times p\\) matrix when \\(\\boldsymbol\\theta\\) contains a total of \\(p\\) parameters, with each element \\(uu_{jk}=u_j(\\boldsymbol \\theta)u_k(\\boldsymbol \\theta)\\) and \\(u_j(\\boldsymbol \\theta)\\) being the \\(k\\)th element of the score vector as defined earlier. Another basic property of the likelihood function is that sum of the expectation of the hessian matrix and the expectation of the kronecker product of the score vector and its transpose is \\(\\mathbf 0\\). That is, \\[\\mathrm{E} \\left( \\frac{ \\partial^2 }{\\partial \\boldsymbol \\theta\\partial \\boldsymbol \\theta^{\\prime}} l(\\boldsymbol \\theta|\\mathbf{x}) \\right) + \\mathrm{E} \\left( \\frac{ \\partial l(\\boldsymbol \\theta|\\mathbf{x})}{\\partial\\boldsymbol \\theta} \\frac{ \\partial l(\\boldsymbol \\theta|\\mathbf{x})}{\\partial\\boldsymbol \\theta^{\\prime}}\\right) = \\mathbf 0.\\] Define the Fisher information matrix as \\[ \\mathcal{I}(\\boldsymbol \\theta) = \\mathrm{E} \\left( \\frac{ \\partial l(\\boldsymbol \\theta|\\mathbf{x})}{\\partial \\boldsymbol \\theta} \\frac{ \\partial l(\\boldsymbol \\theta|\\mathbf{x})}{\\partial \\boldsymbol \\theta^{\\prime}} \\right) = -\\mathrm{E} \\left( \\frac{ \\partial^2}{\\partial \\boldsymbol \\theta \\partial \\boldsymbol \\theta^{\\prime}} l(\\boldsymbol \\theta|\\mathbf{x}) \\right).\\] As the sample size \\(n\\) goes to infinity, the score function (vector) converges in distribution to a normal distribution (or multivariate normal distribution when \\(\\boldsymbol \\theta\\) contains multiple parameters) with mean 0 and variance (or covariance matrix in the multivariate case) given by \\(\\mathcal{I}(\\boldsymbol \\theta)\\). 16.2 Maximum Likelihood Estimators In this section, you learn the definition and derivation of the maximum likelihood estimator (MLE) for parameters from a specific distribution family the properties of maximum likelihood estimators that ensure valid large-sample inference of the parameters why using the MLE-based method, and what caution that needs to be taken. In statistics, maximum likelihood estimators are values of the parameters \\(\\boldsymbol \\theta\\) that are most likely to have been produced by the data. 16.2.1 Definition and Derivation of MLE Based on the definition given in Appendix 14, the value of \\(\\boldsymbol \\theta\\), say \\(\\hat{\\boldsymbol \\theta}_{MLE}\\), that maximizes the likelihood function, is called the maximum likelihood estimator (MLE) of \\(\\boldsymbol \\theta\\). Because the log function \\(\\ln(\\cdot)\\) is a one-to-one function, we can also determine \\(\\hat{\\boldsymbol{\\theta}}_{MLE}\\) by maximizing the log-likelihood function, \\(l(\\boldsymbol \\theta|\\mathbf{x})\\). That is, the MLE is defined as \\[\\hat{\\boldsymbol \\theta}_{MLE}={\\mbox{argmax}}_{\\boldsymbol{\\theta}\\in\\Theta}l(\\boldsymbol{\\theta}|\\mathbf{x}).\\] Given the analytical form of the likelihood function, the MLE can be obtained by taking the first derivative of the log-likelihood function with respect to \\(\\boldsymbol{\\theta}\\), and setting the values of the partial derivatives to zero. That is, the MLE are the solutions of the equations of \\[\\frac{\\partial l(\\hat{\\boldsymbol{\\theta}}|\\mathbf{x})}{\\partial\\hat{\\boldsymbol{\\theta}}}=\\mathbf 0.\\] Show Example Example. Course C/Exam 4. May 2000, 21. You are given the following five observations: 521, 658, 702, 819, 1217. You use the single-parameter Pareto with cumulative distribution function: \\[F(x) = 1- \\left(\\frac{500}{x}\\right)^{\\alpha}, ~~~~ x&gt;500 .\\] Calculate the maximum likelihood estimate of the parameter \\(\\alpha\\). Show Example Solution Solution. With \\(n=5\\), the log-likelihood function is \\[l(\\alpha|\\mathbf{x} ) = \\sum_{i=1}^5 \\ln f(x_i;\\alpha ) = 5 \\alpha \\ln 500 + 5 \\ln \\alpha -(\\alpha+1) \\sum_{i=1}^5 \\ln x_i.\\] Solving for the root of the score function yields \\[\\frac{ \\partial}{\\partial \\alpha } l(\\alpha |\\mathbf{x}) = 5 \\ln 500 + 5 / \\alpha - \\sum_{i=1}^5 \\ln x_i =_{set} 0 \\Rightarrow \\hat{\\alpha}_{MLE} = \\frac{5}{\\sum_{i=1}^5 \\ln x_i - 5 \\ln 500 } = 2.453 .\\] 16.2.2 Asymptotic Properties of MLE From Appendix 14, the MLE has some nice large-sample properties, under certain regularity conditions. We presented the results for a single parameter in Appendix 14, but results are true for the case when \\(\\boldsymbol{\\theta}\\) contains multiple parameters. In particular, we have the following results, in a general case when \\(\\boldsymbol{\\theta}=(\\theta_1,\\theta_2,\\cdots,\\theta_p)\\). The MLE of a parameter \\(\\boldsymbol{\\theta}\\), \\(\\hat{\\boldsymbol{\\theta}}_{MLE}\\), is a consistent estimator. That is, the MLE \\(\\hat{\\boldsymbol{\\theta}}_{MLE}\\) converges in probability to the true value \\(\\boldsymbol{\\theta}\\), as the sample size \\(n\\) goes to infinity. The MLE has the asymptotic normality property, meaning that the estimator will converge in distribution to a multivariate normal distribution centered around the true value, when the sample size goes to infinity. Namely, \\[\\sqrt{n}(\\hat{\\boldsymbol{\\theta}}_{MLE}-\\boldsymbol{\\theta})\\rightarrow N\\left(\\mathbf 0,\\,\\boldsymbol{V}\\right),\\quad \\mbox{as}\\quad n\\rightarrow \\infty,\\] where \\(\\boldsymbol{V}\\) denotes the asymptotic variance (or covariance matrix) of the estimator. Hence, the MLE \\(\\hat{\\boldsymbol{\\theta}}_{MLE}\\) has an approximate normal distribution with mean \\(\\boldsymbol{\\theta}\\) and variance (covariance matrix when \\(p&gt;1\\)) \\(\\boldsymbol{V}/n\\), when the sample size is large. The MLE is efficient, meaning that it has the smallest asymptotic variance \\(\\boldsymbol{V}\\), commonly referred to as the Cramer–Rao lower bound. In particular, the Cramer–Rao lower bound is the inverse of the Fisher information (matrix) \\(\\mathcal{I}(\\boldsymbol{\\theta})\\) defined earlier in this appendix. Hence, \\(\\mathrm{Var}(\\hat{\\boldsymbol{\\theta}}_{MLE})\\) can be estimated based on the observed Fisher information. Based on the above results, we may perform statistical inference based on the procedures defined in Appendix 14. Show Example Example. Course C/Exam 4. Nov 2000, 13. A sample of ten observations comes from a parametric family \\(f(x,; \\theta_1, \\theta_2)\\) with log-likelihood function \\[l(\\theta_1, \\theta_2)= \\sum_{i=1}^{10} f(x_i; \\theta_1, \\theta_2) = -2.5 \\theta_1^2 - 3 \\theta_1 \\theta_2 - \\theta_2^2 + 5 \\theta_1 + 2 \\theta_2 + k,\\] where \\(k\\) is a constant. Determine the estimated covariance matrix of the maximum likelihood estimator, \\(\\hat{\\theta_1}, \\hat{\\theta_2}\\). Show Example Solution Solution. Denoting \\(l=l(\\theta_1, \\theta_2)\\), the hessian matrix of second derivatives is \\[\\left( \\begin{array}{cc} \\frac{ \\partial ^2}{\\partial \\theta_1 ^2 } l &amp; \\frac{ \\partial ^2}{\\partial \\theta_1 \\partial \\theta_2 } l \\\\ \\frac{ \\partial ^2}{\\partial \\theta_1 \\partial \\theta_2 } l &amp; \\frac{ \\partial ^2}{\\partial \\theta_1 ^2 } l \\end{array} \\right) = \\left( \\begin{array}{cc} -5 &amp; -3 \\\\ -3 &amp; -2 \\end{array} \\right)\\] Thus, the information matrix is: \\[\\mathcal{I}(\\theta_1, \\theta_2) = -\\mathrm{E} \\left( \\frac{ \\partial^2}{\\partial \\boldsymbol \\theta \\partial \\boldsymbol \\theta^{\\prime}} l(\\boldsymbol \\theta|\\mathbf{x}) \\right) = \\left( \\begin{array}{cc} 5 &amp; 3 \\\\ 3 &amp; 2 \\end{array} \\right)\\] and \\[\\mathcal{I}^{-1}(\\theta_1, \\theta_2) = \\frac{1}{5(2) - 3(3)}\\left( \\begin{array}{cc} 2 &amp; -3 \\\\ -3 &amp; 5 \\end{array} \\right) = \\left( \\begin{array}{cc} 2 &amp; -3 \\\\ -3 &amp; 5 \\end{array} \\right) .\\] 16.2.3 Use of Maximum Likelihood Estimation The method of maximum likelihood has many advantages over alternative methods such as the method of moment method introduced in Appendix 14. It is a general tool that works in many situations. For example, we may be able to write out the closed-form likelihood function for censored and truncated data. Maximum likelihood estimation can be used for regression models including covariates, such as survival regression, generalized linear models and mixed models, that may include covariates that are time-dependent. From the efficiency of the MLE, it is optimal, the best, in the sense that it has the smallest variance among the class of all unbiased estimators for large sample sizes. From the results on the asymptotic normality of the MLE, we can obtain a large-sample distribution for the estimator, allowing users to assess the variability in the estimation and perform statistical inference on the parameters. The approach is less computationally extensive than re-sampling methods that require a large of fittings of the model. Despite its numerous advantages, MLE has its drawback in cases such as generalized linear models when it does not have a closed analytical form. In such cases, maximum likelihood estimators are computed iteratively using numerical optimization methods. For example, we may use the Newton-Raphson iterative algorithm or its variations for obtaining the MLE. Iterative algorithms require starting values. For some problems, the choice of a close starting value is critical, particularly in cases where the likelihood function has local minimums or maximums. Hence, there may be a convergence issue when the starting value is far from the maximum. Hence, it is important to start from different values across the parameter space, and compare the maximized likelihood or log-likelihood to make sure the algorithms have converged to a global maximum. 16.3 Statistical Inference Based on Maximum Likelhood Estimation In this section, you learn how to perform hypothesis testing based on MLE for cases where there are multiple parameters in \\(\\boldsymbol\\theta\\) perform likelihood ratio test for cases where there are multiple parameters in \\(\\boldsymbol\\theta\\) In Appendix 14, we have introduced maximum likelihood-based methods for statistical inference when \\(\\boldsymbol\\theta\\) contains a single parameter. Here, we will extend the results to cases where there are multiple parameters in \\(\\boldsymbol\\theta\\). 16.3.1 Hypothesis Testing In Appendix 14, we defined hypothesis testing concerning the null hypothesis, a statement on the parameter(s) of a distribution or model. One important type of inference is to assess whether a parameter estimate is statistically significant, meaning whether the value of the parameter is zero or not. We have learned earlier that the MLE \\(\\hat{\\boldsymbol{\\theta}}_{MLE}\\) has a large-sample normal distribution with mean \\(\\boldsymbol \\theta\\) and the variance covariance matrix \\(\\mathcal{I}^{-1}(\\boldsymbol \\theta)\\). Based on the multivariate normal distribution, the \\(j\\)th element of \\(\\hat{\\boldsymbol{\\theta}}_{MLE}\\), say \\(\\hat{\\theta}_{MLE,j}\\), has a large-sample univariate normal distribution. Define \\(se(\\hat{\\theta}_{MLE,j})\\), the standard error (estimated standard deviation) to be the square root of the \\(j\\)th diagonal element of \\(\\mathcal{I}^{-1}(\\boldsymbol \\theta)_{MLE}\\). To assess the null hypothesis that \\(\\theta_j=\\theta_0\\), we define the \\(t\\)-statistic or \\(t\\)-ratio to be \\(t(\\hat{\\theta}_{MLE,j})=(\\hat{\\theta}_{MLE,j}-\\theta_0)/se(\\hat{\\theta}_{MLE,j})\\). Under the null hypothesis, it has a Student-\\(t\\) distribution with degrees of freedom equal to \\(n-p\\), with \\(p\\) being the dimension of \\(\\boldsymbol{\\theta}\\). For most actuarial applications, we have a large sample size \\(n\\), so the \\(t\\)-distribution is very close to the (standard) normal distribution. In the case when \\(n\\) is very large or when the standard error is known, the \\(t\\)-statistic can be referred to as a \\(z\\)-statistic or \\(z\\)-score. Based on the results from Appendix 14, if the \\(t\\)-statistic \\(t(\\hat{\\theta}_{MLE,j})\\) exceeds a cut-off (in absolute value), then the test for the \\(j\\) parameter \\(\\theta_j\\) is said to be statistically significant. If \\(\\theta_j\\) is the regression coefficient of the \\(j\\) th independent variable, then we say that the \\(j\\)th variable is statistically significant. For example, if we use a 5% significance level, then the cut-off value is 1.96 using a normal distribution approximation for cases with a large sample size. More generally, using a \\(100 \\alpha \\%\\) significance level, then the cut-off is a \\(100(1-\\alpha/2)\\%\\) quantile from a Student-\\(t\\) distribution with the degree of freedom being \\(n-p\\). Another useful concept in hypothesis testing is the \\(p\\)-value, shorthand for probability value. From the mathematical definition in Appendix 14, a \\(p\\)-value is defined as the smallest significance level for which the null hypothesis would be rejected. Hence, the \\(p\\)-value is a useful summary statistic for the data analyst to report because it allows the reader to understand the strength of statistical evidence concerning the deviation from the null hypothesis. 16.3.2 MLE and Model Validation In addition to hypothesis testing and interval estimation introduced in Appendix 14 and the previous subsection, another important type of inference is selection of a model from two choices, where one choice is a special case of the other with certain parameters being restricted. For such two models with one being nested in the other, we have introduced the likelihood ratio test (LRT) in Appendix 14. Here, we will briefly review the process of performing a LRT based on a specific example of two alternative models. Suppose that we have a (large) model under which we derive the maximum likelihood estimator, \\(\\hat{\\boldsymbol{\\theta}}_{MLE}\\). Now assume that some of the \\(p\\) elements in \\(\\boldsymbol \\theta\\) are equal to zero and determine the maximum likelihood estimator over the remaining set, with the resulting estimator denoted \\(\\hat{\\boldsymbol{\\theta}}_{Reduced}\\). Based on the definition in Appendix 14, the statistic, \\(LRT= 2 \\left( l(\\hat{\\boldsymbol{\\theta}}_{MLE}) - l(\\hat{\\boldsymbol{\\theta}}_{Reduced}) \\right)\\), is called the likelihood ratio statistic. Under the null hypothesis that the reduced model is correct, the likelihood ratio has a Chi-square distribution with degrees of freedom equal to \\(d\\), the number of variables set to zero. Such a test allows us to judge which of the two models is more likely to be correct, given the observed data. If the statistic \\(LRT\\) is large relative to the critical value from the chi-square distribution, then we reject the reduced model in favor of the larger one. Details regarding the critical value and alternative methods based on information criteria are given in Appendix 14. Contributors Lei (Larry) Hua, Northern Illinois University, and Edward W. (Jed) Frees, University of Wisconsin-Madison, are the principal authors of the initial version of this chapter. Email: lhua@niu.edu or jfrees@bus.wisc.edu for chapter comments and suggested improvements. "],
["C-SummaryDistributions.html", "Chapter 17 Appendix D: Summary of Distributions 17.1 Discrete Distributions 17.2 Continuous Distributions 17.3 Limited Expected Values", " Chapter 17 Appendix D: Summary of Distributions User Notes The R functions are from the packages actuar and invgamma. Tables appear when first loaded by the browser. To hide them, click on one of the distributions, e.g., Poisson, and then click on the Hide button. More information on the R codes is available at the R Codes for Loss Data Analytics site. 17.1 Discrete Distributions Overview. This section summarizes selected discrete probability distributions used throughout Loss Data Analytics. Relevant functions and R code are provided. 17.1.1 The (a,b,0) Class Poisson Geometric Binomial Negative Binomial Hide Poisson Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\lambda&gt;0 \\\\ \\hline ~~p_0 &amp; e^{-\\lambda} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\frac{e^{-\\lambda}\\lambda^k}{k!} \\\\ ~~p_k &amp; \\\\ \\hline \\small{\\text{Expected value}} &amp; \\lambda \\\\ ~~\\mathrm{E}[N] &amp; \\\\ \\hline \\small{\\text{Variance}} &amp; \\lambda \\\\ \\hline \\small{\\text{Probability generating function}} &amp; e^{\\lambda(z-1)} \\\\ ~~P(z) &amp; \\\\ \\hline a \\small{\\text{ and }} b \\small{\\text{ for recursion}} &amp; a=0 \\\\ &amp; b=\\lambda \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\text{dpois}(x=, lambda=\\lambda) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{ppois}(p=, lambda=\\lambda) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qpois}(q=, lambda=\\lambda) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rpois}(n=, lambda=\\lambda) \\\\ \\hline \\end{array} \\end{matrix} \\] Hide Geometric Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\beta&gt;0 \\\\ \\hline ~~p_0 &amp; \\frac{1}{1+\\beta} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\frac{\\beta^k}{(1+\\beta)^{k+1}} \\\\ ~~p_k &amp; \\\\ \\hline \\small{\\text{Expected value}} &amp; \\beta \\\\ ~~\\mathrm{E}[N] &amp; \\\\ \\hline \\small{\\text{Variance}} &amp; \\beta(1+\\beta) \\\\ \\hline \\small{\\text{Probability generating function}} &amp; [1-\\beta(z-1)]^{-1} \\\\ ~~P(z) &amp; \\\\ \\hline a \\small{\\text{ and }} b \\small{\\text{ for recursion}} &amp; a=\\frac{\\beta}{1+\\beta} \\\\ &amp; b=0 \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\text{dgeom}(x=, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pgeom}(p=, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qgeom}(q=, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rgeom}(n=, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\end{array} \\end{matrix} \\] Hide Binomial Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; 0&lt;q&lt;1,~\\text{m is an integer} \\\\ &amp; 0 \\leq k \\leq m\\\\ \\hline ~~p_0 &amp;(1-q)^m \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\binom{m}{k}q^k(1-q)^{m-k} \\\\ ~~p_k &amp; \\\\ \\hline \\small{\\text{Expected value}} &amp; mq \\\\ ~~\\mathrm{E}[N] &amp; \\\\ \\hline \\small{\\text{Variance}} &amp; mq(1-q) \\\\ \\hline \\small{\\text{Probability generating function}} &amp; [1+q(z-1)]^m \\\\ ~~P(z) &amp; \\\\ \\hline a \\small{\\text{ and }} b \\small{\\text{ for recursion}} &amp; a=\\frac{-q}{1-q} \\\\ &amp; b=\\frac{(m+1)q}{1-q} \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\text{dbinom}(x=, size=m, prob=p) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pbinom}(p=, size=m, prob=p) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qbinom}(q=, size=m, prob=p) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rbinom}(n=, size=m, prob=p) \\\\ \\hline \\end{array} \\end{matrix} \\] Hide Negative Binomial Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; r&gt;0, \\beta&gt;0 \\\\ \\hline ~~p_0 &amp; (1+\\beta)^{-r} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\frac{r(r+1)\\cdots(r+k-1)\\beta^k}{k!(1+\\beta)^{r+k}} \\\\ ~~p_k &amp; \\\\ \\hline \\small{\\text{Expected value}} &amp; r\\beta \\\\ ~~\\mathrm{E}[N] &amp; \\\\ \\hline \\small{\\text{Variance}} &amp; r\\beta(1+\\beta) \\\\ \\hline \\small{\\text{Probability generating function}} &amp; [1-\\beta(z-1)]^{-r} \\\\ ~~P(z) &amp; \\\\ \\hline a \\small{\\text{ and }} b \\small{\\text{ for recursion}} &amp; a=\\frac{\\beta}{1+\\beta} \\\\ &amp; b=\\frac{(r-1)\\beta}{1+\\beta} \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\text{dnbinom}(x=, size=r, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pnbinom}(p=, size=r, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qnbinom}(q=, size=r, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rnbinom}(n=, size=r, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\end{array} \\end{matrix} \\] 17.1.2 The (a,b,1) Class Zero Truncated Poisson Zero Truncated Geometric Zero Truncated Binomial Zero Truncated Negative Binomial Logarithmic Hide Zero Truncated Poisson Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\lambda&gt;0 \\\\ \\hline ~~p^T_1 &amp; \\frac{\\lambda}{e^\\lambda-1} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\frac{\\lambda^k}{k!(e^\\lambda-1)} \\\\ ~~p^T_k &amp; \\\\ \\hline \\small{\\text{Expected value}} &amp; \\frac{\\lambda}{1-e^{-\\lambda}} \\\\ ~~\\mathrm{E}[N] &amp; \\\\ \\hline \\small{\\text{Variance}} &amp; \\frac{\\lambda[1-(\\lambda+1)e^{-\\lambda}]}{(1-e^{-\\lambda})^2} \\\\ \\hline \\small{\\text{Probability generating function}} &amp; \\frac{e^{\\lambda z}-1}{e^\\lambda-1} \\\\ ~~P(z) &amp; \\\\ \\hline a \\small{\\text{ and }} b \\small{\\text{ for recursion}} &amp; a=0 \\\\ &amp; b=\\lambda \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\text{dztpois}(x=, lambda=\\lambda) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pztpois}(p=, lambda=\\lambda) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qztpois}(q=, lambda=\\lambda) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rztpois}(n=, lambda=\\lambda) \\\\ \\hline \\end{array} \\end{matrix} \\] Hide Zero Truncated Geometric Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\beta&gt;0 \\\\ \\hline ~~p^T_1 &amp; \\frac{1}{1+\\beta} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\frac{\\beta^{k-1}}{(1+\\beta)^k} \\\\ ~~p^T_k &amp; \\\\ \\hline \\small{\\text{Expected value}} &amp; 1+\\beta \\\\ ~~\\mathrm{E}[N] &amp; \\\\ \\hline \\small{\\text{Variance}} &amp; \\beta(1+\\beta) \\\\ \\hline \\small{\\text{Probability generating function}} &amp; \\frac{[1-\\beta(z-1)]^{-1}-(1+\\beta)^{-1}}{1-(1+\\beta)^{-1}} \\\\ ~~P(z) &amp; \\\\ \\hline a \\small{\\text{ and }} b \\small{\\text{ for recursion}} &amp; a=\\frac{\\beta}{1+\\beta} \\\\ &amp; b=0 \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\text{dztgeom}(x=, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pztgeom}(p=, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qztgeom}(q=, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rztgeom}(n=, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\end{array} \\end{matrix} \\] Hide Zero Truncated Binomial Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; 0&lt;q&lt;1,~\\text{m is an integer} \\\\ &amp; 0 \\leq k \\leq m\\\\ \\hline ~~p^T_1 &amp; \\frac{m(1-q)^{m-1}q}{1-(1-q)^m} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\frac{\\binom{m}{k}q^k(1-q)^{m-k}}{1-(1-q)^m} \\\\ ~~p^T_k &amp; \\\\ \\hline \\small{\\text{Expected value}} &amp; \\frac{mq}{1-(1-q)^m} \\\\ ~~\\mathrm{E}[N] &amp; \\\\ \\hline \\small{\\text{Variance}} &amp; \\frac{mq[(1-q)-(1-q+mq)(1-q)^m]}{[1-(1-q)^m]^2} \\\\ \\hline \\small{\\text{Probability generating function}} &amp; \\frac{[1+q(z-1)^m]-(1-q)^m}{1-(1-q)^m} \\\\ ~~P(z) &amp; \\\\ \\hline a \\small{\\text{ and }} b \\small{\\text{ for recursion}} &amp; a=\\frac{-q}{1-q} \\\\ &amp; b=\\frac{(m+1)q}{1-q} \\\\ \\hline \\end{array} \\end{matrix} \\] R Commmands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\text{dztbinom}(x=, size=m, prob=p) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pztbinom}(p=, size=m, prob=p) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qztbinom}(q=, size=m, prob=p) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rztbinom}(n=, size=m, prob=p) \\\\ \\hline \\end{array} \\end{matrix} \\] Hide Zero Truncated Negative Binomial Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; r&gt;-1, r\\neq0 \\\\ \\hline ~~p^T_1 &amp; \\frac{r\\beta}{(1+\\beta)^{r+1}-(1+\\beta)} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\frac{r(r+1)\\cdots(r+k-1)}{k![(1+\\beta)^r-1]}(\\frac{\\beta}{1+\\beta})^k \\\\ ~~p^T_k &amp; \\\\ \\hline \\small{\\text{Expected value}} &amp; \\frac{r\\beta}{1-(1+\\beta)^{-r}} \\\\ ~~\\mathrm{E}[N] &amp; \\\\ \\hline \\small{\\text{Variance}} &amp; \\frac{r\\beta[(1+\\beta)-(1+\\beta+r\\beta)(1+\\beta)^{-r}]}{[1-(1+\\beta)^{-r}]^2} \\\\ \\hline \\small{\\text{Probability generating function}} &amp; \\frac{[1-\\beta(z-1)]^{-r}-(1+\\beta)^{-r}}{1-(1+\\beta)^{-r}} \\\\ ~~P(z) &amp; \\\\ \\hline a \\small{\\text{ and }} b \\small{\\text{ for recursion}} &amp; a=\\frac{\\beta}{1+\\beta} \\\\ &amp; b=\\frac{(r-1)\\beta}{1+\\beta} \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\text{dztnbinom}(x=, size=r, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pztnbinom}(p=, size=r, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qztnbinom}(q=, size=r, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rztnbinom}(n=, size=r, prob=\\frac{1}{1+\\beta}) \\\\ \\hline \\end{array} \\end{matrix} \\] Hide Logarithmic Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\beta&gt;0 \\\\ \\hline ~~p^T_1 &amp; \\frac{\\beta}{(1+\\beta)ln(1+\\beta)} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\frac{\\beta^k}{k(1+\\beta)^k \\ln (1+\\beta)} \\\\ ~~p^T_k &amp; \\\\ \\hline \\small{\\text{Expected value}} &amp; \\frac{\\beta}{\\ln (1+\\beta)} \\\\ ~~\\mathrm{E}[N] &amp; \\\\ \\hline \\small{\\text{Variance}} &amp; \\frac{\\beta[1+\\beta-\\frac{\\beta}{ln(1+\\beta)}]}{\\ln (1+\\beta)} \\\\ \\hline \\small{\\text{Probability generating function}} &amp; 1-\\frac{ln[1-\\beta(z-1)]}{\\ln (1+\\beta)} \\\\ ~~P(z) &amp; \\\\ \\hline a \\small{\\text{ and }} b \\small{\\text{ for recursion}} &amp; a=\\frac{\\beta}{1+\\beta} \\\\ &amp; b=\\frac{-\\beta}{1+\\beta} \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Probability mass function}} &amp; \\text{dnbinom}(x=,prob=\\frac{\\beta}{1+\\beta}) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pnbinom}(p=,prob=\\frac{\\beta}{1+\\beta}) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qnbinom}(q=,prob=\\frac{\\beta}{1+\\beta}) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rnbinom}(n=,prob=\\frac{\\beta}{1+\\beta}) \\\\ \\hline \\end{array} \\end{matrix} \\] 17.2 Continuous Distributions Overview. This section summarizes selected continuous probability distributions used throughout Loss Data Analytics. Relevant functions, R code, and illustrative graphs are provided. 17.2.1 One Parameter Distributions Exponential Inv Exponential Single Parameter Pareto Hide Exponential Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0 \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{1}{\\theta}e^{-x/\\theta} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; 1-e^{-x/\\theta} \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\theta^k\\Gamma(k+1) \\\\ ~~\\mathrm{E}[X^k] &amp; k&gt;-1 \\\\ \\hline VaR_p(x) &amp; -\\theta \\ln (1-p) \\\\ \\hline \\small{\\text{Limited Expected Value}} &amp; \\theta(1-e^{-x/\\theta}) \\\\ ~~\\mathrm{E}[X\\wedge x] &amp; \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dexp}(x=, rate=1/\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pexp}(p=, rate=1/\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qexp}(q=, rate=1/\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rexp}(n=, rate=1/\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph theta &lt;- 100 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dexp(X,rate=1/theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Exponential Distribution&quot;) Hide Inverse Exponential Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0 \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{\\theta e^{-\\theta/x}}{x^2} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; e^{-\\theta/x} \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\theta^k\\Gamma(1-k) \\\\ ~~\\mathrm{E}[X^k] &amp; k&lt;1 \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\theta^kG(1-k;\\theta/x)+x^k (1 - e^{-\\theta/x}) \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dinvexp}(x=, scale=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pinvexp}(p=, scale=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qinvexp}(q=, scale=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rinvexp}(n=, scale=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph theta &lt;- 0.01 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dinvexp(X, rate = 1/theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Inverse Exponential Distribution&quot;) Hide Single Parameter Pareto Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta~\\text{is known},~x&gt;\\theta, \\alpha &gt; 0 \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{\\alpha\\theta^\\alpha}{x^{\\alpha+1}} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; 1-(\\theta/x)^\\alpha \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\frac{\\alpha\\theta^k}{\\alpha-k} \\\\ ~~\\mathrm{E}[X^k] &amp; k &lt; \\alpha \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\frac{\\alpha\\theta^k}{\\alpha-k}-\\frac{k\\theta^{\\alpha}}{(\\alpha-k)x^{\\alpha-k}} \\\\ &amp; x \\geq\\theta \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dpareto1}(x=, shape=\\alpha,min=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{ppareto1}(p=, shape=\\alpha,min=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qpareto1}(q=, shape=\\alpha,min=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rpareto1}(n=, shape=\\alpha,min=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph alpha &lt;- 3 theta &lt;- 100 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dpareto1(X,shape=alpha,min=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Single Parameter Pareto Distribution&quot;) 17.2.2 Two Parameter Distributions Pareto Inv Pareto Loglogistic Paralogistic Gamma Inv Gamma Weibull Inv Weibull Uniform Normal Hide Pareto Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0, \\alpha&gt;0 \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{\\alpha\\theta^\\alpha}{(x+\\theta)^{\\alpha+1}} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; 1-\\Big(\\frac{\\theta}{x+\\theta}\\Big)^\\alpha \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\frac{\\theta^k\\Gamma(k+1)\\Gamma(\\alpha-k)}{\\Gamma(\\alpha)} \\\\ ~~\\mathrm{E}[X^k] &amp; -1&lt;k&lt;\\alpha \\\\ \\hline \\small{\\text{Limited Expected Value:}}~\\alpha\\neq1 &amp; \\frac{\\theta}{\\alpha-1}\\Big[1-\\Big(\\frac{\\theta}{x+\\theta}\\Big)^{\\alpha-1}\\Big] \\\\ ~~\\mathrm{E}[X\\wedge x] &amp; \\\\ \\hline \\small{\\text{Limited Expected Value:}}~\\alpha=1 &amp; -\\theta \\ln \\left(\\frac{\\theta}{x+\\theta}\\right) \\\\ ~~\\mathrm{E}[X\\wedge x] &amp; \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\frac{\\theta^k\\Gamma(k+1)\\Gamma(\\alpha-k)}{\\Gamma(\\alpha)}\\beta(k+1,\\alpha-k;\\frac{x}{x+\\theta})+x^k(\\frac{\\theta}{x+\\theta})^\\alpha \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dpareto2}(x=, shape=\\alpha, scale=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{ppareto2}(p=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qpareto2}(q=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rpareto2}(n=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph alpha &lt;- 3 theta &lt;- 200 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dpareto2(X,shape=alpha,scale=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Pareto Distribution&quot;) Hide Inverse Pareto Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0, \\tau&gt;0 \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{\\tau\\theta x^{\\tau-1}}{(x+\\theta)^\\tau-1} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\Big(\\frac{x}{x+\\theta}\\Big)^\\tau \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\frac{\\theta^k\\Gamma(\\tau+k)\\Gamma(1-k)}{\\Gamma(\\tau)} \\\\ ~~\\mathrm{E}[X^k] &amp; -\\tau&lt;k&lt;1 \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\theta^k\\tau\\int^{x/(x+\\theta)}_0~y^{\\tau+k-1}(1-y)^{-k}dy+x^k[1-\\Big(\\frac{x}{x+\\theta}\\Big)^\\tau] \\\\ &amp; k&gt;-\\tau \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dinvpareto}(x=, shape=\\tau, scale=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pinvpareto}(p=, shape=\\tau,scale=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qinvpareto}(q=, shape=\\tau,scale=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rinvpareto}(n=, shape=\\tau,scale=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph tau &lt;- 5 theta &lt;- 100 X &lt;- seq(from=0,to=3000,by=1) plot(x=X,y=dinvpareto(X,shape=tau,scale=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Inverse Pareto Distribution&quot;) Hide Loglogistic Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0, \\gamma &gt; 0, u=\\frac{(x/\\theta)^\\gamma}{1+(x/\\theta)^\\gamma} \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{\\gamma(x/\\theta)^\\gamma}{x[1+(x/\\theta)^\\gamma]^2} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; u \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\theta^k\\Gamma(1+(k/\\gamma))\\Gamma(1-(k/\\gamma)) \\\\ ~~\\mathrm{E}[X^k] &amp; -\\gamma&lt;k&lt;\\gamma \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\theta^k\\Gamma(1+(k/\\gamma))\\Gamma(1-(k/\\gamma))\\beta(1+(k/\\gamma),1-(k/\\gamma);u)+x^k(1-u) \\\\ &amp; k&gt;-\\gamma \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph dloglogistic &lt;- function(x, gamma, theta){ p=gamma*(x/theta)^gamma/(x*(1+(x/theta)^gamma)^2) return(p) } gamma &lt;- 2 theta &lt;- 100 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dloglogistic(X,gamma=gamma,theta=theta),type=&quot;l&quot;,col=&quot;red&quot;) Hide Paralogistic Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0, \\alpha&gt;0, u=\\frac{1}{1+(x/\\theta)^\\alpha} \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{\\alpha^2(x/\\theta)^\\alpha}{x[1+(x/\\theta)^\\alpha]^{\\alpha+1}} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; 1-u^\\alpha \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\frac{\\theta^k\\Gamma(1+(k/\\alpha))\\Gamma(\\alpha-(k/\\alpha))}{\\Gamma(\\alpha)} \\\\ ~~\\mathrm{E}[X^k] &amp; -\\alpha&lt;k&lt;\\alpha^2 \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\frac{\\theta^k\\Gamma(1+(k/\\alpha))\\Gamma(\\alpha-(k/\\alpha))}{\\Gamma(\\alpha)}\\beta(1+(k/\\alpha),\\alpha-(k/\\alpha);1-u)+x^ku^\\alpha \\\\ &amp; k&gt;-\\alpha \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dparalogis}(x=, shape=\\alpha, scale=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pparalogis}(p=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qparalogis}(q=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rparalogis}(n=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph alpha &lt;- 2 theta &lt;- 100 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dparalogis(X,shape=alpha,scale=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Paralogistic Distribution&quot;) Hide Gamma Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0,~\\alpha&gt;0 \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{1}{\\theta^{\\alpha}\\Gamma(\\alpha)}x^{\\alpha-1}e^{-x/\\theta} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\Gamma(\\alpha;\\frac{x}{\\theta}) \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\theta^k\\frac{\\Gamma(\\alpha+k)}{\\Gamma(\\alpha)} \\\\ ~~\\mathrm{E}[X^k] &amp; k&gt;-\\alpha \\\\ \\hline &amp; \\frac{\\theta^k\\Gamma(k+\\alpha)}{\\Gamma(\\alpha)}\\Gamma(k+\\alpha; x/\\theta)+x^k[1-\\Gamma(\\alpha; x/\\theta)] \\\\ ~~\\mathrm{E}[X\\wedge x]^k &amp; k &gt; -\\alpha \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\small{\\text{Density function}} &amp; \\text{dgamma}(x=, shape=\\alpha, scale=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pgamma}(p=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qgamma}(q=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rgamma}(n=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph alpha &lt;- 2 theta &lt;- 50 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dgamma(X,shape=alpha,scale=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Gamma Distribution&quot;) Hide Inverse Gamma Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{(\\theta/x)^\\alpha e^{-\\theta/x}}{x\\Gamma(\\alpha)} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; 1-\\Gamma(\\alpha;\\theta/x) \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\frac{\\theta^k\\Gamma(\\alpha-k)}{\\Gamma(\\alpha)} \\\\ ~~\\mathrm{E}[X^k] &amp; k&lt;\\alpha \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\frac{\\theta^k\\Gamma(\\alpha-k)}{\\Gamma(\\alpha)}[1-\\Gamma(\\alpha-k;\\theta/x)]+x^k\\Gamma(\\alpha;\\theta/x) \\\\ &amp; \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dinvgamma}(x=, shape=\\alpha, scale=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pinvgamma}(p=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qinvgamma}(q=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rinvgamma}(n=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph alpha &lt;- 3 theta &lt;- 100 X &lt;- seq(from=0,to=400,by=1) plot(x=X,y=dinvgamma(X,shape=alpha,scale=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Inverse Gamma Distribution&quot;) Hide Weibull Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0,\\alpha&gt;0 \\\\ \\hline\\ \\small{\\text{Probability density}} &amp; \\frac{\\alpha \\Big(\\frac{x}{\\theta}\\Big)^\\alpha \\exp\\Big(-\\Big(\\frac{x}{\\theta}\\Big)^\\alpha\\Big)}{x} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; 1-\\exp\\Big(-\\Big(\\frac{x}{\\theta}\\Big)^\\alpha\\Big) \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\theta^k \\Gamma(1 + \\frac{k}{\\alpha}) \\\\ ~~\\mathrm{E}[X^k] &amp; k&gt;-\\alpha \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\theta^k\\Gamma(1+\\frac{k}{\\alpha})\\Gamma\\Big[1+\\frac{k}{\\alpha};\\Big(\\frac{x}{\\theta}\\Big)^\\alpha\\Big]+x^k\\exp\\Big(-\\Big(\\frac{x}{\\theta}\\Big)^\\alpha\\Big) \\\\ &amp; k&gt;-\\alpha \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dweibull}(x=, shape=\\alpha, scale=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pweibull}(p=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qweibull}(q=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rweibull}(n=, shape=\\alpha,scale=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph alpha &lt;- 2 theta &lt;- 100 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dweibull(X,shape=alpha, scale=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Weibull Distribution&quot;) Hide Inverse Weibull Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0,\\tau&gt;0 \\\\ \\hline\\ \\small{\\text{Probability density}} &amp; \\frac{\\tau(\\theta/x)^\\tau \\exp\\Big(-\\Big(\\frac{\\theta}{x}\\Big)^\\tau\\Big)}{x} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\exp\\Big(-\\Big(\\frac{\\theta}{x}\\Big)^\\tau\\Big) \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\theta^k\\Gamma(1-(k/\\tau)) \\\\ ~~\\mathrm{E}[X^k] &amp; k&lt;\\tau \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\theta^k\\Gamma(1-(k/\\tau))[1-\\Gamma(1-(k/\\tau);(\\theta/x)^\\tau)]+x^k[1-e^{-(\\theta/x)^\\tau}] \\\\ &amp; \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dinvweibull}(x=, shape=\\tau, scale=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pinvweibull}(p=, shape=\\tau,scale=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qinvweibull}(q=, shape=\\tau,scale=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rinvweibull}(n=, shape=\\tau,scale=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph tau &lt;- 5 theta &lt;- 100 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dinvweibull(X,shape=tau,scale=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Inverse Weibull Distribution&quot;) Hide Uniform Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; -\\infty&lt;\\alpha&lt;\\beta&lt;\\infty \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{1}{\\beta-\\alpha} \\\\ \\text{f(x)} &amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\frac{x-\\alpha}{\\beta-\\alpha} \\\\ ~~F(x) &amp; \\\\ \\hline \\text{Mean} &amp; \\frac{\\beta+\\alpha}{2} \\\\ \\text{E[X]} &amp; \\\\ \\hline \\text{Variance} &amp; \\frac{(\\beta-\\alpha)^2}{12} \\\\ E[(X-\\mu)^2] &amp; \\\\ \\hline \\mathrm{E}[(X-\\mu)^k] &amp; \\mu_k=0~~~\\text{for odd }\\textit{k} \\\\ &amp; \\mu_k=\\frac{(\\beta-\\alpha)^k}{2^k (k+1)}~~~\\text{for even }\\textit{k} \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dunif}(x=, min=a, max=b) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{punif}(p=, min=a, max=b) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qunif}(q=, min=a, max=b) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{runif}(n=, min=a, max=b) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph alpha &lt;- 50 beta &lt;- 100 X &lt;- seq(alpha,beta,1) plot(x=X,y=dunif(X,alpha,beta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Continuous Uniform Distribution&quot;) Hide Normal Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; -\\infty&lt;\\mu&lt;\\infty,~\\sigma&gt;0 \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left( -\\frac{(x-\\mu)^2}{2\\sigma^2}\\right) \\\\ \\text{f(x)} &amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\Phi\\left(\\frac{x-\\mu}{\\sigma}\\right) \\\\ ~~F(x) &amp; \\\\ \\hline \\text{Mean} &amp; \\mu \\\\ \\text{E[X]} &amp; \\\\ \\hline \\text{Variance} &amp; \\sigma^2 \\\\ E[(X-\\mu)^2] &amp; \\\\ \\hline \\mathrm{E}[(x-\\mu)^k] &amp; \\mu_k=0~~~\\text{for even k} \\\\ &amp; \\mu_k=\\frac{k!\\sigma^2}{(\\frac{k}{2})! 2^{k/2}}~~~\\text{for odd k} \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dnorm}(x=, mean=\\mu, sd=\\sigma) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pnorm}(p=, mean=\\mu, sd=\\sigma) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qnorm}(q=, mean=\\mu, sd=\\sigma) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rnorm}(n=, mean=\\mu, sd=\\sigma) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph mu &lt;- 100 sigma &lt;- 10 X &lt;- seq(from=0,to=200,by=1) plot(x=X,y=dnorm(X,mean=mu,sd=sigma),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Normal Distribution&quot;) Hide Cauchy Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; -\\infty &lt;\\alpha &lt;\\infty, \\beta&gt;0 \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{1}{\\pi\\beta}[1+\\left( \\frac{x-\\alpha}{\\beta}\\right)^2]^{-1} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dcauchy}(x=, location=\\alpha, scale=\\beta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pcauchy}(p=, location=\\alpha, scale=\\beta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qcauchy}(q=, location=\\alpha, scale=\\beta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rcauchy}(n=, location=\\alpha, scale=\\beta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph alpha &lt;- 50 beta &lt;- 100 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dcauchy(X,location=alpha,scale=beta), type=&quot;l&quot;,ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Cauchy Distribution&quot;) 17.2.3 Three Parameter Distributions Generalized Pareto Burr Inv Burr Hide Generalized Pareto Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0, \\alpha&gt;0, \\tau&gt;0, u=\\frac{x}{x+\\theta} \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{\\Gamma(\\alpha+\\tau)}{\\Gamma(\\alpha)\\Gamma(\\tau)}\\frac{\\theta^\\alpha x^{\\tau-1}}{(x+\\theta)^{\\alpha+\\tau}} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\beta(\\tau,\\alpha;u) \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\frac{\\theta^k\\Gamma(\\tau+1)\\Gamma(\\alpha-k)}{\\Gamma(\\alpha)\\Gamma(\\tau)} \\\\ ~~~~\\mathrm{E}[X^k] &amp; -\\tau&lt;k&lt;\\alpha \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\frac{\\theta^k\\Gamma(\\tau+k)\\Gamma(\\alpha-k)}{\\Gamma(\\alpha)\\Gamma(\\tau)}\\beta(\\tau+k,\\alpha-k;u)+x^k[1-\\beta(\\tau,\\alpha;u)] \\\\ &amp; k&gt;-\\tau \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dgenpareto}(x=, shape1=\\alpha, shape2=\\tau, scale=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pgenpareto}(q=, shape1=\\alpha, shape2=\\tau, scale=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qgenpareto}(p=, shape1=\\alpha, shape2=\\tau, scale=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rgenpareto}(r=, shape1=\\alpha, shape2=\\tau, scale=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph alpha &lt;- 3 tau &lt;- 5 theta &lt;- 100 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dgenpareto(X,shape1=alpha,shape2=tau,scale=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Generalized Pareto Distribution&quot;) Hide Burr Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0, \\alpha&gt;0, \\gamma&gt;0, u=\\frac{1}{1+(x/\\theta)^\\gamma} \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{\\alpha\\gamma(x/\\theta)^\\gamma}{x[1+(x/\\theta)^\\gamma]^{\\alpha+1}} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; 1-u^\\alpha \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\frac{\\theta^k\\Gamma(1+(k/\\gamma))\\Gamma(\\alpha-(k/\\gamma))}{\\Gamma(\\alpha)} \\\\ ~~~~\\mathrm{E}[X^k] &amp; -\\gamma&lt;k&lt;\\alpha\\gamma \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\frac{\\theta^k\\Gamma(1+(k/\\gamma))\\Gamma(\\alpha-(k/\\gamma))}{\\Gamma(\\alpha)}\\beta(1+(k/\\gamma),\\alpha-(k/\\gamma);1-u)+x^ku^\\alpha \\\\ &amp; k&gt;-\\gamma \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dburr}(x=, shape1=\\alpha, shape2=\\gamma, scale=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pburr}(p=, shape1=\\alpha, shape2=\\gamma, scale=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qburr}(q=, shape1=\\alpha, shape2=\\gamma, scale=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rburr}(n=, shape1=\\alpha, shape2=\\gamma, scale=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph alpha &lt;- 2 gamma &lt;- 3 theta &lt;- 100 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dburr(X,shape1=alpha,shape2=gamma,scale=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Burr Distribution&quot;) Hide Inverse Burr Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0, \\tau&gt;0, \\gamma&gt;0, u=\\frac{(x/\\theta)^\\gamma}{1+(x/\\theta)^\\gamma} \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{\\tau\\gamma(x/\\theta)^{\\tau \\gamma}}{x[1+(x/\\theta)^\\gamma]^{\\tau+1}} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; u^\\tau \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\frac{\\theta^k\\Gamma(\\tau+(k/\\gamma))\\Gamma(1-(k/\\gamma))}{\\Gamma(\\tau)} \\\\ ~~~~\\mathrm{E}[X^k] &amp; -\\tau\\gamma&lt;k&lt;\\gamma \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\frac{\\theta^k\\Gamma(\\tau+(k/\\gamma))\\Gamma(1-(k/\\gamma))}{\\Gamma(\\tau)}\\beta(\\tau+(k/\\gamma),1-(k/\\gamma);u)+x^k[1-u^\\tau] \\\\ &amp; k&gt;-\\tau\\gamma \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dinvburr}(x=, shape1=\\tau, shape2=\\gamma, scale=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pinvburr}(p=, shape1=\\tau, shape2=\\gamma, scale=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qinvburr}(q=, shape1=\\tau, shape2=\\gamma, scale=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rinvburr}(n=, shape1=\\tau, shape2=\\gamma, scale=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph tau &lt;- 2 gamma &lt;- 3 theta &lt;- 100 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dinvburr(X,shape1=tau,shape2=gamma,scale=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Inverse Burr Distribution&quot;) 17.2.4 Four Parameter Distribution GB2 Hide Generalized Beta of the Second Kind (GB2) Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0, \\alpha_1&gt;0, \\alpha_2&gt;0, \\sigma&gt;0 \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{(x/\\theta)^{\\alpha_2/\\sigma}}{x \\sigma~\\mathrm{B}\\left( \\alpha_1,\\alpha_2\\right)\\left\\lbrack 1 + \\left( x/\\theta \\right)^{1/\\sigma} \\right\\rbrack^{\\alpha_1 + \\alpha_2}} \\\\ ~~ \\small{\\text{function }} f(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\frac{\\theta^{k}~\\mathrm{B}\\left( \\alpha_1 +k \\sigma,\\alpha_2 - k \\sigma \\right)}{\\mathrm{B}\\left( \\alpha_1,\\alpha_2 \\right)} \\\\ ~~~~\\mathrm{E}[X^k] &amp; \\textit{k}&gt;0 \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands Please see the R Codes for Loss Data Analytics site for information about this distribution. 17.2.5 Other Distributions Lognormal Inv Gaussian Hide Lognormal Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; -\\infty &lt;\\mu &lt;\\infty, \\sigma&gt;0 \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{1}{x\\sqrt{2\\pi}\\sigma} \\exp\\left( -\\frac{(\\ln x-\\mu)^2}{2\\sigma^2}\\right) \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\Phi\\left(\\frac{\\ln (x)-\\mu}{\\sigma}\\right) \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\exp(k\\mu+\\frac{k^2\\sigma^2}{2}) \\\\ ~~\\mathrm{E}[X^k] &amp; \\\\ \\hline \\small{\\text{Limited Expected Value}} &amp; \\exp\\Big(k\\mu+\\frac{k^2\\sigma^2}{2}\\Big)\\Phi\\Big(\\frac{\\ln (x)-\\mu-k\\sigma^2}{\\sigma}\\Big)+x^k\\Big[1-\\Phi\\Big(\\frac{\\ln (x)-\\mu}{\\sigma}\\Big)\\Big] \\\\ ~~\\mathrm{E}[X\\wedge x] &amp; \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph dlognorm &lt;- function(x,mu,sigma){ p=(1/(x*sigma*sqrt(2*pi)))*exp(-((log(x)-mu)/sigma)^2) return(p) } mu &lt;- 20 sigma &lt;- 12 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dlognorm(X,mu=mu,sigma=sigma),type=&quot;l&quot;,col=&quot;red&quot;) Hide Inverse Gaussian Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0, \\mu&gt;0, z=\\frac{x-\\mu}{\\mu}~,~y=\\frac{x+\\mu}{\\mu} \\\\ \\hline \\small{\\text{Probability density}} &amp; \\Big(\\frac{\\theta}{2\\pi x^3}\\Big)^{1/2}\\exp\\Big(\\frac{-\\theta z^2}{2x}\\Big) \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\Phi\\Big[z\\Big(\\frac{\\theta}{x}\\Big)^{1/2}\\Big]+\\exp\\Big(\\frac{2\\theta}{\\mu}\\Big)\\Phi\\Big[-y\\Big(\\frac{\\theta}{x}\\Big)^{1/2}\\Big] \\\\ ~~F(x) &amp; \\\\ \\hline \\text{Mean} &amp; \\mu \\\\ \\mathrm{E}[X] &amp; \\\\ \\hline \\mathrm{Var[X]} &amp; \\frac{\\mu^3}{\\theta}\\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; x-\\mu x\\Phi\\Big[z\\Big(\\frac{\\theta}{x}\\Big)^{1/2}\\Big]-(\\mu y)\\exp\\Big(\\frac{2\\theta}{\\mu}\\Big)\\Phi\\Big[-y\\Big(\\frac{\\theta}{x}\\Big)^{1/2}\\Big] \\\\ &amp; \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dinvgauss}(x=, mean=\\mu,dispersion=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pinvgauss}(p=, mean=\\mu,dispersion=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qinvgauss}(q=, mean=\\mu,dispersion=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rinvgauss}(n=, mean=\\mu,dispersion=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph mu &lt;- 100 theta &lt;- 1000 X &lt;- seq(from=0,to=100,by=1) plot(x=X,y=dinvgauss(X,mean=mu,dispersion=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Inverse Gaussian Distribution&quot;) 17.2.6 Distributions with Finite Support Beta Generalized Beta Hide Beta Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0, ~a&gt;0,~b&gt;0, u=\\frac{x}{\\theta},~0&lt;x&lt;\\theta \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{\\Gamma(a+b)}{\\Gamma(a)\\Gamma(b)} u^a(1-u)^{b-1}\\frac{1}{x} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\beta(a,b;u) \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\frac{\\theta^k \\Gamma(a+b)\\Gamma(a+k)}{\\Gamma(a)\\Gamma(a+b+k)} \\\\ ~~\\mathrm{E}[X^k] &amp; k&gt;-a \\\\ \\hline &amp; \\frac{\\theta^k a(a+1)\\cdots(a+k-1)}{(a+b)(a+b+1)\\cdots(a+b+k-1)}\\beta(a+k,b;u)+x^k[1-\\beta(a,b;u)] \\\\ ~~\\mathrm{E}[X\\wedge x]^k &amp; \\\\ \\hline \\end{array} \\end{matrix} \\] R Commands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dbeta}(x=, shape1=a,shape2=b,ncp=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pbeta}(p=, shape1=a,shape2=b,ncp=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qbeta}(q=, shape1=a,shape2=b,ncp=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rbeta}(n=, shape1=a,shape2=b,ncp=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] a &lt;- 2 b &lt;- 4 theta &lt;- 1 X &lt;- seq(from=0,to=1,by=.0001) plot(x=X,y=dbeta(X,shape1=a,shape2=b,ncp=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Beta Distribution&quot;) Hide Generalized Beta Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Name} &amp; \\text{Function} \\\\ \\hline \\small{\\text{Parameter assumptions}} &amp; \\theta&gt;0, a&gt;0, b&gt;0, \\tau&gt;0, 0&lt;x&lt;\\theta~,~u=(x/\\theta)^\\tau \\\\ \\hline \\small{\\text{Probability density}} &amp; \\frac{\\Gamma(a+b)}{\\Gamma(a)\\Gamma(b)}u^\\alpha(1-u)^{b-1}\\frac{\\tau}{x} \\\\ ~~ \\small{\\text{function }} f(x)&amp; \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\beta(a,b;u) \\\\ ~~F(x) &amp; \\\\ \\hline \\textit{k}^{th}~\\small{\\text{raw moment}} &amp; \\frac{\\theta^k\\Gamma(a+b)\\Gamma(a+(k/\\tau))}{\\Gamma(a)\\Gamma(a+b+(k/\\tau))} \\\\ ~~\\mathrm{E}[X^k] &amp; k&gt;-\\alpha\\tau \\\\ \\hline \\mathrm{E}[(X\\wedge x)^k] &amp; \\frac{\\theta^k\\Gamma(a+b)\\Gamma(a+(k/\\tau))}{\\Gamma(a)\\Gamma(a+b+(k/\\tau))}\\beta(a+(k/\\tau),b;u)+x^k[1-\\beta(a,b;u)] \\\\ \\hline \\end{array} \\end{matrix} \\] R Commmands \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Function Name} &amp; \\text{R Command} \\\\ \\hline \\small{\\text{Density function}} &amp; \\text{dgenbeta}(x=, shape1=a,shape2=b,shape3=\\tau,scale=\\theta) \\\\ \\hline \\small{\\text{Distribution function}} &amp; \\text{pgenbeta}(p=, shape1=a,shape2=b,shape3=\\tau,scale=\\theta) \\\\ \\hline \\small{\\text{Quantile function}} &amp; \\text{qgenbeta}(q=, shape1=a,shape2=b,shape3=\\tau,scale=\\theta) \\\\ \\hline \\small{\\text{Random sampling function}} &amp; \\text{rgenbeta}(n=, shape1=a,shape2=b,shape3=\\tau,scale=\\theta) \\\\ \\hline \\end{array} \\end{matrix} \\] Illustrative Graph a &lt;- 3 b &lt;- 5 tau &lt;- 2 theta &lt;- 1000 X &lt;- seq(from = 0, to = 1000, by = 1) plot(x=X,y=dgenbeta(X,shape1=a,shape2=b,shape3=tau,scale=theta),type=&quot;l&quot;, ylab=&quot;Probability density&quot;,col=&quot;red&quot;,main=&quot;Generalized Beta Distribution&quot;) 17.3 Limited Expected Values Overview. This section summarizes limited expected values for selected continuous distributions. Functions Graph Hide Functions Limited Expected Value Functions \\[ \\begin{matrix} \\begin{array}{l|c} \\hline \\text{Distribuion} &amp; \\text{Function} \\\\ \\hline \\text{GB2} &amp; \\frac{\\theta\\Gamma(\\tau+1)\\Gamma(\\alpha-1)}{\\Gamma(\\alpha)\\Gamma(\\tau)}\\beta(\\tau+1,\\alpha-1;\\frac{x}{x+\\beta})+x[1-\\beta(\\tau,\\alpha;\\frac{x}{x+\\beta})] \\\\ \\hline \\text{Burr} &amp; \\frac{\\theta\\Gamma(1+\\frac{1}{\\gamma})\\Gamma(\\alpha-\\frac{1}{\\gamma})}{\\Gamma(\\alpha)}\\beta(1+\\frac{1}{\\gamma},\\alpha-\\frac{1}{\\gamma};1-\\frac{1}{1+(x/\\theta)^\\gamma})+x\\Big(\\frac{1}{1+(x/\\theta)^\\gamma}\\Big)^\\alpha \\\\ \\hline \\text{Inverse Burr} &amp; \\frac{\\theta\\Gamma(\\tau+(1/\\gamma))\\Gamma(1-(1/\\gamma))}{\\Gamma(\\tau)}\\beta(\\tau+\\frac{1}{\\gamma},1-\\frac{1}{\\gamma};\\frac{(x/\\theta)^\\gamma}{1+(x/\\theta)^\\gamma})+x[1-\\Big(\\frac{(x/\\theta)^\\gamma}{1+(x/\\theta)^\\gamma}\\Big)^\\tau] \\\\ \\hline \\text{Pareto} &amp; \\\\ \\alpha=1 &amp; -\\theta \\ln \\Big(\\frac{\\theta}{x+\\theta}\\Big) \\\\ \\alpha\\neq1 &amp; \\frac{\\theta}{\\alpha-1}[1-\\Big(\\frac{\\theta}{x+\\theta}\\Big)^{\\alpha-1}] \\\\ \\hline \\text{Inverse Pareto} &amp; \\theta\\tau\\int^{x/(x+\\theta)}_0~y^\\tau(1-y)^{-1}dy+x[1-\\Big(\\frac{x}{x+\\theta}\\Big)^\\tau] \\\\ \\hline \\text{Loglogistic} &amp; \\theta\\Gamma(1+\\frac{1}{\\gamma})\\Gamma(1-\\frac{1}{\\gamma})\\beta(1+\\frac{1}{\\gamma},1-\\frac{1}{\\gamma};\\frac{(x/\\theta)^\\gamma}{1+(x/\\theta)^\\gamma})+x(1-\\frac{(x/\\theta)^\\gamma}{1+(x/\\theta)^\\gamma}) \\\\ \\hline \\text{Paralogistic} &amp; \\frac{\\theta\\Gamma(1+\\frac{1}{\\alpha})\\Gamma(\\alpha-\\frac{1}{\\alpha})}{\\Gamma(\\alpha)}\\beta(1+\\frac{1}{\\alpha},\\alpha-\\frac{1}{\\alpha};1-\\frac{1}{1+(x/\\theta)^\\alpha})+x\\Big(\\frac{1}{1+(x/\\theta)^\\alpha}\\Big)^\\alpha \\\\ \\hline \\text{Inverse Paralogistic} &amp; \\frac{\\theta\\Gamma(\\tau+\\frac{1}{\\tau})\\Gamma(1-\\frac{1}{\\tau})}{\\Gamma(\\tau)}\\beta(\\tau+\\frac{1}{\\tau},1-\\frac{1}{\\tau};\\frac{(x/\\theta)^\\tau}{1+(x/\\theta)^\\tau})+x[1-\\Big(\\frac{(x/\\theta)^\\tau}{1+(x/\\theta)^\\tau}\\Big)^\\tau] \\\\ \\hline \\text{Gamma} &amp; \\frac{\\theta\\Gamma(\\alpha+1)}{\\Gamma(\\alpha)}\\Gamma(\\alpha+1;\\frac{x}{\\theta})+x[1-\\Gamma(\\alpha;\\frac{x}{\\theta})] \\\\ \\hline \\text{Inverse Gamma} &amp; \\frac{\\theta\\Gamma(\\alpha-1)}{\\Gamma(\\alpha)}[1-\\Gamma(\\alpha-1;\\frac{\\theta}{x})]+x\\Gamma(\\alpha;\\frac{\\theta}{x}) \\\\ \\hline \\text{Weibull} &amp; \\theta\\Gamma(1+\\frac{1}{\\alpha})\\Gamma(1+\\frac{1}{\\alpha};\\Big(\\frac{x}{\\theta}\\Big)^\\alpha)+x*\\exp(-(x/\\theta)^\\alpha) \\\\ \\hline \\text{Inverse Weibull} &amp; \\theta\\Gamma(1-\\frac{1}{\\alpha})[1-\\Gamma(1-\\frac{1}{\\alpha};\\Big(\\frac{\\theta}{x}\\Big)^\\alpha)]+x[1-\\exp(-(\\theta/x)^\\alpha)] \\\\ \\hline \\text{Exponential} &amp; \\theta(1-\\exp(-(x/\\theta))) \\\\ \\hline \\text{Inverse Exponential} &amp; \\theta G(0;\\frac{\\theta}{x})+x(1-\\exp(-(\\theta/x))) \\\\ \\hline \\text{Lognormal} &amp; \\exp(\\mu+\\sigma^2/2)\\Phi\\Big(\\frac{\\ln (x)-\\mu-\\sigma^2}{\\sigma}\\Big)+x[1-\\Phi\\Big(\\frac{\\ln (x)-\\mu}{\\sigma}\\Big)] \\\\ \\hline \\text{Inverse Gaussian} &amp; x-\\mu\\Big(\\frac{x-\\mu}{\\mu}\\Big)\\Phi\\Big[\\Big(\\frac{x-\\mu}{\\mu}\\Big)\\Big(\\frac{\\theta}{x}\\Big)^{1/2}\\Big]-\\mu\\Big(\\frac{x+\\mu}{\\mu}\\Big)\\exp\\Big(\\frac{2\\theta}{\\mu}\\Big)\\Phi\\Big[-\\Big(\\frac{x+\\mu}{\\mu}\\Big)\\Big(\\frac{\\theta}{x}\\Big)^{1/2}\\Big] \\\\ \\hline \\text{Single-Parameter Pareto} &amp; \\frac{\\alpha\\theta}{\\alpha-1}-\\frac{\\theta^\\alpha}{(\\alpha-1)x^{\\alpha-1}} \\\\ \\hline \\text{Generalized Beta} &amp; \\frac{\\theta\\Gamma(a+b)\\Gamma(a+\\frac{1}{\\tau})}{\\Gamma(a)\\Gamma(a+b+\\frac{1}{\\tau})}\\beta(a+\\frac{1}{\\tau},b;\\Big(\\frac{x}{\\theta}\\Big)^\\tau)+x\\Big[1-\\beta(a,b;\\Big(\\frac{x}{\\theta}\\Big)^\\tau)\\Big] \\\\ \\hline \\text{Beta} &amp; \\frac{\\theta a}{(a+b)}\\beta(a+1,b;\\frac{x}{\\theta})+x[1-\\beta(a,b;\\frac{x}{\\theta})] \\\\ \\hline \\end{array} \\end{matrix} \\] Hide Illustrative Graph Comparison of Limited Expected Values for Selected Distributions \\[ \\begin{matrix} \\begin{array}{l|c|c|c|c|c|c} \\hline \\text{Distribution} &amp; \\text{Parameters} &amp; \\mathrm{E}[x] &amp; E[X\\wedge100] &amp; E[X\\wedge250] &amp; E[X\\wedge500] &amp;E[X\\wedge1000] \\\\ \\hline \\text{Pareto} &amp; \\alpha = 3, \\theta = 200 &amp; 100 &amp; 55.55 &amp;80.25 &amp; 91.84 &amp; 97.22 \\\\ \\hline \\text{Exponential} &amp; \\theta = 100 &amp; 100 &amp; 63.21 &amp; 91.79 &amp; 99.33 &amp; 99.99 \\\\ \\hline \\text{Gamma} &amp; \\alpha = 2, \\theta = 50 &amp; 100 &amp; 72.93 &amp; 97.64 &amp; 99.97 &amp; 100 \\\\ \\hline \\text{Weibull} &amp; \\tau=2, \\theta=\\frac{200}{\\sqrt[]{\\pi}} &amp; 100 &amp; 78.99 &amp; 99.82 &amp; 100 &amp; 100 \\\\ \\hline \\text{GB2} &amp; \\alpha = 3,\\tau=2,\\theta = 100 &amp; 100 &amp; 62.50 &amp; 86.00 &amp; 94.91 &amp; 98.42 \\\\ \\hline \\end{array} \\end{matrix} \\] "],
["bibliography.html", "Bibliography", " Bibliography "]
]
